;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="6480e9a6-1cc9-a1da-8f8a-7ae53ba3a4ca")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7712782,e=>{"use strict";var t=e.i(7432042);let a="Just now",l=" ago",i=(0,t.default)("1s"),r=(0,t.default)("1m"),s=(0,t.default)("1h"),n=(0,t.default)("1y"),d=(0,t.default)("1y")/12,o=(0,t.default)("1w"),c=(0,t.default)("1d"),u=new Intl.DateTimeFormat("en",{day:"numeric",month:"short"}),h=new Intl.DateTimeFormat("en",{dateStyle:"short"});e.s(["AGO_JUST_NOW_LABEL_DEFAULT",0,a,"AGO_JUST_NOW_THRESHOLD_DEFAULT",0,44e3,"AGO_SUFFIX_DEFAULT",0,l,"DAYS_LEFT_SUFFIX_DEFAULT",0," days left","ago",0,function(e){let{long:g,suffix:x=l,justNowThreshold:f=44e3,justNowLabel:m=a,includeSeconds:p,formatYearsWeeksMonths:j,alwaysRelative:_=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return"";let v=Math.max(e,1e3);if(v<f)return m;if(p){let e=Math.round(v/i)*i,a=e%r,l=e-a,n=a>0&&a<r&&l<s?(0,t.default)(a):"",d=l>0?(0,t.default)(l):"";return`${d}${n&&d?" ":""}${n}${x}`}if(!_){if(v<3*c)return`${(0,t.default)(v)}${x}`;let a=new Date,l=new Date(a.valueOf()-e);return(l.getFullYear()===a.getFullYear()?u:h).format(l)}if(j){let e=Math.floor(v/n);if(e>0)return`${e}y${x}`;let t=Math.floor(v/d);if(t>0)return`${t}mo${x}`;let a=Math.floor(v/o);if(a>0)return`${a}w${x}`}return`${(0,t.default)(v,{long:g})}${x}`}])},85019,e=>{"use strict";var t=e.i(7712782);e.s(["AGE_JUST_NOW_THRESHOLD",0,0,"AGE_SUFFIX",0,"","age",0,function(e){let{includeSeconds:a,includeSuffix:l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,t.ago)(e,{suffix:l?void 0:"",justNowThreshold:0,includeSeconds:a})}])},7218483,e=>{"use strict";var t=e.i(6695816),a=e.i(85019),l=e.i(7712782);function i(e){let{long:a,suffix:i=l.AGO_SUFFIX_DEFAULT,justNowThreshold:r=l.AGO_JUST_NOW_THRESHOLD_DEFAULT,justNowLabel:s=l.AGO_JUST_NOW_LABEL_DEFAULT,includeSeconds:n,formatYearsWeeksMonths:d,alwaysRelative:o}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},[c,u]=(0,t.useReducer)(Date.now,null,Date.now),h=(0,t.useMemo)(()=>{if(!e)return null;let t=Math.max(c-e,0);return!n&&t>6e4?6e4:t<r?Math.max(r-t,1e3):1e3},[c,e,r,n]);return((0,t.useEffect)(()=>{if(h){let e=setInterval(u,h);return()=>clearInterval(e)}},[h]),e)?(0,l.ago)(c-e,{long:a,suffix:i,justNowLabel:s,justNowThreshold:r,includeSeconds:n,formatYearsWeeksMonths:d,alwaysRelative:o}):""}e.s(["useAge",0,function(e){let{includeSeconds:t,justNowThreshold:l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return i(e,{suffix:a.AGE_SUFFIX,justNowThreshold:l||a.AGE_JUST_NOW_THRESHOLD,includeSeconds:t})},"useAgo",0,i,"useDaysLeft",0,function(e){if(!e)return"";let t=Math.max(Math.floor((e-Date.now())/864e5),0);return t>1?`${t} ${l.DAYS_LEFT_SUFFIX_DEFAULT}`:"1 day left"}])},7886235,e=>{e.v({checked:"toggle-module__fUrgQa__checked",disabled:"toggle-module__fUrgQa__disabled",input:"toggle-module__fUrgQa__input "+e.i(5472387).visuallyHidden,large:"toggle-module__fUrgQa__large",medium:"toggle-module__fUrgQa__medium",noMargin:"toggle-module__fUrgQa__noMargin",switchFirst:"toggle-module__fUrgQa__switchFirst",thumb:"toggle-module__fUrgQa__thumb",thumbIcon:"toggle-module__fUrgQa__thumbIcon",titleCasing:"toggle-module__fUrgQa__titleCasing",toggle:"toggle-module__fUrgQa__toggle",wrapper:"toggle-module__fUrgQa__wrapper"})},1906681,e=>{"use strict";var t=e.i(31889),a=e.i(6695816),l=e.i(9722978),i=e.i(4004502),r=e.i(9544652),s=e.i(7886235);let n={amber:{background:"--ds-amber-700",foreground:"--ds-amber-100",lightModeForeground:"--ds-amber-1000",checkedBackground:"--ds-gray-100"},"amber-inverted":{background:"--ds-gray-100",foreground:"--ds-gray-100",lightModeForeground:"--ds-amber-1000",checkedBackground:"--ds-amber-700"},"amber-track-only":{background:"--ds-amber-700",foreground:"--ds-black",lightModeForeground:"--ds-black",checkedBackground:"--ds-gray-100"},red:{background:"--ds-red-600",foreground:"--ds-red-100",lightModeForeground:"--ds-red-1000",checkedBackground:"--ds-gray-100"}};e.s(["Toggle",0,e=>{let{className:d,children:o,size:c,disabled:u,name:h,checked:g,onChange:x,onClick:f,onBlur:m,onFocus:p,onKeyDown:j,noMargin:_,direction:v="label-first",labelCasing:y="title",stopPropagation:b=!1,icon:C,color:w,...E}=e,A=(0,r.useDisabled)()||u,T=(0,a.useCallback)(e=>{!A&&x&&(b&&e.stopPropagation(),x(!g))},[g,x,A,b]),N={...E.style};if(w){let e=n[w];N["--unchecked-bg-color-override"]=`var(${e.background})`,N["--checked-bg-color-override"]=`var(${e.checkedBackground})`,N["--thumb-fg-color-override"]=`var(${e.foreground})`,e.lightModeForeground&&(N["--thumb-light-fg-color-override"]=`var(${e.lightModeForeground})`)}return(0,t.jsxs)("label",{className:(0,l.clsx)(s.default.wrapper,d,{[String(s.default.large)]:"large"===c,[String(s.default.medium)]:"medium"===c,[String(s.default.switchFirst)]:"switch-first"===v,[String(s.default.titleCasing)]:"title"===y}),"data-version":"v1",...E,style:N,children:[o?(0,t.jsx)("span",{children:o}):null,(0,t.jsx)("input",{checked:g,className:(0,l.clsx)(s.default.input,"group"),"data-testid":(0,i.tid)(E["data-testid"]??"toggle","input"),disabled:A,name:h,onBlur:m,onChange:T,onClick:f,onFocus:p,onKeyDown:e=>{"Enter"===e.key&&T(e),j?.(e)},type:"checkbox"}),(0,t.jsx)("span",{className:(0,l.clsx)(s.default.toggle,{[String(s.default.checked)]:g,[String(s.default.disabled)]:A,[String(s.default.noMargin)]:_},""),children:(0,t.jsx)("div",{className:(0,l.clsx)(s.default.thumb,{[String(s.default.checked)]:g}),children:C?(0,t.jsxs)("div",{"aria-hidden":!0,className:(0,l.clsx)({[String(s.default.checked)]:g,[String(s.default.thumbIcon)]:!A},"flex justify-center items-center w-full h-full",A?"text-gray-700":"text-gray-900 dark:text-background-100"),children:[g?C.checked:null,g?null:C.unchecked]}):null})})]})}])},4075507,e=>{e.v({border:"card-module__OLxv4G__border",borderBetweenHorizontal:"card-module__OLxv4G__borderBetweenHorizontal",borderBetweenVertical:"card-module__OLxv4G__borderBetweenVertical",card:"card-module__OLxv4G__card",hoverable:"card-module__OLxv4G__hoverable",rounded:"card-module__OLxv4G__rounded",secondary:"card-module__OLxv4G__secondary",shadow:"card-module__OLxv4G__shadow"})},4138437,e=>{"use strict";var t=e.i(31889),a=e.i(9722978),l=e.i(9508212),i=e.i(4075507);e.s(["Card",0,function(e){let{children:r,direction:s="column",className:n,border:d,borderBetween:o,secondary:c,hoverable:u,shadow:h,rounded:g=!0,...x}=e;return(0,t.jsx)(l.Stack,{...x,className:(0,a.clsx)(i.default.card,{[i.default.border||""]:d,[i.default.borderBetweenHorizontal||""]:o&&"row"===s,[i.default.borderBetweenVertical||""]:o&&"column"===s,[i.default.secondary||""]:c,[i.default.hoverable||""]:u,[i.default.shadow||""]:h,[i.default.rounded||""]:g},n),direction:s,children:r})}])},1000921,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M5.25 7.25H4.5V8.75H5.25H9.43934L7.96967 10.2197L7.43934 10.75L8.5 11.8107L9.03033 11.2803L11.7803 8.53033C12.0732 8.23744 12.0732 7.76256 11.7803 7.46967L9.03033 4.71967L8.5 4.18934L7.43934 5.25L7.96967 5.78033L9.43934 7.25H5.25ZM8 14.5C4.41015 14.5 1.5 11.5899 1.5 8C1.5 4.41015 4.41015 1.5 8 1.5C11.5899 1.5 14.5 4.41015 14.5 8C14.5 11.5899 11.5899 14.5 8 14.5ZM0 8C0 12.4183 3.58172 16 8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8Z" fill="currentColor"/>');e.s(["ArrowCircleRight",0,t])},7429602,e=>{"use strict";var t=e.i(31889),a=e.i(3306538),l=e.i(2504781),i=e.i(4557026),r=e.i(9722978);e.s(["default",0,function(e){let{feedback:s,muted:n,size:d,variant:o,className:c}=e;return(0,t.jsxs)("div",{className:(0,r.clsx)("flex items-center gap-[var(--geist-space)]",c),children:[(0,t.jsx)(a.Badge,{className:n?"text-[var(--geist-background)] bg-[var(--accents-3)] border-0 dark:text-[var(--geist-background)] dark:bg-[var(--accents-6)]":"",size:d,variant:n?"gray-subtle":o||"pink",children:"Beta"}),s?(0,t.jsx)(l.Button,{className:"sm:block max-[600px]:hidden",onClick:i.dispatchShowFeedbackEvent,size:"small",type:"tertiary",typeName:"button",children:"Provide feedback"}):null]})}])},7450862,e=>{"use strict";var t=e.i(6695816);function a(){return window.location.hash.slice(1)}let l="hashreset";function i(e){let t=window.navigation;return t?.addEventListener&&t.addEventListener("currententrychange",e),window.addEventListener("hashchange",e),window.addEventListener("popstate",e),window.addEventListener(l,e),()=>{t?.removeEventListener?.("currententrychange",e),window.removeEventListener("hashchange",e),window.removeEventListener("popstate",e),window.removeEventListener(l,e)}}e.s(["useHash",0,function(){return{hash:(0,t.useSyncExternalStore)(i,a,a),setHash:(0,t.useCallback)(e=>{if(e)window.location.hash=`#${e}`;else{let e=new URL(window.location.href);e.hash="",history.replaceState(void 0,document.title,e),window.dispatchEvent(new Event(l))}},[])}}])},185801,e=>{"use strict";var t=e.i(31889),a=e.i(2504781),l=e.i(7137884),i=e.i(5063443),r=e.i(8517043),s=e.i(1232681),n=e.i(9318197),d=e.i(3895030),o=e.i(9792418),c=e.i(5468328),u=e.i(57106),h=e.i(6143247),g=e.i(7450862),x=e.i(6239252),f=e.i(4004502),m=e.i(9544652),p=e.i(3277920),j=e.i(7429602);e.s(["ProjectSettingsFieldset",0,function(e){let{title:_,description:v,note:y,error:b,type:C,disabled:w=!1,disabledForBilling:E,disabledWall:A=!0,onSave:T=null,saveLoading:N=!1,saveDisabled:k=!1,saveDisabledMessage:S,highlightNote:L=!1,beta:D=!1,action:F=null,className:P,children:M,headerNote:I,disabledAction:O}=e,U=(0,p.useMounted)(),{hash:B}=(0,g.useHash)(),$=(0,m.useDisabled)(w),G=O?(0,t.jsx)(s.FieldsetFooter.Actions,{children:O}):null,H=_.toLowerCase().replaceAll(" ","-");return(0,t.jsx)("div",{className:(0,h.cn)(P,"scroll-mt-16 @md-page:scroll-mt-28"),id:H,children:(0,t.jsxs)(r.Fieldset,{"data-testid":(0,f.tid)("project-settings",_),disabled:$&&void 0===E,type:$||E||"error"!==C?"default":"error",highlight:B===H&&U,children:[(0,t.jsxs)(l.FieldsetContent,{disabled:E,disabledWall:A,children:[(0,t.jsx)(o.FieldsetTitle,{children:(0,t.jsxs)("div",{className:"flex flex-initial flex-row items-center justify-start gap-3 flex-wrap",children:[(0,t.jsx)("a",{href:`#${H}`,style:{color:"inherit",textDecoration:"none"},children:(0,t.jsx)(x.SearchContextHighlighter,{children:_})}),D?(0,t.jsx)(j.default,{muted:E}):null,I]})}),(0,t.jsx)(d.FieldsetSubtitle,{children:v}),M]}),(0,t.jsxs)(s.FieldsetFooter,{disabled:!1,highlight:E||L,className:"text-gray-900",children:[(0,t.jsx)(s.FieldsetFooter.Status,{children:b?(0,t.jsx)(i.ErrorText,{children:b instanceof Error?(0,t.jsxs)(t.Fragment,{children:[b.message,b?.link?(0,t.jsxs)(t.Fragment,{children:[" ",(0,t.jsx)(u.Link,{href:b.link,type:"blend",children:b.action??"Learn More"})]}):null]}):b}):y||null}),(0,t.jsx)(n.Spacer,{x:.5}),!$&&(T||F)?(0,t.jsxs)(s.FieldsetFooter.Actions,{children:[T?(0,t.jsx)(c.Tooltip,{text:S,children:(0,t.jsx)(a.Button,{"data-testid":(0,f.tid)("project-settings","save"),disabled:$||k,loading:N,onClick:T,size:"small",children:"Save"})}):null,F]}):G]})]})})}])},5129317,e=>{e.v({linkButton:"index-module__1SkRrq__linkButton"})},278937,e=>{"use strict";var t=e.i(31889),a=e.i(2504781),l=e.i(4030453),i=e.i(6891161),r=e.i(5255926),s=e.i(1906681),n=e.i(5468328),d=e.i(455575),o=e.i(57106),c=e.i(1000921),u=e.i(6695816),h=e.i(8042625),g=e.i(277234),x=e.i(4244280),f=e.i(5338940),m=e.i(4670733),p=e.i(1717203),j=e.i(7557283),_=e.i(1138941),v=e.i(6060673),y=e.i(185801),b=e.i(5129317);function C(){let[e,C]=(0,u.useState)(!1),[w,E]=(0,u.useState)(null),A=(0,_.useProjectIdOrName)(),{team:T,isReady:N}=(0,f.useTeam)(),k=(0,d.useToasts)(),{data:S,mutate:L}=(0,v.useProject)(A),{can:D}=(0,p.default)(),{loading:F,error:P,purgeDataCache:M}=function(){let[e,t]=(0,u.useState)({loading:!1,error:null,data:null}),{isReady:a,team:l}=(0,f.useTeam)();return{...e,purgeDataCache:i=>{let{projectId:r,onSuccess:s,onError:n}=i;if(!a||!r)return;t({data:null,error:null,loading:!0});let d={teamId:l?.id,projectIdOrName:r},o=`${x.API_DATA_CACHE_PURGE_ALL}${(0,h.encode)(d)}`;(0,g.fetchAPI)(o,{method:"DELETE"}).then(()=>{t({...e,loading:!1,data:{status:200}}),s?.()}).catch(a=>{t({...e,loading:!1,error:a}),n?.()})}}}(),[I,O]=(0,u.useState)(!1),U=!S||!N,B=D(j.Action.Update,j.Resource.Project),$=!U&&B,G=!S?.dataCache?.userDisabled,{value:H}=(0,m.useLaunchDarklyFeatureFlag)("data-cache-billing-feature"),R=(0,u.useCallback)(async()=>{try{if(!S)return;let e=S.id,t=T?.id;C(!0),await (0,g.fetchAPI)(`${(0,x.API_PROJECTS_DATA_CACHE)(e)}${(0,h.encode)({teamId:t})}`,{method:"PATCH",body:{disabled:G},throwOnHTTPError:!0}),await L()}catch(e){if(e instanceof Error)return void E(e);throw e}finally{C(!1)}},[C,E,G,T,S,L]);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.Modal.Modal,{active:I,onClickOutside:()=>O(!1),children:[(0,t.jsxs)(i.Modal.Body,{children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial mb-4",children:[(0,t.jsx)(i.Modal.Title,{children:"Purge Data Cache"}),(0,t.jsx)(i.Modal.Subtitle,{children:"All data in the cache will be deleted and then re-validated on next request."})]}),(0,t.jsxs)("p",{className:"text-copy-16",children:["This may cause a ",(0,t.jsx)("strong",{children:"temporary increase"})," in request times for users while new data is re-fetched."]})]}),(0,t.jsxs)(i.Modal.Actions,{children:[(0,t.jsx)(i.Modal.Action,{onClick:()=>O(!1),type:"secondary",children:"Cancel"}),(0,t.jsx)(i.Modal.Action,{disabled:F,onClick:()=>{M({projectId:S?.id,onSuccess:()=>{O(!1),k.success("Cache purged successfully.")},onError:()=>{k.error("Cache purge failed.")}})},type:"error",children:"Continue & Purge Data Cache"})]})]}),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-8 flex-initial tailwind-preflight",children:(0,t.jsxs)(y.ProjectSettingsFieldset,{description:(0,t.jsx)("span",{className:"text-copy-14 text-gray-900",children:"Manage data and components cached automatically by compatible frameworks when using Vercel Functions"}),disabled:U,disabledForBilling:(!!U||!B)&&void 0,error:P,note:(0,t.jsxs)(t.Fragment,{children:["Learn more about ",(0,t.jsx)(o.Link,{external:!0,href:"/docs/infrastructure/data-cache",type:"highlight",children:"Data Cache"})]}),saveDisabled:!$,saveLoading:F,title:"Data Cache",children:[H?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[(0,t.jsx)(s.Toggle,{checked:G,disabled:U||!B||e,onChange:()=>void R(),size:"large"}),(0,t.jsx)("p",{className:"text-copy-14",children:G?"Enabled":"Disabled"})]}),w?(0,t.jsx)("div",{className:"flex flex-col items-start justify-start gap-2 flex-initial",style:{marginTop:"8px"},children:(0,t.jsx)(l.Error,{error:w})}):null]}):null,(0,t.jsxs)(r.Skeleton,{show:U,children:[(0,t.jsx)("div",{className:"my-5",children:(0,t.jsx)("hr",{className:"geist-hr-reset"})}),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between gap-1 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:[(0,t.jsx)("h5",{className:"text-heading-16",children:"Purge Cache"}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"Delete the entire contents of the Data Cache"})]}),(0,t.jsx)(n.Tooltip,{disableTriggers:B,text:"You need additional permissions to purge cache.",children:(0,t.jsx)(a.Button,{"aria-label":"Trash can",disabled:U||!B,onClick:()=>O(!0),svgOnly:!0,children:"Purge Data Cache"})})]})}),(0,t.jsx)("div",{className:"my-5",children:(0,t.jsx)("hr",{className:"geist-hr-reset"})}),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between gap-1 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:[(0,t.jsx)("h5",{className:"text-heading-16",children:"Cache Usage"}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"View most requested cached data, hit/miss ratio and more"})]}),(0,t.jsx)(o.Link,{className:b.default.linkButton,href:T?`/${T.slug}/~/usage#data-cache`:"/dashboard/usage#data-cache",variant:"highlight",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-start gap-2 flex-initial",children:[(0,t.jsx)("span",{children:"View Usage"}),(0,t.jsx)(c.ArrowCircleRight,{})]})})]})})]})]})})]})}var w=e.i(1515636),E=e.i(8893913),A=e.i(3306538),T=e.i(4138437),N=e.i(3500331),k=e.i(1848296),S=e.i(5323212),L=e.i(9318197),D=e.i(3671642),F=e.i(9722978);function P(e){let{active:a,hideModal:l,disabled:r,onContinue:s,title:n,subtitle:d,description:o,type:c}=e;return(0,t.jsxs)(i.Modal.Modal,{active:a,onClickOutside:()=>l(),children:[(0,t.jsxs)(i.Modal.Body,{children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial mb-4",children:[(0,t.jsx)(i.Modal.Title,{children:n}),(0,t.jsx)(i.Modal.Subtitle,{children:d})]}),(0,t.jsx)("p",{className:"text-copy-16",children:o})]}),(0,t.jsxs)(i.Modal.Actions,{children:[(0,t.jsx)(i.Modal.Action,{onClick:()=>l(),type:"secondary",children:"Cancel"}),(0,t.jsxs)(i.Modal.Action,{disabled:r,onClick:s,type:c,children:["Continue & ",n]})]})]})}function M(e,t){if("invalidate"===t&&"*"===e)return"Cannot invalidate all";if(0===e.trim().length)if("invalidate"===t)return"Required";else return"Required (or use * to purge all)";return null}function I(e){let{radioValue:a,enabledValue:l,label:i,description:r,badge:s,badgeColor:n}=e;return(0,t.jsx)(T.Card,{className:(0,F.default)("border p-0 pl-4",{"border-solid border-[var(--ds-blue-700)]":a===l}),gap:2,padding:4,secondary:a===l,children:(0,t.jsx)(k.RadioGroup.Item,{className:"items-center",fullWidth:!0,value:l,children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-between flex-initial p-4 pl-2",children:[(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-start flex-initial",children:[(0,t.jsx)("p",{className:"text-[14px] leading-[20px] font-medium",children:i}),(0,t.jsxs)("div",{className:"flex flex-row items-stretch justify-start flex-initial",children:[(0,t.jsx)(L.Spacer,{x:1}),s?(0,t.jsx)(A.Badge,{className:"w-fit p-2 normal-case",size:"sm",variant:n,children:s}):null]})]}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:r})]})})},a)}function O(e){let{active:a,hideModal:l,disabled:r,onPurgeAll:s,onPurgeSpecific:n}=e,[d,o]=(0,u.useState)(""),[c,h]=(0,u.useState)("invalidate"),[g,x]=(0,u.useState)("tag"),[f,m]=(0,u.useState)(null),p=()=>{o(""),h("invalidate"),x("tag"),m(null)};return(0,t.jsxs)(i.Modal.Modal,{active:a,width:510,onClickOutside:()=>{l()},children:[(0,t.jsx)(i.Modal.Body,{children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,t.jsx)(i.Modal.Title,{children:"Purge CDN Cache"}),(0,t.jsx)(k.RadioGroup,{name:"Purge Method",label:"Purge Method",onChange:e=>{h(e),m(M(d,e))},value:c,children:(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:[(0,t.jsx)(I,{label:"Invalidate content",description:"The next request will serve stale content while revalidating in the background.",radioValue:c,enabledValue:"invalidate",badge:"Recommended",badgeColor:"blue-subtle"}),(0,t.jsx)(I,{label:"Delete content",description:"The next request will block while revalidating, causing high latency or downtime if your backend is unresponsive.",radioValue:c,enabledValue:"delete",badge:"Dangerous",badgeColor:"red-subtle"})]})}),(0,t.jsx)(D.Label,{value:"Purge By:",id:"tags-input-element",children:(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)("div",{className:"flex-none",children:(0,t.jsxs)(S.Select,{"aria-label":"Purge By:",onChange:e=>x(e.target.value),value:g,children:[(0,t.jsx)("option",{value:"tag",children:"Cache Tag"}),(0,t.jsx)("option",{value:"srcimg",children:"Src Image"})]})}),(0,t.jsx)("div",{className:"grow",children:(0,t.jsx)(N.Input,{"aria-label":"Purge By:",error:f,explicitId:"tags-input-element",placeholder:"tag"===g?"product1,product2,product3":"/assets/logo.png",onChange:e=>{let t=e.target.value;o(t),m(M(t,c))},required:!0,value:d})})]})})]})}),(0,t.jsxs)(i.Modal.Actions,{children:[(0,t.jsx)(i.Modal.Action,{onClick:()=>{l(),p()},type:"secondary",children:"Cancel"}),(0,t.jsx)(i.Modal.Action,{disabled:r||!!f,onClick:()=>{let e=M(d,c);m(e),e||("*"===d?s():n({purgeMethod:c,valueType:g,value:d}),p())},type:"error",children:"*"===d?"Purge All":"Purge"})]})]})}var U=e.i(7218483),B=e.i(7909933),$=e.i(7432042);function G(){let[e,l]=(0,u.useState)({type:null}),i=(0,_.useProjectIdOrName)(),{team:s,isReady:c}=(0,f.useTeam)(),{can:m}=(0,p.default)(),v=(0,d.useToasts)(),b="loading"===e.type,C=m(j.Action.Read,j.Resource.EdgeCacheNamespace),A=m(j.Action.Update,j.Resource.Project),{data:T,mutate:N,isLoading:k,error:S}=(0,B.default)(C&&s?.id?`${x.API_EDGE_CACHE_GET_PURGE_METADATA}${(0,h.encode)({projectIdOrName:i,teamId:s.id})}`:null,e=>(0,g.fetchAPI)(e,{method:"GET",headers:{"Content-Type":"application/json"},throwOnHTTPError:!0}),{}),L=k||!c,D=!L&&A,F=T?.lastPurgeAt,M=(0,U.useAgo)(F,{suffix:" ago",alwaysRelative:!0}),I=F&&Date.now()-F<(0,$.default)("15m");return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(O,{active:"show-modal-1"===e.type,hideModal:()=>l({type:null}),disabled:b,onPurgeAll:()=>{l({type:"loading"}),(0,g.fetchAPI)(`${x.API_EDGE_CACHE_PURGE_ALL}${(0,h.encode)({projectIdOrName:i,teamId:s?.id})}`,{method:"POST",headers:{"Content-Type":"application/json"},throwOnHTTPError:!0}).then(()=>{l({type:null}),v.success("CDN cache purged successfully."),setTimeout(()=>{N()},100)}).catch(e=>{l({type:"error",error:e}),v.error("CDN cache purge failed.")})},onPurgeSpecific:e=>{let t,a,{purgeMethod:r,valueType:n,value:d}=e;l({type:"loading"});let o=r.charAt(0).toUpperCase()+r.slice(1);if("invalidate"===r)if("tag"===n)t=x.API_EDGE_CACHE_INVALIDATE_BY_TAGS,a={tags:d};else if("srcimg"===n)t=x.API_EDGE_CACHE_INVALIDATE_BY_SRC_IMAGES,a={srcImages:[d]};else throw Error(`Invalid valueType: ${n}`);else if("delete"===r)if("tag"===n)t=x.API_EDGE_CACHE_DANGEROUSLY_DELETE_BY_TAGS,a={tags:d};else if("srcimg"===n)t=x.API_EDGE_CACHE_DANGEROUSLY_DELETE_BY_SRC_IMAGES,a={srcImages:[d]};else throw Error(`Invalid valueType: ${n}`);else throw Error(`Invalid purgeMethod: ${r}`);(0,g.fetchAPI)(`${t}${(0,h.encode)({projectIdOrName:i,teamId:s?.id})}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a),throwOnHTTPError:!0}).then(()=>{l({type:null}),v.success(`${o}d cache successfully.`),N()}).catch(e=>{l({type:"error",error:e}),v.error(`${o} cache failed.`)})}}),(0,t.jsx)(P,{active:"show-modal-2"===e.type,hideModal:()=>l({type:null}),disabled:b,onContinue:()=>{l({type:"loading"}),(0,g.fetchAPI)(`${x.API_EDGE_CACHE_ROLLBACK_PURGE}${(0,h.encode)({projectIdOrName:i,teamId:s?.id})}`,{method:"POST",headers:{"Content-Type":"application/json"},throwOnHTTPError:!0}).then(()=>{l({type:null}),v.success("CDN cache rolled back successfully."),setTimeout(()=>{N()},100)}).catch(e=>{l({type:"error",error:e}),v.error("CDN cache rollback failed.")})},title:"Undo Purge",subtitle:"Purging the CDN Cache can sometimes cause errors so you may need to undo.",description:"Be aware that undo will use the last cache key, which may not be the most recent data.",type:"warning"}),(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-8 flex-initial tailwind-preflight",children:[I?(0,t.jsx)(w.ProjectBanner,{callToAction:{label:"Undo Purge",onClick:()=>l({type:"show-modal-2"})},icon:(0,t.jsx)(E.RotateCounterClockwise,{}),label:(0,t.jsxs)(t.Fragment,{children:["This project was last purged ",M,"."]}),variant:"warning"}):null,(0,t.jsx)(y.ProjectSettingsFieldset,{description:(0,t.jsx)("span",{className:"text-copy-14 text-gray-900",children:"Manage responses that are cached using a Cache-Control header or revalidation (ISR, PPR, Image Optimization, etc)."}),disabled:L,disabledForBilling:(!!L||!A)&&void 0,error:S||("error"===e.type?e.error:void 0),note:(0,t.jsxs)(t.Fragment,{children:["Learn more about ",(0,t.jsx)(o.Link,{external:!0,href:"/docs/edge-cache",type:"highlight",children:"CDN Cache"})]}),saveDisabled:!D,saveLoading:b,title:"CDN Cache",children:(0,t.jsxs)(r.Skeleton,{show:L,children:[(0,t.jsx)("div",{className:"my-5",children:(0,t.jsx)("hr",{className:"geist-hr-reset"})}),(0,t.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:(0,t.jsxs)("div",{className:"flex flex-row items-center justify-between gap-1 flex-initial",children:[(0,t.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial",children:[(0,t.jsx)("h5",{className:"text-heading-16",children:"Purge Cache"}),(0,t.jsx)("p",{className:"text-copy-14 text-gray-900",children:"Invalidate or delete contents of the CDN Cache"})]}),(0,t.jsx)(n.Tooltip,{disableTriggers:A,text:"You need additional permissions to purge cache.",children:(0,t.jsx)(a.Button,{"aria-label":"Trash can",disabled:L||!A,onClick:()=>l({type:"show-modal-1"}),svgOnly:!0,children:"Purge CDN Cache"})})]})})]})})]})]})}e.s(["CacheSettings",0,function(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(G,{}),(0,t.jsx)(L.Spacer,{y:2}),(0,t.jsx)(C,{})]})}],278937)}]);

//# debugId=6480e9a6-1cc9-a1da-8f8a-7ae53ba3a4ca
//# sourceMappingURL=1c29cc941445f6f6.js.map