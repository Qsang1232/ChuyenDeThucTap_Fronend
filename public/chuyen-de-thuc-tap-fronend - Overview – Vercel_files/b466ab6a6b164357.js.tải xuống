;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="490096c5-31c7-4735-fc18-0bfd542dd6db")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,1781243,e=>{"use strict";let a=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M16 8C16 12.4183 12.4183 16 8 16C3.58172 16 0 12.4183 0 8C0 3.58172 3.58172 0 8 0C12.4183 0 16 3.58172 16 8ZM10.5 11.5607L9.96967 11.0303L8 9.06066L6.03033 11.0303L5.5 11.5607L4.43934 10.5L4.96967 9.96967L6.93934 8L4.96967 6.03033L4.43934 5.5L5.5 4.43934L6.03033 4.96967L8 6.93934L9.96967 4.96967L10.5 4.43934L11.5607 5.5L11.0303 6.03033L9.06066 8L11.0303 9.96967L11.5607 10.5L10.5 11.5607Z" fill="currentColor"/>');e.s(["CrossCircleFill",0,a])},87116,e=>{"use strict";var a=e.i(7909933),t=e.i(5338940);e.s(["useVercelAgentCreditsBalance",0,function(){let{team:e}=(0,t.useTeam)(),{data:i,isLoading:s,mutate:r}=(0,a.default)(e?.id?`/api/agent/agent-credits-balance?teamId=${e.id}`:null,e=>fetch(e).then(e=>e.json()));return{balance:i?Number(i.cumulativeBalance):void 0,loading:s,mutate:r}}])},6359207,e=>{"use strict";e.s(["deriveAgentState",0,function(e,a){let t=!e?.vadeReview||!e?.vadeReview?.firstEnabledAt,i=!e?.alertInvestigation||!e?.alertInvestigation?.firstEnabledAt,s=!!e?.vadeReview?.trialCreditsIssuedAt,r=e?.billing?.plan==="pro"&&e?.billing?.status==="trialing";return{isAgentEnabled:e?.vadeReview?.enabled??!1,isFirstTimeUser:t&&i&&!s,isHobbyPlan:e?.billing?.plan==="hobby",isProTrial:r,hasManualReviewsEnabled:a}}])},982939,e=>{"use strict";var a=e.i(3559248);let t=(0,a.createServerReference)("402550e02df286179b9a249f9c8b4dc27d9e933091",a.callServer,void 0,a.findSourceMapURL,"createAutoTopupConfig");e.s(["createAutoTopupConfig",0,t])},9022995,e=>{"use strict";var a=e.i(3559248);let t=(0,a.createServerReference)("40ee88fc4e81b292b21b89b2972a55dab99610dd88",a.callServer,void 0,a.findSourceMapURL,"deleteAutoTopupConfig");e.s(["deleteAutoTopupConfig",0,t])},131402,e=>{"use strict";var a=e.i(3559248);let t=(0,a.createServerReference)("40f4b7ff66cca0d1ea28b04a702d404c19f1aa1fc1",a.callServer,void 0,a.findSourceMapURL,"updateAutoTopupConfig");e.s(["updateAutoTopupConfig",0,t])},1249298,e=>{"use strict";var a=e.i(4005781),t=e.i(277234),i=e.i(4244280),s=e.i(5338940),r=e.i(5757634),l=e.i(6695816),n=e.i(6359207),o=e.i(982939),d=e.i(131402),c=e.i(9022995),u=e.i(7837522),m=e.i(7780974);function p(e,t,i,r){let{team:o,mutate:d}=(0,s.useTeam)(),c=o?.id,{track:p}=(0,u.useTrackActivity)(),g=(0,l.useRef)(void 0),x=(0,a.default)(c?`${e}?teamId=${encodeURIComponent(c)}`:null,t,{onSuccess:()=>{d().catch(()=>{}),g.current&&(p(m.VercelActivityAction.VercelAgentEnabled,{source:g.current.source,isFirstTimeUser:g.current.isFirstTimeUser,feature:i}),g.current=void 0)}}),h=(0,l.useCallback)((e,a)=>(!o?.[i]?.enabled&&e.enabled&&(g.current={source:r,isFirstTimeUser:(0,n.deriveAgentState)(o,!1).isFirstTimeUser}),x.trigger(e,a)),[x,o,i,r]);return{...x,trigger:h,teamId:c}}e.s(["useApplyTrialCredits",0,function(){let{team:e,mutate:a}=(0,s.useTeam)(),r=e?.id;return{applyTrialCredits:(0,l.useCallback)(async()=>{if(!r)throw Error("No team found");let e=`${i.API_VADE_APPLY_TRIAL_CREDITS}?teamId=${encodeURIComponent(r)}`,s=await (0,t.fetchAPI)(e,{method:"POST",body:{}});if(s.error){if("trial_credits_already_applied"===s.error.code)return s;throw Error(s.error.message??"An unexpected error occurred while applying trial credits.")}return await a().catch(()=>{}),s},[r,a]),teamId:r}},"useAutoRechargeActions",0,function(){let{team:e}=(0,s.useTeam)(),{mutate:a}=(0,r.useSWRConfig)(),t=(0,l.useCallback)(async t=>{if(!e)throw Error("No team found");let i=await (0,o.createAutoTopupConfig)({teamIdOrSlug:e.id,...t});return a(`/api/credit-topups?teamId=${e.id}&currency=vercel_agent_credits`),i},[e,a]);return{createAutoRecharge:t,updateAutoRecharge:(0,l.useCallback)(async t=>{if(!e)throw Error("No team found");let i=await (0,d.updateAutoTopupConfig)({teamIdOrSlug:e.id,...t});return a(`/api/credit-topups?teamId=${e.id}&currency=vercel_agent_credits`),i},[e,a]),deleteAutoRecharge:(0,l.useCallback)(async()=>{if(!e)throw Error("No team found");let t=await (0,c.deleteAutoTopupConfig)({teamIdOrSlug:e.id});return a(`/api/credit-topups?teamId=${e.id}&currency=vercel_agent_credits`),t},[e,a]),teamId:e?.id}},"useUpdateAIReviews",0,function(e){let{source:a}=e;return p(i.API_VADE_REVIEW_CONFIGURE,async(e,a)=>{let{arg:i}=a,s=await (0,t.fetchAPI)(e,{method:"POST",body:i});if(s.error)throw Error(s.error.message??"An unexpected error occurred. Please try again later.");return s},"vadeReview",a)},"useUpdateAlertInvestigations",0,function(e){let{source:a}=e;return p(i.API_VADE_ALERT_INVESTIGATIONS_CONFIGURE,async(e,a)=>{let{arg:i}=a,s=await (0,t.fetchAPI)(e,{method:"POST",body:i});if(s.error)throw Error(s.error.message??"An unexpected error occurred. Please try again later.");return s},"alertInvestigation",a)}])},2596253,e=>{"use strict";var a=e.i(2471070);e.s(["useVercelAgentCreditsAutoRecharge",0,function(){let{topups:e,loading:t,mutate:i}=(0,a.useVercelAgentCreditTopups)(),s=e?.find(e=>"orb_ledger"!==e.provider.type||"miu"!==e.provider.currency);return{autoRechargeConfig:s?{minimumBalance:s.minimumBalance,targetBalance:s.targetBalance,maximumMonthlySpend:s.maximumMonthlySpend??""}:void 0,loading:t,mutate:i}}])},4970672,e=>{"use strict";var a=e.i(3559248);let t=(0,a.createServerReference)("402ab44e99c6fbe9c8ca08c7fa89bca2856af40ec1",a.callServer,void 0,a.findSourceMapURL,"revalidateVercelAgentPage");e.s(["revalidateVercelAgentPage",0,t])},8835542,4468226,e=>{"use strict";var a=e.i(31889),t=e.i(2504781),i=e.i(5468328),s=e.i(57106),r=e.i(87116),l=e.i(5255926),n=e.i(8674454),o=e.i(6694387),d=e.i(4991687),c=e.i(8459493),u=e.i(6695816),m=e.i(6347389),p=e.i(8863362),g=e.i(3282299),x=e.i(1717203),h=e.i(7557283),f=e.i(7608222),b=e.i(7553931);function y(e){let{isFirstTimeUser:s=!1}=e,{can:y}=(0,x.default)(),v=y(h.Action.Update,h.Resource.PaymentMethod),A=y(h.Action.Update,h.Resource.Team),{balance:C}=(0,r.useVercelAgentCreditsBalance)(),{openModal:N,modals:j}=(0,p.useAddCreditsModal)(),{openModal:E,modal:T}=(0,g.useAIReviewsConfigureModal)(),M=(0,b.useParams)(),_=M?.teamSlug,R=(0,u.useCallback)(e=>{if(void 0===e)return"";let a=Math.max(0,e);return a<100?a.toFixed(2):a<1e3?a.toFixed(0):`${(a/1e3).toFixed(0)}k`},[]);return s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Tooltip,{position:"bottom",disableTriggers:A,boxAlign:"center",text:`You need additional permissions to enable ${f.VERCEL_AGENT_NAME}.`,children:(0,a.jsx)(t.Button,{type:"default",disabled:!A,onClick:()=>E({isFirstTimeUser:!0,source:"header-redeem-credit"}),children:"Redeem $100 Free Credit"})}),T]}):(0,a.jsxs)(a.Fragment,{children:[void 0!==C?(0,a.jsxs)(d.MenuContainer,{children:[(0,a.jsx)(i.Tooltip,{position:"bottom",disableTriggers:v,boxAlign:"center",text:`You need additional permissions to manage your team's ${f.VERCEL_AGENT_NAME} credit.`,children:(0,a.jsxs)(o.MenuButton,{type:"secondary",prefix:(0,a.jsx)(m.Coins,{}),children:["$",R(C)," Credit"]})}),(0,a.jsxs)(n.Menu,{width:"180px",children:[(0,a.jsx)(c.MenuItem,{href:`/${_}/~/settings#${f.VERCEL_AGENT_NAME.toLowerCase().replaceAll(" ","-")}`,isLink:!0,children:"Settings"}),(0,a.jsx)(c.MenuItem,{disabled:!v,onClick:()=>N("credits-button"),children:"Add credit…"})]})]}):(0,a.jsx)(l.Skeleton,{children:(0,a.jsx)(t.Button,{type:"secondary",prefix:(0,a.jsx)(m.Coins,{}),children:"Loading credit"})}),j]})}e.s(["AddVercelAgentCreditsButton",0,y],4468226);var v=e.i(6891161),A=e.i(455575),C=e.i(8522580),N=e.i(5338940),j=e.i(8761240),E=e.i(1781243),T=e.i(8248823),M=e.i(1249298),_=e.i(4970672),R=e.i(3738416),w=e.i(1174741),S=e.i(8119470),D=e.i(5481907),U=e.i(28552),I=e.i(7909933),P=e.i(3769024);function k(e){let{onClose:i}=e,{team:s,mutate:r}=(0,N.useTeam)(),{can:l}=(0,x.default)(),n=(0,A.useToasts)(),{trigger:o,isMutating:d}=(0,M.useUpdateAIReviews)({source:"disable-modal"}),{data:c}=(0,U.useObservabilityConfiguration)(),m=(0,P.hasObservabilityPlusAccess)(c?.observabilityPlus,null),{data:p}=(0,D.useSonarQuery)({event:"prReview",rollups:{value:{measure:"reviewComments",aggregation:"sum"}},reason:"agent",summaryOnly:!0,startTime:(0,R.startOfDay)((0,S.subDays)(new Date,30)),endTime:(0,w.endOfDay)(new Date)},{noEnvironmentFilter:!0}),g=(0,R.startOfDay)((0,S.subDays)(new Date,30)),b=(0,w.endOfDay)(new Date),{data:y}=(0,I.default)(s?.id?`/vercel-agent/api/activity?teamId=${s.id}&startTime=${g.toISOString()}&endTime=${b.toISOString()}`:null,async e=>{let a=await fetch(e);return a.ok?a.json():null},{revalidateIfStale:!1,refreshInterval:0}),k=l(h.Action.Update,h.Resource.Team),[B,L]=(0,u.useState)(null);async function F(){if(s){L(null);try{let e={enabled:!1,snoozedAt:new Date().toISOString()};await o(e);let a=[];a.push(r().catch(()=>{})),s.slug&&a.push((0,_.revalidateVercelAgentPage)(s.slug)),await Promise.all(a),n.success(`${f.VERCEL_AGENT_NAME} has been disabled.`),i()}catch(e){L((0,T.errorToString)(e))}}}let O=p?.summary.at(0),$=void 0!==O&&null!==O.value&&O.value>0,V=y?.activities?.length??0,H=m&&V>0;return(0,a.jsxs)(v.Modal.Modal,{active:!0,onClickOutside:i,children:[(0,a.jsxs)(v.Modal.Body,{children:[(0,a.jsx)(v.Modal.Header,{children:(0,a.jsxs)(v.Modal.Title,{children:["Disable ",f.VERCEL_AGENT_NAME]})}),(0,a.jsxs)("div",{className:"space-y-5",children:[(0,a.jsx)("p",{className:"text-copy-14",children:"Disabling means:"}),(0,a.jsxs)("div",{className:"pl-0.5 space-y-3 max-w-[400px]",children:[(0,a.jsxs)("div",{className:"flex items-baseline gap-1.5",children:[(0,a.jsx)(E.CrossCircleFill,{className:"translate-y-0.5",size:14,color:"gray-900"}),(0,a.jsxs)("p",{className:"text-copy-14 text-gray-900 leading-relaxed",children:[(0,a.jsx)("span",{className:"text-gray-1000 font-medium",children:"Pull requests"})," ","won't be"," ",(0,a.jsx)("span",{className:"text-gray-1000 font-medium",children:"reviewed automatically"})]})]}),(0,a.jsxs)("div",{className:"flex items-baseline gap-1.5",children:[(0,a.jsx)(E.CrossCircleFill,{className:"translate-y-0.5",size:14,color:"gray-900"}),(0,a.jsxs)("p",{className:"text-copy-14 text-gray-900 leading-relaxed text-pretty",children:[(0,a.jsx)("span",{className:"text-gray-1000 font-medium",children:"Code suggestions"})," ","won't be validated in"," ",(0,a.jsx)("span",{className:"text-gray-1000 font-medium",children:"sandboxes"})]})]}),m&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-baseline gap-1.5",children:[(0,a.jsx)(E.CrossCircleFill,{className:"translate-y-0.5",size:14,color:"gray-900"}),(0,a.jsxs)("p",{className:"text-copy-14 text-gray-900 leading-relaxed text-pretty",children:[(0,a.jsx)("span",{className:"text-gray-1000 font-medium",children:"Production issues"})," ","won't get"," ",(0,a.jsx)("span",{className:"text-gray-1000 font-medium",children:"root-cause analysis"})]})]}),(0,a.jsxs)("div",{className:"flex items-baseline gap-1.5",children:[(0,a.jsx)(E.CrossCircleFill,{className:"translate-y-0.5",size:14,color:"gray-900"}),(0,a.jsxs)("p",{className:"text-copy-14 text-gray-900 leading-relaxed",children:[(0,a.jsx)("span",{className:"text-gray-1000 font-medium",children:"Incidents"})," ","won't include"," ",(0,a.jsx)("span",{className:"text-gray-1000 font-medium",children:"actionable remediation steps"})]})]})]})]}),(0,a.jsx)("p",{className:"text-copy-14",children:"You can re-enable at any time."}),$&&(0,a.jsxs)(C.Note,{type:"success",fill:!0,icon:(0,a.jsx)(j.CheckCircleFill,{}),children:[O.value?.toLocaleString()," improvements suggested in the last ",30," days."]}),H&&(0,a.jsxs)(C.Note,{type:"success",fill:!0,icon:(0,a.jsx)(j.CheckCircleFill,{}),children:[V.toLocaleString()," investigations performed in the last ",30," days."]}),B&&(0,a.jsx)("div",{className:"p-3 bg-red-100 rounded-md",children:(0,a.jsx)("p",{children:B})})]})]}),(0,a.jsxs)(v.Modal.Actions,{children:[(0,a.jsx)(t.Button,{type:"secondary",onClick:i,children:"Cancel"}),(0,a.jsx)(t.Button,{onClick:F,loading:d,disabled:!k,type:"error",children:"Disable"})]})]})}function B(){let[e,t]=(0,u.useState)(!1),i=(0,u.useCallback)(()=>{t(!0)},[]),s=(0,u.useCallback)(()=>{t(!1)},[]);return{openModal:i,modal:e?(0,a.jsx)(k,{onClose:s}):null}}var L=e.i(5756088),F=e.i(8876434),O=e.i(9138164),$=e.i(9250831),V=e.i(1794286),H=e.i(7432042),G=e.i(1192207),z=e.i(8615881),Y=e.i(8151845);function W(){let[e,t]=(0,Y.useSonarQueryState)(),{start:i,end:s}=(0,Y.useRangeFromQueryState)(),r=Object.entries({"1h":{text:"Last hour",start:(0,G.subHours)(new Date,1),end:new Date},"12h":{text:"Last 12 hours",start:(0,G.subHours)(new Date,12),end:new Date},"1d":{text:"Last 24 hours",start:(0,S.subDays)(new Date,1),end:new Date},"7d":{text:"Last 7 days",start:(0,z.subWeeks)(new Date,1),end:new Date}}).map(e=>{let[a,t]=e;return{key:a,...t}}),l=[{presets:r}],n=e.period?r.find(a=>a.key===e.period)?.key:void 0,o=(0,S.subDays)(new Date,90),d=(0,w.endOfDay)(new Date);return(0,a.jsx)(V.Calendar,{allowClear:!1,compact:!0,minValue:o,maxValue:d,onChange:(e,a)=>{let i=new Date(e.start),s=new Date(e.end);a?((0,$.track)("Agent Changed Date Range Period",{period:a}),t({period:a})):((0,$.track)("Agent Changed Date Range Period",{period:(0,H.default)(s.getTime()-i.getTime())}),t({from:i,to:s}))},popoverAlignment:"center",presetKey:n,presets:l,value:{start:i,end:s},width:"190px"},"date-range-select-agent")}var K=e.i(3089600);e.i(6483798);var q=e.i(8287059),Z=e.i(7917902),Q=e.i(6468432);let X=e=>{let{isFirstTimeUser:i,isEligibleForTrialCredits:s,onConfigure:r,isHobbyPlan:l,isProTrial:n,source:o}=e,{can:d}=(0,x.default)(),c=d(h.Action.Update,h.Resource.Team),{team:u}=(0,Z.useAccount)(),m=(0,q.useOpenUpgradeModal)();return n?(0,a.jsx)(t.Button,{type:"default",onClick:()=>{m({teamHint:u?.id,source:"vercel-agent-pro-trial",disabledSteps:["team-members"],onConversionSuccess:()=>{r({isFirstTimeUser:i,source:"vercel-agent-pro-trial-modal"})}})},children:"Upgrade to Pro"}):i?l?null:(0,a.jsx)(t.Button,{type:"default",onClick:()=>r({isFirstTimeUser:i,source:o}),disabled:!c,children:s?"Enable with $100 Free Credit":"Enable"}):(0,a.jsx)(t.Button,{type:"default",onClick:()=>r({isFirstTimeUser:i,source:o}),disabled:!c,children:"Enable"})};function J(){let e=(0,b.useParams)(),t=e?.teamSlug;return(0,a.jsx)(s.ButtonLink,{href:`/${t}/~/settings/agent`,type:"secondary",svgOnly:!0,"aria-label":"Settings",children:(0,a.jsx)(O.SettingsGear,{})})}let ee=e=>{let{openDisableModal:t,openBuyCreditsModal:s,isDash:r=!1}=e,{can:l}=(0,x.default)(),u=l(h.Action.Update,h.Resource.Team),m=(0,b.useParams)(),p=m?.teamSlug,{team:g}=(0,N.useTeam)(),y=!(0,Q.isFlexibleCommitment)(g),v=y?`/${p}/~/settings#${f.VERCEL_AGENT_NAME.toLowerCase().replaceAll(" ","-")}`:`/${p}/~/settings/agent`;return(0,a.jsxs)(d.MenuContainer,{children:[(0,a.jsx)(o.MenuButton,{"aria-label":"Menu",shape:"square",svgOnly:!0,type:"secondary",children:(0,a.jsx)(F.MoreHorizontal,{})}),(0,a.jsxs)(n.Menu,{width:"208px",children:[y&&(0,a.jsx)(c.MenuItem,{innerMenuItemClassName:"!pointer-events-auto no-underline",disabled:!u,suffix:u?null:(0,a.jsx)(L.LockClosed,{}),onClick:s,children:u?"Buy credit…":(0,a.jsx)(i.Tooltip,{text:"You need additional permissions to buy credit.",children:"Buy credit…"})}),!r&&(0,a.jsx)(c.MenuItem,{innerMenuItemClassName:"!pointer-events-auto no-underline",href:v,isLink:!0,children:"Settings"}),(0,a.jsx)(c.MenuItem,{innerMenuItemClassName:"!pointer-events-auto no-underline",disabled:!u,suffix:u?null:(0,a.jsx)(L.LockClosed,{}),onClick:t,children:u?`Disable ${f.VERCEL_AGENT_NAME}…`:(0,a.jsxs)(i.Tooltip,{text:`You need additional permissions to disable ${f.VERCEL_AGENT_NAME}.`,children:["Disable ",f.VERCEL_AGENT_NAME,"…"]})})]})]})};e.s(["AgentOptionsMenu",0,function(){let{openModal:e,modal:t}=B(),{openModal:i,modals:s}=(0,p.useAddCreditsModal)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ee,{openDisableModal:e,openBuyCreditsModal:()=>i("header-button"),isDash:!1}),t,s]})},"AgentSettingsCard",0,e=>{let{isAgentEnabled:t,isFirstTimeUser:i,isEligibleForTrialCredits:s,isHobbyPlan:r,isProTrial:l,isDash:n=!1,source:o="settings-card"}=e,{openModal:d,modal:c}=(0,g.useAIReviewsConfigureModal)(),{openModal:u,modal:m}=B(),{openModal:x,modals:h}=(0,p.useAddCreditsModal)(),f=(0,b.usePathname)(),v=(0,b.useParams)(),A=v?.teamSlug,C=f===`/${A}/~/agent`,{team:j}=(0,N.useTeam)();return(0,K.default)("enable",(e,a)=>{"1"!==e||t||r||l||d({isFirstTimeUser:i,source:a.source??"query-enable"})},["source"]),(0,a.jsxs)("div",{children:[t?(0,a.jsxs)("div",{className:"flex flex-row gap-2 flex-wrap @md-page:flex-nowrap",children:[C&&(0,a.jsx)("div",{className:"w-fit",children:(0,a.jsx)(W,{})}),!(0,Q.isFlexibleCommitment)(j)&&(0,a.jsx)(y,{}),n&&(0,a.jsx)(J,{}),(0,a.jsx)(ee,{openDisableModal:u,openBuyCreditsModal:()=>x(o),isDash:n})]}):(0,a.jsx)(X,{isFirstTimeUser:i,isEligibleForTrialCredits:s,onConfigure:e=>{d(e)},isHobbyPlan:r,isProTrial:l,source:o}),c,m,h]})}],8835542)},6317369,e=>{"use strict";let a=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M4 5.5C3.17157 5.5 2.5 4.82843 2.5 4C2.5 3.17157 3.17157 2.5 4 2.5C4.82843 2.5 5.5 3.17157 5.5 4C5.5 4.82843 4.82843 5.5 4 5.5ZM4.75 6.90549C6.04392 6.57245 7 5.39788 7 4C7 2.34315 5.65685 1 4 1C2.34315 1 1 2.34315 1 4C1 5.39788 1.95608 6.57245 3.25 6.90549V14.25V15H4.75V14.25V6.90549ZM9.5 3.25H8.75V4.75H9.5H11C11.1381 4.75 11.25 4.86193 11.25 5V9.09451C9.95608 9.42754 9 10.6021 9 12C9 13.6569 10.3431 15 12 15C13.6569 15 15 13.6569 15 12C15 10.6021 14.0439 9.42754 12.75 9.09451V5C12.75 4.0335 11.9665 3.25 11 3.25H9.5ZM10.5 12C10.5 12.8284 11.1716 13.5 12 13.5C12.8284 13.5 13.5 12.8284 13.5 12C13.5 11.1716 12.8284 10.5 12 10.5C11.1716 10.5 10.5 11.1716 10.5 12Z" fill="currentColor"/>');e.s(["GitPullRequest",0,a])},8639841,e=>{"use strict";var a=e.i(31889),t=e.i(6695816);let i=(0,t.createContext)(null),s=[{id:"manual-off-hobby-disabled",label:"Manual OFF + Hobby + Disabled",overrides:{hasManualReviewsEnabled:!1,isHobbyPlan:!0,isAgentEnabled:!1,isFirstTimeUser:!0,isProTrial:!1}},{id:"manual-off-pro-trial-disabled",label:"Manual OFF + Pro Trial + Disabled",overrides:{hasManualReviewsEnabled:!1,isHobbyPlan:!1,isAgentEnabled:!1,isFirstTimeUser:!0,isProTrial:!0}},{id:"manual-off-pro-paid-disabled-first",label:"Manual OFF + Pro Paid + Disabled (First)",overrides:{hasManualReviewsEnabled:!1,isHobbyPlan:!1,isAgentEnabled:!1,isFirstTimeUser:!0,isProTrial:!1}},{id:"manual-off-pro-paid-enabled",label:"Manual OFF + Pro Paid + Enabled",overrides:{hasManualReviewsEnabled:!1,isHobbyPlan:!1,isAgentEnabled:!0,isFirstTimeUser:!1,isProTrial:!1}},{id:"manual-on-pro-paid-disabled-first",label:"Manual ON + Pro Paid + Disabled (First)",overrides:{hasManualReviewsEnabled:!0,isHobbyPlan:!1,isAgentEnabled:!1,isFirstTimeUser:!0,isProTrial:!1,tasks:[]}},{id:"manual-on-pro-paid-disabled-returning",label:"Manual ON + Pro Paid + Disabled (Returning)",overrides:{hasManualReviewsEnabled:!0,isHobbyPlan:!1,isAgentEnabled:!1,isFirstTimeUser:!1,isProTrial:!1,tasks:[]}},{id:"manual-on-pro-paid-enabled-empty",label:"Manual ON + Pro Paid + Enabled (Empty)",overrides:{hasManualReviewsEnabled:!0,isHobbyPlan:!1,isAgentEnabled:!0,isFirstTimeUser:!1,isProTrial:!1,reviewDraftPRs:!1,repositoryVisibility:"all",tasks:[]}},{id:"manual-on-pro-paid-enabled-with-tasks",label:"Manual ON + Pro Paid + Enabled (With Tasks)",overrides:{hasManualReviewsEnabled:!0,isHobbyPlan:!1,isAgentEnabled:!0,isFirstTimeUser:!1,isProTrial:!1,tasks:[{status:"open",author:{username:"alice",uid:"u1"}},{status:"closed",author:{username:"bob",uid:"u2"}},{status:"merged",author:{username:"carol",uid:"u3"}}]}},{id:"manual-on-hobby-disabled",label:"Manual ON + Hobby + Disabled",overrides:{hasManualReviewsEnabled:!0,isHobbyPlan:!0,isAgentEnabled:!1,isFirstTimeUser:!0,isProTrial:!1,tasks:[]}}],r=s[0]?.id??"manual-off-hobby-disabled";function l(e){let{children:l}=e,[n,o]=(0,t.useState)({active:!1,scenarioId:r}),d=(0,t.useMemo)(()=>({state:n,scenarios:s,setActive:e=>o(a=>({...a,active:e})),setScenarioId:e=>o(a=>({...a,scenarioId:e}))}),[n]);return(0,a.jsx)(i.Provider,{value:d,children:l})}function n(){(0,t.useContext)(i);let[e,a]=(0,t.useState)(!1);return null}e.s(["AgentDebugRoot",0,function(e){let{children:t}=e;return(0,a.jsxs)(l,{children:[(0,a.jsx)(n,{}),t]})},"useAgentDebug",0,function(){return(0,t.useContext)(i),{active:!1,overrides:void 0}}])},3041776,e=>{"use strict";(0,e.i(7432042).default)("1y"),e.s(["DEFAULT_AUTO_RECHARGE_MIN_BALANCE_USD",0,5,"DEFAULT_AUTO_RECHARGE_TARGET_BALANCE_USD",0,25,"DEFAULT_MIN_MONTHLY_SPEND",0,50,"MAX_FUND_AMOUNT_USD",0,5e3,"MIN_FUND_AMOUNT_USD",0,10])},3282299,e=>{"use strict";var a=e.i(31889),t=e.i(6695816),i=e.i(7520861),s=e.i(6891161),r=e.i(5323212),l=e.i(2504781),n=e.i(1906681),o=e.i(3500331),d=e.i(455575),c=e.i(3306538),u=e.i(8522580),m=e.i(1136434),p=e.i(6347389),g=e.i(5338940),x=e.i(1717203),h=e.i(7557283),f=e.i(2596253),b=e.i(8248823),y=e.i(1249298),v=e.i(3041776),A=e.i(7608222),C=e.i(4970672),N=e.i(9598279),j=e.i(1230902),E=e.i(28552),T=e.i(3769024),M=e.i(2471070),_=e.i(57106),R=e.i(7553931),w=e.i(6468432),S=e.i(8639841);function D(e){let{onClose:D,isFirstTimeUser:U,source:I,showAutomaticAgentReviewsToggle:P=!1,onConversion:k}=e,B=(0,S.useAgentDebug)(),{team:L,mutate:F}=(0,g.useTeam)(),O=U&&!(0,w.isFlexibleCommitment)(L),{can:$}=(0,x.default)(),V=(0,d.useToasts)(),H=(0,R.useParams)(),G="string"==typeof H?.teamSlug?H.teamSlug:void 0,{trigger:z,isMutating:Y}=(0,y.useUpdateAIReviews)({source:`enable-modal${I?`-${I}`:""}`}),{trigger:W,isMutating:K}=(0,y.useUpdateAlertInvestigations)({source:`enable-modal${I?`-${I}`:""}`}),{autoRechargeConfig:q}=(0,f.useVercelAgentCreditsAutoRecharge)(),{createAutoRecharge:Z,updateAutoRecharge:Q}=(0,y.useAutoRechargeActions)(),{applyTrialCredits:X}=(0,y.useApplyTrialCredits)(),{topups:J}=(0,M.useVercelAgentCreditTopups)(),ee=B.overrides?.autoRechargeConfig??q,ea=B.overrides?.hasMiuTopup??J?.some(e=>"orb_ledger"===e.provider.type&&"miu"===e.provider.currency)??!1,et=$(h.Action.Update,h.Resource.Team),ei=L?.vadeReview?.enabled,es=ei??!1,er=L?.alertInvestigation?.enabled??!0,el=L?.vadeReview?.reviewDraftPRs??!1,en=L?.vadeReview?.repositoryVisibility??"all",[eo,ed]=(0,t.useState)(!P||(ei??!0)),[ec,eu]=(0,t.useState)(el),[em,ep]=(0,t.useState)(en),[eg,ex]=(0,t.useState)(er),[eh,ef]=(0,t.useState)(null),[eb,ey]=(0,t.useState)(!0),[ev,eA]=(0,t.useState)(v.DEFAULT_AUTO_RECHARGE_MIN_BALANCE_USD.toString()),[eC,eN]=(0,t.useState)(v.DEFAULT_AUTO_RECHARGE_TARGET_BALANCE_USD.toString()),[ej,eE]=(0,t.useState)(""),{data:eT}=(0,E.useObservabilityConfiguration)(),eM=B.overrides?.hasObservabilityPlus??(0,T.hasObservabilityPlusAccess)(eT?.observabilityPlus,null),e_=eo!==es||ec!==el||em!==en,eR=eM&&eg!==er,ew=U||e_||eR;async function eS(){if(L){ef(null);try{U&&await X();let e=!eo&&es?new Date().toISOString():eo&&!es?null:void 0,a={enabled:eo};if(a.reviewDraftPRs=ec,a.repositoryVisibility=em,void 0!==e&&(a.snoozedAt=e),await z(a),eM&&eg!==er&&await W({enabled:eg}),es||k?.({isFirstTimeUser:U,autoRechargeEnabled:eb}),eb&&!ea)if(ee)try{await Q({updatedMinimumBalance:ev,updatedTargetBalance:eC,updatedMaximumMonthlySpend:ej}),V.success(`${A.VERCEL_AGENT_NAME} enabled with auto-reload.`)}catch(e){V.success(`${A.VERCEL_AGENT_NAME} enabled. Set up auto-reload later in settings.`)}else try{await Z({minimumBalance:ev,targetBalance:eC,maximumMonthlySpend:ej}),V.success(`${A.VERCEL_AGENT_NAME} enabled with auto-reload.`)}catch(e){V.success(`${A.VERCEL_AGENT_NAME} enabled. Set up auto-reload later in settings.`)}else V.success(`${A.VERCEL_AGENT_NAME} settings updated.`);await F().catch(()=>{}),L.slug&&await (0,C.revalidateVercelAgentPage)(L.slug),D()}catch(e){ef((0,b.errorToString)(e))}}}let eD=(0,N.addDays)(new Date,14);return(0,a.jsxs)(s.Modal.Modal,{active:!0,onClickOutside:D,overlayClassname:"bg-background-200/80",children:[(0,a.jsxs)(s.Modal.Body,{children:[(0,a.jsxs)(s.Modal.Header,{children:[(0,a.jsxs)(s.Modal.Title,{className:"flex flex-row gap-2 items-center",children:["Try ",A.VERCEL_AGENT_NAME]}),O&&(0,a.jsxs)(u.Note,{type:"success",fill:!0,className:"mt-4 text-pretty",icon:(0,a.jsx)(p.Coins,{}),children:["You'll receive $100 in free credit which expires in 2 weeks on"," ",(0,a.jsx)("span",{dangerouslySetInnerHTML:{__html:(0,j.format)(eD,"MMM d, yyyy").split(" ").join("&nbsp;")}}),"."]})]}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("section",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex gap-1 items-center",children:[(0,a.jsx)("h3",{className:"text-heading-16",children:"Code Reviews"}),(0,a.jsx)(c.Badge,{variant:"pink",size:"sm",children:"Beta"})]}),(0,a.jsx)("p",{className:P?"text-gray-900":"",children:P?"Catch bugs before they reach production with AI-powered code reviews.":"Code reviews that catch bugs before they reach production."}),P&&(0,a.jsx)("div",{className:"w-fit",children:(0,a.jsx)(n.Toggle,{checked:eo,onChange:()=>ed(!eo),size:"large",disabled:!et,direction:"switch-first",children:(0,a.jsx)("span",{className:"text-gray-900",children:"Review PRs automatically"})})}),(!P||eo)&&(0,a.jsxs)("div",{className:"flex flex-col @md-page:flex-row gap-4",children:[(0,a.jsx)("div",{style:{flex:"1 0 0"},children:(0,a.jsxs)(r.Select,{label:"Repositories",value:eo?em:"all",disabled:!et||!eo,onChange:e=>{ep(e.target.value)},children:[(0,a.jsx)("option",{value:"all",children:"All repositories"}),(0,a.jsx)("option",{value:"public",children:"Public repositories only"}),(0,a.jsx)("option",{value:"private",children:"Private repositories only"})]})}),(0,a.jsx)("div",{style:{flex:"1 0 0"},children:(0,a.jsxs)(r.Select,{label:P?"Include Draft PRs":"Review Draft PRs",value:eo&&!0===ec?"review":"skip",disabled:!et||!eo,onChange:e=>{eu("review"===e.target.value)},children:[(0,a.jsx)("option",{value:"review",children:"Review draft PRs"}),(0,a.jsx)("option",{value:"skip",children:"Skip draft PRs"})]})})]})]}),eM&&(0,a.jsxs)("section",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex gap-1 items-center",children:[(0,a.jsx)("h3",{className:"text-heading-16",children:"Investigations"}),(0,a.jsx)(c.Badge,{variant:"pink",size:"sm",children:"Beta"})]}),(0,a.jsxs)("p",{className:P?"text-gray-900":"",children:["Understand and fix anomalies quicker with"," ",P?"Vercel Agent ":"automatic ","investigations. 10 free investigations are included each month with Observability Plus. Automatically investigate alerts beyond the 10 included in your subscription."]}),(0,a.jsx)("div",{className:"w-fit",children:(0,a.jsx)(n.Toggle,{checked:eg,onChange:()=>ex(!eg),size:"large",disabled:!et,direction:"switch-first",children:(0,a.jsx)("span",{className:"text-gray-900",children:P?"Investigate anomalies automatically":eg?"Enabled":"Disabled"})})})]}),!(0,w.isFlexibleCommitment)(L)&&(0,a.jsxs)("section",{className:"space-y-3 bg-background-200 border-t px-6 py-5 -mb-6 -mx-6",children:[(0,a.jsx)("h3",{className:"text-heading-16",children:"Auto-reload"}),ea&&G?(0,a.jsx)(u.Note,{fill:!0,children:(0,a.jsxs)("p",{className:"text-copy-14",children:["Buy with MIU is enabled for ",A.VERCEL_AGENT_NAME,". Auto-reload is managed in your"," ",(0,a.jsx)(_.Link,{href:`/${G}/~/settings/billing#plan`,variant:"highlight",children:"billing settings"}),"."]})}):(0,a.jsx)(i.Root,{children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("p",{children:["Keep ",A.VERCEL_AGENT_NAME," running by automatically adding credit when your balance falls below a certain amount."]}),(0,a.jsxs)("div",{className:"flex flex-row gap-2 items-center justify-between",children:[(0,a.jsx)(n.Toggle,{checked:eb,onChange:()=>ey(!eb),size:"medium",disabled:!et,direction:"switch-first",children:(0,a.jsx)("span",{className:"text-gray-1000",children:eb?"Enabled":"Disabled"})}),eb&&(0,a.jsxs)(i.Trigger,{className:"text-xs font-medium hover:text-gray-1000 bg-transparent focus-visible:outline-focus focus-visible:outline-2 focus-visible:outline-offset-2 font-sans text-gray-900 flex items-center gap-0.5 group px-0 translate-x-1.5",children:[(0,a.jsx)("span",{children:"Configure"}),(0,a.jsx)(m.ChevronDownSmall,{className:"-rotate-90 group-aria-expanded:rotate-0"})]})]})]}),eb?(0,a.jsx)(i.Content,{children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex flex-row gap-3",children:[(0,a.jsx)(o.Input,{label:"When balance falls below",width:"100%",prefix:"$",suffix:"USD",value:ev,onChange:e=>eA(e.target.value),disabled:!et,suffixStyling:!1}),(0,a.jsx)(o.Input,{label:"Reload to target balance",width:"100%",prefix:"$",suffix:"USD",value:eC,onChange:e=>eN(e.target.value),disabled:!et,suffixStyling:!1})]}),(0,a.jsx)("div",{children:(0,a.jsx)(o.Input,{label:"Monthly spending limit (optional)",width:"100%",prefix:"$",suffix:"USD",placeholder:"No limit",value:ej,onChange:e=>eE(e.target.value),disabled:!et,suffixStyling:!1})})]})}):(0,a.jsx)(u.Note,{type:"warning",fill:!0,children:"Your pull requests will stop being reviewed for problems when you run out of credits."})]})})]}),eh&&(0,a.jsx)("div",{className:"p-3 bg-red-100 rounded-md",children:(0,a.jsx)("p",{children:eh})}),et?null:(0,a.jsxs)(u.Note,{fill:!0,children:["You need additional permissions to manage your team's"," ",A.VERCEL_AGENT_NAME," settings."]})]})]}),(0,a.jsxs)(s.Modal.Actions,{children:[(0,a.jsx)(l.Button,{type:"secondary",onClick:D,children:"Cancel"}),(0,a.jsx)(l.Button,{onClick:eS,loading:Y||K,disabled:!et||!ew,children:P?O?"Save & Claim $100 Free Credit":"Save":O?"Enable with $100 Free Credit":"Enable"})]})]})}var U=e.i(7837522),I=e.i(7780974),P=e.i(4597921);e.s(["useAIReviewsConfigureModal",0,function(){let[e,i]=(0,t.useState)({isFirstTimeUser:!1,isActive:!1}),{track:s}=(0,U.useTrackActivity)(),r=(0,S.useAgentDebug)(),l=(0,P.useServerFlag)("vade-manual-code-reviews",!1),n=r.overrides?.hasManualReviewsEnabled??l,o=()=>i({isActive:!1,isFirstTimeUser:!1,source:void 0}),d=e.isActive?(0,a.jsx)(D,{source:e.source,onClose:o,isFirstTimeUser:e.isFirstTimeUser,showAutomaticAgentReviewsToggle:n,onConversion:a=>{s(I.VercelActivityAction.VercelAgentModalConverted,{source:e.source,isFirstTimeUser:e.isFirstTimeUser,autoRechargeEnabled:a.autoRechargeEnabled})}}):null;return{openModal:e=>{let{isFirstTimeUser:a,source:t}=e;i({isFirstTimeUser:a,isActive:!0,source:t}),s(I.VercelActivityAction.VercelAgentModalOpened,{source:t,isFirstTimeUser:a})},closeModal:o,modal:d}}],3282299)},3884031,8528535,e=>{"use strict";var a=e.i(31889),t=e.i(87116),i=e.i(2504781),s=e.i(3500331),r=e.i(6891161),l=e.i(8522580),n=e.i(455575),o=e.i(6695816),d=e.i(3559248);let c=(0,d.createServerReference)("405d16508b5d8bca24cb30ae9fb88e84e4a789a4e7",d.callServer,void 0,d.findSourceMapURL,"createTopUpPurchaseIntent");var u=e.i(5338940),m=e.i(5140444);e.i(3512434);var p=e.i(9835407),g=e.i(7917902),x=e.i(6352514),h=e.i(4759942),f=e.i(3041776),b=e.i(7909933),y=e.i(7608222);e.i(4373123);var v=e.i(5325056);let A=p.z.object({amount:p.z.number().int().min(f.MIN_FUND_AMOUNT_USD).max(f.MAX_FUND_AMOUNT_USD)});e.s(["TopUpModal",0,function(e){let{activeModalType:d,setActiveModalType:p,autoRechargeConfig:C}=e,{setPurchaseIntent:N,setProviderDetails:j}=(0,v.useCopperClient)(),{data:E}=(0,b.default)("deferred-auto-recharge-config",{fallbackData:null}),{balance:T}=(0,t.useVercelAgentCreditsBalance)(),[M,_]=(0,o.useState)("0"),[R,w]=(0,o.useState)("ready"),S=""===M||"0"===M,D=Number(M),U=Number(T),I=S||Number.isNaN(D)?U:U+Number(M),{team:P}=(0,u.useTeam)(),{user:k}=(0,m.useUser)(),{account:B}=(0,g.useAccount)(),L=(0,n.useToasts)(),F=(0,o.useMemo)(()=>C?`Auto-reload: Add $${Number(C.targetBalance)-Number(C.minimumBalance)} when balance drops below $${C.minimumBalance}`:E?"Auto-reload will activate after your first purchase":"Set up auto-reload to never run out of credits",[C,E]),O=(0,o.useCallback)(async()=>{try{if(!k||!P)return;if(w("in_progress"),!A.safeParse({amount:D}).success)return void w("invalid_amount");let e=await c({amount:M,returnUrl:window.location.href,teamIdOrSlug:P.id});w("completed"),N(e.purchaseIntent),j(e.providerDetails),p("checkout")}catch(e){L.error("Payment failed. Try again or contact support."),w("ready"),N(null),j(null),p(null),h.analytics.track(x.AnalyticsEvent.VERCEL_AGENT_CREDITS_CHECKOUT_ERROR,{message:e.message})}},[M,k,P,B,p,N,j,D,L]);return(0,a.jsxs)(r.Modal.Modal,{active:"top_up"===d,onClickOutside:()=>p(null),children:[(0,a.jsxs)(r.Modal.Body,{children:[(0,a.jsxs)(r.Modal.Header,{children:[(0,a.jsx)(r.Modal.Title,{children:"Add Credit"}),(0,a.jsxs)(r.Modal.Subtitle,{children:["Credit is valid for one year and exclusive to ",y.VERCEL_AGENT_NAME,"."]})]}),(0,a.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:[(0,a.jsxs)("div",{className:"flex flex-row items-stretch justify-start flex-initial",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2 flex-initial w-full border-r border-gray-200 text-gray-900",children:[(0,a.jsx)("p",{className:"text-copy-14 text-gray-900",children:"Current Balance"}),(0,a.jsx)("p",{className:"text-[32px] leading-[40px] font-semibold tracking-tighter",children:`$${U.toFixed(2)}`})]}),(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center gap-2 flex-initial w-full text-gray-900",children:[(0,a.jsx)("p",{className:"text-copy-14 text-gray-900",children:"New Balance"}),(0,a.jsx)("p",{className:"text-[32px] leading-[40px] font-semibold tracking-tighter",children:S||Number.isNaN(I)?"—":`$${Number(I).toFixed(2)}`})]})]}),(0,a.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-2 flex-initial",children:(0,a.jsx)(s.Input,{"aria-labelledby":"amount-label",label:"Amount",prefix:"$",suffix:"USD",suffixStyling:!1,value:S?"":M,onChange:e=>_(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),O())},error:"invalid_amount"===R?`Enter $${f.MIN_FUND_AMOUNT_USD} to $${f.MAX_FUND_AMOUNT_USD}`:void 0})}),(0,a.jsx)(l.Note,{action:(0,a.jsx)(i.Button,{size:"small",type:"secondary",onClick:()=>{p("auto_recharge")},children:C||E?"Disable":"Enable Auto-Reload"}),fill:!0,type:"secondary",className:"text-pretty",children:F})]})]}),(0,a.jsxs)(r.Modal.Actions,{children:[(0,a.jsx)(r.Modal.Action,{onClick:()=>p(null),type:"secondary",children:"Cancel"}),(0,a.jsx)(r.Modal.Action,{loading:"in_progress"===R,disabled:S||"in_progress"===R,onClick:O,children:"Continue to Payment"})]})]})}],3884031);var C=e.i(5255926),N=e.i(5757634),j=e.i(57106),E=e.i(6938901),T=e.i(982939),M=e.i(6280036),_=e.i(5978870);function R(e){var i,s;let{activeModalType:l,setActiveModalType:d,onConversion:c}=e,{purchaseIntent:p,providerDetails:f}=(0,v.useCopperClient)(),{data:y}=(0,b.default)("deferred-auto-recharge-config",{fallbackData:null}),A=(0,o.useMemo)(()=>p?p.lineItems?.map(e=>({name:e.name,amount:Number(e.unitAmount)*Number(e.quantity)}))??[]:[],[p]),[j,R]=(0,o.useState)("initializing"),{team:U}=(0,u.useTeam)(),{user:I}=(0,m.useUser)(),{mutate:P}=(0,N.useSWRConfig)(),{account:k}=(0,g.useAccount)(),{balance:B}=(0,t.useVercelAgentCreditsBalance)(),L=(0,n.useToasts)(),{resolvedTheme:F}=(0,M.useTheme)(),O=(0,o.useMemo)(()=>p?p.lineItems?.filter(e=>"Vercel Agent Credits"===e.name).reduce((e,a)=>e+Number(a.unitAmount)*(Number(a.quantity)||1),0):0,[p]),$=(0,o.useRef)(null),V=(0,o.useCallback)(async()=>{try{if(R("in_progress"),!U||!I||!p||!f||void 0===B||void 0===O)return void R("ready");if($.current){let e=await $.current();if(e.success){await (0,E.completePurchaseIntent)({purchaseIntentId:p.id,teamIdOrSlug:U.id}),L.success(`Successfully added $${O} to your Agent balance!`);let e=Number(B)+O;if(c?.({amount:O,newBalance:e,autoRechargeConfig:y??void 0}),await P(`/api/agent/agent-credits-balance?teamId=${U.id}`,()=>({cumulativeBalance:e}),{revalidate:!1}),y)try{let{minimumBalance:e,targetBalance:a,maximumMonthlySpend:t}=y;await (0,T.createAutoTopupConfig)({teamIdOrSlug:U.id,minimumBalance:e,targetBalance:a,maximumMonthlySpend:t}),P(`/api/credit-topups?teamId=${U.id}&currency=vercel_agent_credits`),P("deferred-auto-recharge-config",null,{revalidate:!1}),L.success("Auto-reload has been enabled!")}catch(e){L.error("Payment successful, but auto-reload setup failed. Please try setting it up again.")}R("completed"),d(null)}else{h.analytics.track(x.AnalyticsEvent.VERCEL_AGENT_CREDITS_CHECKOUT_ERROR,{message:e.error??"Payment checkout failed"}),L.error(e.error??"Failed to add credits. Please try again."),R("ready");return}}else{h.analytics.track(x.AnalyticsEvent.VERCEL_AGENT_CREDITS_CHECKOUT_ERROR,{message:"Payment handler not initialized"}),L.error("We're having trouble processing your payment. Please try again."),R("ready");return}}catch(e){L.error("We're having trouble processing your payment. Please try again."),R("ready"),d(null),h.analytics.track(x.AnalyticsEvent.VERCEL_AGENT_CREDITS_CHECKOUT_ERROR,{message:e.message})}},[I,U,p,P,R,f,L,d,O,B,y,c]),H=p?.total?Number(p.total):0,G=p?.tax?Number(p.tax):0;return(0,a.jsxs)(r.Modal.Modal,{active:"checkout"===l,onClickOutside:()=>d(null),children:[(0,a.jsxs)(r.Modal.Body,{children:[(0,a.jsxs)(r.Modal.Header,{children:[(0,a.jsx)(r.Modal.Title,{children:"Confirm Payment Method"}),(0,a.jsx)(r.Modal.Subtitle,{children:"Your default payment method will be used for a one-time charge unless you add a new payment method below."})]}),"initializing"===j?(0,a.jsx)(C.Skeleton,{className:"h-32",width:"100%"}):null,(0,a.jsx)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial",children:f&&"clientSecret"in f?(0,a.jsx)(_.CopperPaymentElement,{confirmHandler:$,clientSecret:f.clientSecret,options:{elementsOptions:{appearance:(s={theme:"stripe"},{theme:"flat",variables:{fontSizeBase:"14px",fontSizeSm:"14px",colorTextPlaceholder:(i="dark"===F)?"hsl(240, 3.8%, 60%)":"hsl(240, 3.8%, 46.1%)",colorText:i?"white":"rgb(9, 9, 11)",colorPrimary:"var(--blue-700)",colorDanger:"hsl(0, 84.2%, 60.2%)",borderRadius:"6px",colorBackground:i?"black":"white",focusBoxShadow:i?"rgb(255, 255, 255) 0px 0px 0px 0px, rgb(161, 161, 170) 0px 0px 0px 1px, rgba(0, 0, 0, 0.05) 0px 1px 2px 0px":"rgb(0, 0, 0) 0px 0px 0px 0px, rgb(161, 161, 170) 0px 0px 0px 1px, rgba(0, 0, 0, 0.05) 0px 1px 2px 0px"},rules:{".Input":{border:i?"1px solid hsl(240, 5.9%, 30%)":"1px solid hsl(240, 5.9%, 90%)",padding:"10px 12px",transition:"all cubic-bezier(0.4, 0, 0.2, 1) 150ms"},".Label":{marginBottom:"8px",color:i?"#999999":"#666666",lineHeight:"20px",fontWeight:"400"},".AccordionItem":{backgroundColor:i?"black":"white"},".Block":{backgroundColor:i?"black":"white"}},...s}),loader:"never",savedPaymentMethod:{enableRedisplay:"auto"}}},onReady:()=>R("ready")}):null}),(0,a.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-4 flex-initial -mx-6 -mb-6 mt-6 px-6 py-4 pt-6 border-t bg-background-200",children:[(0,a.jsx)(D,{}),(0,a.jsx)(w,{lineItems:A,tax:G})]})]}),(0,a.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial px-6 py-2 border-t bg-background-200",children:(0,a.jsx)(S,{total:H})}),(0,a.jsxs)(r.Modal.Actions,{children:[(0,a.jsx)(r.Modal.Action,{onClick:()=>{d("top_up"),R("initializing")},type:"secondary",children:"Back"}),(0,a.jsx)(r.Modal.Action,{onClick:async()=>{await V()},loading:["in_progress","initializing"].includes(j),children:"Confirm and Pay"})]})]})}function w(e){let{lineItems:t,tax:i}=e,s=i>0;return(0,a.jsxs)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:[t.map((e,i)=>(0,a.jsxs)("div",{className:`flex flex-row items-stretch justify-between gap-4 flex-initial py-2 ${s||i<t.length-1?"border-b":""}`,children:[(0,a.jsx)("p",{className:"text-[14px] leading-[20px] font-medium text-gray-900",children:e.name}),(0,a.jsx)("p",{className:"text-[14px] leading-[20px] font-medium text-gray-900",children:`$${e.amount.toFixed(2)}`})]},e.name)),i>0?(0,a.jsxs)("div",{className:"flex flex-row items-stretch justify-between gap-4 flex-initial py-4 border-b",children:[(0,a.jsx)("p",{className:"text-[14px] leading-[20px] font-medium text-foreground",children:"Estimated Tax"}),(0,a.jsx)("p",{className:"text-[14px] leading-[20px] font-medium text-foreground",children:`$${i.toFixed(2)}`})]}):null]})}function S(e){let{total:t}=e;return(0,a.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-1 flex-initial py-2",children:[(0,a.jsxs)("div",{className:"flex flex-row items-stretch justify-between gap-4 flex-initial",children:[(0,a.jsx)("p",{className:"text-[14px] leading-[20px] font-medium text-foreground",children:"Total"}),(0,a.jsx)("p",{className:"text-[14px] leading-[20px] font-medium text-foreground",children:`$${t.toFixed(2)}`})]}),(0,a.jsx)("p",{className:"text-label-12 text-gray-900 text-right",children:"* Plus applicable tax and fees"})]})}function D(){return(0,a.jsxs)("p",{className:"text-copy-14 text-gray-900",children:['By pressing "Confirm and Pay" and accessing Agent, you agree to'," ",(0,a.jsx)(j.Link,{href:"/legal/ai-product-terms",className:"text-foreground underline",target:"_blank",children:"Vercel's AI Product Terms."})]})}e.s(["CheckoutModal",0,function(e){return(0,a.jsx)(R,{...e})}],8528535)},8951690,e=>{"use strict";var a=e.i(31889),t=e.i(6695816),i=e.i(3500331),s=e.i(1906681),r=e.i(2504781),l=e.i(455575),n=e.i(6891161),o=e.i(5338940),d=e.i(7909933),c=e.i(5757634),u=e.i(3041776),m=e.i(982939),p=e.i(9022995),g=e.i(131402);e.i(3512434);var x=e.i(9835407),h=e.i(87116);let f=x.z.object({minimumBalance:x.z.string().refine(e=>!Number.isNaN(Number(e))&&Number.isInteger(Number(e))&&Number(e)>=u.DEFAULT_AUTO_RECHARGE_MIN_BALANCE_USD,{message:`Must be at least $${u.DEFAULT_AUTO_RECHARGE_MIN_BALANCE_USD}`}),targetBalance:x.z.string().refine(e=>!Number.isNaN(Number(e))&&Number.isInteger(Number(e))&&Number(e)>=u.DEFAULT_AUTO_RECHARGE_TARGET_BALANCE_USD,{message:`Must be at least $${u.DEFAULT_AUTO_RECHARGE_TARGET_BALANCE_USD}`}),maximumMonthlySpend:x.z.string().optional().refine(e=>!e||!Number.isNaN(Number(e))&&Number.isInteger(Number(e))&&Number(e)>=u.DEFAULT_MIN_MONTHLY_SPEND,{message:`Must be at least $${u.DEFAULT_MIN_MONTHLY_SPEND}`})}).superRefine((e,a)=>{let{minimumBalance:t,targetBalance:i}=e;Number(i)<=Number(t)&&a.addIssue({code:x.z.ZodIssueCode.custom,message:`Target balance must be greater than the minimum balance ($${t})`,path:["targetBalance"]})});function b(e){let{autoRechargeConfig:a,draftAutoRechargeConfig:t,type:i}=e;return t?t[i]??"":a?a[i]??"":"minimumBalance"===i?u.DEFAULT_AUTO_RECHARGE_MIN_BALANCE_USD.toString():"targetBalance"===i?u.DEFAULT_AUTO_RECHARGE_TARGET_BALANCE_USD.toString():"maximumMonthlySpend"===i?u.DEFAULT_MIN_MONTHLY_SPEND.toString():"0"}e.s(["AutoRechargeForm",0,function(e){let{autoRechargeConfig:x,onCancel:y,onComplete:v}=e,{data:A,mutate:C}=(0,d.default)("deferred-auto-recharge-config",{fallbackData:null}),N=x??A??void 0,[j,E]=(0,t.useState)(!!N),[T,M]=(0,t.useState)(null),[_,R]=(0,t.useState)("ready"),[w,S]=(0,t.useState)({}),{balance:D}=(0,h.useVercelAgentCreditsBalance)(),U=!!N!==j||null!==T,{team:I}=(0,o.useTeam)(),{mutate:P}=(0,c.useSWRConfig)(),k=(0,l.useToasts)(),B=function(e){let{autoRechargeConfig:a,draftAutoRechargeConfig:t}=e;return(e,i)=>({minimumBalance:"minimumBalance"===e?i:b({autoRechargeConfig:a,draftAutoRechargeConfig:t,type:"minimumBalance"}),targetBalance:"targetBalance"===e?i:b({autoRechargeConfig:a,draftAutoRechargeConfig:t,type:"targetBalance"}),maximumMonthlySpend:"maximumMonthlySpend"===e?i:b({autoRechargeConfig:a,draftAutoRechargeConfig:t,type:"maximumMonthlySpend"})})}({autoRechargeConfig:N,draftAutoRechargeConfig:T}),L=(0,t.useCallback)(async()=>{if(!I||!T)return;let{minimumBalance:e,targetBalance:a,maximumMonthlySpend:t}=T;await (0,m.createAutoTopupConfig)({teamIdOrSlug:I.id,minimumBalance:e,targetBalance:a,maximumMonthlySpend:t??""}),P(`/api/credit-topups?teamId=${I.id}&currency=vercel_agent_credits`),k.success("Auto-reload enabled")},[I,T,P,k,C]),F=(0,t.useCallback)(async()=>{if(!I||!x||!T)return;let{maximumMonthlySpend:e,minimumBalance:a,targetBalance:t}=T;await (0,g.updateAutoTopupConfig)({teamIdOrSlug:I.id,updatedMaximumMonthlySpend:e??"",updatedMinimumBalance:a,updatedTargetBalance:t}),P(`/api/credit-topups?teamId=${I.id}&currency=vercel_agent_credits`),k.success("Auto-reload updated")},[I,x,T,P,k]),O=(0,t.useCallback)(async()=>{I&&x&&(await (0,p.deleteAutoTopupConfig)({teamIdOrSlug:I.id}),P(`/api/credit-topups?teamId=${I.id}&currency=vercel_agent_credits`),k.success("Auto-reload disabled"))},[I,x,P,k,p.deleteAutoTopupConfig]),$=(0,t.useCallback)(async()=>{if(R("in_progress"),!U)return void R("ready");let e=f.safeParse({minimumBalance:b({autoRechargeConfig:N,draftAutoRechargeConfig:T,type:"minimumBalance"}),targetBalance:b({autoRechargeConfig:N,draftAutoRechargeConfig:T,type:"targetBalance"}),maximumMonthlySpend:b({autoRechargeConfig:N,draftAutoRechargeConfig:T,type:"maximumMonthlySpend"})});if(!e.success){R("ready");let a={};e.error.errors.forEach(e=>{a[e.path[0]]=e.message}),S(a);return}if(void 0!==D&&Number(e.data.minimumBalance)>=Number(D)){R("ready"),S({minimumBalance:"Must be below your current balance"});return}S({});try{N&&!j?x?await O():C(null):!x&&T?await L():x&&T&&await F(),R("completed"),v?.()}catch{k.error("Auto-reload update failed. Try again."),R("ready")}},[x,T,j,N,L,F,O,C,k,U,v,D,R,S]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-col items-stretch justify-start gap-5 flex-initial mb-1",children:[(0,a.jsx)("div",{className:"flex flex-row items-center justify-between gap-2 flex-initial",children:(0,a.jsx)(s.Toggle,{checked:j,size:"large",direction:"switch-first",onChange:()=>{E(e=>{let a=!e;return a&&M({minimumBalance:u.DEFAULT_AUTO_RECHARGE_MIN_BALANCE_USD.toString(),targetBalance:u.DEFAULT_AUTO_RECHARGE_TARGET_BALANCE_USD.toString(),maximumMonthlySpend:""}),S({}),a})},children:(0,a.jsx)("span",{className:"font-medium text-copy-14 text-gray-1000",children:j?"Enabled":"Disabled"})})}),(0,a.jsxs)("div",{className:"flex flex-row items-stretch justify-start gap-4 flex-initial",children:[(0,a.jsx)(i.Input,{"aria-labelledby":"balance-trigger-label",label:"When balance falls below",width:"100%",prefix:"$",suffix:"USD",value:b({autoRechargeConfig:N,draftAutoRechargeConfig:T,type:"minimumBalance"}),onChange:e=>{M(()=>B("minimumBalance",e.target.value)),w.minimumBalance&&S(e=>({...e,minimumBalance:void 0}))},disabled:!j,suffixStyling:!1,error:w.minimumBalance}),(0,a.jsx)(i.Input,{"aria-labelledby":"balance-reload-label",label:"Reload to target balance",width:"100%",prefix:"$",suffix:"USD",value:b({autoRechargeConfig:N,draftAutoRechargeConfig:T,type:"targetBalance"}),onChange:e=>{M(()=>B("targetBalance",e.target.value)),w.targetBalance&&S(e=>({...e,targetBalance:void 0}))},disabled:!j,suffixStyling:!1,error:w.targetBalance})]}),(0,a.jsx)("div",{className:"flex flex-col items-stretch justify-start flex-initial",children:(0,a.jsx)(i.Input,{"aria-labelledby":"max-spend-label",label:"Maximum monthly spend",width:"100%",prefix:"$",suffix:"USD",placeholder:b({autoRechargeConfig:N,draftAutoRechargeConfig:T,type:"maximumMonthlySpend"}),value:b({autoRechargeConfig:N,draftAutoRechargeConfig:T,type:"maximumMonthlySpend"}),onChange:e=>{M(()=>B("maximumMonthlySpend",e.target.value)),w.maximumMonthlySpend&&S(e=>({...e,maximumMonthlySpend:void 0}))},disabled:!j,suffixStyling:!1,error:w.maximumMonthlySpend})})]}),(0,a.jsxs)(n.Modal.Actions,{className:"-mx-6 mt-6",children:[y?(0,a.jsx)(r.Button,{type:"secondary",onClick:y,size:"small",children:"Cancel"}):null,(0,a.jsx)(r.Button,{onClick:$,loading:"in_progress"===_,disabled:!U,size:"small",children:"Save"})]})]})}])},8863362,e=>{"use strict";var a=e.i(31889),t=e.i(6695816),i=e.i(3884031),s=e.i(8528535),r=e.i(8158658),l=e.i(2596253),n=e.i(6891161),o=e.i(8522580),d=e.i(8951690),c=e.i(7608222),u=e.i(2471070),m=e.i(57106),p=e.i(7553931);function g(e){let{activeModalType:t,setActiveModalType:i,autoRechargeConfig:s}=e,r=(0,p.useParams)(),l="string"==typeof r?.teamSlug?r.teamSlug:void 0,{topups:g}=(0,u.useVercelAgentCreditTopups)(),x=g?.some(e=>"orb_ledger"===e.provider.type&&"miu"===e.provider.currency)??!1;return(0,a.jsxs)(n.Modal.Modal,{active:"auto_recharge"===t,onClickOutside:()=>i(null),children:[(0,a.jsxs)(n.Modal.Body,{className:x?void 0:"pb-0 -mb-px",children:[(0,a.jsxs)(n.Modal.Header,{children:[(0,a.jsx)(n.Modal.Title,{children:"Auto-Reload"}),(0,a.jsxs)(n.Modal.Subtitle,{children:["Keep ",c.VERCEL_AGENT_NAME," running by automatically adding credit when your balance falls below a certain amount."]})]}),x&&l?(0,a.jsx)(o.Note,{fill:!0,children:(0,a.jsxs)("p",{className:"text-copy-14",children:["Buy with MIU is enabled for ",c.VERCEL_AGENT_NAME,". Auto-reload is managed in your"," ",(0,a.jsx)(m.Link,{href:`/${l}/~/settings/billing#plan`,variant:"highlight",children:"billing settings"}),"."]})}):(0,a.jsx)(d.AutoRechargeForm,{autoRechargeConfig:s,onCancel:()=>i("top_up"),onComplete:()=>i("top_up")})]}),x&&(0,a.jsx)(n.Modal.Actions,{children:(0,a.jsx)(n.Modal.Action,{type:"secondary",onClick:()=>i("top_up"),children:"Back"})})]})}e.i(4373123);var x=e.i(5325056),h=e.i(2166755),f=e.i(5338940),b=e.i(7917902),y=e.i(7837522),v=e.i(7780974),A=e.i(87116);e.s(["useAddCreditsModal",0,function(){let[e,n]=(0,t.useState)(null),o=(0,t.useRef)(void 0),{track:d}=(0,y.useTrackActivity)(),{autoRechargeConfig:c}=(0,l.useVercelAgentCreditsAutoRecharge)(),{balance:u}=(0,A.useVercelAgentCreditsBalance)(),{team:m}=(0,f.useTeam)(),{account:p}=(0,b.useAccount)(),C=(0,h.useEnvironment)(p),N=(0,t.useRef)(null),j=(0,t.useCallback)(()=>{n(null),N.current?.(),o.current=void 0},[]),E=(0,t.useCallback)(e=>{d(v.VercelActivityAction.VercelAgentAddCreditsModalCompleted,{source:o.current,previousBalance:u,...e,autoRechargeConfig:e.autoRechargeConfig??c})},[c,d,u]);return{openModal:e=>{o.current=e,n("top_up"),d(v.VercelActivityAction.VercelAgentAddCreditsModalOpened,{source:e,previousBalance:u,autoRechargeConfig:c})},closeModal:j,modals:(0,a.jsxs)(x.CopperProvider,{environment:C,teamIdOrSlug:m?.id,clearPaymentStateRef:N,children:[(0,a.jsx)(i.TopUpModal,{activeModalType:e,setActiveModalType:n,autoRechargeConfig:c}),(0,a.jsx)(s.CheckoutModal,{activeModalType:e,setActiveModalType:n,onConversion:E}),(0,a.jsx)(r.default,{active:"add_card"===e,onAdded:()=>{n("checkout")},onCancel:()=>{n("checkout")}}),(0,a.jsx)(g,{activeModalType:e,setActiveModalType:n,autoRechargeConfig:c},JSON.stringify(c))]})}}],8863362)}]);

//# debugId=490096c5-31c7-4735-fc18-0bfd542dd6db
//# sourceMappingURL=cfd852e4909f9d37.js.map