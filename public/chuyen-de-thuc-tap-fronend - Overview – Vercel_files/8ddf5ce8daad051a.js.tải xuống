;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="9bd97046-6f27-73c7-f253-437529c45be6")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7948698,5921732,408695,e=>{"use strict";let t,r;var i=e.i(7962980),n=e.i(5972454),a=e.i(8973103),s=e.i(3683485),o=e.i(7548658);let l=Symbol.for("effect/Clock"),u=n.GenericTag("effect/Clock"),c=0x80000000-1,d={unsafeSchedule(e,t){let r=a.toMillis(t);if(r>c)return s.constFalse;let i=!1,n=setTimeout(()=>{i=!0,e()},r);return()=>(clearTimeout(n),!i)}},p=(r=BigInt(1e6),"u"<typeof performance?()=>BigInt(Date.now())*r:()=>(void 0===t&&(t=BigInt(Date.now())*r-BigInt(Math.round(1e6*performance.now()))),t+BigInt(Math.round(1e6*performance.now())))),f=function(){let e="object"==typeof i.default&&"hrtime"in i.default&&"function"==typeof i.default.hrtime.bigint?i.default.hrtime:void 0;if(!e)return p;let t=p()-e.bigint();return()=>t+e.bigint()}();class h{[l]=l;unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return f()}currentTimeMillis=o.sync(()=>this.unsafeCurrentTimeMillis());currentTimeNanos=o.sync(()=>this.unsafeCurrentTimeNanos());scheduler(){return o.succeed(d)}sleep(e){return o.async(t=>{let r=d.unsafeSchedule(()=>t(o.void),e);return o.asVoid(o.sync(r))})}}e.s(["ClockTypeId",0,l,"clockTag",0,u,"make",0,()=>new h],7948698);var m=e.i(138042),g=e.i(7459383);e.i(6816077);var y=e.i(6712028),S=e.i(4935619);S.isNumber,m.number;let b=y.number,v=y.greaterThanOrEqualTo(b),E=y.clamp(b),w=(0,s.dual)(2,(e,t)=>{let r=(e.toString().split(".")[1]||"").length,i=(t.toString().split(".")[1]||"").length,n=r>i?r:i;return parseInt(e.toFixed(n).replace(".",""))%parseInt(t.toFixed(n).replace(".",""))/Math.pow(10,n)});e.s(["Order",0,b,"clamp",0,E,"greaterThanOrEqualTo",0,v,"nextPow2",0,e=>Math.max(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))),2),"parse",0,e=>{if("NaN"===e)return g.some(NaN);if("Infinity"===e)return g.some(1/0);if("-Infinity"===e)return g.some(-1/0);if(""===e.trim())return g.none;let t=Number(e);return Number.isNaN(t)?g.none:g.some(t)},"remainder",0,w,"sign",0,e=>b(e,0)],5921732),S.isRegExp,e.s(["escape",0,e=>e.replace(/[/\\^$*+?.()|[\]{}]/g,"\\$&")],408695)},194400,e=>{"use strict";var t=e.i(5283034),r=e.i(1331084),i=e.i(3683485),n=e.i(4935619);let a="InvalidData",s="MissingData",o="SourceUnavailable",l="Unsupported",u=Symbol.for("effect/ConfigError"),c={_tag:"ConfigError",[u]:u},d=(e,t)=>{let r=Object.create(c);return r._op="And",r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),Object.defineProperty(r,"message",{enumerable:!1,get(){return this.toString()}}),r},p=(e,t)=>{let r=Object.create(c);return r._op="Or",r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),Object.defineProperty(r,"message",{enumerable:!1,get(){return this.toString()}}),r},f=function(e,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{pathDelim:"."},s=Object.create(c);return s._op=a,s.path=e,s.message=r,Object.defineProperty(s,"toString",{enumerable:!1,value(){let e=(0,i.pipe)(this.path,t.join(n.pathDelim));return`(Invalid data at ${e}: "${this.message}")`}}),s},h=function(e,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{pathDelim:"."},a=Object.create(c);return a._op=s,a.path=e,a.message=r,Object.defineProperty(a,"toString",{enumerable:!1,value(){let e=(0,i.pipe)(this.path,t.join(n.pathDelim));return`(Missing data at ${e}: "${this.message}")`}}),a},m=function(e,r,n){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{pathDelim:"."},s=Object.create(c);return s._op=o,s.path=e,s.message=r,s.cause=n,Object.defineProperty(s,"toString",{enumerable:!1,value(){let e=(0,i.pipe)(this.path,t.join(a.pathDelim));return`(Source unavailable at ${e}: "${this.message}")`}}),s},g=function(e,r){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{pathDelim:"."},a=Object.create(c);return a._op=l,a.path=e,a.message=r,Object.defineProperty(a,"toString",{enumerable:!1,value(){let e=(0,i.pipe)(this.path,t.join(n.pathDelim));return`(Unsupported operation at ${e}: "${this.message}")`}}),a},y=(0,i.dual)(2,(e,t)=>{switch(e._op){case"And":return d(y(e.left,t),y(e.right,t));case"Or":return p(y(e.left,t),y(e.right,t));case a:return f([...t,...e.path],e.message);case s:return h([...t,...e.path],e.message);case o:return m([...t,...e.path],e.message,e.cause);case l:return g([...t,...e.path],e.message)}}),S={andCase:(e,t,r)=>t&&r,orCase:(e,t,r)=>t&&r,invalidDataCase:i.constFalse,missingDataCase:i.constTrue,sourceUnavailableCase:i.constFalse,unsupportedCase:i.constFalse},b=(0,i.dual)(3,(e,t,i)=>{let n=[e],u=[];for(;n.length>0;){let e=n.pop();switch(e._op){case"And":n.push(e.right),n.push(e.left),u.push(r.left({_op:"AndCase"}));break;case"Or":n.push(e.right),n.push(e.left),u.push(r.left({_op:"OrCase"}));break;case a:u.push(r.right(i.invalidDataCase(t,e.path,e.message)));break;case s:u.push(r.right(i.missingDataCase(t,e.path,e.message)));break;case o:u.push(r.right(i.sourceUnavailableCase(t,e.path,e.message,e.cause)));break;case l:u.push(r.right(i.unsupportedCase(t,e.path,e.message)))}}let c=[];for(;u.length>0;){let e=u.pop();switch(e._op){case"Left":switch(e.left._op){case"AndCase":{let e=c.pop(),r=c.pop(),n=i.andCase(t,e,r);c.push(n);break}case"OrCase":{let e=c.pop(),r=c.pop(),n=i.orCase(t,e,r);c.push(n)}}break;case"Right":c.push(e.right)}}if(0===c.length)throw Error("BUG: ConfigError.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return c.pop()});e.s(["And",0,d,"ConfigErrorTypeId",0,u,"InvalidData",0,f,"MissingData",0,h,"Or",0,p,"SourceUnavailable",0,m,"Unsupported",0,g,"isAnd",0,e=>"And"===e._op,"isConfigError",0,e=>(0,n.hasProperty)(e,u),"isInvalidData",0,e=>e._op===a,"isMissingData",0,e=>e._op===s,"isMissingDataOnly",0,e=>b(e,void 0,S),"isOr",0,e=>"Or"===e._op,"isSourceUnavailable",0,e=>e._op===o,"isUnsupported",0,e=>e._op===l,"prefixed",0,y,"reduceWithContext",0,b],194400)},7294722,5166253,1029151,9347119,5525866,3427637,e=>{"use strict";let t,r;var i=e.i(5283034),n=e.i(5972454),a=e.i(8973103),s=e.i(3683485),o=e.i(9159985),l=e.i(7948698),u=e.i(7962980),c=e.i(1331084),d=e.i(5015632),p=e.i(9390854),f=e.i(5921732),h=e.i(8815901),m=e.i(9960543);e.i(4935619);var g=e.i(408695),y=e.i(194400),S=e.i(6774608);let b={_tag:"Empty"},v=(0,s.dual)(2,(e,t)=>({_tag:"AndThen",first:e,second:t})),E=(0,s.dual)(2,(e,t)=>v(e,{_tag:"MapName",f:t})),w=(0,s.dual)(2,(e,t)=>v(e,{_tag:"Nested",name:t})),k=(0,s.dual)(2,(e,t)=>v(e,{_tag:"Unnested",name:t})),I=(0,s.dual)(2,(e,t)=>{let r=S.of(t),n=e;for(;S.isCons(r);){let e=r.head;switch(e._tag){case"Empty":r=r.tail;break;case"AndThen":r=S.cons(e.first,S.cons(e.second,r.tail));break;case"MapName":n=i.map(n,e.f),r=r.tail;break;case"Nested":n=i.prepend(n,e.name),r=r.tail;break;case"Unnested":if(!(0,s.pipe)(i.head(n),h.contains(e.name)))return c.left(y.MissingData(n,`Expected ${e.name} to be in path in ConfigProvider#unnested`));n=i.tailNonEmpty(n),r=r.tail}}return c.right(n)});var T=e.i(7548658);let x="Constant",C="Fail",R="Fallback",F="Described",A="Lazy",O="MapOrFail",_="Nested",M="Primitive",D="Sequence",N="HashMap",P="ZipWith";e.s(["OP_CONSTANT",0,x,"OP_DESCRIBED",0,F,"OP_FAIL",0,C,"OP_FALLBACK",0,R,"OP_HASHMAP",0,N,"OP_LAZY",0,A,"OP_MAP_OR_FAIL",0,O,"OP_NESTED",0,_,"OP_PRIMITIVE",0,M,"OP_SEQUENCE",0,D,"OP_ZIP_WITH",0,P],5166253);let L=(e,t)=>[...e,...t],U=Symbol.for("effect/ConfigProvider"),z=n.GenericTag("effect/ConfigProvider"),W=Symbol.for("effect/ConfigProviderFlat"),B=e=>({[W]:W,patch:e.patch,load:function(t,r){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return e.load(t,r,i)},enumerateChildren:e.enumerateChildren}),q=e=>({[U]:U,pipe(){return(0,m.pipeArguments)(this,arguments)},...{load:t=>T.flatMap(j(e,i.empty(),t,!1),e=>h.match(i.head(e),{onNone:()=>T.fail(y.MissingData(i.empty(),`Expected a single value having structure: ${t}`)),onSome:T.succeed})),flattened:e}}),$=e=>{let{pathDelim:t,seqDelim:r}=Object.assign({},{pathDelim:"_",seqDelim:","},e),n=()=>void 0!==u.default&&"env"in u.default&&"object"==typeof u.default.env?u.default.env:{};return q(B({load:function(e,a){let o=!(arguments.length>2)||void 0===arguments[2]||arguments[2],l=(0,s.pipe)(e,i.join(t)),u=n(),c=l in u?h.some(u[l]):h.none();return(0,s.pipe)(c,T.mapError(()=>y.MissingData(e,`Expected ${l} to exist in the process context`)),T.flatMap(t=>G(t,e,a,r,o)))},enumerateChildren:e=>T.sync(()=>{let r=Object.keys(n()).map(e=>e.toUpperCase().split(t)).filter(t=>{for(let r=0;r<e.length;r++){let n=(0,s.pipe)(e,i.unsafeGet(r)),a=t[r];if(void 0===a||n!==a)return!1}return!0}).flatMap(t=>t.slice(e.length,e.length+1));return p.fromIterable(r)}),patch:b}))},j=(e,t,r,n)=>{switch(r._tag){case x:return T.succeed(i.of(r.value));case F:return T.suspend(()=>j(e,t,r.config,n));case C:return T.fail(y.MissingData(t,r.message));case R:return(0,s.pipe)(T.suspend(()=>j(e,t,r.first,n)),T.catchAll(i=>r.condition(i)?(0,s.pipe)(j(e,t,r.second,n),T.catchAll(e=>T.fail(y.Or(i,e)))):T.fail(i)));case A:return T.suspend(()=>j(e,t,r.config(),n));case O:return T.suspend(()=>(0,s.pipe)(j(e,t,r.original,n),T.flatMap(T.forEachSequential(e=>(0,s.pipe)(r.mapOrFail(e),T.mapError(y.prefixed(((e,t)=>{let r=t;if("Nested"===r._tag){let t=e.slice();for(;"Nested"===r._tag;)t.push(r.name),r=r.config;return t}return e})(t,r.original))))))));case _:return T.suspend(()=>j(e,L(t,i.of(r.name)),r.config,n));case M:return(0,s.pipe)(I(t,e.patch),T.flatMap(t=>(0,s.pipe)(e.load(t,r,n),T.flatMap(e=>{if(0===e.length){let e=(0,s.pipe)(i.last(t),h.getOrElse(()=>"<n/a>"));return T.fail(y.MissingData([],`Expected ${r.description} with name ${e}`))}return T.succeed(e)}))));case D:return(0,s.pipe)(I(t,e.patch),T.flatMap(n=>(0,s.pipe)(e.enumerateChildren(n),T.flatMap(J),T.flatMap(n=>0===n.length?T.suspend(()=>T.map(j(e,t,r.config,!0),i.of)):(0,s.pipe)(T.forEachSequential(n,n=>j(e,i.append(t,`[${n}]`),r.config,!0)),T.map(e=>{let t=i.flatten(e);return 0===t.length?i.of(i.empty()):i.of(t)}))))));case N:return T.suspend(()=>(0,s.pipe)(I(t,e.patch),T.flatMap(t=>(0,s.pipe)(e.enumerateChildren(t),T.flatMap(a=>(0,s.pipe)(a,T.forEachSequential(a=>j(e,L(t,i.of(a)),r.valueConfig,n)),T.map(e=>0===e.length?i.of(d.empty()):(0,s.pipe)(K(e),i.map(e=>d.fromIterable(i.zip(i.fromIterable(a),e)))))))))));case P:return T.suspend(()=>(0,s.pipe)(j(e,t,r.left,n),T.either,T.flatMap(a=>(0,s.pipe)(j(e,t,r.right,n),T.either,T.flatMap(e=>{if(c.isLeft(a)&&c.isLeft(e))return T.fail(y.And(a.left,e.left));if(c.isLeft(a)&&c.isRight(e))return T.fail(a.left);if(c.isRight(a)&&c.isLeft(e))return T.fail(e.left);if(c.isRight(a)&&c.isRight(e)){var n,o;let l,u,d=(0,s.pipe)(t,i.join(".")),p=V(t,d),[f,m]=(n=(0,s.pipe)(a.right,i.map(c.right)),o=(0,s.pipe)(e.right,i.map(c.right)),l=i.unfold(n.length,e=>e>=o.length?h.none():h.some([p(e),e+1])),u=i.unfold(o.length,e=>e>=n.length?h.none():h.some([p(e),e+1])),[L(n,l),L(o,u)]);return(0,s.pipe)(f,i.zip(m),T.forEachSequential(e=>{let[t,i]=e;return(0,s.pipe)(T.zip(t,i),T.map(e=>{let[t,i]=e;return r.zip(t,i)}))}))}throw Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/effect/issues")})))))}},V=(e,t)=>r=>c.left(y.MissingData(e,`The element at index ${r} in a sequence at path "${t}" was missing`)),H=((e,t)=>q(B({load:(t,r)=>e.flattened.load(t,r,!0),enumerateChildren:t=>e.flattened.enumerateChildren(t),patch:w(e.flattened.patch,t)})),(e,t)=>B({load:(r,i,n)=>(0,s.pipe)(I(r,e.patch),T.flatMap(t=>e.load(t,i,n)),T.catchAll(e=>(0,s.pipe)(T.sync(t),T.flatMap(t=>(0,s.pipe)(I(r,t.patch),T.flatMap(e=>t.load(e,i,n)),T.catchAll(t=>T.fail(y.Or(e,t)))))))),enumerateChildren:r=>(0,s.pipe)(I(r,e.patch),T.flatMap(t=>e.enumerateChildren(t)),T.either,T.flatMap(e=>(0,s.pipe)(T.sync(t),T.flatMap(t=>(0,s.pipe)(I(r,t.patch),T.flatMap(e=>t.enumerateChildren(e)),T.either,T.flatMap(t=>{if(c.isLeft(e)&&c.isLeft(t))return T.fail(y.And(e.left,t.left));if(c.isLeft(e)&&c.isRight(t))return T.succeed(t.right);if(c.isRight(e)&&c.isLeft(t))return T.succeed(e.right);if(c.isRight(e)&&c.isRight(t))return T.succeed((0,s.pipe)(e.right,p.union(t.right)));throw Error("BUG: ConfigProvider.orElseFlat - please report an issue at https://github.com/Effect-TS/effect/issues")})))))),patch:b})),G=(e,t,r,n,a)=>a?(0,s.pipe)(e.split(RegExp(`\\s*${g.escape(n)}\\s*`)),T.forEachSequential(e=>r.parse(e.trim())),T.mapError(y.prefixed(t))):(0,s.pipe)(r.parse(e),T.mapBoth({onFailure:y.prefixed(t),onSuccess:i.of})),K=e=>Object.keys(e[0]).map(t=>e.map(e=>e[t])),J=e=>(0,s.pipe)(T.forEachSequential(e,Q),T.mapBoth({onFailure:()=>i.empty(),onSuccess:i.sort(f.Order)}),T.either,T.map(c.merge)),Z=/^(\[(\d+)\])$/,Q=e=>{let t=e.match(Z);if(null!==t){let e=t[2];return(0,s.pipe)(void 0!==e&&e.length>0?h.some(e):h.none(),h.flatMap(Y))}return h.none()},Y=e=>{let t=Number.parseInt(e);return Number.isNaN(t)?h.none():h.some(t)};e.s(["configProviderTag",0,z,"fromEnv",0,$],1029151);let X=Symbol.for("effect/Console"),ee=n.GenericTag("effect/Console"),et={[X]:X,assert(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return T.sync(()=>{console.assert(e,...r)})},clear:T.sync(()=>{console.clear()}),count:e=>T.sync(()=>{console.count(e)}),countReset:e=>T.sync(()=>{console.countReset(e)}),debug(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return T.sync(()=>{console.debug(...t)})},dir:(e,t)=>T.sync(()=>{console.dir(e,t)}),dirxml(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return T.sync(()=>{console.dirxml(...t)})},error(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return T.sync(()=>{console.error(...t)})},group:e=>e?.collapsed?T.sync(()=>console.groupCollapsed(e?.label)):T.sync(()=>console.group(e?.label)),groupEnd:T.sync(()=>{console.groupEnd()}),info(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return T.sync(()=>{console.info(...t)})},log(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return T.sync(()=>{console.log(...t)})},table:(e,t)=>T.sync(()=>{console.table(e,t)}),time:e=>T.sync(()=>console.time(e)),timeEnd:e=>T.sync(()=>console.timeEnd(e)),timeLog(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return T.sync(()=>{console.timeLog(e,...r)})},trace(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return T.sync(()=>{console.trace(...t)})},warn(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return T.sync(()=>{console.warn(...t)})},unsafe:console};e.s(["consoleTag",0,ee,"defaultConsole",0,et],9347119);var er=e.i(7862555),ei=e.i(2090854),en=e.i(4138091);let ea=Symbol.for("effect/Random"),es=n.GenericTag("effect/Random");class eo{seed;[ea]=ea;PRNG;constructor(e){this.seed=e,this.PRNG=new en.PCGRandom(e)}get next(){return T.sync(()=>this.PRNG.number())}get nextBoolean(){return T.map(this.next,e=>e>.5)}get nextInt(){return T.sync(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(e,t){return T.map(this.next,r=>(t-e)*r+e)}nextIntBetween(e,t){return T.sync(()=>this.PRNG.integer(t-e)+e)}shuffle(e){return el(e,e=>this.nextIntBetween(0,e))}}let el=(e,t)=>T.suspend(()=>(0,s.pipe)(T.sync(()=>Array.from(e)),T.flatMap(e=>{let r=[];for(let t=e.length;t>=2;t-=1)r.push(t);return(0,s.pipe)(r,T.forEachSequentialDiscard(r=>(0,s.pipe)(t(r),T.map(t=>eu(e,r-1,t)))),T.as(er.fromIterable(e)))}))),eu=(e,t,r)=>{let i=e[t];return e[t]=e[r],e[r]=i,e},ec=e=>new eo(ei.hash(e));class ed{values;[ea]=ea;index=0;constructor(e){if(this.values=e,0===e.length)throw Error("Requires at least one value")}getNextValue(){let e=this.values[this.index];return this.index=(this.index+1)%this.values.length,e}get next(){return T.sync(()=>{let e=this.getNextValue();return"number"==typeof e?Math.max(0,Math.min(1,e)):ei.hash(e)/0x7fffffff})}get nextBoolean(){return T.sync(()=>{let e=this.getNextValue();return"boolean"==typeof e?e:ei.hash(e)%2==0})}get nextInt(){return T.sync(()=>{let e=this.getNextValue();return"number"==typeof e&&Number.isFinite(e)?Math.round(e):Math.abs(ei.hash(e))})}nextRange(e,t){return T.map(this.next,r=>(t-e)*r+e)}nextIntBetween(e,t){return T.sync(()=>{let r=this.getNextValue();return"number"==typeof r&&Number.isFinite(r)?Math.max(e,Math.min(t-1,Math.round(r))):e+Math.abs(ei.hash(r))%(t-e)})}shuffle(e){return el(e,e=>this.nextIntBetween(0,e))}}e.s(["RandomTypeId",0,ea,"fixed",0,e=>new ed(e),"make",0,ec,"randomTag",0,es],5525866);let ep=Symbol.for("effect/Tracer"),ef=e=>({[ep]:ep,...e}),eh=n.GenericTag("effect/Tracer"),em=n.GenericTag("effect/ParentSpan"),eg=(r=(t="abcdef0123456789").length,function(e){let i="";for(let n=0;n<e;n++)i+=t.charAt(Math.floor(Math.random()*r));return i});class ey{name;parent;context;startTime;kind;_tag="Span";spanId;traceId="native";sampled=!0;status;attributes;events=[];links;constructor(e,t,r,i,n,a){this.name=e,this.parent=t,this.context=r,this.startTime=n,this.kind=a,this.status={_tag:"Started",startTime:n},this.attributes=new Map,this.traceId="Some"===t._tag?t.value.traceId:eg(32),this.spanId=eg(16),this.links=Array.from(i)}end(e,t){this.status={_tag:"Ended",endTime:e,exit:t,startTime:this.status.startTime}}attribute(e,t){this.attributes.set(e,t)}event(e,t,r){this.events.push([e,t,r??{}])}addLinks(e){this.links.push(...e)}}let eS=ef({span:(e,t,r,i,n,a)=>new ey(e,t,r,i,n,a),context:e=>e()}),eb=n.Reference()("effect/Tracer/DisablePropagation",{defaultValue:s.constFalse});e.s(["DisablePropagation",0,eb,"TracerTypeId",0,ep,"addSpanStackTrace",0,e=>{if(e?.captureStackTrace===!1||e?.captureStackTrace!==void 0&&"boolean"!=typeof e.captureStackTrace)return e;let t=Error.stackTraceLimit;Error.stackTraceLimit=3;let r=Error();Error.stackTraceLimit=t;let i=!1;return{...e,captureStackTrace:()=>{if(!1!==i)return i;if(void 0!==r.stack){let e=r.stack.split("\n");if(void 0!==e[3])return i=e[3].trim()}}}},"externalSpan",0,e=>({_tag:"ExternalSpan",spanId:e.spanId,traceId:e.traceId,sampled:e.sampled??!0,context:e.context??n.empty()}),"make",0,ef,"nativeTracer",0,eS,"spanTag",0,em,"tracerTag",0,eh],3427637);let ev=(0,s.pipe)(n.empty(),n.add(l.clockTag,l.make()),n.add(ee,et),n.add(es,ec(Math.random())),n.add(z,$()),n.add(eh,eS)),eE=(0,o.globalValue)(Symbol.for("effect/DefaultServices/currentServices"),()=>T.fiberRefUnsafeMakeContext(ev)),ew=e=>T.withFiberRuntime(t=>e(t.currentDefaultServices)),ek=e=>ew(t=>e(t.unsafeMap.get(l.clockTag.key))),eI=ek(e=>e.currentTimeMillis),eT=ek(e=>e.currentTimeNanos),ex=(0,s.dual)(2,(e,t)=>T.fiberRefLocallyWith(eE,n.add(l.clockTag,t))(e)),eC=(0,s.dual)(2,(e,t)=>T.fiberRefLocallyWith(eE,n.add(z,t))(e)),eR=e=>ew(t=>e(t.unsafeMap.get(z.key))),eF=e=>ew(t=>e(t.unsafeMap.get(es.key))),eA=(0,s.dual)(2,(e,t)=>T.fiberRefLocallyWith(eE,n.add(es,t))(e)),eO=eF(e=>e.next),e_=eF(e=>e.nextInt),eM=eF(e=>e.nextBoolean),eD=(0,s.dual)(2,(e,t)=>T.fiberRefLocallyWith(eE,n.add(eh,t))(e));e.s(["choice",0,e=>{let t=i.fromIterable(e);return T.map(0===t.length?T.fail(new T.NoSuchElementException("Cannot select a random element from an empty array")):eF(e=>e.nextIntBetween(0,t.length)),e=>t[e])},"clockWith",0,ek,"config",0,e=>eR(t=>t.load(e)),"configProviderWith",0,eR,"currentServices",0,eE,"currentTimeMillis",0,eI,"currentTimeNanos",0,eT,"next",0,eO,"nextBoolean",0,eM,"nextInt",0,e_,"nextIntBetween",0,(e,t)=>eF(r=>r.nextIntBetween(e,t)),"nextRange",0,(e,t)=>eF(r=>r.nextRange(e,t)),"randomWith",0,eF,"shuffle",0,e=>eF(t=>t.shuffle(e)),"sleep",0,e=>{let t=a.decode(e);return ek(e=>e.sleep(t))},"tracerWith",0,e=>ew(t=>e(t.unsafeMap.get(eh.key))),"withClock",0,ex,"withConfigProvider",0,eC,"withRandom",0,eA,"withTracer",0,eD],7294722)},2725920,e=>{"use strict";var t=e.i(138042),r=e.i(3683485),i=e.i(6712028);e.i(4935619).isBoolean,t.boolean,i.boolean,e.s(["not",0,e=>!e])},7525378,592224,1177850,283075,9674368,8317886,5886356,2273461,9246450,5369340,3196727,6532885,2916763,8755077,6211456,219787,8531418,1253121,7897461,4039787,e=>{"use strict";var t=e.i(5242335);t.EffectTypeId,t.StreamTypeId,t.SinkTypeId,t.ChannelTypeId;let r=t.EffectPrototype,i=t.CommitPrototype;t.StructuralCommitPrototype;let n=t.Base,a=t.StructuralBase;class s extends n{}e.s(["Class",0,s,"CommitPrototype",0,i,"EffectPrototype",0,r,"StructuralClass",0,class extends a{}],7525378);var o=e.i(3683485);let l="Sequential",u="Parallel",c="ParallelN",d={_tag:l},p={_tag:u},f=e=>({_tag:c,parallelism:e}),h=(0,o.dual)(2,(e,t)=>{switch(e._tag){case l:return t.onSequential();case u:return t.onParallel();case c:return t.onParallelN(e.parallelism)}});e.s(["isParallel",0,e=>e._tag===u,"isParallelN",0,e=>e._tag===c,"isSequential",0,e=>e._tag===l,"match",0,h,"parallel",0,p,"parallelN",0,f,"sequential",0,d],592224),e.s(["parallel",0,p,"parallelN",0,f,"sequential",0,d],1177850);var m=e.i(5283034),g=e.i(3628392),y=e.i(9390854),S=e.i(8815901),b=e.i(9960543),v=e.i(7548658);function E(e){return new I(e)}function w(){return E(new Map)}let k=Symbol.for("effect/FiberRefs");class I{locals;[k]=k;constructor(e){this.locals=e}pipe(){return(0,b.pipeArguments)(this,arguments)}}let T=function(e,t,r){let i,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=t,s=r,o=n;for(;void 0===i;)if(m.isNonEmptyReadonlyArray(a)&&m.isNonEmptyReadonlyArray(s)){let e=m.headNonEmpty(a)[0],t=m.tailNonEmpty(a),r=m.headNonEmpty(s)[0],n=m.headNonEmpty(s)[1],l=m.tailNonEmpty(s);e.startTimeMillis<r.startTimeMillis?(s=l,o=!0):e.startTimeMillis>r.startTimeMillis?a=t:e.id<r.id?(s=l,o=!0):e.id>r.id?a=t:i=[n,o]}else i=[e.initial,!0];return i},x=(0,o.dual)(3,(e,t,r)=>{let i=new Map(e.locals);return r.locals.forEach((e,r)=>{let n=e[0][1];if(!e[0][0][g.symbol](t)){if(!i.has(r)){if(g.equals(n,r.initial))return;i.set(r,[[t,r.join(r.initial,n)]]);return}let a=i.get(r),[s,o]=T(r,a,e);if(o){let e=r.diff(s,n),o=a[0][1],l=r.join(o,r.patch(e)(o));if(!g.equals(o,l)){let e,n=a[0][0];e=n[g.symbol](t)?[[n,l],...a.slice(1)]:[[t,l],...a],i.set(r,e)}}}}),new I(i)}),C=(0,o.dual)(2,(e,t)=>{let r=new Map;return R(e,r,t),new I(r)}),R=(e,t,r)=>{e.locals.forEach((e,i)=>{let n=e[0][1],a=i.patch(i.fork)(n);g.equals(n,a)?t.set(i,e):t.set(i,[[r,a],...e])})},F=e=>y.fromIterable(e.locals.keys()),A=e=>v.forEachSequentialDiscard(F(e),t=>v.fiberRefSet(t,M(e,t))),O=(0,o.dual)(2,(e,t)=>{let r=new Map(e.locals);return r.delete(t),new I(r)}),_=(0,o.dual)(2,(e,t)=>e.locals.has(t)?S.some(m.headNonEmpty(e.locals.get(t))[1]):S.none()),M=(0,o.dual)(2,(e,t)=>(0,o.pipe)(_(e,t),S.getOrElse(()=>t.initial))),D=(0,o.dual)(2,(e,t)=>{let{fiberId:r,fiberRef:i,value:n}=t;if(0===e.locals.size)return new I(new Map([[i,[[r,n]]]]));let a=new Map(e.locals);return N(a,r,i,n),new I(a)}),N=(e,t,r,i)=>{let n,a=e.get(r)??[];if(m.isNonEmptyReadonlyArray(a)){let[e,r]=m.headNonEmpty(a);if(e[g.symbol](t))if(g.equals(r,i))return;else n=[[t,i],...a.slice(1)];else n=[[t,i],...a]}else n=[[t,i]];e.set(r,n)},P=(0,o.dual)(2,(e,t)=>{let{entries:r,forkAs:i}=t;if(0===e.locals.size)return new I(new Map(r));let n=new Map(e.locals);return void 0!==i&&R(e,n,i),r.forEach(e=>{let[t,r]=e;1===r.length?N(n,r[0][0],t,r[0][1]):r.forEach(e=>{let[r,i]=e;N(n,r,t,i)})}),new I(n)});e.s(["FiberRefsSym",0,k,"delete_",0,O,"empty",0,w,"fiberRefs",0,F,"forkAs",0,C,"get",0,_,"getOrDefault",0,M,"joinAs",0,x,"setAll",0,A,"unsafeMake",0,E,"updateAs",0,D,"updateManyAs",0,P],283075),e.s(["delete",0,O,"empty",0,w,"get",0,_,"getOrDefault",0,M,"joinAs",0,x,"setAll",0,A,"updateAs",0,D,"updateManyAs",0,P],9674368);let L="Empty",U="Remove",z="Update",W="AndThen",B={_tag:L},q=(e,t)=>{let r=new Map(e.locals),i=B;for(let[e,n]of t.locals.entries()){let t=m.headNonEmpty(n)[1],a=r.get(e);if(void 0!==a){let r=m.headNonEmpty(a)[1];(0,g.equals)(r,t)||(i=$({_tag:z,fiberRef:e,patch:e.diff(r,t)})(i))}else i=$({_tag:"Add",fiberRef:e,value:t})(i);r.delete(e)}for(let[e]of r.entries())i=$({_tag:U,fiberRef:e})(i);return i},$=(0,o.dual)(2,(e,t)=>({_tag:W,first:e,second:t})),j=(0,o.dual)(3,(e,t,r)=>{let i=r,n=m.of(e);for(;m.isNonEmptyReadonlyArray(n);){let e=m.headNonEmpty(n),r=m.tailNonEmpty(n);switch(e._tag){case L:n=r;break;case"Add":i=D(i,{fiberId:t,fiberRef:e.fiberRef,value:e.value}),n=r;break;case U:i=O(i,e.fiberRef),n=r;break;case z:{let a=M(i,e.fiberRef);i=D(i,{fiberId:t,fiberRef:e.fiberRef,value:e.fiberRef.patch(e.patch)(a)}),n=r;break}case W:n=m.prepend(e.first)(m.prepend(e.second)(r))}}return i});e.s(["diff",0,q,"patch",0,j],8317886);var V=e.i(2090854),H=e.i(4935619);let G="effect/FiberStatus",K=Symbol.for(G),J="Done",Z="Running",Q="Suspended",Y=V.string(`${G}-${J}`);class X{[K]=K;_tag=J;[V.symbol](){return Y}[g.symbol](e){return ei(e)&&e._tag===J}}class ee{runtimeFlags;[K]=K;_tag=Z;constructor(e){this.runtimeFlags=e}[V.symbol](){return(0,o.pipe)(V.hash(G),V.combine(V.hash(this._tag)),V.combine(V.hash(this.runtimeFlags)),V.cached(this))}[g.symbol](e){return ei(e)&&e._tag===Z&&this.runtimeFlags===e.runtimeFlags}}class et{runtimeFlags;blockingOn;[K]=K;_tag=Q;constructor(e,t){this.runtimeFlags=e,this.blockingOn=t}[V.symbol](){return(0,o.pipe)(V.hash(G),V.combine(V.hash(this._tag)),V.combine(V.hash(this.runtimeFlags)),V.combine(V.hash(this.blockingOn)),V.cached(this))}[g.symbol](e){return ei(e)&&e._tag===Q&&this.runtimeFlags===e.runtimeFlags&&g.equals(this.blockingOn,e.blockingOn)}}let er=new X,ei=e=>(0,H.hasProperty)(e,K);e.s(["done",0,er,"isDone",0,e=>e._tag===J,"isRunning",0,e=>e._tag===Z,"isSuspended",0,e=>e._tag===Q,"running",0,e=>new ee(e),"suspended",0,(e,t)=>new et(e,t)],5886356);var en=e.i(5921732),ea=e.i(6712028);let es=v.logLevelAll,eo=v.logLevelFatal,el=v.logLevelError,eu=v.logLevelWarning,ec=v.logLevelInfo,ed=v.logLevelDebug,ep=v.logLevelTrace,ef=v.logLevelNone;v.allLogLevels;let eh=(0,o.pipe)(en.Order,ea.mapInput(e=>e.ordinal)),em=ea.greaterThan(eh);e.s(["Debug",0,ed,"Error",0,el,"Fatal",0,eo,"Info",0,ec,"Trace",0,ep,"Warning",0,eu,"fromLiteral",0,e=>{switch(e){case"All":return es;case"Debug":return ed;case"Error":return el;case"Fatal":return eo;case"Info":return ec;case"Trace":return ep;case"None":return ef;case"Warning":return eu}},"greaterThan",0,em],2273461);var eg=e.i(5972454);e.i(1331084);var ey=e.i(9159985),eS=e.i(2873450),eb=e.i(1200317),ev=e.i(5246317),eE=e.i(4138091);let ew=Symbol.for("effect/Micro"),ek=Symbol.for("effect/Micro/MicroExit"),eI=e=>"object"==typeof e&&null!==e&&ew in e,eT=Symbol.for("effect/Micro/MicroCause"),ex={_E:o.identity};class eC extends globalThis.Error{_tag;traces;[eT];constructor(e,t,r){let i,n,a;const s=`MicroCause.${e}`;if(t instanceof globalThis.Error){i=`(${s}) ${t.name}`;const e=(n=t.message).split("\n").length;a=t.stack?`(${s}) ${t.stack.split("\n").slice(0,e+3).join("\n")}`:`${i}: ${n}`}else i=s,n=(0,eS.toStringUnknown)(t,0),a=`${i}: ${n}`;r.length>0&&(a+=`
    ${r.join("\n    ")}`),super(n),this._tag=e,this.traces=r,this[eT]=ex,this.name=i,this.stack=a}pipe(){return(0,b.pipeArguments)(this,arguments)}toString(){return this.stack}[eS.NodeInspectSymbol](){return this.stack}}class eR extends eC{error;constructor(e,t=[]){super("Fail",e,t),this.error=e}}let eF=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return new eR(e,t)};class eA extends eC{defect;constructor(e,t=[]){super("Die",e,t),this.defect=e}}let eO=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return new eA(e,t)};class e_ extends eC{constructor(e=[]){super("Interrupt","interrupted",e)}}let eM=e=>"Fail"===e._tag,eD=e=>"Interrupt"===e._tag,eN=Symbol.for("effect/Micro/MicroFiber"),eP={_A:o.identity,_E:o.identity};class eL{context;interruptible;[eN];_stack=[];_observers=[];_exit;_children;currentOpCount=0;constructor(e,t=!0){this.context=e,this.interruptible=t,this[eN]=eP}getRef(e){return eb.unsafeGetReference(this.context,e)}addObserver(e){return this._exit?(e(this._exit),o.constVoid):(this._observers.push(e),()=>{let t=this._observers.indexOf(e);t>=0&&this._observers.splice(t,1)})}_interrupted=!1;unsafeInterrupt(){!this._exit&&(this._interrupted=!0,this.interruptible&&this.evaluate(tu))}unsafePoll(){return this._exit}evaluate(e){if(this._exit)return;if(void 0!==this._yielded){let e=this._yielded;this._yielded=void 0,e()}let t=this.runLoop(e);if(t===eH)return;let r=eU.interruptChildren&&eU.interruptChildren(this);if(void 0!==r)return this.evaluate(ti(r,()=>t));this._exit=t;for(let e=0;e<this._observers.length;e++)this._observers[e](t);this._observers.length=0}runLoop(e){let t=!1,r=e;this.currentOpCount=0;try{for(;;){if(this.currentOpCount++,!t&&this.getRef(tb).shouldYield(this)){t=!0;let e=r;r=ti(e5,()=>e)}if((r=r[eq](this))===eH){let e=this._yielded;if(ek in e)return this._yielded=void 0,e;return eH}}}catch(e){if(!(0,H.hasProperty)(r,eq))return tc(`MicroFiber.runLoop: Not a valid effect: ${String(r)}`);return tc(e)}}getCont(e){for(;;){let t=this._stack.pop();if(!t)return;let r=t[eV]&&t[eV](this);if(r)return{[e]:r};if(t[e])return t}}_yielded=void 0;yieldWith(e){return this._yielded=e,eH}children(){return this._children??=new Set}}let eU=(0,ey.globalValue)("effect/Micro/fiberMiddleware",()=>({interruptChildren:void 0})),ez=e=>e2(()=>{for(let t of e)t.unsafeInterrupt();let t=e[Symbol.iterator](),r=e2(()=>{let e=t.next();for(;!e.done;){if(e.value.unsafePoll()){e=t.next();continue}let i=e.value;return e9(e=>{i.addObserver(t=>{e(r)})})}return td});return r}),eW=Symbol.for("effect/Micro/identifier"),eB=Symbol.for("effect/Micro/args"),eq=Symbol.for("effect/Micro/evaluate"),e$=Symbol.for("effect/Micro/successCont"),ej=Symbol.for("effect/Micro/failureCont"),eV=Symbol.for("effect/Micro/ensureCont"),eH=Symbol.for("effect/Micro/Yield"),eG={_A:o.identity,_E:o.identity,_R:o.identity},eK={...r,_op:"Micro",[ew]:eG,pipe(){return(0,b.pipeArguments)(this,arguments)},[Symbol.iterator](){return new eE.SingleShotGen(new eE.YieldWrap(this))},toJSON(){return{_id:"Micro",op:this[eW],...eB in this?{args:this[eB]}:void 0}},toString(){return(0,eS.format)(this)},[eS.NodeInspectSymbol](){return(0,eS.format)(this)}};function eJ(e){return tc("Micro.evaluate: Not implemented")}let eZ=e=>({...eK,[eW]:e.op,[eq]:e.eval??eJ,[e$]:e.contA,[ej]:e.contE,[eV]:e.ensure}),eQ=e=>{let t=eZ(e);return function(){let r=Object.create(t);return r[eB]=!1===e.single?arguments:arguments[0],r}},eY=e=>{let t={...eZ(e),[ek]:ek,_tag:e.op,get[e.prop](){return this[eB]},toJSON(){return{_id:"MicroExit",_tag:e.op,[e.prop]:this[eB]}},[g.symbol](t){return ts(t)&&t._tag===e.op&&g.equals(this[eB],t[eB])},[V.symbol](){return V.cached(this,V.combine(V.string(e.op))(V.hash(this[eB])))}};return function(e){let r=Object.create(t);return r[eB]=e,r[e$]=void 0,r[ej]=void 0,r[eV]=void 0,r}},eX=eY({op:"Success",prop:"value",eval(e){let t=e.getCont(e$);return t?t[e$](this[eB],e):e.yieldWith(this)}}),e0=eY({op:"Failure",prop:"cause",eval(e){let t=e.getCont(ej);for(;eD(this[eB])&&t&&e.interruptible;)t=e.getCont(ej);return t?t[ej](this[eB],e):e.yieldWith(this)}}),e1=eQ({op:"Sync",eval(e){let t=this[eB](),r=e.getCont(e$);return r?r[e$](t,e):e.yieldWith(to(t))}}),e2=eQ({op:"Suspend",eval(e){return this[eB]()}}),e5=eQ({op:"Yield",eval(e){let t=!1;return e.getRef(tb).scheduleTask(()=>{t||e.evaluate(td)},this[eB]??0),e.yieldWith(()=>{t=!0})}})(0),e3=eX(void 0),e8=eQ({op:"WithMicroFiber",eval(e){return this[eB](e)}}),e4=eQ({op:"Async",single:!1,eval(e){let t=this[eB][0],r=!1,i=!1,n=this[eB][1]?new AbortController:void 0,a=t(t=>{r||(r=!0,i?e.evaluate(t):i=t)},n?.signal);return!1!==i?i:(i=!0,e._yielded=()=>{r=!0},void 0===n&&void 0===a||e._stack.push(e6(()=>(r=!0,n?.abort(),a??td))),eH)}}),e6=eQ({op:"AsyncFinalizer",ensure(e){e.interruptible&&(e.interruptible=!1,e._stack.push(tA(!0)))},contE(e,t){return eD(e)?ti(this[eB](),()=>e0(e)):e0(e)}}),e9=e=>e4(e,e.length>=2),e7=(0,o.dual)(2,(e,t)=>ta(e,e=>t)),te=(0,o.dual)(2,(e,t)=>ti(e,e=>{let r=eI(t)?t:"function"==typeof t?t(e):t;return eI(r)?r:eX(r)})),tt=((e,t)=>ti(e,e=>{let r=eI(t)?t:"function"==typeof t?t(e):t;return eI(r)?e7(r,e):eX(e)}),e=>tT(e,{onFailure:tl,onSuccess:to})),tr=(0,o.dual)(2,(e,t)=>{let r;return r=[e,t],e8(e=>e9(t=>{let i=!1,n=new Set,a=e=>{i=!0,t(0===n.size?e:ti(ez(n),()=>e))};for(let t of r){if(i)break;let r=tP(e,tO(t),!0,!0);n.add(r),r.addObserver(e=>{n.delete(r),a(e)})}return ez(n)}))}),ti=(0,o.dual)(2,(e,t)=>{let r=Object.create(tn);return r[eB]=e,r[e$]=t,r}),tn=eZ({op:"OnSuccess",eval(e){return e._stack.push(this),this[eB]}}),ta=(0,o.dual)(2,(e,t)=>ti(e,e=>eX(t(e)))),ts=e=>(0,H.hasProperty)(e,ek),to=eX,tl=e0,tu=tl(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new e_(e)}()),tc=e=>tl(eO(e)),td=to(void 0),tp=e=>{for(let t of e)if("Failure"===t._tag)return t;return td},tf="setImmediate"in globalThis?globalThis.setImmediate:e=>setTimeout(e,0);class th{tasks=[];running=!1;scheduleTask(e,t){this.tasks.push(e),this.running||(this.running=!0,tf(this.afterScheduled))}afterScheduled=()=>{this.running=!1,this.runTasks()};runTasks(){let e=this.tasks;this.tasks=[];for(let t=0,r=e.length;t<r;t++)e[t]()}shouldYield(e){return e.currentOpCount>=e.getRef(ty)}flush(){for(;this.tasks.length>0;)this.runTasks()}}let tm=(0,o.dual)(2,(e,t)=>e8(r=>{let i=r.context;return r.context=t(i),tF(e,()=>(r.context=i,e3))})),tg=(0,o.dual)(2,(e,t)=>tm(e,eg.merge(t)));(e,t,r)=>tm(e,eg.add(t,r));class ty extends eg.Reference()("effect/Micro/currentMaxOpsBeforeYield",{defaultValue:()=>2048}){}class tS extends eg.Reference()("effect/Micro/currentConcurrency",{defaultValue:()=>"unbounded"}){}class tb extends eg.Reference()("effect/Micro/currentScheduler",{defaultValue:()=>new th}){}e=>eI(e[1]),(e,t)=>Array.from({length:t},()=>e);let tv=(0,o.dual)(2,(e,t)=>{let r=Object.create(tE);return r[eB]=e,r[ej]=t,r}),tE=eZ({op:"OnFailure",eval(e){return e._stack.push(this),this[eB]}}),tw=(0,o.dual)(3,(e,t,r)=>tv(e,e=>t(e)?r(e):e0(e))),tk=((e,t)=>tw(e,eM,e=>t(e.error)),(0,o.dual)(2,(e,t)=>{let r=Object.create(tI);return r[eB]=e,r[e$]=t.onSuccess,r[ej]=t.onFailure,r})),tI=eZ({op:"OnSuccessAndFailure",eval(e){return e._stack.push(this),this[eB]}}),tT=(0,o.dual)(2,(e,t)=>tk(e,{onFailure:e=>e1(()=>t.onFailure(e)),onSuccess:e=>e1(()=>t.onSuccess(e))})),tx=((e,t)=>tk(e,{onFailure:e=>"Fail"===e._tag?t.onFailure(e.error):e0(e),onSuccess:t.onSuccess}),e=>e9(t=>{let r=setTimeout(()=>{t(e3)},e);return e1(()=>{clearTimeout(r)})})),tC=((e,t)=>tr(e,te(tO(tx(t.duration)),t.onTimeout)),Symbol.for("effect/Micro/MicroScope"));class tR{[tC];state={_tag:"Open",finalizers:new Set};constructor(){this[tC]=tC}unsafeAddFinalizer(e){"Open"===this.state._tag&&this.state.finalizers.add(e)}addFinalizer(e){return e2(()=>"Open"===this.state._tag?(this.state.finalizers.add(e),e3):e(this.state.exit))}unsafeRemoveFinalizer(e){"Open"===this.state._tag&&this.state.finalizers.delete(e)}close(e){return e2(()=>{if("Open"===this.state._tag){let t=Array.from(this.state.finalizers).reverse();return this.state={_tag:"Closed",exit:e},ti(tN(t,t=>tt(t(e))),tp)}return e3})}get fork(){return e1(()=>{let e=new tR;if("Closed"===this.state._tag)return e.state=this.state,e;function t(t){return e.close(t)}return this.state.finalizers.add(t),e.unsafeAddFinalizer(e=>e1(()=>this.unsafeRemoveFinalizer(t))),e})}}let tF=(0,o.dual)(2,(e,t)=>t_(r=>tk(r(e),{onFailure:e=>ti(t(tl(e)),()=>e0(e)),onSuccess:e=>ti(t(to(e)),()=>eX(e))}))),tA=((e,t,r)=>tF(e,e=>t(e)?r(e):td),eQ({op:"SetInterruptible",ensure(e){if(e.interruptible=this[eB],e._interrupted&&e.interruptible)return()=>tu}})),tO=e=>e8(t=>t.interruptible?e:(t.interruptible=!0,t._stack.push(tA(!1)),t._interrupted)?tu:e),t_=e=>e8(t=>t.interruptible?(t.interruptible=!1,t._stack.push(tA(!0)),e(tO)):e(o.identity)),tM=(e,t)=>Array.isArray(e)||(0,H.isIterable)(e)?tN(e,o.identity,t):t?.discard?tN(Object.values(e),o.identity,t):e2(()=>{let r={};return e7(tN(Object.entries(e),e=>{let[t,i]=e;return ta(i,e=>{r[t]=e})},{discard:!0,concurrency:t?.concurrency}),r)}),tD=eQ({op:"While",contA(e,t){return(this[eB].step(e),this[eB].while())?(t._stack.push(this),this[eB].body()):td},eval(e){return this[eB].while()?(e._stack.push(this),this[eB].body()):td}}),tN=(e,t,r)=>e8(i=>{let n=r?.concurrency==="inherit"?i.getRef(tS):r?.concurrency??1,a="unbounded"===n?1/0:Math.max(1,n),s=m.fromIterable(e),o=s.length;if(0===o)return r?.discard?e3:eX([]);let l=r?.discard?void 0:Array(o),u=0;return 1===a?e7(tD({while:()=>u<s.length,body:()=>t(s[u],u),step:l?e=>l[u++]=e:e=>u++}),l):e9(e=>{let r,n=new Set,c=0,d=0,p=!1,f=!1;return!function h(){for(p=!0;c<a&&u<o;){let m=u,g=s[m];u++,c++;try{let s=tP(i,t(g,m),!0,!0);n.add(s),s.addObserver(t=>{n.delete(s),f||("Failure"===t._tag?void 0===r&&(r=t,o=u,n.forEach(e=>e.unsafeInterrupt())):void 0!==l&&(l[m]=t.value),d++,c--,d===o?e(r??eX(l)):!p&&c<a&&h())})}catch(e){r=tc(e),o=u,n.forEach(e=>e.unsafeInterrupt())}}p=!1}(),e2(()=>(f=!0,u=o,ez(n)))})}),tP=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=new eL(e.context,e.interruptible);return i||(e.children().add(n),n.addObserver(()=>e.children().delete(n))),r?n.evaluate(t):e.getRef(tb).scheduleTask(()=>n.evaluate(t),0),n},tL=function(){class e extends globalThis.Error{}return Object.assign(e.prototype,eK,t.StructuralPrototype,{[eW]:"Failure",[eq](){return e0(eF(this))},toString(){return this.message?`${this.name}: ${this.message}`:this.name},toJSON(){return{...this}},[eS.NodeInspectSymbol](){let e=this.stack;return e?`${this.toString()}
${e.split("\n").slice(1).join("\n")}`:this.toString()}}),e}(),tU=class extends tL{constructor(e){super(),e&&Object.assign(this,e)}},tz=e=>{class t extends tU{_tag=e}return t.prototype.name=e,t};e.s(["provideContext",0,tg,"runFork",0,(e,t)=>{let r=new eL(tb.context(t?.scheduler??new th));if(r.evaluate(e),t?.signal)if(t.signal.aborted)r.unsafeInterrupt();else{let e=()=>r.unsafeInterrupt();t.signal.addEventListener("abort",e,{once:!0}),r.addObserver(()=>t.signal.removeEventListener("abort",e))}return r}],9246450);var tW=e.i(432214);let tB=Symbol.for("effect/Readable");e.s(["TypeId",0,tB],5369340);let tq=Symbol.for("effect/Ref"),t$={_A:e=>e};class tj extends s{ref;commit(){return this.get}[tq]=t$;[tB]=tB;constructor(e){super(),this.ref=e,this.get=v.sync(()=>tW.get(this.ref))}get;modify(e){return v.sync(()=>{let t=tW.get(this.ref),[r,i]=e(t);return t!==i&&tW.set(i)(this.ref),r})}}let tV=e=>new tj(tW.make(e)),tH=e=>v.sync(()=>tV(e)),tG=e=>e.get,tK=(0,o.dual)(2,(e,t)=>e.modify(()=>[void 0,t])),tJ=(0,o.dual)(2,(e,t)=>e.modify(e=>[e,t])),tZ=(0,o.dual)(2,(e,t)=>e.modify(e=>[e,t(e)])),tQ=(0,o.dual)(2,(e,t)=>e.modify(e=>{let r=t(e);switch(r._tag){case"None":return[e,e];case"Some":return[e,r.value]}})),tY=(0,o.dual)(2,(e,t)=>e.modify(()=>[t,t])),tX=(0,o.dual)(2,(e,t)=>e.modify(t)),t0=(0,o.dual)(3,(e,t,r)=>e.modify(e=>{let i=r(e);switch(i._tag){case"None":return[t,e];case"Some":return i.value}})),t1=(0,o.dual)(2,(e,t)=>e.modify(e=>[void 0,t(e)])),t2=(0,o.dual)(2,(e,t)=>e.modify(e=>{let r=t(e);return[r,r]})),t5=(0,o.dual)(2,(e,t)=>e.modify(e=>[void 0,S.match(t(e),{onNone:()=>e,onSome:e=>e})])),t3=(0,o.dual)(2,(e,t)=>e.modify(e=>{let r=t(e);switch(r._tag){case"None":return[e,e];case"Some":return[r.value,r.value]}}));e.s(["RefTypeId",0,tq,"get",0,tG,"getAndSet",0,tJ,"getAndUpdate",0,tZ,"getAndUpdateSome",0,tQ,"make",0,tH,"modify",0,tX,"modifySome",0,t0,"refVariance",0,t$,"set",0,tK,"setAndGet",0,tY,"unsafeMake",0,tV,"update",0,t1,"updateAndGet",0,t2,"updateSome",0,t5,"updateSomeAndGet",0,t3],3196727),e.s(["RefTypeId",0,tq,"get",0,tG,"getAndSet",0,tJ,"getAndUpdate",0,tZ,"getAndUpdateSome",0,tQ,"make",0,tH,"modify",0,tX,"modifySome",0,t0,"set",0,tK,"setAndGet",0,tY,"unsafeMake",0,tV,"update",0,t1,"updateAndGet",0,t2,"updateSome",0,t5,"updateSomeAndGet",0,t3],6532885);class t8{buckets=[];scheduleTask(e,t){let r,i=this.buckets.length,n=0;for(;n<i;n++)if(this.buckets[n][0]<=t)r=this.buckets[n];else break;r&&r[0]===t?r[1].push(e):n===i?this.buckets.push([t,[e]]):this.buckets.splice(n,0,[t,[e]])}}class t4{maxNextTickBeforeTimer;running=!1;tasks=new t8;constructor(e){this.maxNextTickBeforeTimer=e}starveInternal(e){let t=this.tasks.buckets;for(let[e,r]of(this.tasks.buckets=[],t))for(let e=0;e<r.length;e++)r[e]();0===this.tasks.buckets.length?this.running=!1:this.starve(e)}starve(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;e>=this.maxNextTickBeforeTimer?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(e+1))}shouldYield(e){return e.currentOpCount>e.getFiberRef(v.currentMaxOpsBeforeYield)&&e.getFiberRef(v.currentSchedulingPriority)}scheduleTask(e,t){this.tasks.scheduleTask(e,t),this.running||(this.running=!0,this.starve())}}let t6=(0,ey.globalValue)(Symbol.for("effect/Scheduler/defaultScheduler"),()=>new t4(2048));class t9{tasks=new t8;deferred=!1;scheduleTask(e,t){this.deferred?t6.scheduleTask(e,t):this.tasks.scheduleTask(e,t)}shouldYield(e){return e.currentOpCount>e.getFiberRef(v.currentMaxOpsBeforeYield)&&e.getFiberRef(v.currentSchedulingPriority)}flush(){for(;this.tasks.buckets.length>0;){let e=this.tasks.buckets;for(let[t,r]of(this.tasks.buckets=[],e))for(let e=0;e<r.length;e++)r[e]()}this.deferred=!0}}let t7=(0,ey.globalValue)(Symbol.for("effect/FiberRef/currentScheduler"),()=>v.fiberRefUnsafeMake(t6)),re=(0,o.dual)(2,(e,t)=>v.fiberRefLocally(e,t7,t));e.s(["SyncScheduler",0,t9,"currentScheduler",0,t7,"withScheduler",0,re],2916763);let rt=(0,ey.globalValue)(Symbol.for("effect/FiberRef/currentRequestMap"),()=>(0,v.fiberRefUnsafeMake)(new Map));e.s(["currentRequestMap",0,rt],8755077),e.s(["match",0,(e,t,r,i)=>{switch(e){case void 0:return t();case"unbounded":return r();case"inherit":return v.fiberRefGetWith(v.currentConcurrency,e=>"unbounded"===e?r():e>1?i(e):t());default:return e>1?i(e):t()}},"matchSimple",0,(e,t,r)=>{switch(e){case void 0:return t();case"unbounded":return r();case"inherit":return v.fiberRefGetWith(v.currentConcurrency,e=>"unbounded"===e||e>1?r():t());default:return e>1?r():t()}}],6211456);var rr=e.i(7862555),ri=e.i(7948698),rn=e.i(7294722);ri.ClockTypeId,ri.make;let ra=rn.sleep,rs=rn.currentTimeMillis,ro=rn.currentTimeNanos,rl=rn.clockWith,ru=ri.clockTag;e.s(["Clock",0,ru,"clockWith",0,rl,"currentTimeMillis",0,rs,"currentTimeNanos",0,ro,"sleep",0,ra],219787);var rc=e.i(8973103),rd=e.i(5015632),rp=e.i(6774608);let rf=(e,t)=>({label:e,startTime:t}),rh=e=>e.replace(/[\s="]/g,"_");e.s(["formatLabel",0,rh,"make",0,rf,"render",0,e=>t=>{let r=rh(t.label);return`${r}=${e-t.startTime}ms`}],8531418);var rm=e.i(3427637);rm.TracerTypeId;let rg=rm.spanTag;rm.tracerTag,rm.make;let ry=rm.externalSpan,rS=rn.tracerWith;rm.DisablePropagation,e.s(["ParentSpan",0,rg,"externalSpan",0,ry,"tracerWith",0,rS],1253121);var rb=e.i(4043929);let rv="effect/MetricLabel",rE=Symbol.for(rv);class rw{key;value;[rE]=rE;_hash;constructor(e,t){this.key=e,this.value=t,this._hash=V.string(rv+this.key+this.value)}[V.symbol](){return this._hash}[g.symbol](e){return rI(e)&&this.key===e.key&&this.value===e.value}pipe(){return(0,b.pipeArguments)(this,arguments)}}let rk=(e,t)=>new rw(e,t),rI=e=>(0,H.hasProperty)(e,rE);e.s(["make",0,rk],7897461);var rT=e.i(1191948);let rx=(0,o.dual)(e=>v.isEffect(e[0]),function(){let e=arguments;return v.fiberRefLocallyWith(e[0],v.currentLogAnnotations,"string"==typeof e[1]?rd.set(e[1],e[2]):t=>Object.entries(e[1]).reduce((e,t)=>{let[r,i]=t;return rd.set(e,r,i)},t))}),rC=e=>v.map(e,S.some),rR=e=>{let t,r;return"function"==typeof e?t=e:(t=e.try,r=e.catch),v.suspend(()=>{try{return v.succeed((0,eE.internalCall)(t))}catch(e){return v.fail(r?(0,eE.internalCall)(()=>r(e)):new v.UnknownException(e,"An unknown error occurred in Effect.try"))}})},rF=(0,o.dual)(3,(e,t,r)=>v.catchAll(e,e=>H.hasProperty(e,t)&&e[t]===r.failure?r.onFailure(e):v.fail(e))),rA=(0,o.dual)(2,(e,t)=>v.catchAllCause(e,e=>{let r=rb.find(e,e=>rb.isDieType(e)?S.some(e):S.none());switch(r._tag){case"None":return v.failCause(e);case"Some":return t(r.value.defect)}})),rO=(0,o.dual)(2,(e,t)=>v.matchCauseEffect(e,{onFailure:e=>{let r=t(e);switch(r._tag){case"None":return v.failCause(e);case"Some":return r.value}},onSuccess:v.succeed})),r_=(0,o.dual)(2,(e,t)=>v.catchAllCause(e,e=>{let r=rb.find(e,e=>rb.isDieType(e)?S.some(e):S.none());switch(r._tag){case"None":return v.failCause(e);case"Some":{let i=t(r.value.defect);return"Some"===i._tag?i.value:v.failCause(e)}}})),rM=(0,o.dual)(e=>v.isEffect(e[0]),function(e){let t;for(var r=arguments.length,i=Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];let a=i[i.length-1];return t=2===i.length?H.isTagged(i[0]):e=>{let t=H.hasProperty(e,"_tag")?e._tag:void 0;if(!t)return!1;for(let e=0;e<i.length-1;e++)if(i[e]===t)return!0;return!1},v.catchIf(e,t,a)}),rD=(0,o.dual)(2,(e,t)=>{let r;return v.catchIf(e,e=>(r??=Object.keys(t),H.hasProperty(e,"_tag")&&H.isString(e._tag)&&r.includes(e._tag)),e=>t[e._tag](e))}),rN=rl(v.succeed),rP=(0,o.dual)(2,(e,t)=>v.zipRight(ra(t),e)),rL=e=>v.withFiberRuntime((t,r)=>e({id:t.id(),status:r,interruptors:rb.interruptors(t.getFiberRef(v.currentInterruptedCause))})),rU=rL(e=>y.size(e.interruptors)>0?v.interrupt:v.void),rz=rL(v.succeed),rW=v.succeed({}),rB=ev.bind(v.map,v.flatMap),rq=ev.bindTo(v.map),r$=ev.let_(v.map),rj=(0,o.dual)(2,(e,t)=>v.suspend(()=>{let r,i=e[Symbol.iterator](),n=[],a=v.succeed(!1),s=0;for(;(r=i.next())&&!r.done;){let e=r.value,i=s++;a=v.flatMap(a,r=>r?(n.push(e),v.succeed(!0)):t(e,i))}return v.map(a,()=>n)})),rV=(0,o.dual)(2,(e,t)=>v.suspend(()=>{let r,i=e[Symbol.iterator](),n=[],a=v.succeed(!0),s=0;for(;(r=i.next())&&!r.done;){let e=r.value,i=s++;a=v.flatMap(a,r=>v.map(r?t(e,i):v.succeed(!1),t=>(t||n.push(e),t)))}return v.map(a,()=>n)})),rH=e=>v.orElse(e,()=>v.flatMap(v.yieldNow(),()=>rH(e))),rG=(0,o.dual)(2,(e,t)=>v.map(v.forEachSequential(e,o.identity),m.filterMap(t))),rK=(0,o.dual)(3,(e,t,r)=>rZ(e,t,e=>v.dieSync(()=>r(e)))),rJ=(0,o.dual)(3,(e,t,r)=>rZ(e,t,()=>v.dieMessage(r))),rZ=(0,o.dual)(3,(e,t,r)=>v.flatMap(e,e=>t(e)?v.succeed(e):r(e))),rQ=(0,o.dual)(3,(e,t,r)=>v.suspend(()=>t(e)?v.succeed(e):v.fail(r(e)))),rY=(0,o.dual)(e=>v.isEffect(e[0]),(e,t,r)=>rZ(e,t,e=>void 0===r?v.fail(new v.NoSuchElementException):v.failSync(()=>r(e)))),rX=(0,o.dual)(2,(e,t)=>v.suspend(()=>{let r=e[Symbol.iterator](),i=r.next();return i.done?v.succeed(S.none()):r0(r,0,t,i.value)})),r0=(e,t,r,i)=>v.flatMap(r(i,t),n=>{if(n)return v.succeed(S.some(i));let a=e.next();return a.done?v.succeed(S.none()):r0(e,t+1,r,a.value)}),r1=(0,o.dual)(2,(e,t)=>v.flip(t(v.flip(e)))),r2=(0,o.dual)(2,(e,t)=>v.matchEffect(e,{onFailure:e=>v.succeed(t.onFailure(e)),onSuccess:e=>v.succeed(t.onSuccess(e))})),r5=(0,o.dual)(2,(e,t)=>v.suspend(()=>r3(e[Symbol.iterator](),0,t))),r3=(e,t,r)=>{let i=e.next();return i.done?v.succeed(!0):v.flatMap(r(i.value,t),i=>i?r3(e,t+1,r):v.succeed(i))},r8=v.withFiberRuntime(e=>v.succeed(e.getFiberRefs())),r4=e=>r2(e,{onFailure:o.constVoid,onSuccess:o.constVoid}),r6=(e,t)=>v.suspend(()=>t.while(e)?v.flatMap(t.body(e),e=>r6(e,t)):v.succeed(e)),r9=e=>function(){let t;for(var r=arguments.length,i=Array(r),n=0;n<r;n++)i[n]=arguments[n];let a=S.fromNullable(e);for(let e=0,r=i.length;e<r;e++){let r=i[e];rb.isCause(r)&&(t=void 0!==t?rb.sequential(t,r):r,i=[...i.slice(0,e),...i.slice(e+1)],e--)}return void 0===t&&(t=rb.empty),v.withFiberRuntime(e=>(e.log(i,t,a),v.void))},r7=r9(),ie=r9(ep),it=r9(ed),ir=r9(ec),ii=r9(eu),ia=r9(el),is=r9(eo),io=(0,o.dual)(2,(e,t)=>v.flatMap(rs,r=>v.fiberRefLocallyWith(e,v.currentLogSpan,rp.prepend(rf(t,r))))),il=v.fiberRefGet(v.currentLogAnnotations),iu=(e,t,r,i)=>v.suspend(()=>t(e)?v.flatMap(i(e),n=>v.map(iu(r(e),t,r,i),rp.prepend(n))):v.sync(()=>rp.empty())),ic=(e,t,r,i)=>v.suspend(()=>t(e)?v.flatMap(i(e),()=>ic(r(e),t,r,i)):v.void),id=(0,o.dual)(3,(e,t,r)=>v.suspend(()=>{let i,n=e[Symbol.iterator](),a=[],s=v.succeed(t),o=0;for(;!(i=n.next()).done;){let e=o++,t=i.value;s=v.flatMap(s,i=>v.map(r(i,t,e),e=>{let[t,r]=e;return a.push(r),t}))}return v.map(s,e=>[e,a])})),ip=(0,o.dual)(2,(e,t)=>v.matchCauseEffect(e,{onFailure:e=>v.failCauseSync(()=>t(e)),onSuccess:v.succeed})),ih=e=>v.map(tH(!0),t=>v.asVoid(v.whenEffect(e,tJ(t,!1)))),im=(0,o.dual)(2,(e,t)=>v.orElse(e,()=>v.failSync(t))),ig=(0,o.dual)(2,(e,t)=>v.orElse(e,()=>v.sync(t))),iy=e=>iV((t,r)=>(0,o.pipe)(e,j(t,r))),iS=(0,o.dual)(3,(e,t,r)=>v.contextWithEffect(i=>v.provideContext(e,eg.add(i,t,r)))),ib=(0,o.dual)(3,(e,t,r)=>v.contextWithEffect(i=>v.flatMap(r,r=>v.provideContext(e,(0,o.pipe)(i,eg.add(t,r)))))),iv=rn.randomWith(v.succeed),iE=(0,o.dual)(3,(e,t,r)=>m.fromIterable(e).reduce((e,t,i)=>v.flatMap(e,e=>r(e,t,i)),v.succeed(t))),iw=(0,o.dual)(3,(e,t,r)=>m.fromIterable(e).reduceRight((e,t,i)=>v.flatMap(e,e=>r(t,e,i)),v.succeed(t))),ik=(0,o.dual)(3,(e,t,r)=>v.flatMap(v.sync(()=>e[Symbol.iterator]()),e=>iI(e,0,t,r.while,r.body))),iI=(e,t,r,i,n)=>{let a=e.next();return!a.done&&i(r)?v.flatMap(n(r,a.value,t),r=>iI(e,t+1,r,i,n)):v.succeed(r)},iT=(0,o.dual)(2,(e,t)=>v.suspend(()=>ix(e,t))),ix=(e,t)=>v.flatMap(e,r=>t<=0?v.succeed(r):v.zipRight(v.yieldNow(),ix(e,t-1))),iC=v.succeed(S.none()),iR=(0,o.dual)(3,(e,t,r)=>v.flatMap(t,i=>v.flatMap(e,e=>v.map(t,t=>[r(i,t),e])))),iF=(0,o.dual)(e=>v.isEffect(e[0]),function(){return iA(arguments[0],"string"==typeof arguments[1]?[rk(arguments[1],arguments[2])]:Object.entries(arguments[1]).map(e=>{let[t,r]=e;return rk(t,r)}))}),iA=(0,o.dual)(2,(e,t)=>v.fiberRefLocallyWith(e,v.currentMetricLabels,e=>m.union(e,t))),iO=(0,o.dual)(2,(e,t)=>v.suspend(()=>{let r,i=e[Symbol.iterator](),n=[],a=v.succeed(!1),s=0;for(;(r=i.next())&&!r.done;){let e=r.value,i=s++;a=v.flatMap(a,r=>r?v.succeed(!0):(n.push(e),t(e,i)))}return v.map(a,()=>n)})),i_=(0,o.dual)(2,(e,t)=>v.suspend(()=>{let r,i=e[Symbol.iterator](),n=[],a=v.succeed(!0),s=0;for(;(r=i.next())&&!r.done;){let e=r.value,i=s++;a=v.flatMap(a,r=>(0,o.pipe)(r?t(e,i):v.succeed(!1),v.map(t=>(t&&n.push(e),t))))}return v.map(a,()=>n)})),iM=(0,o.dual)(2,(e,t)=>{let{onFailure:r,onSuccess:i}=t;return v.matchCauseEffect(e,{onFailure:e=>{let t=rb.failureOrCause(e);switch(t._tag){case"Left":return v.zipRight(r(t.left),v.failCause(e));case"Right":return v.failCause(e)}},onSuccess:e=>v.as(i(e),e)})}),iD=(0,o.dual)(2,(e,t)=>v.catchAllCause(e,e=>S.match(rb.keepDefects(e),{onNone:()=>v.failCause(e),onSome:r=>v.zipRight(t(r),v.failCause(e))}))),iN=(0,o.dual)(2,(e,t)=>v.matchCauseEffect(e,{onFailure:e=>{let r=rb.failureOrCause(e);switch(r._tag){case"Left":return v.zipRight(t(r.left),v.failCause(e));case"Right":return v.failCause(e)}},onSuccess:v.succeed})),iP=(0,o.dual)(3,(e,t,r)=>iN(e,e=>H.isTagged(e,t)?r(e):v.void)),iL=(0,o.dual)(2,(e,t)=>v.matchCauseEffect(e,{onFailure:e=>v.zipRight(t(e),v.failCause(e)),onSuccess:v.succeed})),iU=(0,o.dual)(2,(e,t)=>iR(e,t,(e,t)=>rc.nanos(t-e))),iz=rS(v.succeed),iW=e=>{let t,r;"function"==typeof e?t=e:(t=e.try,r=e.catch);let i=e=>r?v.failSync(()=>r(e)):v.fail(new v.UnknownException(e,"An unknown error occurred in Effect.tryPromise"));return t.length>=1?v.async((e,r)=>{try{t(r).then(t=>e(v.succeed(t)),t=>e(i(t)))}catch(t){e(i(t))}}):v.async(e=>{try{t().then(t=>e(v.succeed(t)),t=>e(i(t)))}catch(t){e(i(t))}})},iB=(0,o.dual)(2,(e,t)=>v.flatMap(e,e=>rR({try:()=>t.try(e),catch:t.catch}))),iq=(0,o.dual)(2,(e,t)=>v.flatMap(e,e=>iW({try:t.try.length>=1?r=>t.try(e,r):()=>t.try(e),catch:t.catch}))),i$=(0,o.dual)(2,(e,t)=>v.suspend(()=>t()?iC:rC(e))),ij=(0,o.dual)(2,(e,t)=>v.flatMap(t,t=>t?iC:rC(e))),iV=e=>v.withFiberRuntime(t=>(t.setFiberRefs(e(t.id(),t.getFiberRefs())),v.void)),iH=(0,o.dual)(3,(e,t,r)=>v.mapInputContext(e,e=>eg.add(e,t,r(eg.unsafeGet(e,t))))),iG=(0,o.dual)(2,(e,t)=>v.suspend(()=>t()?v.map(e,S.some):v.succeed(S.none()))),iK=(0,o.dual)(3,(e,t,r)=>v.flatMap(v.fiberRefGet(t),t=>r(t)?v.map(e,e=>[t,S.some(e)]):v.succeed([t,S.none()]))),iJ=(0,o.dual)(3,(e,t,r)=>v.flatMap(tG(t),t=>r(t)?v.map(e,e=>[t,S.some(e)]):v.succeed([t,S.none()]))),iZ=(0,o.dual)(2,(e,t)=>t(e)),iQ=e=>new Proxy({},{get:(t,r,i)=>function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return v.flatMap(e,e=>e[r](...i))}}),iY=e=>new Proxy({},{get:(t,r,i)=>v.flatMap(e,e=>v.isEffect(e[r])?e[r]:v.succeed(e[r]))}),iX=e=>v.flatMap(v.context(),eg.getOption(e)),i0=(0,o.dual)(e=>v.isEffect(e[0]),function(){let e=arguments;return v.fiberRefLocallyWith(e[0],v.currentTracerSpanAnnotations,"string"==typeof e[1]?rd.set(e[1],e[2]):t=>Object.entries(e[1]).reduce((e,t)=>{let[r,i]=t;return rd.set(e,r,i)},t))}),i1=iX(rm.spanTag),i2=v.flatMap(v.context(),e=>{let t=e.unsafeMap.get(rm.spanTag.key);return void 0!==t&&"Span"===t._tag?v.succeed(t):v.fail(new v.NoSuchElementException)}),i5=(0,o.dual)(e=>v.isEffect(e[0]),(e,t,r)=>v.fiberRefLocallyWith(e,v.currentTracerSpanLinks,rr.append({_tag:"SpanLink",span:t,attributes:r??{}}))),i3=BigInt(0),i8=S.flatMap(e=>eg.get(e.context,rm.DisablePropagation)?"Span"===e._tag?i8(e.parent):S.none():S.some(e)),i4=(e,t,r)=>{let i,n=!e.getFiberRef(v.currentTracerEnabled)||r.context&&eg.get(r.context,rm.DisablePropagation),a=e.getFiberRef(v.currentContext),s=r.parent?S.some(r.parent):r.root?S.none():i8(eg.getOption(a,rm.spanTag));if(n)i=v.noopSpan({name:t,parent:s,context:eg.add(r.context??eg.empty(),rm.DisablePropagation,!0)});else{let n=e.getFiberRef(rn.currentServices),a=eg.get(n,rm.tracerTag),o=eg.get(n,ru),l=e.getFiberRef(v.currentTracerTimingEnabled),u=e.getFiberRefs(),c=_(u,v.currentTracerSpanAnnotations),d=_(u,v.currentTracerSpanLinks),p="Some"===d._tag?void 0!==r.links?[...rr.toReadonlyArray(d.value),...r.links??[]]:rr.toReadonlyArray(d.value):r.links??m.empty();i=a.span(t,s,r.context??eg.empty(),p,l?o.unsafeCurrentTimeNanos():i3,r.kind??"internal",r),"Some"===c._tag&&rd.forEach(c.value,(e,t)=>i.attribute(t,e)),void 0!==r.attributes&&Object.entries(r.attributes).forEach(e=>{let[t,r]=e;return i.attribute(t,r)})}return"function"==typeof r.captureStackTrace&&rb.spanToTrace.set(i,r.captureStackTrace),i},i6=v.fiberRefGet(v.currentTracerSpanAnnotations),i9=v.fiberRefGet(v.currentTracerSpanLinks),i7=(e,t,r,i)=>v.sync(()=>{"Ended"!==e.status._tag&&(v.exitIsFailure(t)&&rb.spanToTrace.has(e)&&e.attribute("code.stacktrace",rb.spanToTrace.get(e)()),e.end(i?r.unsafeCurrentTimeNanos():i3,t))}),ne=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];let n=rm.addSpanStackTrace(1===r.length?void 0:r[0]),a=r[r.length-1];return v.withFiberRuntime(t=>{let r=i4(t,e,n),i=t.getFiberRef(v.currentTracerTimingEnabled),s=eg.get(t.getFiberRef(rn.currentServices),ri.clockTag);return v.onExit(a(r),e=>i7(r,e,s,i))})},nt=(0,o.dual)(2,(e,t)=>iS(e,rm.spanTag,t)),nr=function(){let e="string"!=typeof arguments[0],t=e?arguments[1]:arguments[0],r=rm.addSpanStackTrace(e?arguments[2]:arguments[1]);if(e){let e=arguments[0];return ne(t,r,t=>nt(e,t))}return e=>ne(t,r,t=>nt(e,t))};e.s(["Do",0,rW,"_catch",0,rF,"allowInterrupt",0,rU,"annotateCurrentSpan",0,function(){let e=arguments;return r4(v.flatMap(i2,t=>v.sync(()=>{if("string"==typeof e[0])t.attribute(e[0],e[1]);else for(let r in e[0])t.attribute(r,e[0][r])})))},"annotateLogs",0,rx,"annotateSpans",0,i0,"asSome",0,rC,"asSomeError",0,e=>v.mapError(e,S.some),"bind",0,rB,"bindTo",0,rq,"catchAllDefect",0,rA,"catchSomeCause",0,rO,"catchSomeDefect",0,r_,"catchTag",0,rM,"catchTags",0,rD,"cause",0,e=>v.matchCause(e,{onFailure:o.identity,onSuccess:()=>rb.empty}),"clock",0,rN,"clockWith",0,rl,"contextWith",0,e=>v.map(v.context(),e),"currentParentSpan",0,i1,"currentSpan",0,i2,"delay",0,rP,"descriptor",0,rz,"descriptorWith",0,rL,"diffFiberRefs",0,e=>iR(e,r8,q),"dropUntil",0,rj,"dropWhile",0,rV,"endSpan",0,i7,"eventually",0,rH,"every",0,r5,"fiberRefs",0,r8,"filterMap",0,rG,"filterOrDie",0,rK,"filterOrDieMessage",0,rJ,"filterOrElse",0,rZ,"filterOrFail",0,rY,"findFirst",0,rX,"firstSuccessOf",0,e=>v.suspend(()=>{let t=rr.fromIterable(e);return rr.isNonEmpty(t)?(0,o.pipe)(rr.tailNonEmpty(t),m.reduce(rr.headNonEmpty(t),(e,t)=>v.orElse(e,()=>t))):v.dieSync(()=>new v.IllegalArgumentException("Received an empty collection of effects"))}),"flipWith",0,r1,"forever",0,e=>{let t=v.flatMap(v.flatMap(e,()=>v.yieldNow()),()=>t);return t},"fromNullable",0,e=>null==e?v.fail(new v.NoSuchElementException):v.succeed(e),"functionWithSpan",0,e=>function(){let t=e.captureStackTrace??!1;if(!1!==e.captureStackTrace){let e=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=Error();Error.stackTraceLimit=e;let i=!1;t=()=>!1!==i?i:r.stack?i=r.stack.trim().split("\n").slice(2).join("\n").trim():void 0}return v.suspend(()=>{let r="function"==typeof e.options?e.options.apply(null,arguments):e.options;return nr(v.suspend(()=>(0,eE.internalCall)(()=>e.body.apply(this,arguments))),r.name,{...r,captureStackTrace:t})})},"head",0,e=>v.flatMap(e,e=>{let t=e[Symbol.iterator]().next();return t.done?v.fail(new v.NoSuchElementException):v.succeed(t.value)}),"ignore",0,r4,"ignoreLogged",0,e=>v.matchCauseEffect(e,{onFailure:e=>it(e,"An error was silently ignored because it is not anticipated to be useful"),onSuccess:()=>v.void}),"inheritFiberRefs",0,e=>iV((t,r)=>x(r,t,e)),"isFailure",0,e=>r2(e,{onFailure:o.constTrue,onSuccess:o.constFalse}),"isSuccess",0,e=>r2(e,{onFailure:o.constFalse,onSuccess:o.constTrue}),"iterate",0,r6,"labelMetrics",0,iA,"let_",0,r$,"liftPredicate",0,rQ,"linkSpanCurrent",0,function(){let e=arguments,t=Array.isArray(e[0])?e[0]:[{_tag:"SpanLink",span:e[0],attributes:e[1]??{}}];return r4(v.flatMap(i2,e=>v.sync(()=>e.addLinks(t))))},"linkSpans",0,i5,"log",0,r7,"logAnnotations",0,il,"logDebug",0,it,"logError",0,ia,"logFatal",0,is,"logInfo",0,ir,"logTrace",0,ie,"logWarning",0,ii,"logWithLevel",0,r9,"loop",0,(e,t)=>t.discard?ic(e,t.while,t.step,t.body):v.map(iu(e,t.while,t.step,t.body),m.fromIterable),"makeSpan",0,(e,t)=>(t=rm.addSpanStackTrace(t),v.withFiberRuntime(r=>v.succeed(i4(r,e,t)))),"mapAccum",0,id,"mapErrorCause",0,ip,"match",0,r2,"memoize",0,e=>(0,o.pipe)(v.deferredMake(),v.flatMap(t=>(0,o.pipe)(iR(e,v.zip(r8,v.runtimeFlags),(e,t)=>{let[r,i]=e,[n,a]=t;return[q(r,n),rT.diff(i,a)]}),v.intoDeferred(t),ih,v.map(e=>v.zipRight(e,(0,o.pipe)(v.deferredAwait(t),v.flatMap(e=>{let[t,r]=e;return v.as(v.zip(iy(t[0]),v.updateRuntimeFlags(t[1])),r)}))))))),"merge",0,e=>v.matchEffect(e,{onFailure:e=>v.succeed(e),onSuccess:v.succeed}),"negate",0,e=>v.map(e,e=>!e),"none",0,e=>v.flatMap(e,e=>{switch(e._tag){case"None":return v.void;case"Some":return v.fail(new v.NoSuchElementException)}}),"once",0,ih,"option",0,e=>v.matchEffect(e,{onFailure:()=>v.succeed(S.none()),onSuccess:e=>v.succeed(S.some(e))}),"optionFromOptional",0,e=>v.catchAll(v.map(e,S.some),e=>v.isNoSuchElementException(e)?iC:v.fail(e)),"orElseFail",0,im,"orElseSucceed",0,ig,"parallelErrors",0,e=>v.matchCauseEffect(e,{onFailure:e=>{let t=m.fromIterable(rb.failures(e));return 0===t.length?v.failCause(e):v.fail(t)},onSuccess:v.succeed}),"patchFiberRefs",0,iy,"promise",0,e=>e.length>=1?v.async((t,r)=>{try{e(r).then(e=>t(v.succeed(e)),e=>t(v.die(e)))}catch(e){t(v.die(e))}}):v.async(t=>{try{e().then(e=>t(v.succeed(e)),e=>t(v.die(e)))}catch(e){t(v.die(e))}}),"provideService",0,iS,"provideServiceEffect",0,ib,"random",0,iv,"reduce",0,iE,"reduceRight",0,iw,"reduceWhile",0,ik,"repeatN",0,iT,"sandbox",0,e=>v.matchCauseEffect(e,{onFailure:v.fail,onSuccess:v.succeed}),"serviceConstants",0,iY,"serviceFunction",0,(e,t)=>function(){for(var r=arguments.length,i=Array(r),n=0;n<r;n++)i[n]=arguments[n];return v.map(e,e=>t(e)(...i))},"serviceFunctionEffect",0,(e,t)=>function(){for(var r=arguments.length,i=Array(r),n=0;n<r;n++)i[n]=arguments[n];return v.flatMap(e,e=>t(e)(...i))},"serviceFunctions",0,iQ,"serviceMembers",0,e=>({functions:iQ(e),constants:iY(e)}),"serviceOption",0,e=>v.map(v.context(),eg.getOption(e)),"serviceOptional",0,iX,"setFiberRefs",0,e=>v.suspend(()=>A(e)),"sleep",0,ra,"spanAnnotations",0,i6,"spanLinks",0,i9,"succeedNone",0,iC,"succeedSome",0,e=>v.succeed(S.some(e)),"summarized",0,iR,"tagMetrics",0,iF,"takeUntil",0,iO,"takeWhile",0,i_,"tapBoth",0,iM,"tapDefect",0,iD,"tapError",0,iN,"tapErrorCause",0,iL,"tapErrorTag",0,iP,"timed",0,e=>iU(e,ro),"timedWith",0,iU,"tracer",0,iz,"tryMap",0,iB,"tryMapPromise",0,iq,"tryPromise",0,iW,"try_",0,rR,"unless",0,i$,"unlessEffect",0,ij,"unsafeMakeSpan",0,i4,"unsandbox",0,e=>ip(e,rb.flatten),"updateFiberRefs",0,iV,"updateService",0,iH,"useSpan",0,ne,"when",0,iG,"whenFiberRef",0,iK,"whenRef",0,iJ,"withLogSpan",0,io,"withMetric",0,iZ,"withParentSpan",0,nt,"withSpan",0,nr],4039787)},7836076,e=>{"use strict";var t=e.i(7548658);let r=t.exitIsExit,i=t.exitIsFailure,n=t.exitIsSuccess,a=t.exitIsInterrupted,s=t.exitAs,o=t.exitAsVoid,l=t.exitCauseOption,u=t.exitCollectAll,c=t.exitDie,d=t.exitExists,p=t.exitFail,f=t.exitFailCause,h=t.exitFlatMap,m=t.exitFlatMapEffect,g=t.exitFlatten,y=t.exitForEachEffect,S=t.exitFromEither,b=t.exitFromOption,v=t.exitGetOrElse,E=t.exitInterrupt,w=t.exitMap,k=t.exitMapBoth,I=t.exitMapError,T=t.exitMapErrorCause,x=t.exitMatch,C=t.exitMatchEffect,R=t.exitSucceed,F=t.exitVoid,A=t.exitZip,O=t.exitZipLeft,_=t.exitZipRight,M=t.exitZipPar,D=t.exitZipParLeft,N=t.exitZipParRight,P=t.exitZipWith;e.s(["all",0,u,"as",0,s,"asVoid",0,o,"causeOption",0,l,"die",0,c,"exists",0,d,"fail",0,p,"failCause",0,f,"flatMap",0,h,"flatMapEffect",0,m,"flatten",0,g,"forEachEffect",0,y,"fromEither",0,S,"fromOption",0,b,"getOrElse",0,v,"interrupt",0,E,"isExit",0,r,"isFailure",0,i,"isInterrupted",0,a,"isSuccess",0,n,"map",0,w,"mapBoth",0,k,"mapError",0,I,"mapErrorCause",0,T,"match",0,x,"matchEffect",0,C,"succeed",0,R,"void",0,F,"zip",0,A,"zipLeft",0,O,"zipPar",0,M,"zipParLeft",0,D,"zipParRight",0,N,"zipRight",0,_,"zipWith",0,P])},1658800,2311887,1145227,2034623,4309139,1635211,5663534,e=>{"use strict";let t,r,i;var n=e.i(5283034),a=e.i(2725920),s=e.i(7862555),o=e.i(5972454),l=e.i(7525378),u=e.i(1177850),c=e.i(1150852),d=e.i(9674368),p=e.i(8317886),f=e.i(5886356),h=e.i(3683485),m=e.i(9159985),g=e.i(5015632),y=e.i(9390854),S=e.i(2873450),b=e.i(2273461),v=e.i(9246450),E=e.i(432214),w=e.i(8815901),k=e.i(9960543),I=e.i(4935619),T=e.i(6532885),x=e.i(8332882),C=e.i(2916763),R=e.i(4138091),F=e.i(9839518),A=e.i(4043929),O=e.i(7948698),_=e.i(8755077),M=e.i(6211456),D=e.i(1029151),N=e.i(4039787),P=e.i(7548658),L=e.i(7294722),U=e.i(9347119),z=e.i(592224),W=e.i(219787),B=e.i(1331084),q=e.i(7836076),$=e.i(5921732),j=e.i(6712028),V=e.i(5242335);let H="InterruptSignal",G="Stateful",K="Resume",J="YieldNow",Z=e=>({_tag:H,cause:e}),Q=e=>({_tag:G,onFiber:e}),Y=e=>({_tag:K,effect:e}),X=()=>({_tag:J}),ee=Symbol.for("effect/FiberScope");class et{[ee]=ee;fiberId=c.none;roots=new Set;add(e,t){this.roots.add(t),t.addObserver(()=>{this.roots.delete(t)})}}class er{fiberId;parent;[ee]=ee;constructor(e,t){this.fiberId=e,this.parent=t}add(e,t){this.parent.tell(Q(e=>{e.addChild(t),t.addObserver(()=>{e.removeChild(t)})}))}}let ei=e=>new er(e.id(),e),en=(0,m.globalValue)(Symbol.for("effect/FiberScope/Global"),()=>new et);e.s(["globalScope",0,en,"unsafeMake",0,ei],2311887);var ea=e.i(1191948);let es=Symbol.for("effect/Fiber"),eo={_E:e=>e,_A:e=>e},el={[es]:eo,pipe(){return(0,k.pipeArguments)(this,arguments)}},eu=Symbol.for("effect/Fiber"),ec=(0,h.pipe)(j.tuple($.Order,$.Order),j.mapInput(e=>[e.id().startTimeMillis,e.id().id])),ed=e=>eu in e,ep=e=>e.await,ef=e=>({...V.CommitPrototype,commit(){return eb(this)},...el,id:()=>c.none,await:P.succeed(e),children:P.succeed([]),inheritAll:P.void,poll:P.succeed(w.some(e)),interruptAsFork:()=>P.void}),eh=e=>P.map(e.status,t=>({id:e.id(),status:t})),em=e=>ef(q.failCause(e)),eg=e=>e.inheritAll,ey=(0,h.dual)(2,P.fnUntraced(function*(e,t){for(let r of e){if(ed(r)){r.unsafeInterruptAsFork(t);continue}yield*r.interruptAsFork(t)}for(let t of e)ed(t)&&t.unsafePoll()||(yield*t.await)})),eS=(0,h.dual)(2,(e,t)=>e.interruptAsFork(t)),eb=e=>P.zipLeft(P.flatten(e.await),e.inheritAll),ev=(0,h.dual)(2,(e,t)=>eE(e,e=>P.sync(()=>t(e)))),eE=(0,h.dual)(2,(e,t)=>({...V.CommitPrototype,commit(){return eb(this)},...el,id:()=>e.id(),await:P.flatMap(e.await,q.forEachEffect(t)),children:e.children,inheritAll:e.inheritAll,poll:P.flatMap(e.poll,e=>{switch(e._tag){case"None":return P.succeed(w.none());case"Some":return(0,h.pipe)(q.forEachEffect(e.value,t),P.map(w.some))}}),interruptAsFork:t=>e.interruptAsFork(t)})),ew=(0,h.dual)(2,(e,t)=>P.map(e.await,q.match({onFailure:e=>em(e),onSuccess:e=>t(e)}))),ek=(0,h.dual)(2,(e,t)=>{let{onFiber:r,onRuntimeFiber:i}=t;return ed(e)?i(e):r(e)}),eI={...V.CommitPrototype,commit(){return eb(this)},...el,id:()=>c.none,await:P.never,children:P.succeed([]),inheritAll:P.never,poll:P.succeed(w.none()),interruptAsFork:()=>P.never},eT=(0,h.dual)(2,(e,t)=>({...V.CommitPrototype,commit(){return eb(this)},...el,id:()=>c.getOrElse(e.id(),t.id()),await:P.zipWith(e.await,t.await,(e,t)=>q.isSuccess(e)?e:t),children:e.children,inheritAll:P.zipRight(t.inheritAll,e.inheritAll),poll:P.zipWith(e.poll,t.poll,(e,t)=>{switch(e._tag){case"None":return w.none();case"Some":return q.isSuccess(e.value)?e:t}}),interruptAsFork:r=>(0,h.pipe)(P.interruptAsFiber(e,r),P.zipRight((0,h.pipe)(t,P.interruptAsFiber(r))),P.asVoid)})),ex=(0,h.dual)(2,(e,t)=>eT(ev(e,B.left),ev(t,B.right))),eC=()=>Array.from(en.roots),eR=P.sync(eC),eF=e=>ef(q.succeed(e)),eA=eF(void 0),eO="effect/FiberCurrent";e.s(["FiberTypeId",0,es,"Order",0,ec,"RuntimeFiberTypeId",0,eu,"_await",0,ep,"children",0,e=>e.children,"currentFiberURI",0,eO,"done",0,ef,"dump",0,eh,"dumpAll",0,e=>P.forEachSequential(e,eh),"fail",0,e=>ef(q.fail(e)),"failCause",0,em,"fiberVariance",0,eo,"fromEffect",0,e=>P.map(P.exit(e),ef),"getCurrentFiber",0,()=>w.fromNullable(globalThis[eO]),"id",0,e=>e.id(),"inheritAll",0,eg,"interruptAll",0,e=>P.flatMap(P.fiberId,t=>(0,h.pipe)(e,ey(t))),"interruptAllAs",0,ey,"interruptAsFork",0,eS,"interrupted",0,e=>ef(q.interrupt(e)),"isFiber",0,e=>(0,I.hasProperty)(e,es),"isRuntimeFiber",0,ed,"join",0,eb,"map",0,ev,"mapEffect",0,eE,"mapFiber",0,ew,"match",0,ek,"never",0,eI,"orElse",0,eT,"orElseEither",0,ex,"poll",0,e=>e.poll,"pretty",0,e=>P.flatMap(W.currentTimeMillis,t=>P.map(eh(e),e=>{var r;let i,n,{days:a,hours:s,milliseconds:o,minutes:l,seconds:u}={days:(i=(r=t-e.id.startTimeMillis)>0?Math.floor:Math.ceil)(r/864e5),hours:i(r/36e5)%24,minutes:i(r/6e4)%60,seconds:i(r/1e3)%60,milliseconds:i(r)%1e3,microseconds:i(1e3*r)%1e3,nanoseconds:i(1e6*r)%1e3},d=(0===a?"":`${a}d`)+(0===a&&0===s?"":`${s}h`)+(0===a&&0===s&&0===l?"":`${l}m`)+(0===a&&0===s&&0===l&&0===u?"":`${u}s`)+`${o}ms`,p=f.isSuspended(e.status)?(n=c.ids(e.status.blockingOn),y.size(n)>0?"waiting on "+Array.from(n).map(e=>`${e}`).join(", "):""):"",h=(e=>{if(f.isDone(e))return"Done";if(f.isRunning(e))return"Running";let t=ea.interruptible(e.runtimeFlags)?"interruptible":"uninterruptible";return`Suspended(${t})`})(e.status);return`[Fiber](#${e.id.id}) (${d}) ${p}
   Status: ${h}`})),"roots",0,eR,"status",0,e=>e.status,"succeed",0,eF,"unsafeRoots",0,eC,"void",0,eA],1145227);var e_=e.i(283075),eM=e.i(7962980),eD=e.i(6774608),eN=e.i(1088581),eP=e.i(8531418);let eL=Symbol.for("effect/Logger"),eU={_Message:e=>e,_Output:e=>e},ez=e=>({[eL]:eU,log:e,pipe(){return(0,k.pipeArguments)(this,arguments)}}),eW=(0,h.dual)(2,(e,t)=>ez(r=>t(e.log(r))));h.constVoid,(e,t)=>ez(r=>[e.log(r),t.log(r)]);let eB=/^[^\s"=]*$/,eq=(e,t)=>r=>{let{annotations:i,cause:a,date:s,fiberId:o,logLevel:l,message:u,spans:c}=r,d=t=>t.match(eB)?t:e(t),p=(e,t)=>`${eP.formatLabel(e)}=${d(t)}`,f=(e,t)=>" "+p(e,t),h=p("timestamp",s.toISOString());h+=f("level",l.label),h+=f("fiber",eN.threadName(o));let m=n.ensure(u);for(let e=0;e<m.length;e++)h+=f("message",S.toStringUnknown(m[e],t));for(let e of(A.isEmptyType(a)||(h+=f("cause",A.pretty(a,{renderErrorCause:!0}))),c))h+=" "+eP.render(s.getTime())(e);for(let[e,r]of i)h+=f(e,S.toStringUnknown(r,t));return h},e$=ez(eq(e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`)),ej=(JSON.stringify,ez(e=>{let{annotations:t,cause:r,date:i,fiberId:a,logLevel:s,message:o,spans:l}=e,u=i.getTime(),c={},d={};if(g.size(t)>0)for(let[e,r]of t)c[e]=eV(r);if(eD.isCons(l))for(let e of l)d[e.label]=u-e.startTime;let p=n.ensure(o);return{message:1===p.length?eV(p[0]):p.map(eV),logLevel:s.label,timestamp:i.toISOString(),cause:A.isEmpty(r)?void 0:A.pretty(r,{renderErrorCause:!0}),annotations:c,spans:d,fiberId:eN.threadName(a)}})),eV=e=>{switch(typeof e){case"bigint":case"function":case"symbol":return String(e);default:return S.toJSON(e)}},eH=(S.stringifyCircular,function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];let n="";for(let e=0;e<r.length;e++)n+=`\x1b[${r[e]}m`;return n+e+"\x1b[0m"}),eG=function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return e},eK={None:[],All:[],Trace:["90"],Debug:["34"],Info:["32"],Warning:["33"],Error:["31"],Fatal:["101","30"]},eJ={None:"",All:"",Trace:"color:gray",Debug:"color:blue",Info:"color:green",Warning:"color:orange",Error:"color:red",Fatal:"background-color:red;color:white"},eZ=e=>`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}:${e.getSeconds().toString().padStart(2,"0")}.${e.getMilliseconds().toString().padStart(3,"0")}`,eQ="object"==typeof eM.default&&null!==eM.default&&"object"==typeof eM.default.stdout&&null!==eM.default.stdout,eY=eQ&&!0===eM.default.stdout.isTTY,eX=eQ||"Deno"in globalThis;()=>{var e,t,r;let i,a,s,l,u,c;return a="browser"===("auto"===(i=e?.mode??"auto")?eX?"tty":"browser":i),s="boolean"==typeof e?.colors?e.colors:eY||a,l=e?.formatDate??eZ,a?(u=(t={colors:s,formatDate:l}).colors?"%c":"",ez(e=>{let{annotations:r,cause:i,context:a,date:s,fiberId:l,logLevel:c,message:p,spans:f}=e,h=d.getOrDefault(a,L.currentServices),m=o.get(h,U.consoleTag).unsafe,y=n.ensure(p),b=`${u}[${t.formatDate(s)}]`,v=[];if(t.colors&&v.push("color:gray"),b+=` ${u}${c.label}${u} (${eN.threadName(l)})`,t.colors&&v.push(eJ[c._tag],""),eD.isCons(f)){let e=s.getTime(),t=eP.render(e);for(let e of f)b+=" "+t(e)}b+=":";let E=0;if(y.length>0){let e=eV(y[0]);"string"==typeof e&&(b+=` ${u}${e}`,t.colors&&v.push("color:deepskyblue"),E++)}if(m.groupCollapsed(b,...v),A.isEmpty(i)||m.error(A.pretty(i,{renderErrorCause:!0})),E<y.length)for(;E<y.length;E++)m.log(S.redact(y[E]));if(g.size(r)>0)for(let[e,i]of r){let r=S.redact(i);t.colors?m.log(`%c${e}:`,"color:gray",r):m.log(`${e}:`,r)}m.groupEnd()})):(c=(r={colors:s,formatDate:l,stderr:e?.stderr===!0}).colors?eH:eG,ez(e=>{let{annotations:t,cause:i,context:a,date:s,fiberId:l,logLevel:u,message:p,spans:f}=e,h=d.getOrDefault(a,L.currentServices),m=o.get(h,U.consoleTag).unsafe,y=!0===r.stderr?m.error:m.log,b=n.ensure(p),v=c(`[${r.formatDate(s)}]`,"37")+` ${c(u.label,...eK[u._tag])}`+` (${eN.threadName(l)})`;if(eD.isCons(f)){let e=s.getTime(),t=eP.render(e);for(let e of f)v+=" "+t(e)}v+=":";let E=0;if(b.length>0){let e=eV(b[0]);"string"==typeof e&&(v+=" "+c(e,"1","36"),E++)}if(y(v),m.group(),A.isEmpty(i)||y(A.pretty(i,{renderErrorCause:!0})),E<b.length)for(;E<b.length;E++)y(S.redact(b[E]));if(g.size(t)>0)for(let[e,r]of t)y(c(`${e}:`,"1","37"),S.redact(r));m.groupEnd()}))};var e0=e.i(8973103),e1=e.i(3628392),e2=e.i(2090854);let e5="effect/MetricBoundaries",e3=Symbol.for(e5);class e8{values;[e3]=e3;constructor(e){this.values=e,this._hash=(0,h.pipe)(e2.string(e5),e2.combine(e2.array(this.values)))}_hash;[e2.symbol](){return this._hash}[e1.symbol](e){return e4(e)&&e1.equals(this.values,e.values)}pipe(){return(0,k.pipeArguments)(this,arguments)}}let e4=e=>(0,I.hasProperty)(e,e3),e6=Symbol.for("effect/MetricKeyType"),e9="effect/MetricKeyType/Counter",e7=Symbol.for(e9),te="effect/MetricKeyType/Frequency",tt=Symbol.for(te),tr="effect/MetricKeyType/Gauge",ti=Symbol.for(tr),tn="effect/MetricKeyType/Histogram",ta=Symbol.for(tn),ts=Symbol.for("effect/MetricKeyType/Summary"),to={_In:e=>e,_Out:e=>e};class tl{incremental;bigint;[e6]=to;[e7]=e7;constructor(e,t){this.incremental=e,this.bigint=t,this._hash=e2.string(e9)}_hash;[e2.symbol](){return this._hash}[e1.symbol](e){return tc(e)}pipe(){return(0,k.pipeArguments)(this,arguments)}}e2.symbol,e1.symbol,e2.symbol,e1.symbol;class tu{boundaries;[e6]=to;[ta]=ta;constructor(e){this.boundaries=e,this._hash=(0,h.pipe)(e2.string(tn),e2.combine(e2.hash(this.boundaries)))}_hash;[e2.symbol](){return this._hash}[e1.symbol](e){return td(e)&&e1.equals(this.boundaries,e.boundaries)}pipe(){return(0,k.pipeArguments)(this,arguments)}}e2.symbol,e1.symbol;let tc=e=>(0,I.hasProperty)(e,e7),td=e=>(0,I.hasProperty)(e,ta);var tp=e.i(7897461);let tf=Symbol.for("effect/MetricKey"),th={_Type:e=>e},tm=n.getEquivalence(e1.equals);class tg{name;keyType;description;tags;[tf]=th;constructor(e,t,r,i=[]){this.name=e,this.keyType=t,this.description=r,this.tags=i,this._hash=(0,h.pipe)(e2.string(this.name+this.description),e2.combine(e2.hash(this.keyType)),e2.combine(e2.array(this.tags)))}_hash;[e2.symbol](){return this._hash}[e1.symbol](e){return ty(e)&&this.name===e.name&&e1.equals(this.keyType,e.keyType)&&e1.equals(this.description,e.description)&&tm(this.tags,e.tags)}pipe(){return(0,k.pipeArguments)(this,arguments)}}let ty=e=>(0,I.hasProperty)(e,tf),tS=(0,h.dual)(2,(e,t)=>0===t.length?e:new tg(e.name,e.keyType,e.description,n.union(e.tags,t))),tb=Symbol.for("effect/MutableHashMap"),tv={[tb]:tb,[Symbol.iterator](){return new tE(this)},toString(){return(0,S.format)(this.toJSON())},toJSON(){return{_id:"MutableHashMap",values:Array.from(this).map(S.toJSON)}},[S.NodeInspectSymbol](){return this.toJSON()},pipe(){return(0,k.pipeArguments)(this,arguments)}};class tE{self;referentialIterator;bucketIterator;constructor(e){this.self=e,this.referentialIterator=e.referential[Symbol.iterator]()}next(){if(void 0!==this.bucketIterator)return this.bucketIterator.next();let e=this.referentialIterator.next();return e.done?(this.bucketIterator=new tw(this.self.buckets.values()),this.next()):e}[Symbol.iterator](){return new tE(this.self)}}class tw{backing;constructor(e){this.backing=e}currentBucket;next(){if(void 0===this.currentBucket){let e=this.backing.next();if(e.done)return e;this.currentBucket=e.value[Symbol.iterator]()}let e=this.currentBucket.next();return e.done?(this.currentBucket=void 0,this.next()):e}}let tk=()=>{let e=Object.create(tv);return e.referential=new Map,e.buckets=new Map,e.bucketsSize=0,e},tI=(0,h.dual)(2,(e,t)=>{if(!1===e1.isEqual(t))return e.referential.has(t)?w.some(e.referential.get(t)):w.none();let r=t[e2.symbol](),i=e.buckets.get(r);return void 0===i?w.none():tT(e,i,t)}),tT=function(e,t,r){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];for(let n=0,a=t.length;n<a;n++)if(r[e1.symbol](t[n][0])){let r=t[n][1];return i&&(t.splice(n,1),e.bucketsSize--),w.some(r)}return w.none()},tx=(0,h.dual)(2,(e,t)=>w.isSome(tI(e,t))),tC=(0,h.dual)(3,(e,t,r)=>{if(!1===e1.isEqual(t))return e.referential.set(t,r),e;let i=t[e2.symbol](),n=e.buckets.get(i);return void 0===n?e.buckets.set(i,[[t,r]]):(tR(e,n,t),n.push([t,r])),e.bucketsSize++,e}),tR=(e,t,r)=>{for(let i=0,n=t.length;i<n;i++)if(r[e1.symbol](t[i][0])){t.splice(i,1),e.bucketsSize--;return}},tF=(0,h.dual)(2,(e,t)=>{if(!1===e1.isEqual(t))return e.referential.delete(t),e;let r=t[e2.symbol](),i=e.buckets.get(r);return void 0===i||(tR(e,i,t),0===i.length&&e.buckets.delete(r)),e});e.s(["empty",0,tk,"get",0,tI,"has",0,tx,"remove",0,tF,"set",0,tC,"size",0,e=>e.referential.size+e.bucketsSize],2034623);let tA=Symbol.for("effect/MetricState"),tO="effect/MetricState/Counter",t_=Symbol.for(tO),tM="effect/MetricState/Frequency",tD=Symbol.for(tM),tN="effect/MetricState/Gauge",tP=Symbol.for(tN),tL="effect/MetricState/Histogram",tU=Symbol.for(tL),tz="effect/MetricState/Summary",tW=Symbol.for(tz),tB={_A:e=>e};class tq{count;[tA]=tB;[t_]=t_;constructor(e){this.count=e}[e2.symbol](){return(0,h.pipe)(e2.hash(tO),e2.combine(e2.hash(this.count)),e2.cached(this))}[e1.symbol](e){return tK(e)&&this.count===e.count}pipe(){return(0,k.pipeArguments)(this,arguments)}}let t$=n.getEquivalence(e1.equals);class tj{occurrences;[tA]=tB;[tD]=tD;constructor(e){this.occurrences=e}_hash;[e2.symbol](){return(0,h.pipe)(e2.string(tM),e2.combine(e2.array(n.fromIterable(this.occurrences.entries()))),e2.cached(this))}[e1.symbol](e){return tJ(e)&&t$(n.fromIterable(this.occurrences.entries()),n.fromIterable(e.occurrences.entries()))}pipe(){return(0,k.pipeArguments)(this,arguments)}}class tV{value;[tA]=tB;[tP]=tP;constructor(e){this.value=e}[e2.symbol](){return(0,h.pipe)(e2.hash(tN),e2.combine(e2.hash(this.value)),e2.cached(this))}[e1.symbol](e){return tZ(e)&&this.value===e.value}pipe(){return(0,k.pipeArguments)(this,arguments)}}class tH{buckets;count;min;max;sum;[tA]=tB;[tU]=tU;constructor(e,t,r,i,n){this.buckets=e,this.count=t,this.min=r,this.max=i,this.sum=n}[e2.symbol](){return(0,h.pipe)(e2.hash(tL),e2.combine(e2.hash(this.buckets)),e2.combine(e2.hash(this.count)),e2.combine(e2.hash(this.min)),e2.combine(e2.hash(this.max)),e2.combine(e2.hash(this.sum)),e2.cached(this))}[e1.symbol](e){return tQ(e)&&e1.equals(this.buckets,e.buckets)&&this.count===e.count&&this.min===e.min&&this.max===e.max&&this.sum===e.sum}pipe(){return(0,k.pipeArguments)(this,arguments)}}class tG{error;quantiles;count;min;max;sum;[tA]=tB;[tW]=tW;constructor(e,t,r,i,n,a){this.error=e,this.quantiles=t,this.count=r,this.min=i,this.max=n,this.sum=a}[e2.symbol](){return(0,h.pipe)(e2.hash(tz),e2.combine(e2.hash(this.error)),e2.combine(e2.hash(this.quantiles)),e2.combine(e2.hash(this.count)),e2.combine(e2.hash(this.min)),e2.combine(e2.hash(this.max)),e2.combine(e2.hash(this.sum)),e2.cached(this))}[e1.symbol](e){return tY(e)&&this.error===e.error&&e1.equals(this.quantiles,e.quantiles)&&this.count===e.count&&this.min===e.min&&this.max===e.max&&this.sum===e.sum}pipe(){return(0,k.pipeArguments)(this,arguments)}}let tK=e=>(0,I.hasProperty)(e,t_),tJ=e=>(0,I.hasProperty)(e,tD),tZ=e=>(0,I.hasProperty)(e,tP),tQ=e=>(0,I.hasProperty)(e,tU),tY=e=>(0,I.hasProperty)(e,tW),tX=Symbol.for("effect/MetricHook"),t0={_In:e=>e,_Out:e=>e},t1=e=>({[tX]:t0,pipe(){return(0,k.pipeArguments)(this,arguments)},...e}),t2=BigInt(0),t5=(e,t,r,i,a,s)=>{let o=e,l=t,u=r,c=i,d=a,p=s,f=e,h=t,m=r,g=i,y=a,S=s;for(;;){if(!n.isNonEmptyReadonlyArray(p))return{quantile:d,value:w.none(),consumed:c,rest:[]};if(1===d)return{quantile:d,value:w.some(n.lastNonEmpty(p)),consumed:c+p.length,rest:[]};let e=n.headNonEmpty(p),t=n.span(p,t=>t===e),r=d*l,i=o/2*r,a=c+t[0].length,s=Math.abs(a-r);if(a<r-i){f=o,h=l,m=n.head(p),g=a,y=d,S=t[1],o=f,l=h,u=m,c=g,d=y,p=S;continue}if(a>r+i)return{quantile:d,value:w.isNone(u)?w.some(e):u,consumed:c,rest:p};switch(u._tag){case"None":f=o,h=l,m=n.head(p),g=a,y=d,S=t[1],o=f,l=h,u=m,c=g,d=y,p=S;continue;case"Some":if(s<Math.abs(r-u.value)){f=o,h=l,m=n.head(p),g=a,y=d,S=t[1],o=f,l=h,u=m,c=g,d=y,p=S;continue}return{quantile:d,value:w.some(u.value),consumed:c,rest:p}}}throw Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/effect/issues")},t3=Symbol.for("effect/MetricPair"),t8={_Type:e=>e},t4=(e,t)=>({[t3]:t8,metricKey:e,metricState:t,pipe(){return(0,k.pipeArguments)(this,arguments)}}),t6=Symbol.for("effect/MetricRegistry");class t9{[t6]=t6;map=tk();snapshot(){let e=[];for(let[t,r]of this.map)e.push(t4(t,r.get()));return e}get(e){let t,r,i,n=(0,h.pipe)(this.map,tI(e),w.getOrUndefined);if(null!=n)return n;if(tc(e.keyType))return this.getCounter(e);if(t=e.keyType,(0,I.hasProperty)(t,ti))return this.getGauge(e);if(r=e.keyType,(0,I.hasProperty)(r,tt))return this.getFrequency(e);if(td(e.keyType))return this.getHistogram(e);if(i=e.keyType,(0,I.hasProperty)(i,ts))return this.getSummary(e);throw Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/effect/issues")}getCounter(e){let t=(0,h.pipe)(this.map,tI(e),w.getOrUndefined);if(null==t){let r,i,n,a=(r=e.keyType.bigint?t2:0,i=e.keyType.incremental?e.keyType.bigint?e=>e>=t2:e=>e>=0:e=>!0,t1({get:()=>new tq(r),update:n=e=>{i(e)&&(r+=e)},modify:n}));(0,h.pipe)(this.map,tx(e))||(0,h.pipe)(this.map,tC(e,a)),t=a}return t}getFrequency(e){let t=(0,h.pipe)(this.map,tI(e),w.getOrUndefined);if(null==t){let r=(e=>{let t=new Map;for(let r of e.keyType.preregisteredWords)t.set(r,0);let r=e=>{let r=t.get(e)??0;t.set(e,r+1)};return t1({get:()=>new tj(t),update:r,modify:r})})(e);(0,h.pipe)(this.map,tx(e))||(0,h.pipe)(this.map,tC(e,r)),t=r}return t}getGauge(e){let t=(0,h.pipe)(this.map,tI(e),w.getOrUndefined);if(null==t){let r,i=(r=e.keyType.bigint?BigInt(0):0,t1({get:()=>new tV(r),update:e=>{r=e},modify:e=>{r+=e}}));(0,h.pipe)(this.map,tx(e))||(0,h.pipe)(this.map,tC(e,i)),t=i}return t}getHistogram(e){let t=(0,h.pipe)(this.map,tI(e),w.getOrUndefined);if(null==t){let r,i,a,s,o,l,u,c,d,p=(a=new Uint32Array((i=(r=e.keyType.boundaries.values).length)+1),s=new Float64Array(i),o=0,l=0,u=Number.MAX_VALUE,c=5e-324,(0,h.pipe)(r,n.sort($.Order),n.map((e,t)=>{s[t]=e})),t1({get:()=>{let e;return new tH((e={buckets:(()=>{let e=n.allocate(i),t=0;for(let r=0;r<i;r++){let i=s[r];t+=a[r],e[r]=[i,t]}return e})(),count:o,min:u,max:c,sum:l}).buckets,e.count,e.min,e.max,e.sum)},update:d=e=>{let t=0,r=i;for(;t!==r;){let i=Math.floor(t+(r-t)/2);e<=s[i]?r=i:t=i,r===t+1&&(e<=s[t]?r=t:t=r)}a[t]=a[t]+1,o+=1,l+=e,e<u&&(u=e),e>c&&(c=e)},modify:d}));(0,h.pipe)(this.map,tx(e))||(0,h.pipe)(this.map,tC(e,p)),t=p}return t}getSummary(e){let t=(0,h.pipe)(this.map,tI(e),w.getOrUndefined);if(null==t){let r=(e=>{let{error:t,maxAge:r,maxSize:i,quantiles:a}=e.keyType,s=(0,h.pipe)(a,n.sort($.Order)),o=n.allocate(i),l=0,u=0,c=0,d=0,p=0,f=(e,t)=>{i>0&&(o[(l+=1)%i]=[t,e]),d=0===u?e:Math.min(d,e),p=0===u?e:Math.max(p,e),u+=1,c+=e};return t1({get:()=>{let e;return e={error:t,quantiles:(e=>{let a=[],l=0;for(;l!==i-1;){let t=o[l];if(null!=t){let[i,n]=t,s=e0.millis(e-i);e0.greaterThanOrEqualTo(s,e0.zero)&&e0.lessThanOrEqualTo(s,r)&&a.push(n)}l+=1}return((e,t,r)=>{let i=r.length;if(!n.isNonEmptyReadonlyArray(t))return n.empty();let a=t[0],s=t.slice(1),o=t5(e,i,w.none(),0,a,r),l=n.of(o);return s.forEach(t=>{l.push(t5(e,i,o.value,o.consumed,t,o.rest))}),n.map(l,e=>[e.quantile,e.value])})(t,s,n.sort(a,$.Order))})(Date.now()),count:u,min:d,max:p,sum:c},new tG(e.error,e.quantiles,e.count,e.min,e.max,e.sum)},update:e=>{let[t,r]=e;return f(t,r)},modify:e=>{let[t,r]=e;return f(t,r)}})})(e);(0,h.pipe)(this.map,tx(e))||(0,h.pipe)(this.map,tC(e,r)),t=r}return t}}let t7=Symbol.for("effect/Metric"),re={_Type:e=>e,_In:e=>e,_Out:e=>e},rt=(0,m.globalValue)(Symbol.for("effect/Metric/globalMetricRegistry"),()=>new t9),rr=function(e,t,r,i){let n=Object.assign(e=>P.tap(e,e=>ro(n,e)),{[t7]:re,keyType:e,unsafeUpdate:t,unsafeValue:r,unsafeModify:i,register(){return this.unsafeValue([]),this},pipe(){return(0,k.pipeArguments)(this,arguments)}});return n},ri=((e,t)=>rr(e.keyType,(r,i)=>e.unsafeUpdate(t(r),i),e.unsafeValue,(r,i)=>e.unsafeModify(t(r),i)),(e,t)=>rn(new tg(e,new tl(t?.incremental??!1,t?.bigint??!1),w.fromNullable(t?.description)))),rn=e=>{let t,r=new WeakMap,i=i=>{if(0===i.length)return void 0!==t?t:t=rt.get(e);let n=r.get(i);return void 0!==n||(n=rt.get(tS(e,i)),r.set(i,n)),n};return rr(e.keyType,(e,t)=>i(t).update(e),e=>i(e).get(),(e,t)=>i(t).modify(e))},ra=((e,t)=>rr(e.keyType,e.unsafeUpdate,r=>t(e.unsafeValue(r)),e.unsafeModify),(0,h.dual)(3,(e,t,r)=>rs(e,[tp.make(t,r)]))),rs=(0,h.dual)(2,(e,t)=>rr(e.keyType,(r,i)=>e.unsafeUpdate(r,n.union(t,i)),r=>e.unsafeValue(n.union(t,r)),(r,i)=>e.unsafeModify(r,n.union(t,i)))),ro=((e,t,r)=>{let i=e=>ro(t,r(e));return N.tapDefect(e,e=>P.forEachSequentialDiscard(A.defects(e),i))},(0,h.dual)(2,(e,t)=>P.fiberRefGetWith(P.currentMetricLabels,r=>P.sync(()=>e.unsafeUpdate(t,r)))));var rl=e.i(6187448),ru=e.i(5525866);let rc=Symbol.for("effect/Request"),rd={...V.StructuralPrototype,[rc]:{_E:e=>e,_A:e=>e}},rp=function(){function e(e){e&&Object.assign(this,e)}return e.prototype=rd,e}(),rf=(0,h.dual)(2,(e,t)=>P.fiberRefGetWith(_.currentRequestMap,r=>P.sync(()=>{if(r.has(e)){let i=r.get(e);i.state.completed||(i.state.completed=!0,P.deferredUnsafeDone(i.result,t))}}))),rh=(0,h.dual)(2,(e,t)=>P.matchEffect(t,{onFailure:t=>rf(e,P.exitFail(t)),onSuccess:t=>rf(e,P.exitSucceed(t))})),rm=(0,h.dual)(2,(e,t)=>rf(e,P.exitFail(t))),rg=(0,h.dual)(2,(e,t)=>rf(e,P.exitFailCause(t))),ry=(0,h.dual)(2,(e,t)=>rf(e,P.exitSucceed(t)));class rS{count=0;observers=new Set;interrupted=!1;addObserver(e){this.observers.add(e)}removeObserver(e){this.observers.delete(e)}increment(){this.count++,this.observers.forEach(e=>e(this.count))}decrement(){this.count--,this.observers.forEach(e=>e(this.count))}}e.s(["Class",0,rp,"Listeners",0,rS,"RequestTypeId",0,rc,"TaggedClass",0,e=>class extends rp{_tag=e},"complete",0,rf,"completeEffect",0,rh,"fail",0,rm,"failCause",0,rg,"isRequest",0,e=>(0,I.hasProperty)(e,rc),"of",0,()=>e=>Object.assign(Object.create(rd),e),"succeed",0,ry,"tagged",0,e=>t=>{let r=Object.assign(Object.create(rd),t);return r._tag=e,r}],4309139);class rb{self;stack;direction;count=0;constructor(e,t,r){this.self=e,this.stack=t,this.direction=r}clone(){return new rb(this.self,this.stack.slice(),this.direction)}reversed(){return new rb(this.self,this.stack.slice(),1*(0===this.direction))}next(){let e=this.entry;switch(this.count++,0===this.direction?this.moveNext():this.movePrev(),e._tag){case"None":return{done:!0,value:this.count};case"Some":return{done:!1,value:e.value}}}get key(){return this.stack.length>0?w.some(this.stack[this.stack.length-1].key):w.none()}get value(){return this.stack.length>0?w.some(this.stack[this.stack.length-1].value):w.none()}get entry(){return w.map(n.last(this.stack),e=>[e.key,e.value])}get index(){let e=0,t=this.stack;if(0===t.length){let e=this.self._root;return null!=e?e.count:0}null!=t[t.length-1].left&&(e=t[t.length-1].left.count);for(let r=t.length-2;r>=0;--r)t[r+1]===t[r].right&&(++e,null!=t[r].left&&(e+=t[r].left.count));return e}moveNext(){let e=this.stack;if(0===e.length)return;let t=e[e.length-1];if(null!=t.right)for(t=t.right;null!=t;)e.push(t),t=t.left;else for(e.pop();e.length>0&&e[e.length-1].right===t;)t=e[e.length-1],e.pop()}get hasNext(){let e=this.stack;if(0===e.length)return!1;if(null!=e[e.length-1].right)return!0;for(let t=e.length-1;t>0;--t)if(e[t-1].left===e[t])return!0;return!1}movePrev(){let e=this.stack;if(0===e.length)return;let t=e[e.length-1];if(null!=t&&null!=t.left)for(t=t.left;null!=t;)e.push(t),t=t.right;else for(e.pop();e.length>0&&e[e.length-1].left===t;)t=e[e.length-1],e.pop()}get hasPrev(){let e=this.stack;if(0===e.length)return!1;if(null!=e[e.length-1].left)return!0;for(let t=e.length-1;t>0;--t)if(e[t-1].right===e[t])return!0;return!1}}let rv=e=>{let{color:t,count:r,key:i,left:n,right:a,value:s}=e;return{color:t,key:i,value:s,left:n,right:a,count:r}};function rE(e,t){e.key=t.key,e.value=t.value,e.left=t.left,e.right=t.right,e.color=t.color,e.count=t.count}let rw=(e,t)=>{let{count:r,key:i,left:n,right:a,value:s}=e;return{color:t,key:i,value:s,left:n,right:a,count:r}},rk=e=>{e.count=1+(e.left?.count??0)+(e.right?.count??0)};var rI=e.i(9804639);let rT="effect/RedBlackTree",rx=Symbol.for(rT),rC={[rx]:{_Key:e=>e,_Value:e=>e},[e2.symbol](){let e=e2.hash(rT);for(let t of this)e^=(0,h.pipe)(e2.hash(t[0]),e2.combine(e2.hash(t[1])));return e2.cached(this,e)},[e1.symbol](e){if(rF(e)){if((this._root?.count??0)!==(e._root?.count??0))return!1;let t=Array.from(e);return Array.from(this).every((e,r)=>{let i=t[r];return e1.equals(e[0],i[0])&&e1.equals(e[1],i[1])})}return!1},[Symbol.iterator](){let e=[],t=this._root;for(;null!=t;)e.push(t),t=t.left;return new rb(this,e,0)},toString(){return(0,S.format)(this.toJSON())},toJSON(){return{_id:"RedBlackTree",values:Array.from(this).map(S.toJSON)}},[S.NodeInspectSymbol](){return this.toJSON()},pipe(){return(0,k.pipeArguments)(this,arguments)}},rR=(e,t)=>{let r=Object.create(rC);return r._ord=e,r._root=t,r},rF=e=>(0,I.hasProperty)(e,rx),rA=(0,h.dual)(2,(e,t)=>{let r=rR(t,void 0);for(let[t,i]of e)r=rM(r,t,i);return r}),rO=(0,h.dual)(2,(e,t)=>{let r=e._ord,i=e._root;for(;void 0!==i;){let e=r(t,i.key);if(e1.equals(t,i.key))return w.some(i.value);i=e<=0?i.left:i.right}return w.none()}),r_=(0,h.dual)(2,(e,t)=>w.isSome(rO(e,t))),rM=(0,h.dual)(3,(e,t,r)=>{let i=e._ord,n=e._root,a=[],s=[];for(;null!=n;){let e=i(t,n.key);a.push(n),s.push(e),n=e<=0?n.left:n.right}a.push({color:0,key:t,value:r,left:void 0,right:void 0,count:1});for(let e=a.length-2;e>=0;--e){let t=a[e];s[e]<=0?a[e]={color:t.color,key:t.key,value:t.value,left:a[e+1],right:t.right,count:t.count+1}:a[e]={color:t.color,key:t.key,value:t.value,left:t.left,right:a[e+1],count:t.count+1}}for(let e=a.length-1;e>1;--e){let t=a[e-1],r=a[e];if(1===t.color||1===r.color)break;let i=a[e-2];if(i.left===t)if(t.left===r){let n=i.right;if(n&&0===n.color)t.color=1,i.right=rw(n,1),i.color=0,e-=1;else{if(i.color=0,i.left=t.right,t.color=1,t.right=i,a[e-2]=t,a[e-1]=r,rk(i),rk(t),e>=3){let r=a[e-3];r.left===i?r.left=t:r.right=t}break}}else{let n=i.right;if(n&&0===n.color)t.color=1,i.right=rw(n,1),i.color=0,e-=1;else{if(t.right=r.left,i.color=0,i.left=r.right,r.color=1,r.left=t,r.right=i,a[e-2]=r,a[e-1]=t,rk(i),rk(t),rk(r),e>=3){let t=a[e-3];t.left===i?t.left=r:t.right=r}break}}else if(t.right===r){let n=i.left;if(n&&0===n.color)t.color=1,i.left=rw(n,1),i.color=0,e-=1;else{if(i.color=0,i.right=t.left,t.color=1,t.left=i,a[e-2]=t,a[e-1]=r,rk(i),rk(t),e>=3){let r=a[e-3];r.right===i?r.right=t:r.left=t}break}}else{let n=i.left;if(n&&0===n.color)t.color=1,i.left=rw(n,1),i.color=0,e-=1;else{if(t.left=r.right,i.color=0,i.right=r.left,r.color=1,r.right=t,r.left=i,a[e-2]=r,a[e-1]=t,rk(i),rk(t),rk(r),e>=3){let t=a[e-3];t.right===i?t.right=r:t.left=r}break}}}return a[0].color=1,rR(e._ord,a[0])}),rD=(e,t)=>{let r=e[Symbol.iterator](),i=0;return{[Symbol.iterator]:()=>rD(e,t),next:()=>{i++;let e=r.key;switch(0===t?r.moveNext():r.movePrev(),e._tag){case"None":return{done:!0,value:i};case"Some":return{done:!1,value:e.value}}}}},rN=(0,h.dual)(2,(e,t)=>{let r=e._root;void 0!==r&&rL(r,(e,r)=>(t(e,r),w.none()))}),rP=(0,h.dual)(2,(e,t)=>{if(!r_(e,t))return e;let r=e._ord,i=e._root,n=[];for(;void 0!==i;){let e=r(t,i.key);n.push(i),i=e1.equals(t,i.key)?void 0:e<=0?i.left:i.right}if(0===n.length)return e;let a=Array(n.length),s=n[n.length-1];a[a.length-1]={color:s.color,key:s.key,value:s.value,left:s.left,right:s.right,count:s.count};for(let e=n.length-2;e>=0;--e)(s=n[e]).left===n[e+1]?a[e]={color:s.color,key:s.key,value:s.value,left:a[e+1],right:s.right,count:s.count}:a[e]={color:s.color,key:s.key,value:s.value,left:s.left,right:a[e+1],count:s.count};if(void 0!==(s=a[a.length-1]).left&&void 0!==s.right){let e=a.length;for(s=s.left;null!=s.right;)a.push(s),s=s.right;let t=a[e-1];a.push({color:s.color,key:t.key,value:t.value,left:s.left,right:s.right,count:s.count}),a[e-1].key=s.key,a[e-1].value=s.value;for(let t=a.length-2;t>=e;--t)s=a[t],a[t]={color:s.color,key:s.key,value:s.value,left:s.left,right:a[t+1],count:s.count};a[e-1].left=a[e]}if(0===(s=a[a.length-1]).color){let e=a[a.length-2];e.left===s?e.left=void 0:e.right===s&&(e.right=void 0),a.pop();for(let e=0;e<a.length;++e)a[e].count--}else if(void 0!==s.left||void 0!==s.right){void 0!==s.left?rE(s,s.left):void 0!==s.right&&rE(s,s.right),s.color=1;for(let e=0;e<a.length-1;++e)a[e].count--}else{if(1===a.length)return rR(r,void 0);for(let e=0;e<a.length;++e)a[e].count--;let e=a[a.length-2];rU(a),e.left===s?e.left=void 0:e.right=void 0}return rR(r,a[0])}),rL=(e,t)=>{let r,i=e,n=!1;for(;!n;)if(null!=i)r=rI.make(i,r),i=i.left;else if(null!=r){let e=t(r.value.key,r.value.value);if(w.isSome(e))return e;i=r.value.right,r=r.previous}else n=!0;return w.none()},rU=e=>{let t,r,i,n;for(let a=e.length-1;a>=0;--a){if(t=e[a],0===a){t.color=1;return}if((r=e[a-1]).left===t){if(void 0!==(i=r.right)&&void 0!==i.right&&0===i.right.color){if(n=(i=r.right=rv(i)).right=rv(i.right),r.right=i.left,i.left=r,i.right=n,i.color=r.color,t.color=1,r.color=1,n.color=1,rk(r),rk(i),a>1){let t=e[a-2];t.left===r?t.left=i:t.right=i}e[a-1]=i;return}if(void 0!==i&&void 0!==i.left&&0===i.left.color){if(n=(i=r.right=rv(i)).left=rv(i.left),r.right=n.left,i.left=n.right,n.left=r,n.right=i,n.color=r.color,r.color=1,i.color=1,t.color=1,rk(r),rk(i),rk(n),a>1){let t=e[a-2];t.left===r?t.left=n:t.right=n}e[a-1]=n;return}if(void 0!==i&&1===i.color)if(0===r.color){r.color=1,r.right=rw(i,0);return}else{r.right=rw(i,0);continue}if(void 0!==i){if(r.right=(i=rv(i)).left,i.left=r,i.color=r.color,r.color=0,rk(r),rk(i),a>1){let t=e[a-2];t.left===r?t.left=i:t.right=i}e[a-1]=i,e[a]=r,a+1<e.length?e[a+1]=t:e.push(t),a+=2}}else{if(void 0!==(i=r.left)&&void 0!==i.left&&0===i.left.color){if(n=(i=r.left=rv(i)).left=rv(i.left),r.left=i.right,i.right=r,i.left=n,i.color=r.color,t.color=1,r.color=1,n.color=1,rk(r),rk(i),a>1){let t=e[a-2];t.right===r?t.right=i:t.left=i}e[a-1]=i;return}if(void 0!==i&&void 0!==i.right&&0===i.right.color){if(n=(i=r.left=rv(i)).right=rv(i.right),r.left=n.right,i.right=n.left,n.right=r,n.left=i,n.color=r.color,r.color=1,i.color=1,t.color=1,rk(r),rk(i),rk(n),a>1){let t=e[a-2];t.right===r?t.right=n:t.left=n}e[a-1]=n;return}if(void 0!==i&&1===i.color)if(0===r.color){r.color=1,r.left=rw(i,0);return}else{r.left=rw(i,0);continue}if(void 0!==i){if(r.left=(i=rv(i)).right,i.right=r,i.color=r.color,r.color=0,rk(r),rk(i),a>1){let t=e[a-2];t.right===r?t.right=i:t.left=i}e[a-1]=i,e[a]=r,a+1<e.length?e[a+1]=t:e.push(t),a+=2}}}},rz=Symbol.for("effect/SortedSet"),rW={[rz]:{_A:e=>e},[e2.symbol](){return(0,h.pipe)(e2.hash(this.keyTree),e2.combine(e2.hash(rz)),e2.cached(this))},[e1.symbol](e){return rq(e)&&e1.equals(this.keyTree,e.keyTree)},[Symbol.iterator](){return rD(this.keyTree,0)},toString(){return(0,S.format)(this.toJSON())},toJSON(){return{_id:"SortedSet",values:Array.from(this).map(S.toJSON)}},[S.NodeInspectSymbol](){return this.toJSON()},pipe(){return(0,k.pipeArguments)(this,arguments)}},rB=e=>{let t=Object.create(rW);return t.keyTree=e,t},rq=e=>(0,I.hasProperty)(e,rz),r$=h.dual(2,(e,t)=>rB(rA(Array.from(e).map(e=>[e,!0]),t))),rj=h.dual(2,(e,t)=>r_(e.keyTree,t)?e:rB(rM(e.keyTree,t,!0))),rV=h.dual(2,(e,t)=>{for(let r of e)if(!t(r))return!1;return!0}),rH=((e,t)=>rN(e.keyTree,t),h.dual(2,(e,t)=>r_(e.keyTree,t))),rG=h.dual(2,(e,t)=>rV(e,e=>rH(t,e))),rK=h.dual(2,(e,t)=>rB(rP(e.keyTree,t)));e.s(["add",0,rj,"fromIterable",0,r$,"getEquivalence",0,()=>(e,t)=>rG(e,t)&&rG(t,e),"isSortedSet",0,rq,"remove",0,rK,"values",0,e=>rD(e.keyTree,0)],1635211);let rJ=Symbol.for("effect/Supervisor"),rZ={_T:e=>e};class rQ{underlying;value0;[rJ]=rZ;constructor(e,t){this.underlying=e,this.value0=t}get value(){return this.value0}onStart(e,t,r,i){this.underlying.onStart(e,t,r,i)}onEnd(e,t){this.underlying.onEnd(e,t)}onEffect(e,t){this.underlying.onEffect(e,t)}onSuspend(e){this.underlying.onSuspend(e)}onResume(e){this.underlying.onResume(e)}map(e){return new rQ(this,(0,h.pipe)(this.value,P.map(e)))}zip(e){return new rY(this,e)}}class rY{left;right;_tag="Zip";[rJ]=rZ;constructor(e,t){this.left=e,this.right=t}get value(){return P.zip(this.left.value,this.right.value)}onStart(e,t,r,i){this.left.onStart(e,t,r,i),this.right.onStart(e,t,r,i)}onEnd(e,t){this.left.onEnd(e,t),this.right.onEnd(e,t)}onEffect(e,t){this.left.onEffect(e,t),this.right.onEffect(e,t)}onSuspend(e){this.left.onSuspend(e),this.right.onSuspend(e)}onResume(e){this.left.onResume(e),this.right.onResume(e)}map(e){return new rQ(this,(0,h.pipe)(this.value,P.map(e)))}zip(e){return new rY(this,e)}}let rX=e=>(0,I.hasProperty)(e,rJ)&&(0,I.isTagged)(e,"Zip");class r0{[rJ]=rZ;fibers=new Set;get value(){return P.sync(()=>Array.from(this.fibers))}onStart(e,t,r,i){this.fibers.add(i)}onEnd(e,t){this.fibers.delete(t)}onEffect(e,t){}onSuspend(e){}onResume(e){}map(e){return new rQ(this,(0,h.pipe)(this.value,P.map(e)))}zip(e){return new rY(this,e)}onRun(e,t){return e()}}class r1{effect;[rJ]=rZ;constructor(e){this.effect=e}get value(){return this.effect}onStart(e,t,r,i){}onEnd(e,t){}onEffect(e,t){}onSuspend(e){}onResume(e){}map(e){return new rQ(this,(0,h.pipe)(this.value,P.map(e)))}zip(e){return new rY(this,e)}onRun(e,t){return e()}}let r2=P.sync(()=>new r0),r5=(0,m.globalValue)("effect/Supervisor/none",()=>new r1(P.void));e.s(["Zip",0,rY,"isZip",0,rX,"none",0,r5,"track",0,r2],5663534);var r3=e.i(211823),r8=e.i(4730360),r4=e.i(731044),r6=e.i(8806827),r9=e.i(8308496),r7=e.i(4063476),ie=e.i(1800779);r3.DifferTypeId,r8.ChunkPatchTypeId,r4.ContextPatchTypeId,r6.HashMapPatchTypeId,r9.HashSetPatchTypeId,r7.OrPatchTypeId,ie.ReadonlyArrayPatchTypeId;let it=r3.make;r3.environment,r3.chunk,r3.hashMap,r3.hashSet,r3.orElseEither,r3.readonlyArray,r3.transform,r3.update,r3.updateWith,r3.zip;let ir="Empty",ii="AddSupervisor",ia="RemoveSupervisor",is="AndThen",io={_tag:ir},il=(e,t)=>({_tag:is,first:e,second:t}),iu=(e,t)=>e1.equals(e,t)?r5:rX(e)?iu(e.left,t).zip(iu(e.right,t)):e,ic=e=>e1.equals(e,r5)?y.empty():rX(e)?(0,h.pipe)(ic(e.left),y.union(ic(e.right))):y.make(e),id=it({empty:io,patch:(e,t)=>((e,t)=>{let r=e,i=t;for(;s.isNonEmpty(i);){let e=s.headNonEmpty(i);switch(e._tag){case ir:i=s.tailNonEmpty(i);break;case ii:r=r.zip(e.supervisor),i=s.tailNonEmpty(i);break;case ia:r=iu(r,e.supervisor),i=s.tailNonEmpty(i);break;case is:i=s.prepend(e.first)(s.prepend(e.second)(s.tailNonEmpty(i)))}}return r})(t,s.of(e)),combine:il,diff:(e,t)=>{if(e1.equals(e,t))return io;let r=ic(e),i=ic(t),n=(0,h.pipe)(i,y.difference(r),y.reduce(io,(e,t)=>il(e,{_tag:ii,supervisor:t}))),a=(0,h.pipe)(r,y.difference(i),y.reduce(io,(e,t)=>il(e,{_tag:ia,supervisor:t})));return il(n,a)}});var ip=e.i(3427637),ih=e.i(2561845);let im=ri("effect_fiber_started",{incremental:!0}),ig=ri("effect_fiber_active"),iy=ri("effect_fiber_successes",{incremental:!0}),iS=ri("effect_fiber_failures",{incremental:!0}),ib=ra((t={start:.5,factor:2,count:35},rn((r=(0,h.pipe)(n.makeBy(t.count-1,e=>t.start*Math.pow(t.factor,e)),s.unsafeFromArray,e=>new e8((0,h.pipe)(e,n.appendAll(s.of(1/0)),n.dedupe))),new tg("effect_fiber_lifetimes",new tu(r),w.fromNullable(i))))),"time_unit","milliseconds"),iv="Continue",iE="Yield",iw={_E:e=>e,_A:e=>e},ik=e=>{throw Error(`BUG: FiberRuntime - ${S.toStringUnknown(e)} - please report an issue at https://github.com/Effect-TS/effect/issues`)},iI=Symbol.for("effect/internal/fiberRuntime/YieldedOp"),iT=(0,m.globalValue)("effect/internal/fiberRuntime/yieldedOpChannel",()=>({currentOp:null})),ix={[rl.OP_ON_SUCCESS]:(e,t,r)=>(0,R.internalCall)(()=>t.effect_instruction_i1(r)),OnStep:(e,t,r)=>P.exitSucceed(P.exitSucceed(r)),[rl.OP_ON_SUCCESS_AND_FAILURE]:(e,t,r)=>(0,R.internalCall)(()=>t.effect_instruction_i2(r)),[rl.OP_REVERT_FLAGS]:(e,t,r)=>(e.patchRuntimeFlags(e.currentRuntimeFlags,t.patch),ea.interruptible(e.currentRuntimeFlags)&&e.isInterrupted())?P.exitFailCause(e.getInterruptedCause()):P.exitSucceed(r),[rl.OP_WHILE]:(e,t,r)=>((0,R.internalCall)(()=>t.effect_instruction_i2(r)),(0,R.internalCall)(()=>t.effect_instruction_i0()))?(e.pushStack(t),(0,R.internalCall)(()=>t.effect_instruction_i1())):P.void,[rl.OP_ITERATOR]:(e,t,r)=>{let i=(0,R.internalCall)(()=>t.effect_instruction_i0.next(r));return i.done?P.exitSucceed(i.value):(e.pushStack(t),(0,R.yieldWrapGet)(i.value))}},iC={[H]:(e,t,r,i)=>(e.processNewInterruptSignal(i.cause),ea.interruptible(t)?P.exitFailCause(i.cause):r),[K]:(e,t,r,i)=>{throw Error("It is illegal to have multiple concurrent run loops in a single fiber")},[G]:(e,t,r,i)=>(i.onFiber(e,f.running(t)),r),[J]:(e,t,r,i)=>P.flatMap(P.yieldNow(),()=>r)},iR=ih.getCurrentVersion();class iF extends l.Class{[es]=eo;[eu]=iw;_fiberRefs;_fiberId;_queue=[];_children=null;_observers=[];_running=!1;_stack=[];_asyncInterruptor=null;_asyncBlockingOn=null;_exitValue=null;_steps=[];_isYielding=!1;currentRuntimeFlags;currentOpCount=0;currentSupervisor;currentScheduler;currentTracer;currentSpan;currentContext;currentDefaultServices;constructor(e,t,r){if(super(),this.currentRuntimeFlags=r,this._fiberId=e,this._fiberRefs=t,ea.runtimeMetrics(r)){const e=this.getFiberRef(P.currentMetricLabels);im.unsafeUpdate(1,e),ig.unsafeUpdate(1,e)}this.refreshRefCache()}commit(){return eb(this)}id(){return this._fiberId}resume(e){this.tell(Y(e))}get status(){return this.ask((e,t)=>t)}get runtimeFlags(){return this.ask((e,t)=>f.isDone(t)?e.currentRuntimeFlags:t.runtimeFlags)}scope(){return ei(this)}get children(){return this.ask(e=>Array.from(e.getChildren()))}getChildren(){return null===this._children&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(P.currentInterruptedCause)}fiberRefs(){return this.ask(e=>e.getFiberRefs())}ask(e){return P.suspend(()=>{let t=P.deferredUnsafeMake(this._fiberId);return this.tell(Q((r,i)=>{P.deferredUnsafeDone(t,P.sync(()=>e(r,i)))})),P.deferredAwait(t)})}tell(e){this._queue.push(e),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}get await(){return P.async(e=>{let t=t=>e(P.succeed(t));return this.tell(Q((e,r)=>{null!==e._exitValue?t(this._exitValue):e.addObserver(t)})),P.sync(()=>this.tell(Q((e,r)=>{e.removeObserver(t)})))},this.id())}get inheritAll(){return P.withFiberRuntime((e,t)=>{let r=e.id(),i=e.getFiberRefs(),n=t.runtimeFlags,a=this.getFiberRefs(),s=e_.joinAs(i,r,a);e.setFiberRefs(s);let o=e.getFiberRef(nw),l=(0,h.pipe)(ea.diff(n,o),x.exclude(ea.Interruption),x.exclude(ea.WindDown));return P.updateRuntimeFlags(l)})}get poll(){return P.sync(()=>w.fromNullable(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(e){return P.sync(()=>this.tell(Z(A.interrupt(e))))}unsafeInterruptAsFork(e){this.tell(Z(A.interrupt(e)))}addObserver(e){null!==this._exitValue?e(this._exitValue):this._observers.push(e)}removeObserver(e){this._observers=this._observers.filter(t=>t!==e)}getFiberRefs(){return this.setFiberRef(nw,this.currentRuntimeFlags),this._fiberRefs}unsafeDeleteFiberRef(e){this._fiberRefs=e_.delete_(this._fiberRefs,e)}getFiberRef(e){return this._fiberRefs.locals.has(e)?this._fiberRefs.locals.get(e)[0][1]:e.initial}setFiberRef(e,t){this._fiberRefs=e_.updateAs(this._fiberRefs,{fiberId:this._fiberId,fiberRef:e,value:t}),this.refreshRefCache()}refreshRefCache(){this.currentDefaultServices=this.getFiberRef(L.currentServices),this.currentTracer=this.currentDefaultServices.unsafeMap.get(ip.tracerTag.key),this.currentSupervisor=this.getFiberRef(nk),this.currentScheduler=this.getFiberRef(C.currentScheduler),this.currentContext=this.getFiberRef(P.currentContext),this.currentSpan=this.currentContext.unsafeMap.get(ip.spanTag.key)}setFiberRefs(e){this._fiberRefs=e,this.refreshRefCache()}addChild(e){this.getChildren().add(e)}removeChild(e){this.getChildren().delete(e)}transferChildren(e){let t=this._children;if(this._children=null,null!==t&&t.size>0)for(let r of t)null===r._exitValue&&e.add(this.currentRuntimeFlags,r)}drainQueueOnCurrentThread(){let e=!0;for(;e;){let t=iv,r=globalThis[eO];globalThis[eO]=this;try{for(;t===iv;)t=0===this._queue.length?"Done":this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[eO]=r}this._queue.length>0&&!this._running?(this._running=!0,t===iE?(this.drainQueueLaterOnExecutor(),e=!1):e=!0):e=!1}}drainQueueLaterOnExecutor(){this.currentScheduler.scheduleTask(this.run,this.getFiberRef(P.currentSchedulingPriority))}drainQueueWhileRunning(e,t){let r=t;for(;this._queue.length>0;){let t=this._queue.splice(0,1)[0];r=iC[t._tag](this,e,r,t)}return r}isInterrupted(){return!A.isEmpty(this.getFiberRef(P.currentInterruptedCause))}addInterruptedCause(e){let t=this.getFiberRef(P.currentInterruptedCause);this.setFiberRef(P.currentInterruptedCause,A.sequential(t,e))}processNewInterruptSignal(e){this.addInterruptedCause(e),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(null===this._children||0===this._children.size)return!1;let e=!1;for(let t of this._children)t.tell(Z(A.interrupt(this.id()))),e=!0;return e}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){let e=this._children.values();this._children=null;let t=!1;return P.whileLoop({while:()=>!t,body:()=>{let r=e.next();return r.done?P.sync(()=>{t=!0}):P.asVoid(r.value.await)},step:()=>{}})}return null}reportExitValue(e){if(ea.runtimeMetrics(this.currentRuntimeFlags)){let t=this.getFiberRef(P.currentMetricLabels),r=this.id().startTimeMillis,i=Date.now();switch(ib.unsafeUpdate(i-r,t),ig.unsafeUpdate(-1,t),e._tag){case rl.OP_SUCCESS:iy.unsafeUpdate(1,t);break;case rl.OP_FAILURE:iS.unsafeUpdate(1,t)}}if("Failure"===e._tag){let t=this.getFiberRef(P.currentUnhandledErrorLogLevel);A.isInterruptedOnly(e.cause)||"Some"!==t._tag||this.log("Fiber terminated with an unhandled error",e.cause,t)}}setExitValue(e){this._exitValue=e,this.reportExitValue(e);for(let t=this._observers.length-1;t>=0;t--)this._observers[t](e);this._observers=[]}getLoggers(){return this.getFiberRef(iM)}log(e,t,r){let i=w.isSome(r)?r.value:this.getFiberRef(P.currentLogLevel),n=this.getFiberRef(iA);if(b.greaterThan(n,i))return;let a=this.getFiberRef(P.currentLogSpan),s=this.getFiberRef(P.currentLogAnnotations),l=this.getLoggers(),u=this.getFiberRefs();if(y.size(l)>0){let r=new Date(o.get(this.getFiberRef(L.currentServices),O.clockTag).unsafeCurrentTimeMillis());S.withRedactableContext(u,()=>{for(let n of l)n.log({fiberId:this.id(),logLevel:i,message:e,cause:t,context:u,spans:a,annotations:s,date:r})})}}evaluateMessageWhileSuspended(e){switch(e._tag){case J:return iE;case H:return this.processNewInterruptSignal(e.cause),null!==this._asyncInterruptor&&(this._asyncInterruptor(P.exitFailCause(e.cause)),this._asyncInterruptor=null),iv;case K:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(e.effect),iv;case G:return e.onFiber(this,null!==this._exitValue?f.done:f.suspended(this.currentRuntimeFlags,this._asyncBlockingOn)),iv;default:return ik(e)}}evaluateEffect(e){this.currentSupervisor.onResume(this);try{let t=ea.interruptible(this.currentRuntimeFlags)&&this.isInterrupted()?P.exitFailCause(this.getInterruptedCause()):e;for(;null!==t;){let e=t,r=this.runLoop(e);if(r===iI){let e=iT.currentOp;iT.currentOp=null,e._op===rl.OP_YIELD?ea.cooperativeYielding(this.currentRuntimeFlags)?(this.tell(X()),this.tell(Y(P.exitVoid)),t=null):t=P.exitVoid:e._op===rl.OP_ASYNC&&(t=null)}else{this.currentRuntimeFlags=(0,h.pipe)(this.currentRuntimeFlags,ea.enable(ea.WindDown));let e=this.interruptAllChildren();null!==e?t=P.flatMap(e,()=>r):(0===this._queue.length?this.setExitValue(r):this.tell(Y(r)),t=null)}}}finally{this.currentSupervisor.onSuspend(this)}}start(e){if(this._running)this.tell(Y(e));else{this._running=!0;let t=globalThis[eO];globalThis[eO]=this;try{this.evaluateEffect(e)}finally{this._running=!1,globalThis[eO]=t,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(e){this.tell(Y(e))}patchRuntimeFlags(e,t){let r=ea.patch(e,t);return globalThis[eO]=this,this.currentRuntimeFlags=r,r}initiateAsync(e,t){let r=!1,i=e=>{r||(r=!0,this.tell(Y(e)))};ea.interruptible(e)&&(this._asyncInterruptor=i);try{t(i)}catch(e){i(P.failCause(A.die(e)))}}pushStack(e){this._stack.push(e),"OnStep"===e._op&&this._steps.push({refs:this.getFiberRefs(),flags:this.currentRuntimeFlags})}popStack(){let e=this._stack.pop();if(e)return"OnStep"===e._op&&this._steps.pop(),e}getNextSuccessCont(){let e=this.popStack();for(;e;){if(e._op!==rl.OP_ON_FAILURE)return e;e=this.popStack()}}getNextFailCont(){let e=this.popStack();for(;e;){if(e._op!==rl.OP_ON_SUCCESS&&e._op!==rl.OP_WHILE&&e._op!==rl.OP_ITERATOR)return e;e=this.popStack()}}[rl.OP_TAG](e){return P.sync(()=>o.unsafeGet(this.currentContext,e))}Left(e){return P.fail(e.left)}None(e){return P.fail(new P.NoSuchElementException)}Right(e){return P.exitSucceed(e.right)}Some(e){return P.exitSucceed(e.value)}Micro(e){return P.unsafeAsync(t=>{let r=t,i=v.runFork(v.provideContext(e,this.currentContext));return i.addObserver(e=>{if("Success"===e._tag)return r(P.exitSucceed(e.value));switch(e.cause._tag){case"Interrupt":return r(P.exitFailCause(A.interrupt(c.none)));case"Fail":return r(P.fail(e.cause.error));case"Die":return r(P.die(e.cause.defect))}}),P.unsafeAsync(e=>{r=t=>{e(P.void)},i.unsafeInterrupt()})})}[rl.OP_SYNC](e){let t=(0,R.internalCall)(()=>e.effect_instruction_i0()),r=this.getNextSuccessCont();return void 0!==r?(r._op in ix||ik(r),ix[r._op](this,r,t)):(iT.currentOp=P.exitSucceed(t),iI)}[rl.OP_SUCCESS](e){let t=this.getNextSuccessCont();return void 0!==t?(t._op in ix||ik(t),ix[t._op](this,t,e.effect_instruction_i0)):(iT.currentOp=e,iI)}[rl.OP_FAILURE](e){let t=e.effect_instruction_i0,r=this.getNextFailCont();if(void 0===r)return iT.currentOp=P.exitFailCause(t),iI;switch(r._op){case rl.OP_ON_FAILURE:case rl.OP_ON_SUCCESS_AND_FAILURE:if(!(ea.interruptible(this.currentRuntimeFlags)&&this.isInterrupted()))return(0,R.internalCall)(()=>r.effect_instruction_i1(t));return P.exitFailCause(A.stripFailures(t));case"OnStep":if(!(ea.interruptible(this.currentRuntimeFlags)&&this.isInterrupted()))return P.exitSucceed(P.exitFailCause(t));return P.exitFailCause(A.stripFailures(t));case rl.OP_REVERT_FLAGS:if(this.patchRuntimeFlags(this.currentRuntimeFlags,r.patch),ea.interruptible(this.currentRuntimeFlags)&&this.isInterrupted())return P.exitFailCause(A.sequential(t,this.getInterruptedCause()));return P.exitFailCause(t);default:ik(r)}}[rl.OP_WITH_RUNTIME](e){return(0,R.internalCall)(()=>e.effect_instruction_i0(this,f.running(this.currentRuntimeFlags)))}Blocked(e){let t=this.getFiberRefs(),r=this.currentRuntimeFlags;if(this._steps.length>0){let i=[],n=this._steps[this._steps.length-1],a=this.popStack();for(;a&&"OnStep"!==a._op;)i.push(a),a=this.popStack();this.setFiberRefs(n.refs),this.currentRuntimeFlags=n.flags;let s=p.diff(n.refs,t),o=ea.diff(n.flags,r);return P.exitSucceed(P.blocked(e.effect_instruction_i0,P.withFiberRuntime(t=>{for(;i.length>0;)t.pushStack(i.pop());return t.setFiberRefs(p.patch(t.id(),t.getFiberRefs())(s)),t.currentRuntimeFlags=ea.patch(o)(t.currentRuntimeFlags),e.effect_instruction_i1})))}return P.uninterruptibleMask(t=>P.flatMap(iZ(P.runRequestBlock(e.effect_instruction_i0)),()=>t(e.effect_instruction_i1)))}RunBlocked(e){let t;return t=e.effect_instruction_i0,P.forEachSequentialDiscard(F.flatten(t),e=>iG(F.sequentialCollectionToChunk(e),e=>{let[t,r]=e,i=new Map,n=[];for(let e of r)for(let t of(n.push(s.toReadonlyArray(e)),e))i.set(t.request,t);let a=n.flat();return P.fiberRefLocally(nA(t.runAll(n),a,()=>a.forEach(e=>{e.listeners.interrupted=!0})),_.currentRequestMap,i)},!1,!1))}[rl.OP_UPDATE_RUNTIME_FLAGS](e){let t=e.effect_instruction_i0,r=this.currentRuntimeFlags,i=ea.patch(r,t);if(ea.interruptible(i)&&this.isInterrupted())return P.exitFailCause(this.getInterruptedCause());if(this.patchRuntimeFlags(this.currentRuntimeFlags,t),!e.effect_instruction_i1)return P.exitVoid;{let t=ea.diff(i,r);return this.pushStack(new P.RevertFlags(t,e)),(0,R.internalCall)(()=>e.effect_instruction_i1(r))}}[rl.OP_ON_SUCCESS](e){return this.pushStack(e),e.effect_instruction_i0}OnStep(e){return this.pushStack(e),e.effect_instruction_i0}[rl.OP_ON_FAILURE](e){return this.pushStack(e),e.effect_instruction_i0}[rl.OP_ON_SUCCESS_AND_FAILURE](e){return this.pushStack(e),e.effect_instruction_i0}[rl.OP_ASYNC](e){return this._asyncBlockingOn=e.effect_instruction_i1,this.initiateAsync(this.currentRuntimeFlags,e.effect_instruction_i0),iT.currentOp=e,iI}[rl.OP_YIELD](e){return this._isYielding=!1,iT.currentOp=e,iI}[rl.OP_WHILE](e){let t=e.effect_instruction_i0,r=e.effect_instruction_i1;return t()?(this.pushStack(e),r()):P.exitVoid}[rl.OP_ITERATOR](e){return ix[rl.OP_ITERATOR](this,e,void 0)}[rl.OP_COMMIT](e){return(0,R.internalCall)(()=>e.commit())}runLoop(e){let t=e;for(this.currentOpCount=0;;){if((this.currentRuntimeFlags&ea.OpSupervision)!=0&&this.currentSupervisor.onEffect(this,t),this._queue.length>0&&(t=this.drainQueueWhileRunning(this.currentRuntimeFlags,t)),!this._isYielding){this.currentOpCount+=1;let e=this.currentScheduler.shouldYield(this);if(!1!==e){this._isYielding=!0,this.currentOpCount=0;let r=t;t=P.flatMap(P.yieldNow({priority:e}),()=>r)}}try{if((t=this.currentTracer.context(()=>{if(iR!==t[P.EffectTypeId]._V){let e=this.getFiberRef(P.currentVersionMismatchErrorLogLevel);if("Some"===e._tag){let r=t[P.EffectTypeId]._V;this.log(`Executing an Effect versioned ${r} with a Runtime of version ${ih.getCurrentVersion()}, you may want to dedupe the effect dependencies, you can use the language service plugin to detect this at compile time: https://github.com/Effect-TS/language-service`,A.empty,e)}}return this[t._op](t)},this))===iI){let e=iT.currentOp;if(e._op===rl.OP_YIELD||e._op===rl.OP_ASYNC)return iI;return iT.currentOp=null,e._op===rl.OP_SUCCESS||e._op===rl.OP_FAILURE?e:P.exitFailCause(A.die(e))}}catch(e){t=(t===iI||I.hasProperty(t,"_op"))&&t._op in this?P.isInterruptedException(e)?P.exitFailCause(A.sequential(A.die(e),A.interrupt(c.none))):P.die(e):P.dieMessage(`Not a valid effect: ${S.toStringUnknown(t)}`)}}}run=()=>{this.drainQueueOnCurrentThread()}}let iA=(0,m.globalValue)("effect/FiberRef/currentMinimumLogLevel",()=>P.fiberRefUnsafeMake(b.fromLiteral("Info"))),iO=(0,m.globalValue)(Symbol.for("effect/Logger/defaultLogger"),()=>{let e;return e=e$,ez(t=>{let r=d.getOrDefault(t.context,L.currentServices);o.get(r,U.consoleTag).unsafe.log(e.log(t))})}),i_=(0,m.globalValue)(Symbol.for("effect/Logger/tracerLogger"),()=>ez(e=>{let{annotations:t,cause:r,context:i,fiberId:n,logLevel:a,message:s}=e,l=o.getOption(e_.getOrDefault(i,P.currentContext),ip.spanTag);if("None"===l._tag||"ExternalSpan"===l.value._tag)return;let u=o.unsafeGet(e_.getOrDefault(i,L.currentServices),O.clockTag),d={};for(let[e,r]of t)d[e]=r;d["effect.fiberId"]=c.threadName(n),d["effect.logLevel"]=a.label,null!==r&&"Empty"!==r._tag&&(d["effect.cause"]=A.pretty(r,{renderErrorCause:!0})),l.value.event(S.toStringUnknown(Array.isArray(s)&&1===s.length?s[0]:s),u.unsafeCurrentTimeNanos(),d)})),iM=(0,m.globalValue)(Symbol.for("effect/FiberRef/currentLoggers"),()=>P.fiberRefUnsafeMakeHashSet(y.make(iO,i_))),iD=(0,h.dual)(2,(e,t)=>{let r="string"==typeof t?b.fromLiteral(t):t;return P.withFiberRuntime(t=>{let i=t.getFiberRef(iA);return b.greaterThan(i,r)?P.succeed(w.none()):P.map(e,w.some)})}),iN=(0,h.dual)(e=>P.isEffect(e[0]),(e,t)=>P.uninterruptible(P.tap(e,e=>iL(r=>t(e,r))))),iP=(0,h.dual)(e=>P.isEffect(e[0]),(e,t)=>nF(e,iL(e=>t(e)))),iL=e=>P.withFiberRuntime(t=>{let r=t.getFiberRefs(),i=ea.disable(t.currentRuntimeFlags,ea.Interruption);return P.flatMap(np,t=>P.scopeAddFinalizerExit(t,t=>P.withFiberRuntime(n=>{let a=n.getFiberRefs(),s=n.currentRuntimeFlags,o=p.diff(a,r),l=ea.diff(s,i),u=p.diff(r,a);return n.setFiberRefs(p.patch(o,n.id(),r)),nF(P.withRuntimeFlags(e(t),l),P.sync(()=>{n.setFiberRefs(p.patch(u,n.id(),n.getFiberRefs()))}))})))}),iU=Symbol.for("effect/Effect/existsPar/found"),iz=(0,h.dual)(e=>I.isIterable(e[0])&&!P.isEffect(e[0]),(e,t,r)=>M.matchSimple(r?.concurrency,()=>P.suspend(()=>iW(e[Symbol.iterator](),0,t)),()=>P.matchEffect(iV(e,(e,r)=>P.if_(t(e,r),{onTrue:()=>P.fail(iU),onFalse:()=>P.void}),r),{onFailure:e=>e===iU?P.succeed(!0):P.fail(e),onSuccess:()=>P.succeed(!1)}))),iW=(e,t,r)=>{let i=e.next();return i.done?P.succeed(!1):P.flatMap(r(i.value,t),i=>i?P.succeed(i):iW(e,t+1,r))},iB=(0,h.dual)(e=>I.isIterable(e[0])&&!P.isEffect(e[0]),(e,t,r)=>{let i=r?.negate?(e,r)=>P.map(t(e,r),a.not):t;return M.matchSimple(r?.concurrency,()=>P.suspend(()=>n.fromIterable(e).reduceRight((e,t,r)=>P.zipWith(e,P.suspend(()=>i(t,r)),(e,r)=>r?[t,...e]:e),P.sync(()=>[]))),()=>P.map(iV(e,(e,t)=>P.map(i(e,t),t=>t?w.some(e):w.none()),r),n.getSomes))}),iq=(e,t)=>{let[r,i]=(e=>{if(Array.isArray(e)||I.isIterable(e))return[e,w.none()];let t=Object.keys(e),r=t.length;return[t.map(t=>e[t]),w.some(e=>{let i={};for(let n=0;n<r;n++)i[t[n]]=e[n];return i})]})(e);if(t?.mode==="validate"){let e=[];for(let t of r)e.push(P.either(t));return P.flatMap(iV(e,h.identity,{concurrency:t?.concurrency,batching:t?.batching,concurrentFinalizers:t?.concurrentFinalizers}),e=>{let r=w.none(),n=e.length,a=Array(n),s=Array(n),o=!1;for(let t=0;t<n;t++){let i=e[t];"Left"===i._tag?(a[t]=w.some(i.left),o=!0):(s[t]=i.right,a[t]=r)}return o?"Some"===i._tag?P.fail(i.value(a)):P.fail(a):t?.discard?P.void:"Some"===i._tag?P.succeed(i.value(s)):P.succeed(s)})}if(t?.mode==="either"){let e=[];for(let t of r)e.push(P.either(t));return t?.discard?iV(e,h.identity,{concurrency:t?.concurrency,batching:t?.batching,discard:!0,concurrentFinalizers:t?.concurrentFinalizers}):P.map(iV(e,h.identity,{concurrency:t?.concurrency,batching:t?.batching,concurrentFinalizers:t?.concurrentFinalizers}),e=>"Some"===i._tag?i.value(e):e)}return t?.discard!==!0&&"Some"===i._tag?P.map(iV(r,h.identity,t),i.value):iV(r,h.identity,t)},i$=(0,h.dual)(2,(e,t)=>Array.from({length:t},()=>e)),ij=(0,h.dual)(e=>P.isEffect(e[0]),(e,t,r)=>iq(i$(e,t),r)),iV=(0,h.dual)(e=>I.isIterable(e[0]),(e,t,r)=>P.withFiberRuntime(i=>{let n=r?.batching===!0||r?.batching==="inherit"&&i.getFiberRef(P.currentRequestBatching);return r?.discard?M.match(r.concurrency,()=>i9(u.sequential,r?.concurrentFinalizers)(r=>n?iG(e,(e,i)=>r(t(e,i)),!0,!1,1):P.forEachSequentialDiscard(e,(e,i)=>r(t(e,i)))),()=>i9(u.parallel,r?.concurrentFinalizers)(r=>iG(e,(e,i)=>r(t(e,i)),n,!1)),i=>i9(u.parallelN(i),r?.concurrentFinalizers)(r=>iG(e,(e,i)=>r(t(e,i)),n,!1,i))):M.match(r?.concurrency,()=>i9(u.sequential,r?.concurrentFinalizers)(r=>n?iK(e,1,(e,i)=>r(t(e,i)),!0):P.forEachSequential(e,(e,i)=>r(t(e,i)))),()=>i9(u.parallel,r?.concurrentFinalizers)(r=>iH(e,(e,i)=>r(t(e,i)),n)),i=>i9(u.parallelN(i),r?.concurrentFinalizers)(r=>iK(e,i,(e,i)=>r(t(e,i)),n)))})),iH=(e,t,r)=>P.suspend(()=>{let i=n.fromIterable(e),a=Array(i.length);return P.zipRight(iG(i,(e,r)=>P.flatMap(t(e,r),e=>P.sync(()=>a[r]=e)),r,!1),P.succeed(a))}),iG=(e,t,r,i,n)=>P.uninterruptibleMask(a=>P.transplant(s=>P.withFiberRuntime(o=>{let l=Array.from(e).reverse(),u=l.length;if(0===u)return P.void;let c=0,d=!1,p=n?Math.min(l.length,n):l.length,f=new Set,h=[],m=[],g=[],y=[],S=()=>{let e=h.filter(e=>{let{exit:t}=e;return"Failure"===t._tag}).sort((e,t)=>e.index<t.index?-1:+(e.index!==t.index)).map(e=>{let{exit:t}=e;return t});return 0===e.length&&e.push(P.exitVoid),e},b=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=P.uninterruptible(s(e)),i=iX(r,o,o.currentRuntimeFlags,en);return o.currentScheduler.scheduleTask(()=>{t&&i.unsafeInterruptAsFork(o.id()),i.resume(r)},0),i},v=()=>{i||(u-=l.length,l=[]),d=!0,f.forEach(e=>{e.currentScheduler.scheduleTask(()=>{e.unsafeInterruptAsFork(o.id())},0)})},E=r?P.step:P.exit,k=b(P.async(e=>{let i=(e,t)=>{"Blocked"===e._op?y.push(e):(h.push({index:t,exit:e}),"Failure"!==e._op||d||v())},s=()=>{if(l.length>0){let p=l.pop(),v=c++,k=e=>{if(l.length>0&&(i(e,v),l.length>0)){let e;return e=l.pop(),v=c++,P.flatMap(P.yieldNow(),()=>P.flatMap(E(a(t(e,v))),k))}return P.succeed(e)},I=b(P.flatMap(E(a(t(p,v))),k));m.push(I),f.add(I),d&&I.currentScheduler.scheduleTask(()=>{I.unsafeInterruptAsFork(o.id())},0),I.addObserver(t=>{let a;if(a="Failure"===t._op?t:t.effect_instruction_i0,g.push(I),f.delete(I),i(a,v),h.length===u)e(P.succeed(w.getOrElse(P.exitCollectAll(S(),{parallel:!0}),()=>P.exitVoid)));else if(y.length+h.length===u){let t=S(),i=y.map(e=>e.effect_instruction_i0).reduce(F.par);e(P.succeed(P.blocked(i,iG([w.getOrElse(P.exitCollectAll(t,{parallel:!0}),()=>P.exitVoid),...y.map(e=>e.effect_instruction_i1)],e=>e,r,!0,n))))}else s()})}};for(let e=0;e<p;e++)s()}));return P.asVoid(P.onExit(P.flatten(a(eb(k))),P.exitMatch({onFailure:e=>{v();let t=y.length+1,r=Math.min("number"==typeof n?n:y.length,y.length),i=Array.from(y);return P.async(n=>{let a=[],s=0,o=0,l=(r,o)=>l=>{a[r]=l,++s===t&&n(P.exitSucceed(P.exitFailCause(e))),i.length>0&&o&&u()},u=()=>{b(i.pop(),!0).addObserver(l(o,!0)),o++};k.addObserver(l(o,!1)),o++;for(let e=0;e<r;e++)u()})},onSuccess:()=>P.forEachSequential(g,e=>e.inheritAll)})))}))),iK=(e,t,r,i)=>P.suspend(()=>{let a=n.fromIterable(e),s=Array(a.length);return P.zipRight(iG(a,(e,t)=>P.map(r(e,t),e=>s[t]=e),i,!1,t),P.succeed(s))}),iJ=e=>P.withFiberRuntime((t,r)=>P.succeed(iY(e,t,r.runtimeFlags))),iZ=e=>i1(e,en),iQ=(0,h.dual)(2,(e,t)=>iJ(P.onError(e,e=>{let r=A.failureOrCause(e);switch(r._tag){case"Left":return t(r.left);case"Right":return P.failCause(r.right)}}))),iY=function(e,t,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=i0(e,t,r,i);return n.resume(e),n},iX=function(e,t,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return i0(e,t,r,i)},i0=function(e,t,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=c.unsafeMake(),a=t.getFiberRefs(),s=e_.forkAs(a,n),o=new iF(n,s,r),l=e_.getOrDefault(s,P.currentContext),u=o.currentSupervisor;return u.onStart(l,e,w.some(t),o),o.addObserver(e=>u.onEnd(e,o)),(null!==i?i:(0,h.pipe)(t.getFiberRef(P.currentForkScopeOverride),w.getOrElse(()=>t.scope()))).add(r,o),o},i1=(e,t)=>P.withFiberRuntime((r,i)=>P.succeed(iY(e,r,i.runtimeFlags,t))),i2=(0,h.dual)(e=>I.isFunction(e[2]),(e,t,r,i)=>M.matchSimple(i?.concurrency,()=>n.fromIterable(e).reduce((e,t,i)=>P.zipWith(e,t,(e,t)=>r(e,t,i)),P.succeed(t)),()=>P.flatMap(T.make(t),t=>P.flatMap(iV(e,(e,i)=>P.flatMap(e,e=>T.update(t,t=>r(t,e,i))),i),()=>T.get(t))))),i5=(0,h.dual)(e=>I.isIterable(e[0]),(e,t,r)=>(0,h.pipe)(iV(e,(e,r)=>P.either(t(e,r)),r),P.map(e=>P.partitionMap(e,h.identity)))),i3=(0,h.dual)(e=>I.isIterable(e[0]),(e,t,r)=>P.flatMap(i5(e,t,{concurrency:r?.concurrency,batching:r?.batching,concurrentFinalizers:r?.concurrentFinalizers}),e=>{let[t,i]=e;return n.isNonEmptyArray(t)?P.fail(t):r?.discard?P.void:P.succeed(i)})),i8=(0,h.dual)(e=>I.isIterable(e[0])&&!P.isEffect(e[0]),(e,t,r,i)=>M.matchSimple(i?.concurrency,()=>n.fromIterable(e).reduce((e,t,i)=>P.zipWith(e,t,(e,t)=>r(e,t,i)),t),()=>P.suspend(()=>(0,h.pipe)(i2([t,...e],w.none(),(e,t,i)=>{switch(e._tag){case"None":return w.some(t);case"Some":return w.some(r(e.value,t,i))}},i),P.map(e=>{switch(e._tag){case"None":throw Error("BUG: Effect.reduceEffect - please report an issue at https://github.com/Effect-TS/effect/issues");case"Some":return e.value}}))))),i4=e=>P.contextWithEffect(t=>w.match(o.getOption(t,nd),{onNone:()=>e,onSome:t=>{switch(t.strategy._tag){case"Parallel":return e;case"Sequential":case"ParallelN":return P.flatMap(P.scopeFork(t,u.parallel),t=>ng(e,t))}}})),i6=e=>t=>P.contextWithEffect(r=>w.match(o.getOption(r,nd),{onNone:()=>t,onSome:r=>"ParallelN"===r.strategy._tag&&r.strategy.parallelism===e?t:P.flatMap(P.scopeFork(r,u.parallelN(e)),e=>ng(t,e))})),i9=(e,t)=>r=>P.contextWithEffect(i=>w.match(o.getOption(i,nd),{onNone:()=>r(h.identity),onSome:i=>{if(!0!==t)return r(h.identity);{let t="Parallel"===e._tag?i4:"Sequential"===e._tag?nt:i6(e.parallelism);switch(i.strategy._tag){case"Parallel":return t(r(i4));case"Sequential":return t(r(nt));case"ParallelN":return t(r(i6(i.strategy.parallelism)))}}}})),i7=e=>P.flatMap(nd,e),ne=e=>P.flatMap(nm(),t=>P.onExit(e(t),e=>t.close(e))),nt=e=>P.contextWithEffect(t=>w.match(o.getOption(t,nd),{onNone:()=>e,onSome:t=>{switch(t.strategy._tag){case"Sequential":return e;case"Parallel":case"ParallelN":return P.flatMap(P.scopeFork(t,u.sequential),t=>ng(e,t))}}})),nr=e=>nv(P.currentMetricLabels,t=>n.union(t,e)),ni=(0,h.dual)(2,(e,t)=>ne(r=>P.flatMap(ng(e,r),t))),nn=(0,h.dual)(e=>P.isEffect(e[1]),(e,t,r)=>na(e,t,(e,t)=>[e,t],r)),na=(0,h.dual)(e=>P.isEffect(e[1]),(e,t,r,i)=>P.flatten(nc(P.exit(e),P.exit(t),(e,t)=>P.exitZipWith(e,t,{onSuccess:r,onFailure:(e,t)=>i?.concurrent?A.parallel(e,t):A.sequential(e,t)}),i))),ns=(0,h.dual)(e=>I.isIterable(e[0]),(e,t,r)=>P.flip(iV(e,(e,r)=>P.flip(t(e,r)),r))),no=(0,h.dual)(e=>P.isEffect(e[1]),(e,t,r)=>nc(e,t,(e,t)=>[e,t],r)),nl=(0,h.dual)(e=>P.isEffect(e[1]),(e,t,r)=>r?.concurrent!==!0&&(r?.batching===void 0||!1===r.batching)?P.zipLeft(e,t):nc(e,t,(e,t)=>e,r)),nu=(0,h.dual)(e=>P.isEffect(e[1]),(e,t,r)=>r?.concurrent!==!0&&(r?.batching===void 0||!1===r.batching)?P.zipRight(e,t):nc(e,t,(e,t)=>t,r)),nc=(0,h.dual)(e=>P.isEffect(e[1]),(e,t,r,i)=>P.map(iq([e,t],{concurrency:i?.concurrent?2:1,batching:i?.batching,concurrentFinalizers:i?.concurrentFinalizers}),e=>{let[t,i]=e;return r(t,i)})),nd=o.GenericTag("effect/Scope"),np=nd,nf={[P.ScopeTypeId]:P.ScopeTypeId,[P.CloseableScopeTypeId]:P.CloseableScopeTypeId,pipe(){return(0,k.pipeArguments)(this,arguments)},fork(e){return P.sync(()=>{var t;let r=nh(e);if("Closed"===this.state._tag)return r.state=this.state,r;let i={};return this.state.finalizers.set(i,e=>r.close(e)),t=e=>P.sync(()=>{"Open"===this.state._tag&&this.state.finalizers.delete(i)}),"Open"===r.state._tag&&r.state.finalizers.set({},t),r})},close(e){return P.suspend(()=>{if("Closed"===this.state._tag)return P.void;let t=Array.from(this.state.finalizers.values()).reverse();return(this.state={_tag:"Closed",exit:e},0===t.length)?P.void:z.isSequential(this.strategy)?(0,h.pipe)(P.forEachSequential(t,t=>P.exit(t(e))),P.flatMap(e=>(0,h.pipe)(P.exitCollectAll(e),w.map(P.exitAsVoid),w.getOrElse(()=>P.exitVoid)))):z.isParallel(this.strategy)?(0,h.pipe)(iH(t,t=>P.exit(t(e)),!1),P.flatMap(e=>(0,h.pipe)(P.exitCollectAll(e,{parallel:!0}),w.map(P.exitAsVoid),w.getOrElse(()=>P.exitVoid)))):(0,h.pipe)(iK(t,this.strategy.parallelism,t=>P.exit(t(e)),!1),P.flatMap(e=>(0,h.pipe)(P.exitCollectAll(e,{parallel:!0}),w.map(P.exitAsVoid),w.getOrElse(()=>P.exitVoid))))})},addFinalizer(e){return P.suspend(()=>"Closed"===this.state._tag?e(this.state.exit):(this.state.finalizers.set({},e),P.void))}},nh=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z.sequential,t=Object.create(nf);return t.strategy=e,t.state={_tag:"Open",finalizers:new Map},t},nm=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z.sequential;return P.sync(()=>nh(e))},ng=(0,h.dual)(2,(e,t)=>P.mapInputContext(e,o.merge(o.make(nd,t)))),ny=(0,h.dual)(2,(e,t)=>(0,h.pipe)(e,ng(t),P.onExit(e=>t.close(e)))),nS=e=>P.fiberRefUnsafeMakePatch(e,{differ:id,fork:io}),nb=(0,h.dual)(2,(e,t)=>P.asVoid(iN(P.flatMap(P.fiberRefGet(e),r=>P.as(P.fiberRefSet(e,t),r)),t=>P.fiberRefSet(e,t)))),nv=(0,h.dual)(2,(e,t)=>P.fiberRefGetWith(e,r=>nb(e,t(r)))),nE=e=>iN(P.tap(P.sync(e),e=>P.fiberRefUpdate(e,h.identity)),e=>P.fiberRefDelete(e)),nw=P.fiberRefUnsafeMakeRuntimeFlags(ea.none),nk=nS(r5),nI=e=>({...l.CommitPrototype,commit(){return eb(this)},[es]:eo,id:()=>n.fromIterable(e).reduce((e,t)=>c.combine(e,t.id()),c.none),await:P.exit(iH(e,e=>P.flatten(e.await),!1)),children:P.map(iH(e,e=>e.children,!1),n.flatten),inheritAll:P.forEachSequentialDiscard(e,e=>e.inheritAll),poll:P.map(P.forEachSequential(e,e=>e.poll),n.reduceRight(w.some(P.exitSucceed([])),(e,t)=>{switch(t._tag){case"None":return w.none();case"Some":switch(e._tag){case"None":return w.none();case"Some":return w.some(P.exitZipWith(t.value,e.value,{onSuccess:(e,t)=>[e,...t],onFailure:A.parallel}))}}})),interruptAsFork:t=>P.forEachSequentialDiscard(e,e=>e.interruptAsFork(t))}),nT=(0,h.dual)(3,(e,t,r)=>nC(e,t,{onSelfWin:(e,t)=>P.flatMap(e.await,i=>{switch(i._tag){case rl.OP_SUCCESS:return P.flatMap(e.inheritAll,()=>r.onSelfDone(i,t));case rl.OP_FAILURE:return r.onSelfDone(i,t)}}),onOtherWin:(e,t)=>P.flatMap(e.await,i=>{switch(i._tag){case rl.OP_SUCCESS:return P.flatMap(e.inheritAll,()=>r.onOtherDone(i,t));case rl.OP_FAILURE:return r.onOtherDone(i,t)}})})),nx=(0,h.dual)(2,(e,t)=>P.fiberIdWith(r=>nT(e,t,{onSelfDone:(e,t)=>P.exitMatchEffect(e,{onFailure:e=>(0,h.pipe)(eb(t),N.mapErrorCause(t=>A.parallel(e,t))),onSuccess:e=>(0,h.pipe)(t,P.interruptAsFiber(r),P.as(e))}),onOtherDone:(e,t)=>P.exitMatchEffect(e,{onFailure:e=>(0,h.pipe)(eb(t),N.mapErrorCause(t=>A.parallel(t,e))),onSuccess:e=>(0,h.pipe)(t,P.interruptAsFiber(r),P.as(e))})}))),nC=(0,h.dual)(3,(e,t,r)=>P.withFiberRuntime((i,n)=>{let a=n.runtimeFlags,s=E.make(!0),o=i0(e,i,a,r.selfScope),l=i0(t,i,a,r.otherScope);return P.async(i=>{o.addObserver(()=>nR(o,l,r.onSelfWin,s,i)),l.addObserver(()=>nR(l,o,r.onOtherWin,s,i)),o.startFork(e),l.startFork(t)},c.combine(o.id(),l.id()))})),nR=(e,t,r,i,n)=>{E.compareAndSet(!0,!1)(i)&&n(r(e,t))},nF=(0,h.dual)(2,(e,t)=>P.uninterruptibleMask(r=>P.matchCauseEffect(r(e),{onFailure:e=>P.matchCauseEffect(t,{onFailure:t=>P.failCause(A.sequential(e,t)),onSuccess:()=>P.failCause(e)}),onSuccess:e=>P.as(t,e)}))),nA=(e,t,r)=>P.fiberIdWith(i=>P.flatMap(P.flatMap(iZ(P.interruptible(e)),e=>P.async(i=>{let n=t.map(e=>e.listeners.count),a=()=>{n.every(e=>0===e)&&t.every(e=>"Pending"===e.result.state.current._tag||!!("Done"===e.result.state.current._tag&&P.exitIsExit(e.result.state.current.effect)&&"Failure"===e.result.state.current.effect._tag&&A.isInterrupted(e.result.state.current.effect.cause)))&&(s.forEach(e=>e()),r?.(),i(P.interruptFiber(e)))};e.addObserver(e=>{s.forEach(e=>e()),i(e)});let s=t.map((e,t)=>{let r=e=>{n[t]=e,a()};return e.listeners.addObserver(r),()=>e.listeners.removeObserver(r)});return a(),P.sync(()=>{s.forEach(e=>e())})})),()=>P.suspend(()=>{let e=t.flatMap(e=>e.state.completed?[]:[e]);return P.forEachSequentialDiscard(e,e=>rf(e.request,P.exitInterrupt(i)))}))),nO=(0,h.dual)(2,(e,t)=>P.fiberRefGetWith(_.currentRequestMap,r=>P.suspend(()=>nA(e,n.fromIterable(t).flatMap(e=>r.has(e)?[r.get(e)]:[]))))),n_=(e,t)=>(t=ip.addSpanStackTrace(t),P.uninterruptible(P.withFiberRuntime(r=>{let i=o.unsafeGet(r.getFiberRef(P.currentContext),nd),n=N.unsafeMakeSpan(r,e,t),a=r.getFiberRef(P.currentTracerTimingEnabled),s=o.get(r.getFiberRef(L.currentServices),O.clockTag);return P.as(P.scopeAddFinalizerExit(i,e=>N.endSpan(n,e,s,a)),n)})));e.s(["FiberRuntime",0,iF,"acquireRelease",0,iN,"acquireReleaseInterruptible",0,iP,"addFinalizer",0,iL,"all",0,iq,"allSuccesses",0,(e,t)=>P.map(iq(n.fromIterable(e).map(P.exit),t),n.filterMap(e=>P.exitIsSuccess(e)?w.some(e.effect_instruction_i0):w.none())),"allWith",0,e=>t=>iq(t,e),"annotateLogsScoped",0,function(){if("string"==typeof arguments[0])return nv(P.currentLogAnnotations,g.set(arguments[0],arguments[1]));let e=Object.entries(arguments[0]);return nv(P.currentLogAnnotations,g.mutate(t=>{for(let r=0;r<e.length;r++){let[i,n]=e[r];g.set(t,i,n)}return t}))},"currentLoggers",0,iM,"currentMinimumLogLevel",0,iA,"currentRuntimeFlags",0,nw,"currentSupervisor",0,nk,"daemonChildren",0,e=>P.fiberRefLocally(P.currentForkScopeOverride,w.some(en))(e),"disconnect",0,e=>P.uninterruptibleMask(t=>P.fiberIdWith(r=>P.flatMap(iZ(t(e)),e=>(0,h.pipe)(t(eb(e)),P.onInterrupt(()=>(0,h.pipe)(e,eS(r))))))),"ensuring",0,nF,"exists",0,iz,"fiberAll",0,nI,"fiberAwaitAll",0,e=>iV(e,ep),"fiberInterruptFork",0,e=>P.asVoid(iZ(P.interruptFiber(e))),"fiberJoinAll",0,e=>eb(nI(e)),"fiberRefLocallyScoped",0,nb,"fiberRefLocallyScopedWith",0,nv,"fiberRefMake",0,(e,t)=>nE(()=>P.fiberRefUnsafeMake(e,t)),"fiberRefMakeContext",0,e=>nE(()=>P.fiberRefUnsafeMakeContext(e)),"fiberRefMakeRuntimeFlags",0,e=>nE(()=>P.fiberRefUnsafeMakeRuntimeFlags(e)),"fiberRefMakeWith",0,nE,"fiberRefUnsafeMakeSupervisor",0,nS,"fiberScoped",0,e=>iN(P.succeed(e),P.interruptFiber),"filter",0,iB,"finalizersMask",0,e=>t=>i9(e,!0)(t),"forEach",0,iV,"forEachConcurrentDiscard",0,iG,"forEachParUnbounded",0,iH,"fork",0,iJ,"forkDaemon",0,iZ,"forkWithErrorHandler",0,iQ,"interruptWhenPossible",0,nO,"invokeWithInterrupt",0,nA,"labelMetricsScoped",0,nr,"makeSpanScoped",0,n_,"mergeAll",0,i2,"parallelFinalizers",0,i4,"partition",0,i5,"race",0,nx,"raceAll",0,e=>P.withFiberRuntime((t,r)=>P.async(i=>{let n,a=new Set,s=A.empty,o=()=>{for(let e of a)e.unsafeInterruptAsFork(t.id())},l=!1,u=!0;for(let c of e){u=!1;let e=iY(P.interruptible(c),t,r.runtimeFlags);if(a.add(e),e.addObserver(t=>{a.delete(e),n||("Success"===t._tag?(l=!0,n=e,s=A.empty,o()):s=A.parallel(t.cause,s)),l&&0===a.size&&i(n?P.zipRight(eg(n),n.unsafePoll()):P.failCause(s))}),n)break}return u?i(P.dieSync(()=>new P.IllegalArgumentException("Received an empty collection of effects"))):(l=!0,ey(a,t.id()))})),"raceFibersWith",0,nC,"raceWith",0,nT,"reduceEffect",0,i8,"replicate",0,i$,"replicateEffect",0,ij,"scope",0,np,"scopeExtend",0,ng,"scopeMake",0,nm,"scopeTag",0,nd,"scopeUse",0,ny,"scopeWith",0,i7,"scopedEffect",0,e=>P.flatMap(nm(),t=>ny(e,t)),"scopedWith",0,ne,"sequentialFinalizers",0,nt,"tagMetricsScoped",0,(e,t)=>nr([tp.make(e,t)]),"unsafeFork",0,iY,"using",0,ni,"validate",0,nn,"validateAll",0,i3,"validateFirst",0,ns,"validateWith",0,na,"whenLogLevel",0,iD,"withClockScoped",0,e=>nv(L.currentServices,o.add(O.clockTag,e)),"withConfigProviderScoped",0,e=>nv(L.currentServices,o.add(D.configProviderTag,e)),"withEarlyRelease",0,e=>i7(t=>P.flatMap(P.scopeFork(t,z.sequential),t=>(0,h.pipe)(e,ng(t),P.map(e=>[P.fiberIdWith(e=>P.scopeClose(t,P.exitInterrupt(e))),e])))),"withRandomScoped",0,e=>nv(L.currentServices,o.add(ru.randomTag,e)),"withRuntimeFlagsScoped",0,e=>e===x.empty?P.void:(0,h.pipe)(P.runtimeFlags,P.flatMap(t=>{let r=ea.patch(t,e),i=ea.diff(r,t);return(0,h.pipe)(P.updateRuntimeFlags(e),P.zipRight(iL(()=>P.updateRuntimeFlags(i))),P.asVoid)}),P.uninterruptible),"withSpanScoped",0,function(){let e="string"!=typeof arguments[0],t=e?arguments[1]:arguments[0],r=ip.addSpanStackTrace(e?arguments[2]:arguments[1]);if(e){let e=arguments[0];return P.flatMap(n_(t,ip.addSpanStackTrace(r)),t=>N.provideService(e,ip.spanTag,t))}return e=>P.flatMap(n_(t,ip.addSpanStackTrace(r)),t=>N.provideService(e,ip.spanTag,t))},"withTracerScoped",0,e=>nv(L.currentServices,o.add(ip.tracerTag,e)),"zipLeftOptions",0,nl,"zipOptions",0,no,"zipRightOptions",0,nu,"zipWithOptions",0,nc],1658800)},5450905,e=>{"use strict";var t=e.i(4043929),r=e.i(7548658);let i=t.CauseTypeId,n=r.RuntimeExceptionTypeId,a=r.InterruptedExceptionTypeId,s=r.IllegalArgumentExceptionTypeId,o=r.NoSuchElementExceptionTypeId,l=r.InvalidPubSubCapacityExceptionTypeId,u=r.ExceededCapacityExceptionTypeId,c=r.TimeoutExceptionTypeId,d=r.UnknownExceptionTypeId,p=r.YieldableError,f=t.empty,h=t.fail,m=t.die,g=t.interrupt,y=t.parallel,S=t.sequential,b=t.isCause,v=t.isEmptyType,E=t.isFailType,w=t.isDieType,k=t.isInterruptType,I=t.isSequentialType,T=t.isParallelType,x=t.size,C=t.isEmpty,R=t.isFailure,F=t.isDie,A=t.isInterrupted,O=t.isInterruptedOnly,_=t.failures,M=t.defects,D=t.interruptors,N=t.failureOption,P=t.failureOrCause,L=t.flipCauseOption,U=t.dieOption,z=t.interruptOption,W=t.keepDefects,B=t.linearize,q=t.stripFailures,$=t.stripSomeDefects,j=t.as,V=t.map,H=t.flatMap,G=t.andThen,K=t.flatten,J=t.contains,Z=r.causeSquash,Q=r.causeSquashWith,Y=t.find,X=t.filter,ee=t.match,et=t.reduce,er=t.reduceWithContext,ei=r.InterruptedException,en=r.isInterruptedException,ea=r.IllegalArgumentException,es=r.isIllegalArgumentException,eo=r.NoSuchElementException,el=r.isNoSuchElementException,eu=r.RuntimeException,ec=r.isRuntimeException,ed=r.TimeoutException,ep=r.isTimeoutException,ef=r.UnknownException,eh=r.isUnknownException,em=r.ExceededCapacityException,eg=r.isExceededCapacityException,ey=t.pretty,eS=t.prettyErrors,eb=r.originalInstance;e.s(["CauseTypeId",0,i,"ExceededCapacityException",0,em,"ExceededCapacityExceptionTypeId",0,u,"IllegalArgumentException",0,ea,"IllegalArgumentExceptionTypeId",0,s,"InterruptedException",0,ei,"InterruptedExceptionTypeId",0,a,"InvalidPubSubCapacityExceptionTypeId",0,l,"NoSuchElementException",0,eo,"NoSuchElementExceptionTypeId",0,o,"RuntimeException",0,eu,"RuntimeExceptionTypeId",0,n,"TimeoutException",0,ed,"TimeoutExceptionTypeId",0,c,"UnknownException",0,ef,"UnknownExceptionTypeId",0,d,"YieldableError",0,p,"andThen",0,G,"as",0,j,"contains",0,J,"defects",0,M,"die",0,m,"dieOption",0,U,"empty",0,f,"fail",0,h,"failureOption",0,N,"failureOrCause",0,P,"failures",0,_,"filter",0,X,"find",0,Y,"flatMap",0,H,"flatten",0,K,"flipCauseOption",0,L,"interrupt",0,g,"interruptOption",0,z,"interruptors",0,D,"isCause",0,b,"isDie",0,F,"isDieType",0,w,"isEmpty",0,C,"isEmptyType",0,v,"isExceededCapacityException",0,eg,"isFailType",0,E,"isFailure",0,R,"isIllegalArgumentException",0,es,"isInterruptType",0,k,"isInterrupted",0,A,"isInterruptedException",0,en,"isInterruptedOnly",0,O,"isNoSuchElementException",0,el,"isParallelType",0,T,"isRuntimeException",0,ec,"isSequentialType",0,I,"isTimeoutException",0,ep,"isUnknownException",0,eh,"keepDefects",0,W,"linearize",0,B,"map",0,V,"match",0,ee,"originalError",0,eb,"parallel",0,y,"pretty",0,ey,"prettyErrors",0,eS,"reduce",0,et,"reduceWithContext",0,er,"sequential",0,S,"size",0,x,"squash",0,Z,"squashWith",0,Q,"stripFailures",0,q,"stripSomeDefects",0,$])},3322401,5160412,4026828,3674254,6028004,210165,5523614,2067266,5331375,9333060,9992093,1650035,578549,217551,6902776,945364,e=>{"use strict";var t=e.i(3683485),r=e.i(4043929),i=e.i(5972454),n=e.i(7548658),a=e.i(7294722),s=e.i(9347119),o=e.i(1658800),l=e.i(5450905),u=e.i(219787),c=e.i(8973103),d=e.i(8317886),p=e.i(5015632),f=e.i(9960543),h=e.i(4935619),m=e.i(7862555),g=e.i(8815901);let y=Symbol.for("effect/ScheduleInterval"),S={[y]:y,startMillis:0,endMillis:0},b=(e,t)=>e>t?S:{[y]:y,startMillis:e,endMillis:t},v=(0,t.dual)(2,(e,t)=>E(e,t)===e),E=(0,t.dual)(2,(e,t)=>e.endMillis<=t.startMillis?e:t.endMillis<=e.startMillis?t:e.startMillis<t.startMillis?e:t.startMillis<e.startMillis?t:e.endMillis<=t.endMillis?e:t),w=(0,t.dual)(2,(e,t)=>b(Math.max(e.startMillis,t.startMillis),Math.min(e.endMillis,t.endMillis))),k=e=>e.startMillis>=e.endMillis;var I=e.i(8928058);let T=Symbol.for("effect/ScheduleIntervals"),x=e=>({[T]:T,intervals:e}),C=(0,t.dual)(2,(e,t)=>m.isNonEmpty(t.intervals)?m.isNonEmpty(e.intervals)?m.headNonEmpty(e.intervals).startMillis<m.headNonEmpty(t.intervals).startMillis?R(m.tailNonEmpty(e.intervals),t.intervals,m.headNonEmpty(e.intervals),m.empty()):R(e.intervals,m.tailNonEmpty(t.intervals),m.headNonEmpty(t.intervals),m.empty()):t:e),R=(e,r,i,n)=>{let a=e,s=r,o=i,l=n;for(;m.isNonEmpty(a)||m.isNonEmpty(s);)if(!m.isNonEmpty(a)&&m.isNonEmpty(s))o.endMillis<m.headNonEmpty(s).startMillis?(l=(0,t.pipe)(l,m.prepend(o)),o=m.headNonEmpty(s)):o=b(o.startMillis,m.headNonEmpty(s).endMillis),s=m.tailNonEmpty(s),a=m.empty();else if(m.isNonEmpty(a)&&m.isEmpty(s))o.endMillis<m.headNonEmpty(a).startMillis?(l=(0,t.pipe)(l,m.prepend(o)),o=m.headNonEmpty(a)):o=b(o.startMillis,m.headNonEmpty(a).endMillis),s=m.empty(),a=m.tailNonEmpty(a);else if(m.isNonEmpty(a)&&m.isNonEmpty(s))m.headNonEmpty(a).startMillis<m.headNonEmpty(s).startMillis?(o.endMillis<m.headNonEmpty(a).startMillis?(l=(0,t.pipe)(l,m.prepend(o)),o=m.headNonEmpty(a)):o=b(o.startMillis,m.headNonEmpty(a).endMillis),a=m.tailNonEmpty(a)):(o.endMillis<m.headNonEmpty(s).startMillis?(l=(0,t.pipe)(l,m.prepend(o)),o=m.headNonEmpty(s)):o=b(o.startMillis,m.headNonEmpty(s).endMillis),s=m.tailNonEmpty(s));else throw Error((0,I.getBugErrorMessage)("Intervals.unionLoop"));return x((0,t.pipe)(l,m.prepend(o),m.reverse))},F=(0,t.dual)(2,(e,t)=>A(e.intervals,t.intervals,m.empty())),A=(e,r,i)=>{let n=e,a=r,s=i;for(;m.isNonEmpty(n)&&m.isNonEmpty(a);){let e=(0,t.pipe)(m.headNonEmpty(n),w(m.headNonEmpty(a))),r=k(e)?s:(0,t.pipe)(s,m.prepend(e));(0,t.pipe)(m.headNonEmpty(n),v(m.headNonEmpty(a)))?n=m.tailNonEmpty(n):a=m.tailNonEmpty(a),s=r}return x(m.reverse(s))},O=e=>(0,t.pipe)(e.intervals,m.head,g.getOrElse(()=>S)).startMillis,_=(0,t.dual)(2,(e,t)=>O(e)<O(t)),M=(0,t.dual)(2,(e,t)=>_(e,t)?t:e),D=e=>(0,t.pipe)(e.intervals,m.head,g.getOrElse(()=>S)).endMillis,N="Continue",P="Done",L=e=>({_tag:N,intervals:e}),U=e=>({_tag:N,intervals:x(m.of(e))}),z={_tag:P};n.ScopeTypeId,n.CloseableScopeTypeId;let W=o.scopeTag,B=n.scopeAddFinalizer,q=n.scopeAddFinalizerExit,$=n.scopeClose,j=o.scopeExtend,V=n.scopeFork;o.scopeUse;let H=o.scopeMake;e.s(["Scope",0,W,"addFinalizer",0,B,"addFinalizerExit",0,q,"close",0,$,"extend",0,j,"fork",0,V,"make",0,H],5160412);var G=e.i(4039787),K=e.i(7525378),J=e.i(3628392),Z=e.i(7836076),Q=e.i(1150852),Y=e.i(2090854),X=e.i(2034623),ee=e.i(5369340),et=e.i(2916763),er=e.i(1145227),ei=e.i(2311887),en=e.i(3196727),ea=e.i(5663534);class es{permits;waiters=new Set;taken=0;constructor(e){this.permits=e}get free(){return this.permits-this.taken}take=e=>n.asyncInterrupt(t=>{if(this.free<e){let r=()=>{this.free<e||(this.waiters.delete(r),this.taken+=e,t(n.succeed(e)))};return this.waiters.add(r),n.sync(()=>{this.waiters.delete(r)})}return this.taken+=e,t(n.succeed(e))});updateTakenUnsafe(e,t){return this.taken=t(this.taken),this.waiters.size>0&&e.getFiberRef(et.currentScheduler).scheduleTask(()=>{let e=this.waiters.values(),t=e.next();for(;!1===t.done&&this.free>0;)t.value(),t=e.next()},e.getFiberRef(n.currentSchedulingPriority)),n.succeed(this.free)}updateTaken(e){return n.withFiberRuntime(t=>this.updateTakenUnsafe(t,e))}resize=e=>n.asVoid(n.withFiberRuntime(t=>(this.permits=e,this.free<0)?n.void:this.updateTakenUnsafe(t,e=>e)));release=e=>this.updateTaken(t=>t-e);releaseAll=this.updateTaken(e=>0);withPermits=e=>t=>n.uninterruptibleMask(r=>n.flatMap(r(this.take(e)),e=>o.ensuring(r(t),this.release(e))));withPermitsIfAvailable=e=>t=>n.uninterruptibleMask(r=>n.suspend(()=>this.free<e?G.succeedNone:(this.taken+=e,o.ensuring(r(G.asSome(t)),this.release(e)))))}let eo=e=>new es(e),el=e=>n.sync(()=>eo(e));class eu extends K.Class{isOpen;waiters=[];scheduled=!1;constructor(e){super(),this.isOpen=e}commit(){return this.await}unsafeSchedule(e){return this.scheduled||0===this.waiters.length||(this.scheduled=!0,e.currentScheduler.scheduleTask(this.flushWaiters,e.getFiberRef(n.currentSchedulingPriority))),n.void}flushWaiters=()=>{this.scheduled=!1;let e=this.waiters;this.waiters=[];for(let t=0;t<e.length;t++)e[t](n.exitVoid)};open=n.withFiberRuntime(e=>this.isOpen?n.void:(this.isOpen=!0,this.unsafeSchedule(e)));unsafeOpen(){this.isOpen||(this.isOpen=!0,this.flushWaiters())}release=n.withFiberRuntime(e=>this.isOpen?n.void:this.unsafeSchedule(e));await=n.asyncInterrupt(e=>this.isOpen?e(n.void):(this.waiters.push(e),n.sync(()=>{let t=this.waiters.indexOf(e);-1!==t&&this.waiters.splice(t,1)})));unsafeClose(){this.isOpen=!1}close=n.sync(()=>{this.isOpen=!1});whenOpen=e=>n.zipRight(this.await,e)}let ec=e=>new eu(e??!1),ed=e=>n.sync(()=>ec(e)),ep=e=>eb(e,o.fiberAwaitAll),ef=(0,t.dual)(2,(e,t)=>n.map(eh(e,t),e=>e[0])),eh=(0,t.dual)(2,(e,t)=>{let r=c.decode(t);return n.flatMap(n.context(),t=>n.map(eU(g.none()),i=>[n.provideContext(eg(e,r,i),t),ey(i)]))}),em=(e,r,i)=>{let a=c.toMillis(c.decode(r));return(0,t.pipe)(n.deferredMake(),n.tap(t=>n.intoDeferred(e,t)),n.map(e=>g.some([i+a,e])))},eg=(e,r,i)=>n.uninterruptibleMask(a=>(0,t.pipe)(G.clockWith(e=>e.currentTimeMillis),n.flatMap(t=>eW(i,i=>{switch(i._tag){case"None":return g.some(em(e,r,t));case"Some":{let[n]=i.value;return n-t<=0?g.some(em(e,r,t)):g.none()}}})),n.flatMap(e=>g.isNone(e)?n.dieMessage("BUG: Effect.cachedInvalidate - please report an issue at https://github.com/Effect-TS/effect/issues"):a(n.deferredAwait(e.value[1]))))),ey=e=>en.set(e,g.none()),eS=(0,t.dual)(2,(e,t)=>eb(e,e=>t(o.fiberAll(e)))),eb=(0,t.dual)(2,(e,r)=>n.flatMap(ea.track,i=>(0,t.pipe)(eF(e,i),o.ensuring(n.flatMap(i.value,r))))),ev=(0,t.dual)(e=>h.isIterable(e[0]),(e,t)=>t?.discard?n.forEachSequentialDiscard(e,o.fork):n.map(n.forEachSequential(e,o.fork),o.fiberAll)),eE=(0,t.dual)(2,(e,t)=>n.withFiberRuntime((r,i)=>{let a=o.unsafeFork(e,r,i.runtimeFlags,ei.globalScope);if("Open"===t.state._tag){let e={};t.state.finalizers.set(e,()=>n.fiberIdWith(e=>J.equals(e,a.id())?n.void:n.asVoid(n.interruptFiber(a)))),a.addObserver(()=>{"Closed"!==t.state._tag&&t.state.finalizers.delete(e)})}else a.unsafeInterruptAsFork(r.id());return n.succeed(a)})),ew=e=>o.scopeWith(t=>eE(e,t)),ek=e=>er.join(e),eI=e=>n.suspend(()=>n.flatMap(e,er.join)),eT=Symbol.for("effect/Effect/memoizeFunction.key");class ex{a;eq;[eT]=eT;constructor(e,t){this.a=e,this.eq=t}[J.symbol](e){if(h.hasProperty(e,eT))if(this.eq)return this.eq(this.a,e.a);else return J.equals(this.a,e.a);return!1}[Y.symbol](){return this.eq?0:Y.cached(this,Y.hash(this.a))}}let eC=(e,r)=>(0,t.pipe)(n.sync(()=>X.empty()),n.flatMap(eU),n.map(i=>a=>(0,t.pipe)(i.modifyEffect(i=>{let s=(0,t.pipe)(i,X.get(new ex(a,r)));return g.isNone(s)?(0,t.pipe)(n.deferredMake(),n.tap(r=>(0,t.pipe)(G.diffFiberRefs(e(a)),n.intoDeferred(r),o.fork)),n.map(e=>[e,(0,t.pipe)(i,X.set(new ex(a,r),e))])):n.succeed([s.value,i])}),n.flatMap(n.deferredAwait),n.flatMap(e=>{let[r,i]=e;return(0,t.pipe)(G.patchFiberRefs(r),n.as(i))})))),eR=(0,t.dual)(2,(e,r)=>(0,t.pipe)(n.exit(e),o.race(n.exit(r)),e=>n.flatten(e))),eF=(0,t.dual)(2,(e,t)=>n.fiberRefLocallyWith(o.currentSupervisor,e=>e.zip(t))(e)),eA=(0,t.dual)(2,(e,t)=>eO(e,{onTimeout:()=>n.timeoutExceptionFromDuration(t),duration:t})),eO=(0,t.dual)(2,(e,t)=>{let{duration:r,onTimeout:i}=t;return n.flatten(eD(e,{onTimeout:()=>n.failSync(i),onSuccess:n.succeed,duration:r}))}),e_=(0,t.dual)(2,(e,t)=>{let{duration:r,onTimeout:i}=t;return n.flatten(eD(e,{onTimeout:()=>n.failCauseSync(i),onSuccess:n.succeed,duration:r}))}),eM=(0,t.dual)(2,(e,t)=>eD(e,{duration:t,onSuccess:g.some,onTimeout:g.none})),eD=(0,t.dual)(2,(e,t)=>{let{duration:r,onSuccess:i,onTimeout:a}=t;return n.fiberIdWith(t=>n.uninterruptibleMask(s=>o.raceFibersWith(s(e),n.interruptible(G.sleep(r)),{onSelfWin:(e,r)=>n.flatMap(e.await,a=>"Success"===a._tag?n.flatMap(e.inheritAll,()=>n.as(n.interruptAsFiber(r,t),i(a.value))):n.flatMap(n.interruptAsFiber(r,t),()=>n.exitFailCause(a.cause))),onOtherWin:(e,r)=>n.flatMap(e.await,i=>"Success"===i._tag?n.flatMap(e.inheritAll,()=>n.as(n.interruptAsFiber(r,t),a())):n.flatMap(n.interruptAsFiber(r,t),()=>n.exitFailCause(i.cause))),otherScope:ei.globalScope})))}),eN=Symbol.for("effect/Ref/SynchronizedRef"),eP={_A:e=>e};class eL extends K.Class{ref;withLock;[eN]=eP;[en.RefTypeId]=en.refVariance;[ee.TypeId]=ee.TypeId;constructor(e,t){super(),this.ref=e,this.withLock=t,this.get=en.get(this.ref)}get;commit(){return this.get}modify(e){return this.modifyEffect(t=>n.succeed(e(t)))}modifyEffect(e){return this.withLock((0,t.pipe)(n.flatMap(en.get(this.ref),e),n.flatMap(e=>{let[t,r]=e;return n.as(en.set(this.ref,r),t)})))}}let eU=e=>n.sync(()=>ez(e)),ez=e=>new eL(en.unsafeMake(e),eo(1).withPermits(1)),eW=(0,t.dual)(2,(e,t)=>e.modifyEffect(e=>{let r=t(e);switch(r._tag){case"None":return n.succeed([e,e]);case"Some":return n.map(r.value,e=>[e,e])}})),eB=(0,t.dual)(2,(e,t)=>ej(e,t,(e,t)=>[e,t])),eq=(0,t.dual)(2,(e,t)=>ej(e,t,(e,t)=>e)),e$=(0,t.dual)(2,(e,t)=>ej(e,t,(e,t)=>t)),ej=(0,t.dual)(3,(e,i,a)=>({...K.CommitPrototype,commit(){return er.join(this)},[er.FiberTypeId]:er.fiberVariance,id:()=>(0,t.pipe)(e.id(),Q.getOrElse(i.id())),await:(0,t.pipe)(e.await,n.flatten,o.zipWithOptions(n.flatten(i.await),a,{concurrent:!0}),n.exit),children:e.children,inheritAll:n.zipRight(i.inheritAll,e.inheritAll),poll:n.zipWith(e.poll,i.poll,(e,i)=>(0,t.pipe)(e,g.flatMap(e=>(0,t.pipe)(i,g.map(t=>Z.zipWith(e,t,{onSuccess:a,onFailure:r.parallel})))))),interruptAsFork:t=>n.zipRight(e.interruptAsFork(t),i.interruptAsFork(t)),pipe(){return(0,f.pipeArguments)(this,arguments)}})),eV=(0,t.dual)(e=>n.isEffect(e[0]),(e,t,r)=>n.flatMap(e,e=>o.all(t(e),r).pipe(n.map(t=>Object.assign({},e,t)))));e.s(["SynchronizedTypeId",0,eN,"awaitAllChildren",0,ep,"bindAll",0,eV,"cached",0,ef,"cachedFunction",0,eC,"cachedInvalidateWithTTL",0,eh,"ensuringChild",0,eS,"ensuringChildren",0,eb,"forkAll",0,ev,"forkIn",0,eE,"forkScoped",0,ew,"fromFiber",0,ek,"fromFiberEffect",0,eI,"makeLatch",0,ed,"makeSemaphore",0,el,"makeSynchronized",0,eU,"raceFirst",0,eR,"supervised",0,eF,"synchronizedVariance",0,eP,"timeout",0,eA,"timeoutFail",0,eO,"timeoutFailCause",0,e_,"timeoutOption",0,eM,"timeoutTo",0,eD,"unsafeMakeLatch",0,ec,"unsafeMakeSemaphore",0,eo,"unsafeMakeSynchronized",0,ez,"updateSomeAndGetEffectSynchronized",0,eW,"zipFiber",0,eB,"zipLeftFiber",0,eq,"zipRightFiber",0,e$,"zipWithFiber",0,ej],4026828);let eH=Symbol.for("effect/ManagedRuntime");e.s(["TypeId",0,eH],3674254);var eG=e.i(6187448);let eK="Fresh",eJ="ProvideMerge";er.FiberTypeId,er.RuntimeFiberTypeId,er.Order,er.isFiber,er.isRuntimeFiber,er.id;let eZ=er._await;o.fiberAwaitAll,er.children,o.fiberAll,er.done,er.dump,er.dumpAll,er.fail,er.failCause,er.fromEffect;let eQ=er.getCurrentFiber,eY=er.inheritAll,eX=n.interruptFiber;er.interrupted;let e0=n.interruptAsFiber;er.interruptAsFork,er.interruptAll;let e1=er.interruptAllAs;o.fiberInterruptFork;let e2=er.join;o.fiberJoinAll,er.map,er.mapEffect,er.mapFiber,er.match,er.never,er.orElse,er.orElseEither;let e5=er.poll;er.pretty,er.roots,er.unsafeRoots,o.fiberScoped,er.status,er.succeed,er.void,e.s(["await",0,eZ,"getCurrentFiber",0,eQ,"inheritAll",0,eY,"interrupt",0,eX,"interruptAllAs",0,e1,"interruptAs",0,e0,"join",0,e2,"poll",0,e5],6028004);var e3=e.i(9674368),e8=e.i(2873450),e4=e.i(592224),e6=e.i(1191948);let e9=e=>function(){if(1==arguments.length){let t=arguments[0];return function(r){for(var i=arguments.length,n=Array(i>1?i-1:0),a=1;a<i;a++)n[a-1]=arguments[a];return e(t,r,...n)}}return e.apply(this,arguments)},e7=e9((e,t,r)=>{let i=Q.unsafeMake(),a=[[n.currentContext,[[i,e.context]]]];r?.scheduler&&a.push([et.currentScheduler,[[i,r.scheduler]]]);let s=e3.updateManyAs(e.fiberRefs,{entries:a,forkAs:i});r?.updateRefs&&(s=r.updateRefs(s,i));let l=new o.FiberRuntime(i,s,e.runtimeFlags),u=t;r?.scope&&(u=n.flatMap(V(r.scope,e4.sequential),e=>n.zipRight(n.scopeAddFinalizer(e,n.fiberIdWith(e=>(0,J.equals)(e,l.id())?n.void:n.interruptAsFiber(l,e))),n.onExit(t,t=>$(e,t)))));let c=l.currentSupervisor;return c!==ea.none&&(c.onStart(e.context,u,g.none(),l),l.addObserver(e=>c.onEnd(e,l))),ei.globalScope.add(e.runtimeFlags,l),r?.immediate===!1?l.resume(u):l.start(u),l}),te=e9(function(e,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=e7(e,r,i);return i.onExit&&n.addObserver(e=>{i.onExit(e)}),(r,i)=>te(e)((0,t.pipe)(n,e0(r??Q.none)),{...i,onExit:i?.onExit?e=>i.onExit(Z.flatten(e)):void 0})}),tt=e9((e,t)=>{let r=tl(e)(t);if("Failure"===r._tag)throw ts(r.effect_instruction_i0);return r.effect_instruction_i0});class tr extends Error{fiber;_tag="AsyncFiberException";constructor(e){super(`Fiber #${e.id().id} cannot be resolved synchronously. This is caused by using runSync on an effect that performs async work`),this.fiber=e,this.name=this._tag,this.stack=this.message}}let ti=Symbol.for("effect/Runtime/FiberFailure"),tn=Symbol.for("effect/Runtime/FiberFailure/Cause");class ta extends Error{[ti];[tn];constructor(e){const t=r.prettyErrors(e)[0];super(t?.message||"An error has occurred"),this[ti]=ti,this[tn]=e,this.name=t?`(FiberFailure) ${t.name}`:"FiberFailure",t?.stack&&(this.stack=t.stack)}toJSON(){return{_id:"FiberFailure",cause:this[tn].toJSON()}}toString(){return"(FiberFailure) "+r.pretty(this[tn],{renderErrorCause:!0})}[e8.NodeInspectSymbol](){return this.toString()}}let ts=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new ta(e);return Error.stackTraceLimit=t,r},to=e=>{switch(e._op){case"Failure":case"Success":return e;case"Left":return n.exitFail(e.left);case"Right":return n.exitSucceed(e.right);case"Some":return n.exitSucceed(e.value);case"None":return n.exitFail(n.NoSuchElementException())}},tl=e9((e,t)=>{let r,i,a=to(t);if(a)return a;let s=new et.SyncScheduler,o=e7(e)(t,{scheduler:s});s.flush();let l=o.unsafePoll();return l?l:n.exitDie(n.capture((r=Error.stackTraceLimit,Error.stackTraceLimit=0,i=new tr(o),Error.stackTraceLimit=r,i),n.currentSpanFromFiber(o)))}),tu=e9((e,t,r)=>tc(e,t,r).then(e=>{switch(e._tag){case eG.OP_SUCCESS:return e.effect_instruction_i0;case eG.OP_FAILURE:throw ts(e.effect_instruction_i0)}})),tc=e9((e,t,r)=>new Promise(i=>{let n=to(t);n&&i(n);let a=e7(e)(t);a.addObserver(e=>{i(e)}),r?.signal!==void 0&&(r.signal.aborted?a.unsafeInterruptAsFork(a.id()):r.signal.addEventListener("abort",()=>{a.unsafeInterruptAsFork(a.id())},{once:!0}))}));class td{context;runtimeFlags;fiberRefs;constructor(e,t,r){this.context=e,this.runtimeFlags=t,this.fiberRefs=r}pipe(){return(0,f.pipeArguments)(this,arguments)}}let tp=e=>new td(e.context,e.runtimeFlags,e.fiberRefs),tf=()=>n.withFiberRuntime((e,t)=>n.succeed(new td(e.getFiberRef(n.currentContext),t.runtimeFlags,e.getFiberRefs()))),th=e6.make(e6.Interruption,e6.CooperativeYielding,e6.RuntimeMetrics),tm=tp({context:i.empty(),runtimeFlags:th,fiberRefs:e3.empty()}),tg=(0,t.dual)(2,(e,t)=>tp({context:e.context,runtimeFlags:t(e.runtimeFlags),fiberRefs:e.fiberRefs})),ty=(0,t.dual)(2,(e,t)=>tg(e,e6.disable(t))),tS=(0,t.dual)(2,(e,t)=>tg(e,e6.enable(t))),tb=(0,t.dual)(2,(e,t)=>tp({context:t(e.context),runtimeFlags:e.runtimeFlags,fiberRefs:e.fiberRefs})),tv=(0,t.dual)(3,(e,t,r)=>tb(e,i.add(t,r))),tE=(0,t.dual)(2,(e,t)=>tp({context:e.context,runtimeFlags:e.runtimeFlags,fiberRefs:t(e.fiberRefs)})),tw=(0,t.dual)(3,(e,t,r)=>tE(e,e3.updateAs({fiberId:Q.none,fiberRef:t,value:r}))),tk=(0,t.dual)(2,(e,t)=>tE(e,e3.delete(t))),tI=te(tm),tT=e7(tm),tx=tu(tm),tC=tc(tm),tR=tt(tm),tF=tl(tm),tA=e=>n.suspend(()=>{let t;return n.flatMap(n.deferredMake(),r=>n.flatMap(tf(),i=>n.uninterruptibleMask(a=>n.zipRight(o.fork(a(n.matchCauseEffect(e(e=>te(i)(n.intoDeferred(e,r))),{onFailure:e=>n.deferredFailCause(r,e),onSuccess:e=>(t=e,n.void)}))),a(n.onInterrupt(n.deferredAwait(r),()=>t??n.void))))))});e.s(["FiberFailureCauseId",0,tn,"asyncEffect",0,tA,"defaultRuntime",0,tm,"defaultRuntimeFlags",0,th,"deleteFiberRef",0,tk,"disableRuntimeFlag",0,ty,"enableRuntimeFlag",0,tS,"fiberFailure",0,ts,"isAsyncFiberException",0,e=>h.isTagged(e,"AsyncFiberException")&&"fiber"in e,"isFiberFailure",0,e=>h.hasProperty(e,ti),"make",0,tp,"provideService",0,tv,"runtime",0,tf,"setFiberRef",0,tw,"unsafeFork",0,e7,"unsafeForkEffect",0,tT,"unsafeRunCallback",0,te,"unsafeRunEffect",0,tI,"unsafeRunPromise",0,tu,"unsafeRunPromiseEffect",0,tx,"unsafeRunPromiseExit",0,tc,"unsafeRunPromiseExitEffect",0,tC,"unsafeRunSync",0,tt,"unsafeRunSyncEffect",0,tR,"unsafeRunSyncExit",0,tl,"unsafeRunSyncExitEffect",0,tF,"updateContext",0,tb,"updateFiberRefs",0,tE,"updateRuntimeFlags",0,tg],210165);let tO=(0,t.dual)(2,(e,t)=>e.modifyEffect(e=>n.map(t(e),t=>[e,t]))),t_=(0,t.dual)(2,(e,t)=>e.modifyEffect(e=>{let r=t(e);switch(r._tag){case"None":return n.succeed([e,e]);case"Some":return n.map(r.value,t=>[e,t])}})),tM=(0,t.dual)(2,(e,t)=>e.modify(t)),tD=(0,t.dual)(2,(e,t)=>e.modifyEffect(t)),tN=(0,t.dual)(3,(e,r,i)=>e.modifyEffect(e=>(0,t.pipe)(i(e),g.getOrElse(()=>n.succeed([r,e]))))),tP=(0,t.dual)(2,(e,t)=>e.modifyEffect(e=>n.map(t(e),e=>[void 0,e]))),tL=(0,t.dual)(2,(e,t)=>e.modifyEffect(e=>n.map(t(e),e=>[e,e]))),tU=(0,t.dual)(2,(e,t)=>e.modifyEffect(e=>{let r=t(e);switch(r._tag){case"None":return n.succeed([void 0,e]);case"Some":return n.map(r.value,e=>[void 0,e])}}));e.s(["getAndUpdateEffect",0,tO,"getAndUpdateSomeEffect",0,t_,"modify",0,tM,"modifyEffect",0,tD,"modifySomeEffect",0,tN,"updateAndGetEffect",0,tL,"updateEffect",0,tP,"updateSomeEffect",0,tU],5523614);var tz=e.i(3427637);let tW=Symbol.for("effect/Layer"),tB={[tW]:{_RIn:e=>e,_E:e=>e,_ROut:e=>e},pipe(){return(0,f.pipeArguments)(this,arguments)}},tq=Symbol.for("effect/Layer/MemoMap"),t$=i.Reference()("effect/Layer/CurrentMemoMap",{defaultValue:()=>tK()}),tj=e=>(0,h.hasProperty)(e,tW),tV=e=>e._op_layer===eK;class tH{ref;[tq];constructor(e){this.ref=e,this[tq]=tq}getOrElseMemoize(e,r){return(0,t.pipe)(tD(this.ref,i=>{let a=i.get(e);if(void 0!==a){let[e,s]=a,o=(0,t.pipe)(e,n.flatMap(e=>{let[r,i]=e;return(0,t.pipe)(G.patchFiberRefs(r),n.as(i))}),n.onExit(n.exitMatch({onFailure:()=>n.void,onSuccess:()=>n.scopeAddFinalizerExit(r,s)})));return n.succeed([o,i])}return(0,t.pipe)(en.make(0),n.flatMap(a=>(0,t.pipe)(n.deferredMake(),n.flatMap(s=>(0,t.pipe)(en.make(()=>n.void),n.map(l=>{let u=n.uninterruptibleMask(u=>(0,t.pipe)(o.scopeMake(),n.flatMap(o=>(0,t.pipe)(u(n.flatMap(tQ(e,o,!0),e=>G.diffFiberRefs(e(this)))),n.exit,n.flatMap(u=>{switch(u._tag){case eG.OP_FAILURE:return(0,t.pipe)(n.deferredFailCause(s,u.effect_instruction_i0),n.zipRight(n.scopeClose(o,u)),n.zipRight(n.failCause(u.effect_instruction_i0)));case eG.OP_SUCCESS:return(0,t.pipe)(en.set(l,e=>(0,t.pipe)(n.scopeClose(o,e),n.whenEffect(en.modify(a,e=>[1===e,e-1])),n.asVoid)),n.zipRight(en.update(a,e=>e+1)),n.zipRight(n.scopeAddFinalizerExit(r,r=>(0,t.pipe)(n.sync(()=>i.delete(e)),n.zipRight(en.get(l)),n.flatMap(e=>e(r))))),n.zipRight(n.deferredSucceed(s,u.effect_instruction_i0)),n.as(u.effect_instruction_i0[1]))}}))))),c=[(0,t.pipe)(n.deferredAwait(s),n.onExit(n.exitMatchEffect({onFailure:()=>n.void,onSuccess:()=>en.update(a,e=>e+1)}))),e=>(0,t.pipe)(en.get(l),n.flatMap(t=>t(e)))];return[u,tV(e)?i:i.set(e,c)]}))))))}),n.flatten)}}let tG=n.suspend(()=>n.map(eU(new Map),e=>new tH(e))),tK=()=>new tH(ez(new Map)),tJ=(0,t.dual)(2,(e,t)=>n.flatMap(tG,r=>tZ(e,r,t))),tZ=(0,t.dual)(3,(e,t,r)=>n.flatMap(tQ(e,r),e=>G.provideService(e(t),t$,t))),tQ=function(e,r){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];switch(e._op_layer){case"Locally":return n.sync(()=>t=>e.f(t.getOrElseMemoize(e.self,r)));case"ExtendScope":return n.sync(()=>t=>o.scopeWith(r=>t.getOrElseMemoize(e.layer,r)));case"Fold":return n.sync(()=>i=>(0,t.pipe)(i.getOrElseMemoize(e.layer,r),n.matchCauseEffect({onFailure:t=>i.getOrElseMemoize(e.failureK(t),r),onSuccess:t=>i.getOrElseMemoize(e.successK(t),r)})));case"Fresh":return n.sync(()=>i=>(0,t.pipe)(e.layer,tJ(r)));case"FromEffect":return i?n.sync(()=>t=>e.effect):n.sync(()=>t=>t.getOrElseMemoize(e,r));case"Provide":return n.sync(()=>i=>(0,t.pipe)(i.getOrElseMemoize(e.first,r),n.flatMap(a=>(0,t.pipe)(i.getOrElseMemoize(e.second,r),n.provideContext(a)))));case"Scoped":return i?n.sync(()=>t=>o.scopeExtend(e.effect,r)):n.sync(()=>t=>t.getOrElseMemoize(e,r));case"Suspend":return n.sync(()=>t=>t.getOrElseMemoize(e.evaluate(),r));case"ProvideMerge":return n.sync(()=>i=>(0,t.pipe)(i.getOrElseMemoize(e.first,r),n.zipWith(i.getOrElseMemoize(e.second,r),e.zipK)));case"ZipWith":return n.sync(()=>i=>(0,t.pipe)(i.getOrElseMemoize(e.first,r),o.zipWithOptions(i.getOrElseMemoize(e.second,r),e.zipK,{concurrent:!0})))}},tY=(0,t.dual)(2,(e,t)=>ru(e,{onFailure:t,onSuccess:rw})),tX=(0,t.dual)(2,(e,t)=>rl(e,{onFailure:t,onSuccess:rw})),t0=e=>t3(l.die(e)),t1=()=>re(n.context()),t2=e=>t3(l.fail(e)),t5=e=>t8(()=>l.fail(e())),t3=e=>re(n.failCause(e)),t8=e=>re(n.failCauseSync(e)),t4=(0,t.dual)(2,(e,t)=>ru(e,{onFailure:t2,onSuccess:t})),t6=(0,t.dual)(2,(e,t)=>t4(e,i.get(t))),t9=e=>{let t=Object.create(tB);return t._op_layer=eK,t.layer=e,t},t7=(0,t.dual)(2,(e,t)=>{let r=i.isTag(e),a=r?e:t,s=r?t:e;return re(n.map(s,e=>i.make(a,e)))});function re(e){let t=Object.create(tB);return t._op_layer="FromEffect",t.effect=e,t}let rt=(0,t.dual)(3,(e,t,r)=>rr(e,n.fiberRefLocally(t,r))),rr=(0,t.dual)(2,(e,t)=>{let r=Object.create(tB);return r._op_layer="Locally",r.self=e,r.f=t,r}),ri=(0,t.dual)(3,(e,t,r)=>rr(e,n.fiberRefLocallyWith(t,r))),rn=(e,r)=>rE(e,new Proxy({...r},{get(t,r,i){if(r in t)return t[r];let n=Error.stackTraceLimit;Error.stackTraceLimit=2;let a=Error(`${e.key}: Unimplemented method "${r.toString()}"`);return Error.stackTraceLimit=n,a.name="UnimplementedError",ra(a)},has:t.constTrue})),ra=e=>{let t=n.die(e);function r(){return t}return Object.assign(r,t),Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r},rs=(0,t.dual)(2,(e,t)=>t4(e,e=>rw(t(e)))),ro=(0,t.dual)(2,(e,t)=>tY(e,e=>t5(()=>t(e)))),rl=(0,t.dual)(2,(e,t)=>{let{onFailure:r,onSuccess:i}=t,n=Object.create(tB);return n._op_layer="Fold",n.layer=e,n.failureK=r,n.successK=i,n}),ru=(0,t.dual)(2,(e,t)=>{let{onFailure:r,onSuccess:i}=t;return rl(e,{onFailure:e=>{let t=l.failureOrCause(e);switch(t._tag){case"Left":return r(t.left);case"Right":return t3(t.right)}},onSuccess:i})}),rc=(0,t.dual)(2,(e,t)=>r_(e,t,(e,t)=>i.merge(e,t))),rd=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let i=t[0];for(let e=1;e<t.length;e++)i=rc(i,t[e]);return i},rp=(0,t.dual)(2,(e,t)=>tY(e,t)),rf=(0,t.dual)(4,(e,t,r,n)=>rs(e,e=>i.make(r,n(i.unsafeGet(e,t))))),rh=(0,t.dual)(2,(e,r)=>rI(()=>{let n=i.GenericTag("effect/Layer/retry/{ state: unknown }");return(0,t.pipe)(rE(n,{state:r.initial}),t4(a=>rm(e,r,n,(0,t.pipe)(a,i.get(n)).state)))})),rm=(e,r,n,a)=>(0,t.pipe)(e,tY(s=>(0,t.pipe)(rg(r,n,s,a),t4(a=>t9(rm(e,r,n,(0,t.pipe)(a,i.get(n)).state)))))),rg=(e,r,i,a)=>t7(r,(0,t.pipe)(u.currentTimeMillis,n.flatMap(r=>(0,t.pipe)(e.step(r,i,a),n.flatMap(e=>{let[a,s,o]=e;return o._tag===P?n.fail(i):(0,t.pipe)(u.sleep(c.millis(O(o.intervals)-r)),n.as({state:a}))}))))),ry=(0,t.dual)(2,(e,t)=>{let r=i.isTag(e),a=r?e:t,s=r?t:e;return rb(n.map(s,e=>i.make(a,e)))}),rS=e=>rb((0,t.pipe)(e,n.as(i.empty()))),rb=e=>{let t=Object.create(tB);return t._op_layer="Scoped",t.effect=e,t},rv=rb(n.map(o.acquireRelease(o.scopeMake(),(e,t)=>e.close(t)),e=>i.make(W,e))),rE=(0,t.dual)(2,(e,t)=>{let r=i.isTag(e),a=r?e:t,s=r?t:e;return re(n.succeed(i.make(a,s)))}),rw=e=>re(n.succeed(e)),rk=rw(i.empty()),rI=e=>{let t=Object.create(tB);return t._op_layer="Suspend",t.evaluate=e,t},rT=(0,t.dual)(2,(e,t)=>{let r=i.isTag(e),a=r?e:t,s=r?t:e;return re(n.sync(()=>i.make(a,s())))}),rx=(0,t.dual)(2,(e,t)=>t4(e,e=>re(n.as(t(e),e)))),rC=(0,t.dual)(2,(e,t)=>tY(e,e=>re(n.flatMap(t(e),()=>n.fail(e))))),rR=(0,t.dual)(2,(e,t)=>tX(e,e=>re(n.flatMap(t(e),()=>n.failCause(e))))),rF=(0,t.dual)(2,(e,r)=>n.flatMap(o.scopeWith(t=>tZ(e,r,t)),e=>(0,t.pipe)(tf(),n.provideContext(e)))),rA=(0,t.dual)(2,(e,r)=>rI(()=>{let n=Object.create(tB);return n._op_layer="Provide",n.first=Object.create(tB,{_op_layer:{value:eJ,enumerable:!0},first:{value:t1(),enumerable:!0},second:{value:Array.isArray(r)?rd(...r):r},zipK:{value:(e,r)=>(0,t.pipe)(e,i.merge(r))}}),n.second=e,n})),rO=(0,t.dual)(2,(e,r)=>{let n=Object.create(tB);return n._op_layer=eJ,n.first=r,n.second=rA(e,r),n.zipK=(e,r)=>(0,t.pipe)(e,i.merge(r)),n}),r_=(0,t.dual)(3,(e,t,r)=>rI(()=>{let i=Object.create(tB);return i._op_layer="ZipWith",i.first=e,i.second=t,i.zipK=r,i})),rM=e=>{let t=i.GenericTag("effect/Layer/unwrapScoped/Layer.Layer<R1, E1, A>");return t4(ry(t,e),e=>i.get(e,t))},rD=(0,t.dual)(e=>tj(e[0]),function(){let e=arguments;return ri(e[0],n.currentLogAnnotations,"string"==typeof e[1]?p.set(e[1],e[2]):t=>Object.entries(e[1]).reduce((e,t)=>{let[r,i]=t;return p.set(e,r,i)},t))}),rN=(0,t.dual)(e=>tj(e[0]),function(){let e=arguments;return ri(e[0],n.currentTracerSpanAnnotations,"string"==typeof e[1]?p.set(e[1],e[2]):t=>Object.entries(e[1]).reduce((e,t)=>{let[r,i]=t;return p.set(e,r,i)},t))}),rP=(0,t.dual)(2,(e,t)=>rA(e,rw(i.make(tz.spanTag,t)))),rL=(0,t.dual)(2,(e,t)=>o.scopedWith(r=>n.flatMap(tJ(t,r),t=>n.provideSomeContext(e,t)))),rU=(0,t.dual)(2,(e,t)=>{let r=d.diff(tm.fiberRefs,t.fiberRefs),a=e6.diff(tm.runtimeFlags,t.runtimeFlags);return n.uninterruptibleMask(s=>n.withFiberRuntime(l=>{let u=l.getFiberRef(n.currentContext),c=l.getFiberRefs(),p=d.patch(l.id(),c)(r),f=l.currentRuntimeFlags,h=e6.patch(a)(f),m=d.diff(p,c),g=e6.diff(h,f);return l.setFiberRefs(p),l.currentRuntimeFlags=h,o.ensuring(n.provideSomeContext(s(e),i.merge(u,t.context)),n.withFiberRuntime(e=>(e.setFiberRefs(d.patch(e.id(),e.getFiberRefs())(m)),e.currentRuntimeFlags=e6.patch(g)(e.currentRuntimeFlags),n.void)))}))}),rz=(0,t.dual)(2,(e,t)=>Array.isArray(t)?rL(e,rd(...t)):tj(t)?rL(e,t):i.isContext(t)?n.provideSomeContext(e,t):eH in t?n.flatMap(t.runtimeEffect,t=>rU(e,t)):rU(e,t));e.s(["CurrentMemoMap",0,t$,"LayerTypeId",0,tW,"MemoMapTypeId",0,tq,"annotateLogs",0,rD,"annotateSpans",0,rN,"build",0,e=>o.scopeWith(t=>tJ(e,t)),"buildWithMemoMap",0,tZ,"buildWithScope",0,tJ,"catchAll",0,tY,"catchAllCause",0,tX,"context",0,t1,"die",0,t0,"dieSync",0,e=>t8(()=>l.die(e())),"discard",0,e=>rs(e,()=>i.empty()),"effect_provide",0,rz,"empty",0,rk,"extendScope",0,e=>{let t=Object.create(tB);return t._op_layer="ExtendScope",t.layer=e,t},"fail",0,t2,"failCause",0,t3,"failCauseSync",0,t8,"failSync",0,t5,"fiberRefLocally",0,rt,"fiberRefLocallyScoped",0,(e,t)=>rS(o.fiberRefLocallyScoped(e,t)),"fiberRefLocallyScopedWith",0,(e,t)=>rS(o.fiberRefLocallyScopedWith(e,t)),"fiberRefLocallyWith",0,ri,"flatMap",0,t4,"flatten",0,t6,"fresh",0,t9,"fromEffect",0,t7,"fromEffectContext",0,re,"fromEffectDiscard",0,e=>re(n.map(e,()=>i.empty())),"fromFunction",0,(e,t,r)=>re(n.map(e,e=>i.make(t,r(e)))),"isFresh",0,tV,"isLayer",0,tj,"launch",0,e=>o.scopedEffect(n.zipRight(o.scopeWith(r=>(0,t.pipe)(e,tJ(r))),n.never)),"locallyEffect",0,rr,"makeMemoMap",0,tG,"map",0,rs,"mapError",0,ro,"match",0,ru,"matchCause",0,rl,"memoize",0,e=>o.scopeWith(t=>n.map(G.memoize(tJ(e,t)),re)),"merge",0,rc,"mergeAll",0,rd,"mock",0,function(){return 1==arguments.length?e=>rn(arguments[0],e):rn(arguments[0],arguments[1])},"orDie",0,e=>tY(e,e=>t0(e)),"orElse",0,rp,"passthrough",0,e=>rc(t1(),e),"project",0,rf,"provide",0,rA,"provideMerge",0,rO,"retry",0,rh,"scope",0,rv,"scoped",0,ry,"scopedContext",0,rb,"scopedDiscard",0,rS,"service",0,e=>t7(e,e),"succeed",0,rE,"succeedContext",0,rw,"suspend",0,rI,"sync",0,rT,"syncContext",0,e=>re(n.sync(e)),"tap",0,rx,"tapError",0,rC,"tapErrorCause",0,rR,"toRuntime",0,e=>(0,t.pipe)(o.scopeWith(t=>tJ(e,t)),n.flatMap(e=>(0,t.pipe)(tf(),n.provideContext(e)))),"toRuntimeWithMemoMap",0,rF,"unsafeMakeMemoMap",0,tK,"unwrapEffect",0,e=>{let t=i.GenericTag("effect/Layer/unwrapEffect/Layer.Layer<R1, E1, A>");return t4(t7(t,e),e=>i.get(e,t))},"unwrapScoped",0,rM,"withParentSpan",0,rP,"withSpan",0,function(){let e="string"!=typeof arguments[0],t=e?arguments[1]:arguments[0],r=tz.addSpanStackTrace(e?arguments[2]:arguments[1]);if(e){let e=arguments[0];return rM(n.map(r?.onEnd?n.tap(o.makeSpanScoped(t,r),e=>o.addFinalizer(t=>r.onEnd(e,t))):o.makeSpanScoped(t,r),t=>rP(e,t)))}return e=>rM(n.map(r?.onEnd?n.tap(o.makeSpanScoped(t,r),e=>o.addFinalizer(t=>r.onEnd(e,t))):o.makeSpanScoped(t,r),t=>rP(e,t)))},"zipWith",0,r_],2067266);let rW=n.map(n.fiberRefGet(a.currentServices),i.get(s.consoleTag)),rB=(0,t.dual)(2,(e,t)=>n.fiberRefLocallyWith(e,a.currentServices,i.add(s.consoleTag,t)));var rq=e.i(1200317),r$=e.i(1331084),rj=e.i(5283034),rV=e.i(5305881),rH=e.i(138042),rG=e.i(9159985),rK=e.i(6712028);let rJ=Symbol.for("effect/DateTime"),rZ=Symbol.for("effect/DateTime/TimeZone"),rQ={[rJ]:rJ,pipe(){return(0,f.pipeArguments)(this,arguments)},[e8.NodeInspectSymbol](){return this.toString()},toJSON(){return iL(this).toJSON()}},rY={...rQ,_tag:"Utc",[Y.symbol](){return Y.cached(this,Y.number(this.epochMillis))},[J.symbol](e){return r3(e)&&"Utc"===e._tag&&this.epochMillis===e.epochMillis},toString(){return`DateTime.Utc(${iL(this).toJSON()})`}},rX={...rQ,_tag:"Zoned",[Y.symbol](){return(0,t.pipe)(Y.number(this.epochMillis),Y.combine(Y.hash(this.zone)),Y.cached(this))},[J.symbol](e){return r3(e)&&"Zoned"===e._tag&&this.epochMillis===e.epochMillis&&J.equals(this.zone,e.zone)},toString(){return`DateTime.Zoned(${np(this)})`}},r0={[rZ]:rZ,[e8.NodeInspectSymbol](){return this.toString()}},r1={...r0,_tag:"Named",[Y.symbol](){return Y.cached(this,Y.string(`Named:${this.id}`))},[J.symbol](e){return r4(e)&&"Named"===e._tag&&this.id===e.id},toString(){return`TimeZone.Named(${this.id})`},toJSON(){return{_id:"TimeZone",_tag:"Named",id:this.id}}},r2={...r0,_tag:"Offset",[Y.symbol](){return Y.cached(this,Y.string(`Offset:${this.offset}`))},[J.symbol](e){return r4(e)&&"Offset"===e._tag&&this.offset===e.offset},toString(){return`TimeZone.Offset(${iW(this.offset)})`},toJSON(){return{_id:"TimeZone",_tag:"Offset",offset:this.offset}}},r5=(e,t,r)=>{let i=Object.create(rX);return i.epochMillis=e,i.zone=t,Object.defineProperty(i,"partsUtc",{value:r,enumerable:!1,writable:!0}),Object.defineProperty(i,"adjustedEpochMillis",{value:void 0,enumerable:!1,writable:!0}),Object.defineProperty(i,"partsAdjusted",{value:void 0,enumerable:!1,writable:!0}),i},r3=e=>h.hasProperty(e,rJ),r8=e=>r3(e[0]),r4=e=>h.hasProperty(e,rZ),r6=e=>r4(e)&&"Named"===e._tag,r9=e=>"Zoned"===e._tag,r7=rH.make((e,t)=>e.epochMillis===t.epochMillis),ie=rK.make((e,t)=>e.epochMillis<t.epochMillis?-1:+(e.epochMillis>t.epochMillis)),it=rK.clamp(ie),ir=e=>{let t=Object.create(rY);return t.epochMillis=e,Object.defineProperty(t,"partsUtc",{value:void 0,enumerable:!1,writable:!0}),t},ii=e=>{let t=e.getTime();if(Number.isNaN(t))throw new l.IllegalArgumentException("Invalid date");return ir(t)},ia=e=>{if(r3(e))return e;if(e instanceof Date)return ii(e);if("object"==typeof e){let t=new Date(0);return iK(t,e),ii(t)}return"string"!=typeof e||is(e)?ii(new Date(e)):ii(new Date(e+"Z"))},is=e=>/Z|[+-]\d{2}$|[+-]\d{2}:?\d{2}$|\]$/.test(e),io=(e,t)=>{let r;if(t?.timeZone===void 0&&r3(e)&&r9(e))return e;let i=ia(e);if(i.epochMillis<-86399999568e5||i.epochMillis>86399999496e5)throw RangeError(`Epoch millis out of range: ${i.epochMillis}`);if(t?.timeZone===void 0)r=iE(-60*new Date(i.epochMillis).getTimezoneOffset()*1e3);else if(r4(t?.timeZone))r=t.timeZone;else if("number"==typeof t?.timeZone)r=iE(t.timeZone);else{let e=iI(t.timeZone);if(g.isNone(e))throw new l.IllegalArgumentException(`Invalid time zone: ${t.timeZone}`);r=e.value}return t?.adjustForTimeZone!==!0?r5(i.epochMillis,r,i.partsUtc):iQ(i.epochMillis,r,t?.disambiguation??"compatible")},il=g.liftThrowable(io),iu=g.liftThrowable(ia),ic=/^(.{17,35})\[(.+)\]$/,id=n.map(u.currentTimeMillis,ir),ip=n.map(u.currentTimeMillis,e=>new Date(e)),ih=()=>ir(Date.now()),im=(0,t.dual)(r8,(e,t,r)=>r?.adjustForTimeZone===!0?iQ(e.epochMillis,t,r?.disambiguation??"compatible"):r5(e.epochMillis,t,e.partsUtc)),ig=(0,t.dual)(r8,(e,t,r)=>im(e,iE(t),r)),iy=(0,rG.globalValue)("effect/DateTime/validZoneCache",()=>new Map),iS={day:"numeric",month:"numeric",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"longOffset",fractionalSecondDigits:3,hourCycle:"h23"},ib=e=>{let t=e.resolvedOptions().timeZone;if(iy.has(t))return iy.get(t);let r=Object.create(r1);return r.id=t,r.format=e,iy.set(t,r),r},iv=e=>{if(iy.has(e))return iy.get(e);try{return ib(new Intl.DateTimeFormat("en-US",{...iS,timeZone:e}))}catch{throw new l.IllegalArgumentException(`Invalid time zone: ${e}`)}},iE=e=>{let t=Object.create(r2);return t.offset=e,t},iw=g.liftThrowable(iv),ik=/^(?:GMT|[+-])/,iI=e=>{if(ik.test(e)){let t=iX(e);return null===t?g.none():g.some(iE(t))}return iw(e)},iT=(0,t.dual)(r8,(e,t,r)=>g.map(iw(t),t=>im(e,t,r))),ix=(0,t.dual)(r8,(e,t,r)=>im(e,iv(t),r)),iC=(0,t.dual)(2,(e,t)=>iq(t)-iq(e)),iR=(0,t.dual)(2,(e,t)=>{let r=iC(e,t);return r>0?r$.right(c.millis(r)):r$.left(c.millis(-r))}),iF=(0,t.dual)(2,(e,t)=>c.millis(Math.abs(iC(e,t)))),iA=rK.min(ie),iO=rK.max(ie),i_=rK.greaterThan(ie),iM=rK.greaterThanOrEqualTo(ie),iD=rK.lessThan(ie),iN=rK.lessThanOrEqualTo(ie),iP=rK.between(ie),iL=e=>new Date(e.epochMillis),iU=e=>{if("Utc"===e._tag)return new Date(e.epochMillis);if("Offset"===e.zone._tag)return new Date(e.epochMillis+e.zone.offset);if(void 0!==e.adjustedEpochMillis)return new Date(e.adjustedEpochMillis);let t=e.zone.format.formatToParts(e.epochMillis).filter(e=>"literal"!==e.type),r=new Date(0);return r.setUTCFullYear(Number(t[2].value),Number(t[0].value)-1,Number(t[1].value)),r.setUTCHours(Number(t[3].value),Number(t[4].value),Number(t[5].value),Number(t[6].value)),e.adjustedEpochMillis=r.getTime(),r},iz=e=>iU(e).getTime()-iq(e),iW=e=>{let t=Math.abs(e),r=Math.floor(t/36e5),i=Math.round(t%36e5/6e4);return 60===i&&(r+=1,i=0),`${e<0?"-":"+"}${String(r).padStart(2,"0")}:${String(i).padStart(2,"0")}`},iB=e=>iW(iz(e)),iq=e=>e.epochMillis,i$=e=>({millis:e.getUTCMilliseconds(),seconds:e.getUTCSeconds(),minutes:e.getUTCMinutes(),hours:e.getUTCHours(),day:e.getUTCDate(),weekDay:e.getUTCDay(),month:e.getUTCMonth()+1,year:e.getUTCFullYear()}),ij=e=>"Utc"===e._tag?iV(e):(void 0!==e.partsAdjusted||(e.partsAdjusted=i3(e,i$)),e.partsAdjusted),iV=e=>(void 0!==e.partsUtc||(e.partsUtc=i8(e,i$)),e.partsUtc),iH=(0,t.dual)(2,(e,t)=>iV(e)[t]),iG=(0,t.dual)(2,(e,t)=>ij(e)[t]),iK=(e,t)=>{if(void 0!==t.year&&e.setUTCFullYear(t.year),void 0!==t.month&&e.setUTCMonth(t.month-1),void 0!==t.day&&e.setUTCDate(t.day),void 0!==t.weekDay){let r=t.weekDay-e.getUTCDay();e.setUTCDate(e.getUTCDate()+r)}void 0!==t.hours&&e.setUTCHours(t.hours),void 0!==t.minutes&&e.setUTCMinutes(t.minutes),void 0!==t.seconds&&e.setUTCSeconds(t.seconds),void 0!==t.millis&&e.setUTCMilliseconds(t.millis)},iJ=(0,t.dual)(2,(e,t)=>i1(e,e=>iK(e,t))),iZ=(0,t.dual)(2,(e,t)=>i2(e,e=>iK(e,t))),iQ=(e,t,r)=>{if("Offset"===t._tag)return r5(e-t.offset,t);let i=i0(e-864e5,e,t),n=i0(e+864e5,e,t);if(i===n)return r5(e-i,t);let a=i-n;if(i<n){if(i0(e-n,e,t)===n)return r5(e-n,t);let a=r5(e-i,t);if(e!==iU(a).getTime())switch(r){case"reject":{let r=new Date(e).toISOString();throw RangeError(`Gap time: ${r} does not exist in time zone ${t.id}`)}case"earlier":return r5(e-n,t)}return a}if(i0(e-i,e,t)===i){if("earlier"===r||"compatible"===r||i0(e-i+a,e+a,t)===i)return r5(e-i,t);if("reject"===r){let r=new Date(e).toISOString();throw RangeError(`Ambiguous time: ${r} occurs twice in time zone ${t.id}`)}}return r5(e-n,t)},iY=/([+-])(\d{2}):(\d{2})$/,iX=e=>{let t=iY.exec(e);if(null===t)return null;let[,r,i,n]=t;return("+"===r?1:-1)*(60*Number(i)+Number(n))*6e4},i0=(e,t,r)=>{let i=r.format.formatToParts(e).find(e=>"timeZoneName"===e.type)?.value??"";if("GMT"===i)return 0;let n=iX(i);return null===n?iz(r5(t,r)):n},i1=(0,t.dual)(r8,(e,t,r)=>{if("Utc"===e._tag){let r=iL(e);return t(r),ir(r.getTime())}let i=new Date(iU(e).getTime());return t(i),iQ(i.getTime(),e.zone,r?.disambiguation??"compatible")}),i2=(0,t.dual)(2,(e,t)=>i5(e,e=>{let r=new Date(e);return t(r),r.getTime()})),i5=(0,t.dual)(2,(e,t)=>{let r=t(iq(e));return"Utc"===e._tag?ir(r):r5(r,e.zone)}),i3=(0,t.dual)(2,(e,t)=>t(iU(e))),i8=(0,t.dual)(2,(e,t)=>t(iL(e))),i4=(0,t.dual)(2,(e,t)=>"Utc"===e._tag?t.onUtc(e):t.onZoned(e)),i6=(0,t.dual)(2,(e,t)=>i5(e,e=>e+c.toMillis(t))),i9=(0,t.dual)(2,(e,t)=>i5(e,e=>e-c.toMillis(t))),i7=(e,t)=>{e.setTime(e.getTime()+t)},ne=(0,t.dual)(2,(e,t)=>i1(e,e=>{if(t.millis&&i7(e,t.millis),t.seconds&&i7(e,1e3*t.seconds),t.minutes&&i7(e,60*t.minutes*1e3),t.hours&&i7(e,60*t.hours*6e4),t.days&&e.setUTCDate(e.getUTCDate()+t.days),t.weeks&&e.setUTCDate(e.getUTCDate()+7*t.weeks),t.months){let r=e.getUTCDate();e.setUTCMonth(e.getUTCMonth()+t.months+1,0),r<e.getUTCDate()&&e.setUTCDate(r)}if(t.years){let r=e.getUTCDate(),i=e.getUTCMonth();e.setUTCFullYear(e.getUTCFullYear()+t.years,i+1,0),r<e.getUTCDate()&&e.setUTCDate(r)}})),nt=(0,t.dual)(2,(e,t)=>{let r={};for(let e in t)r[e]=-1*t[e];return ne(e,r)}),nr=(e,t,r)=>{switch(t){case"second":e.setUTCMilliseconds(0);break;case"minute":e.setUTCSeconds(0,0);break;case"hour":e.setUTCMinutes(0,0,0);break;case"day":e.setUTCHours(0,0,0,0);break;case"week":{let t=r?.weekStartsOn??0,i=e.getUTCDay();e.setUTCDate(e.getUTCDate()-(i-t+7)%7),e.setUTCHours(0,0,0,0);break}case"month":e.setUTCDate(1),e.setUTCHours(0,0,0,0);break;case"year":e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}},ni=(0,t.dual)(r8,(e,t,r)=>i1(e,e=>nr(e,t,r))),nn=(e,t,r)=>{switch(t){case"second":e.setUTCMilliseconds(999);break;case"minute":e.setUTCSeconds(59,999);break;case"hour":e.setUTCMinutes(59,59,999);break;case"day":e.setUTCHours(23,59,59,999);break;case"week":{let t=r?.weekStartsOn??0,i=e.getUTCDay();e.setUTCDate(e.getUTCDate()-(i-t+7)%7+6),e.setUTCHours(23,59,59,999);break}case"month":e.setUTCMonth(e.getUTCMonth()+1,0),e.setUTCHours(23,59,59,999);break;case"year":e.setUTCMonth(11,31),e.setUTCHours(23,59,59,999)}},na=(0,t.dual)(r8,(e,t,r)=>i1(e,e=>nn(e,t,r))),ns=(0,t.dual)(r8,(e,t,r)=>i1(e,e=>{if("milli"===t)return;let i=e.getTime(),n=new Date(i);nr(n,t,r);let a=n.getTime(),s=new Date(i);nn(s,t,r);let o=s.getTime()+1;i-a<o-i?e.setTime(a):e.setTime(o)})),no=(0,t.dual)(r8,(e,t)=>{try{var r;return new Intl.DateTimeFormat(t?.locale,{timeZone:"Utc"===e._tag?"UTC":(r=e.zone,"Named"===r._tag?r.id:iW(r.offset)),...t}).format(e.epochMillis)}catch{return new Intl.DateTimeFormat(t?.locale,{timeZone:"UTC",...t}).format(iU(e))}}),nl=(0,t.dual)(r8,(e,t)=>new Intl.DateTimeFormat(t?.locale,t).format(e.epochMillis)),nu=(0,t.dual)(r8,(e,t)=>new Intl.DateTimeFormat(t?.locale,{...t,timeZone:"UTC"}).format(e.epochMillis)),nc=(0,t.dual)(2,(e,t)=>t.format(e.epochMillis)),nd=e=>{let t=iU(e);return"Utc"===e._tag?t.toISOString():`${t.toISOString().slice(0,-1)}${iB(e)}`},np=e=>"Offset"===e.zone._tag?nd(e):`${nd(e)}[${e.zone.id}]`;e.s(["Equivalence",0,r7,"Order",0,ie,"TimeZoneTypeId",0,rZ,"TypeId",0,rJ,"add",0,ne,"addDuration",0,i6,"between",0,iP,"clamp",0,it,"distance",0,iC,"distanceDuration",0,iF,"distanceDurationEither",0,iR,"endOf",0,na,"format",0,no,"formatIntl",0,nc,"formatIso",0,e=>iL(e).toISOString(),"formatIsoDate",0,e=>iU(e).toISOString().slice(0,10),"formatIsoDateUtc",0,e=>iL(e).toISOString().slice(0,10),"formatIsoOffset",0,nd,"formatIsoZoned",0,np,"formatLocal",0,nl,"formatUtc",0,nu,"getPart",0,iG,"getPartUtc",0,iH,"greaterThan",0,i_,"greaterThanOrEqualTo",0,iM,"isDateTime",0,r3,"isFuture",0,e=>n.map(id,iD(e)),"isPast",0,e=>n.map(id,i_(e)),"isTimeZone",0,r4,"isTimeZoneNamed",0,r6,"isTimeZoneOffset",0,e=>r4(e)&&"Offset"===e._tag,"isUtc",0,e=>"Utc"===e._tag,"isZoned",0,r9,"lessThan",0,iD,"lessThanOrEqualTo",0,iN,"make",0,iu,"makeZoned",0,il,"makeZonedFromString",0,e=>{let t=ic.exec(e);if(null===t){let t=iX(e);return null!==t?il(e,{timeZone:t}):g.none()}let[,r,i]=t;return il(r,{timeZone:i})},"mapEpochMillis",0,i5,"match",0,i4,"max",0,iO,"min",0,iA,"mutate",0,i1,"mutateUtc",0,i2,"nearest",0,ns,"now",0,id,"nowAsDate",0,ip,"removeTime",0,e=>i3(e,e=>(e.setUTCHours(0,0,0,0),ir(e.getTime()))),"setParts",0,iJ,"setPartsUtc",0,iZ,"setZone",0,im,"setZoneNamed",0,iT,"setZoneOffset",0,ig,"startOf",0,ni,"subtract",0,nt,"subtractDuration",0,i9,"toDate",0,iU,"toDateUtc",0,iL,"toEpochMillis",0,iq,"toParts",0,ij,"toPartsUtc",0,iV,"toUtc",0,e=>ir(e.epochMillis),"unsafeFromDate",0,ii,"unsafeIsFuture",0,e=>iD(ih(),e),"unsafeIsPast",0,e=>i_(ih(),e),"unsafeMake",0,ia,"unsafeMakeZoned",0,io,"unsafeNow",0,ih,"unsafeSetZoneNamed",0,ix,"withDate",0,i3,"withDateUtc",0,i8,"zoneFromString",0,iI,"zoneMakeLocal",0,()=>ib(new Intl.DateTimeFormat("en-US",iS)),"zoneMakeNamed",0,iw,"zoneMakeNamedEffect",0,e=>G.try_({try:()=>iv(e),catch:e=>e}),"zoneMakeOffset",0,iE,"zoneToString",0,e=>"Offset"===e._tag?iW(e.offset):e.id,"zoneUnsafeMakeNamed",0,iv,"zonedOffset",0,iz,"zonedOffsetIso",0,iB],5331375);var nf=e.i(5921732);e.i(2958341),h.isString;let nh=rH.string;rK.string;let nm=e=>e.length>0;class ng{s;stripped;index;length;constructor(e,t=!1){this.s=e,this.stripped=t,this.index=0,this.length=e.length}next(){if(this.done)return{done:!0,value:void 0};let e=this.index;for(;!this.done&&!ny(this.s[this.index]);)this.index=this.index+1;let t=this.index;if(!this.done){let e=this.s[this.index];this.index=this.index+1,!this.done&&nS(e,this.s[this.index])&&(this.index=this.index+1),this.stripped||(t=this.index)}return{done:!1,value:this.s.substring(e,t)}}[Symbol.iterator](){return new ng(this.s,this.stripped)}get done(){return this.index>=this.length}}let ny=e=>{let t=e.charCodeAt(0);return 13===t||10===t},nS=(e,t)=>13===e.charCodeAt(0)&&10===t.charCodeAt(0);e.s(["Equivalence",0,nh,"capitalize",0,e=>0===e.length?e:e[0].toUpperCase()+e.slice(1),"isNonEmpty",0,nm,"uncapitalize",0,e=>0===e.length?e:e[0].toLowerCase()+e.slice(1)],9333060);let nb=Symbol.for("effect/Cron"),nv={[nb]:nb,[J.symbol](e){return nE(e)&&nA(this,e)},[Y.symbol](){return(0,t.pipe)(Y.hash(this.tz),Y.combine(Y.array(rj.fromIterable(this.seconds))),Y.combine(Y.array(rj.fromIterable(this.minutes))),Y.combine(Y.array(rj.fromIterable(this.hours))),Y.combine(Y.array(rj.fromIterable(this.days))),Y.combine(Y.array(rj.fromIterable(this.months))),Y.combine(Y.array(rj.fromIterable(this.weekdays))),Y.cached(this))},toString(){return(0,e8.format)(this.toJSON())},toJSON(){return{_id:"Cron",tz:this.tz,seconds:rj.fromIterable(this.seconds),minutes:rj.fromIterable(this.minutes),hours:rj.fromIterable(this.hours),days:rj.fromIterable(this.days),months:rj.fromIterable(this.months),weekdays:rj.fromIterable(this.weekdays)}},[e8.NodeInspectSymbol](){return this.toJSON()},pipe(){return(0,f.pipeArguments)(this,arguments)}},nE=e=>(0,h.hasProperty)(e,nb),nw=e=>{let t=Object.create(nv);t.seconds=new Set(rj.sort(e.seconds??[0],nf.Order)),t.minutes=new Set(rj.sort(e.minutes,nf.Order)),t.hours=new Set(rj.sort(e.hours,nf.Order)),t.days=new Set(rj.sort(e.days,nf.Order)),t.months=new Set(rj.sort(e.months,nf.Order)),t.weekdays=new Set(rj.sort(e.weekdays,nf.Order)),t.tz=g.fromNullable(e.tz);let r=Array.from(t.seconds),i=Array.from(t.minutes),n=Array.from(t.hours),a=Array.from(t.days),s=Array.from(t.months),o=Array.from(t.weekdays);return t.first={second:r[0]??0,minute:i[0]??0,hour:n[0]??0,day:a[0]??1,month:(s[0]??1)-1,weekday:o[0]??0},t.next={second:nk(r,60),minute:nk(i,60),hour:nk(n,24),day:nk(a,32),month:nk(s,13),weekday:nk(o,7)},t},nk=(e,t)=>{let r,i=Array(t).fill(void 0);if(0===e.length)return i;let n=e.length-1;for(let a=t-1;a>=0;a--){for(;n>=0&&e[n]>=a;)r=e[n--];i[a]=r}return i},nI=Symbol.for("effect/Cron/errors/ParseError");class nT extends rV.TaggedError("CronParseError"){[nI]=nI}let nx=e=>new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth()+1,0)).getUTCDate(),nC=rH.make((e,t)=>nF(e.seconds,t.seconds)&&nF(e.minutes,t.minutes)&&nF(e.hours,t.hours)&&nF(e.days,t.days)&&nF(e.months,t.months)&&nF(e.weekdays,t.weekdays)),nR=rH.array(rH.number),nF=(e,t)=>nR(rj.fromIterable(e),rj.fromIterable(t)),nA=(0,t.dual)(2,(e,t)=>nC(e,t)),nO={min:0,max:59},n_={min:0,max:59},nM={min:0,max:23},nD={min:1,max:31},nN={min:1,max:12,aliases:{jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12}},nP={min:0,max:6,aliases:{sun:0,mon:1,tue:2,wed:3,thu:4,fri:5,sat:6}},nL=(e,t)=>{let r=t.max-t.min+1,i=new Set;for(let n of e.split(",")){let[a,s]=nU(n);if("*"===a&&void 0===s)return r$.right(new Set);if(void 0!==s){if(!Number.isInteger(s))return r$.left(new nT({message:"Expected step value to be a positive integer",input:e}));if(s<1)return r$.left(new nT({message:"Expected step value to be greater than 0",input:e}));if(s>t.max)return r$.left(new nT({message:`Expected step value to be less than ${t.max}`,input:e}))}if("*"===a)for(let e=t.min;e<=t.max;e+=s??1)i.add(e);else{let[r,n]=nz(a,t.aliases);if(!Number.isInteger(r))return r$.left(new nT({message:"Expected a positive integer",input:e}));if(r<t.min||r>t.max)return r$.left(new nT({message:`Expected a value between ${t.min} and ${t.max}`,input:e}));if(void 0===n)i.add(r);else{if(!Number.isInteger(n))return r$.left(new nT({message:"Expected a positive integer",input:e}));if(n<t.min||n>t.max)return r$.left(new nT({message:`Expected a value between ${t.min} and ${t.max}`,input:e}));if(r>n)return r$.left(new nT({message:"Invalid value range",input:e}));for(let e=r;e<=n;e+=s??1)i.add(e)}}if(i.size>=r)return r$.right(new Set)}return r$.right(i)},nU=e=>{let t=e.indexOf("/");return -1!==t?[e.slice(0,t),Number(e.slice(t+1))]:[e,void 0]},nz=(e,t)=>{let r=e.indexOf("-");return -1!==r?[nW(e.slice(0,r),t),nW(e.slice(r+1),t)]:[nW(e,t),void 0]};function nW(e,t){return t?.[e.toLocaleLowerCase()]??Number(e)}var nB=e.i(5525866);nB.RandomTypeId;let nq=a.next;a.nextInt,a.nextBoolean,a.nextRange,a.nextIntBetween,a.shuffle,a.choice,a.randomWith,nB.randomTag,nB.make;let n$=nB.fixed,nj=Symbol.for("effect/Schedule"),nV=e=>(0,h.hasProperty)(e,nj),nH=Symbol.for("effect/ScheduleDriver"),nG={start:0,now:0,input:void 0,output:void 0,elapsed:c.zero,elapsedSincePrevious:c.zero,recurrence:0},nK=i.Reference()("effect/Schedule/CurrentIterationMetadata",{defaultValue:()=>nG}),nJ={_Out:e=>e,_In:e=>e,_R:e=>e},nZ={_Out:e=>e,_In:e=>e,_R:e=>e};class nQ{initial;step;[nj]=nJ;constructor(e,t){this.initial=e,this.step=t}pipe(){return(0,f.pipeArguments)(this,arguments)}}let nY=(e,t,r,i)=>en.update(e,e=>0===e.recurrence?{now:t,input:r,output:i,recurrence:e.recurrence+1,elapsed:c.zero,elapsedSincePrevious:c.zero,start:t}:{now:t,input:r,output:i,recurrence:e.recurrence+1,elapsed:c.millis(t-e.start),elapsedSincePrevious:c.millis(t-e.now),start:e.start});class nX{schedule;ref;[nH]=nZ;constructor(e,t){this.schedule=e,this.ref=t}get state(){return n.map(en.get(this.ref),e=>e[1])}get last(){return n.flatMap(en.get(this.ref),e=>{let[t,r]=e;switch(t._tag){case"None":return n.failSync(()=>new n.NoSuchElementException);case"Some":return n.succeed(t.value)}})}iterationMeta=en.unsafeMake(nG);get reset(){return en.set(this.ref,[g.none(),this.schedule.initial]).pipe(n.zipLeft(en.set(this.iterationMeta,nG)))}next(e){return(0,t.pipe)(n.map(en.get(this.ref),e=>e[1]),n.flatMap(r=>(0,t.pipe)(u.currentTimeMillis,n.flatMap(i=>(0,t.pipe)(n.suspend(()=>this.schedule.step(i,e,r)),n.flatMap(r=>{let[a,s,o]=r,l=en.set(this.ref,[g.some(s),a]);if(o._tag===P)return l.pipe(n.zipRight(n.fail(g.none())));let u=O(o.intervals)-i;if(u<=0)return l.pipe(n.zipRight(nY(this.iterationMeta,i,e,s)),n.as(s));let d=c.millis(u);return(0,t.pipe)(l,n.zipRight(nY(this.iterationMeta,i,e,s)),n.zipRight(G.sleep(d)),n.as(s))}))))))}}let n0=(e,t)=>new nQ(e,t),n1=(0,t.dual)(2,(e,t)=>n2(e,e=>n.sync(()=>t(e)))),n2=(0,t.dual)(2,(e,t)=>ak(e,(e,r)=>n.map(t(e),e=>c.sum(r,c.decode(e))))),n5=(0,t.dual)(2,(e,t)=>av(n3(e,t),r$.merge)),n3=(0,t.dual)(2,(e,t)=>n0([e.initial,t.initial,!0],(r,i,a)=>a[2]?n.flatMap(e.step(r,i,a[0]),e=>{let[s,o,l]=e;return l._tag===P?n.map(t.step(r,i,a[1]),e=>{let[t,r,i]=e;return[[s,t,!1],r$.right(r),i]}):n.succeed([[s,a[1],!0],r$.left(o),l])}):n.map(t.step(r,i,a[1]),e=>{let[t,r,i]=e;return[[a[0],t,!1],r$.right(r),i]}))),n8=(0,t.dual)(2,(e,t)=>av(e,()=>t)),n4=e=>av(e,t.constVoid),n6=(0,t.dual)(2,(e,r)=>n0([e.initial,r.initial],(i,a,s)=>{let[o,l]=a;return n.zipWith(e.step(i,o,s[0]),r.step(i,l,s[1]),(e,r)=>{let[i,n,a]=e,[s,o,l]=r;return a._tag===N&&l._tag===N?[[i,s],[n,o],L((0,t.pipe)(a.intervals,C(l.intervals)))]:[[i,s],[n,o],z]})})),n9=(0,t.dual)(2,(e,t)=>n7(e,(e,r)=>n.sync(()=>t(e,r)))),n7=(0,t.dual)(2,(e,t)=>n0(e.initial,(r,i,a)=>n.flatMap(e.step(r,i,a),e=>{let[r,a,s]=e;return s._tag===P?n.succeed([r,a,z]):n.map(t(i,a),e=>e?[r,a,s]:[r,a,z])}))),ae=e=>aD(e,m.empty(),(e,r)=>(0,t.pipe)(e,m.append(r))),at=(0,t.dual)(2,(e,r)=>n0([e.initial,r.initial],(i,a,s)=>n.flatMap(e.step(i,a,s[0]),e=>{let[a,o,l]=e;return n.map(r.step(i,o,s[1]),e=>{let[r,i,n]=e;return l._tag===P||n._tag===P?[[a,r],i,z]:[[a,r],i,L((0,t.pipe)(l.intervals,M(n.intervals)))]})}))),ar=(0,t.dual)(2,(e,t)=>an(e,e=>n.sync(()=>t(e)))),ai=(0,t.dual)(2,(e,t)=>n0(e.initial,(r,i,a)=>n.mapInputContext(e.step(r,i,a),t))),an=(0,t.dual)(2,(e,t)=>n0(e.initial,(r,i,a)=>n.flatMap(t(i),t=>e.step(r,t,a)))),aa=(0,t.dual)(2,(e,t)=>as(e,e=>n.sync(()=>t(e)))),as=(0,t.dual)(2,(e,t)=>ak(e,(e,r)=>t(r))),ao=e=>n1(e,e=>e),al=(0,t.dual)(2,(e,t)=>{let{onInput:r,onOutput:i}=t;return av(ar(e,r),i)}),au=(0,t.dual)(2,(e,t)=>{let{onInput:r,onOutput:i}=t;return aE(an(e,r),i)}),ac=e=>(0,t.pipe)(en.make([g.none(),e.initial]),n.map(t=>new nX(e,t))),ad=e=>{let t=c.decode(e),r=c.toMillis(t);return n0(!0,(e,i,a)=>n.succeed(a?[!1,t,U(b(e+r,1/0))]:[!1,c.zero,z]))},ap=(0,t.dual)(2,(e,t)=>a$(e,t)),af=(0,t.dual)(3,(e,t,r)=>aj(e,t,r)),ah=(0,t.dual)(2,(e,t)=>n0(e.initial,(r,i,a)=>n.flatMap(e.step(r,i,a),e=>{let[r,i,a]=e;return a._tag===P?n.as(t,[r,i,a]):n.succeed([r,i,a])}))),am=()=>n0(void 0,(e,t,r)=>n.succeed([r,t,U(b(e,1/0))])),ag=(0,t.dual)(2,(e,t)=>ay(e,t,F)),ay=(0,t.dual)(3,(e,r,i)=>n0([e.initial,r.initial],(a,s,o)=>(0,t.pipe)(n.zipWith(e.step(a,s,o[0]),r.step(a,s,o[1]),(e,t)=>[e,t]),n.flatMap(t=>{let[[a,o,l],[u,c,d]]=t;return l._tag===N&&d._tag===N?aS(e,r,s,a,o,l.intervals,u,c,d.intervals,i):n.succeed([[a,u],[o,c],z])})))),aS=(e,r,i,a,s,o,l,u,c,d)=>{let p=d(o,c);return m.isNonEmpty(p.intervals)?n.succeed([[a,l],[s,u],L(p)]):(0,t.pipe)(o,_(c))?n.flatMap(e.step(D(o),i,a),t=>{let[a,s,o]=t;return o._tag===P?n.succeed([[a,l],[s,u],z]):aS(e,r,i,a,s,o.intervals,l,u,c,d)}):n.flatMap(r.step(D(c),i,l),t=>{let[l,u,c]=t;return c._tag===P?n.succeed([[a,l],[s,u],z]):aS(e,r,i,a,s,o,l,u,c.intervals,d)})},ab=(0,t.dual)(2,(e,t)=>{let{max:r,min:i}=Object.assign({min:.8,max:1.2},t);return as(e,e=>n.map(nq,t=>{let n=c.toMillis(e);return c.millis(n*i*(1-t)+n*r*t)}))}),av=(0,t.dual)(2,(e,t)=>aE(e,e=>n.sync(()=>t(e)))),aE=(0,t.dual)(2,(e,t)=>n0(e.initial,(r,i,a)=>n.flatMap(e.step(r,i,a),e=>{let[r,i,a]=e;return n.map(t(i),e=>[r,e,a])}))),aw=(0,t.dual)(2,(e,t)=>ak(e,(e,r)=>n.sync(()=>t(e,r)))),ak=(0,t.dual)(2,(e,t)=>n0(e.initial,(r,i,a)=>n.flatMap(e.step(r,i,a),e=>{let i,[a,s,o]=e;if(o._tag===P)return n.succeed([a,s,o]);let l=o.intervals,u=(i=b(r,O(l)),c.millis(i.endMillis-i.startMillis));return n.map(t(s,u),e=>{let t=c.decode(e),i=O(l),n=r+c.toMillis(t),o=n-i;return[a,s,U(b(n,Math.max(0,D(l)+o)))]})}))),aI=(0,t.dual)(2,(e,t)=>n0(e.initial,(r,i,a)=>n.flatMap(e.step(r,i,a),e=>{let[r,i,a]=e;return n.as(t(i,a),[r,i,a])}))),aT=e=>n0(e.initial,(r,i,a)=>(0,t.pipe)(e.step(r,i,a),n.map(e=>{let[t,r,n]=e;return[t,i,n]}))),ax=(0,t.dual)(2,(e,t)=>n0(e.initial,(r,i,a)=>n.provideContext(e.step(r,i,a),t))),aC=(0,t.dual)(3,(e,t,r)=>n0(e.initial,(a,s,o)=>n.contextWithEffect(l=>n.provideContext(e.step(a,s,o),i.add(l,t,r))))),aR=e=>aV(am(),e),aF=e=>aH(am(),e),aA=e=>{let t=c.decode(e);return aY(sS,e=>c.lessThan(e,t))},aO=e=>aZ(am(),e),a_=e=>aQ(am(),e),aM=e=>aY(sb,t=>t<e),aD=(0,t.dual)(3,(e,t,r)=>aN(e,t,(e,t)=>n.sync(()=>r(e,t)))),aN=(0,t.dual)(3,(e,t,r)=>n0([e.initial,t],(t,i,a)=>{let[s,o]=a;return n.flatMap(e.step(t,i,s),e=>{let[t,i,a]=e;return a._tag===P?n.succeed([[t,o],o,a]):n.map(r(o,i),e=>[[t,e],o,a])})})),aP=(0,t.dual)(2,(e,r)=>{let i=c.decode(r);return(0,t.pipe)(e,ag(sS),aL(e=>{let[,t]=e;return c.greaterThanOrEqualTo(t,i)}),av(e=>e[0]))}),aL=(0,t.dual)(2,(e,t)=>n0(e.initial,(r,i,a)=>n.flatMap(e.step(r,i,a),a=>{let[s,o,l]=a;return t(o)?e.step(r,i,e.initial):n.succeed([s,o,l])}))),aU=(0,t.dual)(3,(e,r,i)=>(0,t.pipe)(az(e,r,m.fromIterable(i),e.initial,m.empty()),n.map(e=>m.reverse(e)))),az=(e,r,i,a,s)=>{if(!m.isNonEmpty(i))return n.succeed(s);let o=m.headNonEmpty(i),l=m.tailNonEmpty(i);return n.flatMap(e.step(r,o,a),r=>{let[i,a,o]=r;return o._tag===P?n.sync(()=>(0,t.pipe)(s,m.prepend(a))):az(e,O(o.intervals),l,i,m.prepend(s,a))})},aW=(0,t.dual)(2,(e,t)=>n0(e.initial,(r,i,a)=>n.zipRight(t(i),e.step(r,i,a)))),aB=(0,t.dual)(2,(e,t)=>n0(e.initial,(r,i,a)=>n.tap(e.step(r,i,a),e=>{let[,r]=e;return t(r)}))),aq=(e,t)=>n0(e,(e,r,i)=>n.sync(()=>[t(i),i,U(b(e,1/0))])),a$=(0,t.dual)(2,(e,t)=>aj(e,t,C)),aj=(0,t.dual)(3,(e,t,r)=>n0([e.initial,t.initial],(i,a,s)=>n.zipWith(e.step(i,a,s[0]),t.step(i,a,s[1]),(e,t)=>{let[i,n,a]=e,[s,o,l]=t;if(a._tag===P&&l._tag===P)return[[i,s],[n,o],z];if(a._tag===P&&l._tag===N)return[[i,s],[n,o],L(l.intervals)];if(a._tag===N&&l._tag===P)return[[i,s],[n,o],L(a.intervals)];if(a._tag===N&&l._tag===N)return[[i,s],[n,o],L(r(a.intervals,l.intervals))];throw Error("BUG: Schedule.unionWith - please report an issue at https://github.com/Effect-TS/effect/issues")}))),aV=(0,t.dual)(2,(e,t)=>n9(e,(e,r)=>!t(e))),aH=(0,t.dual)(2,(e,t)=>n7(e,(e,r)=>G.negate(t(e)))),aG=(0,t.dual)(2,(e,t)=>n9(e,(e,r)=>!t(r))),aK=(0,t.dual)(2,(e,t)=>n7(e,(e,r)=>G.negate(t(r)))),aJ=(0,t.dual)(2,(e,t)=>a0(e,aA(t))),aZ=(0,t.dual)(2,(e,t)=>n9(e,(e,r)=>t(e))),aQ=(0,t.dual)(2,(e,t)=>n7(e,(e,r)=>t(e))),aY=(0,t.dual)(2,(e,t)=>n9(e,(e,r)=>t(r))),aX=(0,t.dual)(2,(e,t)=>n7(e,(e,r)=>t(r))),a0=(0,t.dual)(2,(e,t)=>av(ag(e,t),e=>e[0])),a1=(0,t.dual)(2,(e,t)=>av(ag(e,t),e=>e[1])),a2=(0,t.dual)(3,(e,t,r)=>av(ag(e,t),e=>{let[t,i]=e;return r(t,i)})),a5=e=>{let t=new Date(e);return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),0).getTime()},a3=e=>{let t=new Date(a5(e));return t.setSeconds(t.getSeconds()+1)},a8=e=>{let t=new Date(e);return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),0,0).getTime()},a4=e=>{let t=new Date(e);return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),0,0,0).getTime()},a6=e=>{let t=new Date(e);return new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0).getTime()},a9=e=>{let t=new Date(a6(e));return t.setDate(t.getDate()+1)},a7=(e,t,r)=>{let i=new Date(new Date(e).setDate(t));if(new Date(i.setMonth(i.getMonth()+r)).getDate()===t){let i=new Date(new Date(e).setDate(t));return i.setMonth(i.getMonth()+r)}return a7(e,t,r+1)},se=Symbol.for("effect/Schedule/ScheduleDefect");class st{error;[se];constructor(e){this.error=e,this[se]=se}}let sr=e=>n.catchAll(e,e=>n.die(new st(e))),si=e=>g.match(r.find(e,e=>{let t;return r.isDieType(e)&&(t=e.defect,(0,h.hasProperty)(t,se))?g.some(e.defect):g.none()}),{onNone:()=>e,onSome:e=>r.fail(e.error)}),sn=e=>n.catchAllCause(e,e=>n.failCause(si(e))),sa=(0,t.dual)(2,(e,t)=>so(e,t,(e,t)=>n.fail(e))),ss=(0,t.dual)(2,(e,t)=>{if(nV(t))return sa(e,t);let r=t.schedule??aT(sb),i=t.while?aQ(r,e=>{let r=t.while(e);return"boolean"==typeof r?n.succeed(r):sr(r)}):r,a=t.until?aH(i,e=>{let r=t.until(e);return"boolean"==typeof r?n.succeed(r):sr(r)}):i;return sn(sa(e,t.times?ag(a,aM(t.times)).pipe(av(e=>e[0])):a))}),so=(0,t.dual)(3,(e,t,r)=>n.flatMap(ac(t),t=>n.matchEffect(e,{onFailure:e=>r(e,g.none()),onSuccess:i=>sl(G.provideServiceEffect(e,nK,en.get(t.iterationMeta)),t,(e,i)=>G.provideServiceEffect(r(e,i),nK,en.get(t.iterationMeta)),i)}))),sl=(e,t,r,i)=>n.matchEffect(t.next(i),{onFailure:()=>n.orDie(t.last),onSuccess:i=>n.matchEffect(e,{onFailure:e=>r(e,g.some(i)),onSuccess:i=>sl(e,t,r,i)})}),su=(0,t.dual)(2,(e,t)=>sp(e,t,(e,t)=>n.fail(e))),sc=(0,t.dual)(2,(e,t)=>nV(t)?su(e,t):sn(su(e,sd(t)))),sd=e=>{let t=e.schedule??sb,r=e.while?aQ(t,t=>{let r=e.while(t);return"boolean"==typeof r?n.succeed(r):sr(r)}):t,i=e.until?aH(r,t=>{let r=e.until(t);return"boolean"==typeof r?n.succeed(r):sr(r)}):r;return e.times?ag(i,aM(e.times)):i},sp=(0,t.dual)(3,(e,t,r)=>n.flatMap(ac(t),t=>sf(G.provideServiceEffect(e,nK,en.get(t.iterationMeta)),t,(e,i)=>G.provideServiceEffect(r(e,i),nK,en.get(t.iterationMeta))))),sf=(e,r,i)=>n.catchAll(e,a=>n.matchEffect(r.next(a),{onFailure:()=>(0,t.pipe)(r.last,n.orDie,n.flatMap(e=>i(a,e))),onSuccess:()=>sf(e,r,i)})),sh=(0,t.dual)(2,(e,t)=>sm(e,void 0,t)),sm=(0,t.dual)(3,(e,t,r)=>n.flatMap(ac(r),r=>sg(G.provideServiceEffect(e,nK,en.get(r.iterationMeta)),t,r))),sg=(e,t,r)=>n.matchEffect(r.next(t),{onFailure:()=>n.orDie(r.last),onSuccess:()=>n.flatMap(e,t=>sg(e,t,r))}),sy=aq(0,e=>e+1),sS=n0(g.none(),(e,t,r)=>{switch(r._tag){case"None":return n.succeed([g.some(e),c.zero,U(b(e,1/0))]);case"Some":return n.succeed([g.some(r.value),c.millis(e-r.value),U(b(e,1/0))])}}),sb=aq(0,e=>e+1),sv=n4(aM(1)),sE=n4(aM(0)),sw=(0,t.dual)(2,(e,t)=>ew(sh(e,t)));e.s(["CurrentIterationMetadata",0,nK,"ScheduleDriverTypeId",0,nH,"ScheduleTypeId",0,nj,"addDelay",0,n1,"addDelayEffect",0,n2,"andThen",0,n5,"andThenEither",0,n3,"as",0,n8,"asVoid",0,n4,"bothInOut",0,n6,"check",0,n9,"checkEffect",0,n7,"collectAllInputs",0,()=>ae(am()),"collectAllOutputs",0,ae,"collectUntil",0,e=>ae(aR(e)),"collectUntilEffect",0,e=>ae(aF(e)),"collectWhile",0,e=>ae(aO(e)),"collectWhileEffect",0,e=>ae(a_(e)),"compose",0,at,"count",0,sy,"cron",0,(e,r)=>{let i=nE(e)?r$.right(e):((e,t)=>{let r=e.split(" ").filter(nm);if(5!==r.length&&6!==r.length)return r$.left(new nT({message:"Invalid number of segments in cron expression",input:e}));5===r.length&&r.unshift("0");let[i,n,a,s,o,l]=r,u=void 0===t||r4(t)?r$.right(t):r$.fromOption(iI(t),()=>new nT({message:"Invalid time zone in cron expression",input:t}));return r$.all({tz:u,seconds:nL(i,nO),minutes:nL(n,n_),hours:nL(a,nM),days:nL(s,nD),months:nL(o,nN),weekdays:nL(l,nP)}).pipe(r$.map(nw))})(e,r);return n0([!0,[Number.MIN_SAFE_INTEGER,0,0]],(e,r,a)=>{let s,o,l,u,c,[d,p]=a;if(e<p[0])return n.succeed([[!1,p],[p[1],p[2]],U(b(p[1],p[2]))]);if(r$.isLeft(i))return n.die(i.left);let f=i.right,h=new Date(e);d&&(s=io(h,{timeZone:g.getOrUndefined(f.tz)}).pipe(ij),(0===f.seconds.size||f.seconds.has(s.seconds))&&(0===f.minutes.size||f.minutes.has(s.minutes))&&(0===f.hours.size||f.hours.has(s.hours))&&(0===f.months.size||f.months.has(s.month))&&(0===f.days.size&&0===f.weekdays.size||(0===f.weekdays.size?f.days.has(s.day):0===f.days.size?f.weekdays.has(s.weekDay):f.days.has(s.day)||f.weekdays.has(s.weekDay))))&&(c=e);let m=a5(c=(o=g.getOrUndefined(f.tz),l=io(h??new Date,{timeZone:o}),u=void 0!==o&&r6(o)&&"UTC"===o.id?t.constVoid:e=>{let t=io(e,{timeZone:l.zone,adjustForTimeZone:!0}).pipe(iU),r=e.getTime()-t.getTime();r>0&&e.setTime(e.getTime()+r)},iL(i1(l,e=>{e.setUTCSeconds(e.getUTCSeconds()+1,0);for(let t=0;t<1e4;t++){if(0!==f.seconds.size){let t=e.getUTCSeconds(),r=f.next.second[t];if(void 0===r){e.setUTCMinutes(e.getUTCMinutes()+1,f.first.second),u(e);continue}if(r>t){e.setUTCSeconds(r),u(e);continue}}if(0!==f.minutes.size){let t=e.getUTCMinutes(),r=f.next.minute[t];if(void 0===r){e.setUTCHours(e.getUTCHours()+1,f.first.minute,f.first.second),u(e);continue}if(r>t){e.setUTCMinutes(r,f.first.second),u(e);continue}}if(0!==f.hours.size){let t=e.getUTCHours(),r=f.next.hour[t];if(void 0===r){e.setUTCDate(e.getUTCDate()+1),e.setUTCHours(f.first.hour,f.first.minute,f.first.second),u(e);continue}if(r>t){e.setUTCHours(r,f.first.minute,f.first.second),u(e);continue}}if(0!==f.weekdays.size||0!==f.days.size){let t=1/0,r=1/0;if(0!==f.weekdays.size){let r=e.getUTCDay(),i=f.next.weekday[r];t=void 0===i?7-r+f.first.weekday:i-r}if(0!==f.days.size&&0!==t){let t=e.getUTCDate(),i=f.next.day[t];r=void 0===i?nx(e)-t+f.first.day:i-t}let i=Math.min(t,r);if(0!==i){e.setUTCDate(e.getUTCDate()+i),e.setUTCHours(f.first.hour,f.first.minute,f.first.second),u(e);continue}}if(0!==f.months.size){let t=e.getUTCMonth()+1,r=f.next.month[t];if(void 0===r){e.setUTCFullYear(e.getUTCFullYear()+1),e.setUTCMonth(f.first.month,f.first.day),e.setUTCHours(f.first.hour,f.first.minute,f.first.second),u(e);continue}if(r>t){e.setUTCMonth(r-1,f.first.day),e.setUTCHours(f.first.hour,f.first.minute,f.first.second),u(e);continue}}return}throw Error("Unable to find next cron date")}))).getTime()),y=a3(c);return n.succeed([[!1,[c,m,y]],[m,y],U(b(m,y))])})},"dayOfMonth",0,e=>n0([-1/0,0],(t,r,i)=>{var a,s,o;let l;if(!Number.isInteger(e)||e<1||31<e)return n.dieSync(()=>new n.IllegalArgumentException(`Invalid argument in: dayOfMonth(${e}). Must be in range 1...31`));let u=i[1],c=(a=t,s=e,o=0===u,(l=new Date(a)).getDate()===s&&o?a:l.getDate()<s?l.setDate(s):a7(a,s,1)),d=a6(c),p=a9(c),f=b(d,p);return n.succeed([[p,u+1],u,U(f)])}),"dayOfWeek",0,e=>n0([Number.MIN_SAFE_INTEGER,0],(t,r,i)=>{if(!Number.isInteger(e)||e<1||7<e)return n.dieSync(()=>new n.IllegalArgumentException(`Invalid argument in: dayOfWeek(${e}). Must be in range 1 (Monday)...7 (Sunday)`));let a=i[1],s=((e,t,r)=>{let i=new Date(e);if(i.getDay()===t&&r)return e;let n=(7+t-i.getDay())%7;return i.setDate(i.getDate()+(0===n?7:n))})(t,e,0===a),o=a6(s),l=a9(s),u=b(o,l);return n.succeed([[l,a+1],a,U(u)])}),"delayed",0,aa,"delayedEffect",0,as,"delayedSchedule",0,ao,"delays",0,e=>n0(e.initial,(r,i,a)=>(0,t.pipe)(e.step(r,i,a),n.flatMap(e=>{let[t,i,a]=e;return a._tag===P?n.succeed([t,c.zero,a]):n.succeed([t,c.millis(O(a.intervals)-r),a])}))),"driver",0,ac,"duration",0,ad,"either",0,ap,"eitherWith",0,af,"elapsed",0,sS,"ensuring",0,ah,"exponential",0,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=c.decode(e);return ao(av(sb,e=>c.times(r,Math.pow(t,e))))},"fibonacci",0,e=>{let r=c.decode(e);return ao((0,t.pipe)(aq([r,r],e=>{let[t,r]=e;return[r,c.sum(t,r)]}),av(e=>e[0])))},"fixed",0,e=>{let t=c.decode(e),r=c.toMillis(t);return n0([g.none(),0],(e,i,a)=>{let[s,o]=a;return n.sync(()=>{switch(s._tag){case"None":return[[g.some([e,e+r]),o+1],o,U(b(e+r,1/0))];case"Some":{let[i,n]=s.value,a=e>n+r,l=J.equals(t,c.zero)?t:c.millis(r-(e-i)%r),u=J.equals(l,c.zero)?t:l,d=a?e:e+c.toMillis(u);return[[g.some([i,d]),o+1],o,U(b(d,1/0))]}}})})},"forever",0,sb,"fromDelay",0,e=>ad(e),"fromDelays",0,function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return n0([[e,...r].map(e=>c.decode(e)),!0],(e,t,r)=>{let[i,a]=r;return n.sync(()=>{if(a){let t=i[0],r=b(e+c.toMillis(t),1/0);return i.length>=2?[[i.slice(1),!0],t,U(r)]:[[[t,...i.slice(1)],!1],t,U(r)]}return[[i,!1],c.zero,z]})})},"fromFunction",0,e=>av(am(),e),"fromRetryOptions",0,sd,"hourOfDay",0,e=>n0([-1/0,0],(t,r,i)=>{let a;if(!Number.isInteger(e)||e<0||23<e)return n.dieSync(()=>new n.IllegalArgumentException(`Invalid argument in: hourOfDay(${e}). Must be in range 0...23`));let s=i[1],o=((e,t,r)=>{let i=new Date(e);if(i.getHours()===t&&r)return e;if(i.getHours()<t)return i.setHours(t);let n=new Date(i.setHours(t));return n.setTime(n.getTime()+864e5)})(t,e,0===s),l=a4(o),u=(a=new Date(a4(o))).setHours(a.getHours()+1),c=b(l,u);return n.succeed([[u,s+1],s,U(c)])}),"identity",0,am,"intersect",0,ag,"intersectWith",0,ay,"isSchedule",0,nV,"jittered",0,e=>ab(e,{min:.8,max:1.2}),"jitteredWith",0,ab,"linear",0,e=>{let t=c.decode(e);return ao(av(sb,e=>c.times(t,e+1)))},"makeWithState",0,n0,"map",0,av,"mapBoth",0,al,"mapBothEffect",0,au,"mapEffect",0,aE,"mapInput",0,ar,"mapInputContext",0,ai,"mapInputEffect",0,an,"minuteOfHour",0,e=>n0([Number.MIN_SAFE_INTEGER,0],(t,r,i)=>{let a;if(!Number.isInteger(e)||e<0||59<e)return n.dieSync(()=>new n.IllegalArgumentException(`Invalid argument in: minuteOfHour(${e}). Must be in range 0...59`));let s=i[1],o=((e,t,r)=>{let i=new Date(e);if(i.getMinutes()===t&&r)return e;if(i.getMinutes()<t)return i.setMinutes(t);let n=new Date(i.setMinutes(t));return n.setTime(n.getTime()+36e5)})(t,e,0===s),l=a8(o),u=(a=new Date(a8(o))).setMinutes(a.getMinutes()+1),c=b(l,u);return n.succeed([[u,s+1],s,U(c)])}),"modifyDelay",0,aw,"modifyDelayEffect",0,ak,"onDecision",0,aI,"once",0,sv,"passthrough",0,aT,"provideContext",0,ax,"provideService",0,aC,"recurUntil",0,aR,"recurUntilEffect",0,aF,"recurUntilOption",0,e=>aG(av(am(),e),g.isSome),"recurUpTo",0,aA,"recurWhile",0,aO,"recurWhileEffect",0,a_,"recurs",0,aM,"reduce",0,aD,"reduceEffect",0,aN,"repeatOrElse_Effect",0,so,"repeat_combined",0,ss,"repetitions",0,e=>aD(e,0,(e,t)=>e+1),"resetAfter",0,aP,"resetWhen",0,aL,"retryOrElse_Effect",0,sp,"retry_Effect",0,su,"retry_combined",0,sc,"run",0,aU,"scheduleDefectRefail",0,sn,"scheduleDefectRefailCause",0,si,"scheduleForked",0,sw,"scheduleFrom_Effect",0,sm,"schedule_Effect",0,sh,"secondOfMinute",0,e=>n0([-1/0,0],(t,r,i)=>{if(!Number.isInteger(e)||e<0||59<e)return n.dieSync(()=>new n.IllegalArgumentException(`Invalid argument in: secondOfMinute(${e}). Must be in range 0...59`));let a=i[1],s=((e,t,r)=>{let i=new Date(e);if(i.getSeconds()===t&&r)return e;if(i.getSeconds()<t)return i.setSeconds(t);let n=new Date(i.setSeconds(t));return n.setTime(n.getTime()+6e4)})(t,e,0===a),o=a5(s),l=a3(s),u=b(o,l);return n.succeed([[l,a+1],a,U(u)])}),"spaced",0,e=>n1(sb,()=>e),"stop",0,sE,"succeed",0,e=>av(sb,()=>e),"sync",0,e=>av(sb,e),"tapInput",0,aW,"tapOutput",0,aB,"unfold",0,aq,"union",0,a$,"unionWith",0,aj,"untilInput",0,aV,"untilInputEffect",0,aH,"untilOutput",0,aG,"untilOutputEffect",0,aK,"upTo",0,aJ,"whileInput",0,aZ,"whileInputEffect",0,aQ,"whileOutput",0,aY,"whileOutputEffect",0,aX,"windowed",0,e=>{let t=c.decode(e),r=c.toMillis(t);return n0([g.none(),0],(e,t,i)=>{let[a,s]=i;switch(a._tag){case"None":return n.succeed([[g.some(e),s+1],s,U(b(e+r,1/0))]);case"Some":return n.succeed([[g.some(a.value),s+1],s,U(b(e+(r-(e-a.value)%r),1/0))])}})},"zipLeft",0,a0,"zipRight",0,a1,"zipWith",0,a2],9992093);let sk=(0,t.dual)(2,(e,t)=>n.suspend(()=>{let r,i=0;return n.flatMap(n.whileLoop({while:()=>i<t.steps.length&&(void 0===r||r$.isLeft(r)),body:()=>{let a=t.steps[i],s=rz(e,a.provide);if(r){let e=!1,t=s;s=sn(su(s=n.suspend(()=>e?t:(e=!0,r)),sI(a,!1)))}else{let e=sI(a,!0);s=e?sn(su(s,e)):s}return n.either(s)},step:e=>{r=e,i++}}),()=>r)})),sI=(e,t)=>t?1!==e.attempts&&(e.schedule||e.attempts)?sd({schedule:e.schedule,while:e.while,times:e.attempts?e.attempts-1:void 0}):void 0:sd({schedule:e.schedule?e.schedule:e.attempts?void 0:sv,times:e.attempts,while:e.while});e.s(["scheduleFromStep",0,sI,"withExecutionPlan",0,sk],1650035);var sT=e.i(7459383),sx=e.i(9839518);let sC=e.i(6999262).DeferredTypeId,sR=n.deferredMake,sF=n.deferredMakeAs,sA=n.deferredAwait,sO=n.deferredComplete,s_=n.deferredCompleteWith,sM=n.deferredDone,sD=n.deferredFail,sN=n.deferredFailSync,sP=n.deferredFailCause,sL=n.deferredFailCauseSync,sU=n.deferredDie,sz=n.deferredDieSync,sW=n.deferredInterrupt,sB=n.deferredInterruptWith,sq=n.deferredIsDone,s$=n.deferredPoll,sj=n.deferredSucceed,sV=n.deferredSync,sH=n.deferredUnsafeMake,sG=n.deferredUnsafeDone;e.s(["DeferredTypeId",0,sC,"await",0,sA,"complete",0,sO,"completeWith",0,s_,"die",0,sU,"dieSync",0,sz,"done",0,sM,"fail",0,sD,"failCause",0,sP,"failCauseSync",0,sL,"failSync",0,sN,"interrupt",0,sW,"interruptWith",0,sB,"isDone",0,sq,"make",0,sR,"makeAs",0,sF,"poll",0,s$,"succeed",0,sj,"sync",0,sV,"unsafeDone",0,sG,"unsafeMake",0,sH],578549);let sK=Symbol.for("effect/MutableList"),sJ={[sK]:sK,[Symbol.iterator](){let e=!1,t=this.head;return{next(){if(e)return this.return();if(null==t)return e=!0,this.return();let r=t.value;return t=t.next,{done:e,value:r}},return:t=>(e||(e=!0),{done:!0,value:t})}},toString(){return(0,e8.format)(this.toJSON())},toJSON(){return{_id:"MutableList",values:Array.from(this).map(e8.toJSON)}},[e8.NodeInspectSymbol](){return this.toJSON()},pipe(){return(0,f.pipeArguments)(this,arguments)}},sZ=t.dual(2,(e,t)=>{let r={value:t,removed:!1,prev:void 0,next:void 0};return void 0===e.head&&(e.head=r),void 0===e.tail||(e.tail.next=r,r.prev=e.tail),e.tail=r,e._length+=1,e}),sQ=Symbol.for("effect/MutableQueue"),sY=Symbol.for("effect/mutable/MutableQueue/Empty"),sX={[sQ]:sQ,[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()},toString(){return(0,e8.format)(this.toJSON())},toJSON(){return{_id:"MutableQueue",values:Array.from(this).map(e8.toJSON)}},[e8.NodeInspectSymbol](){return this.toJSON()},pipe(){return(0,f.pipeArguments)(this,arguments)}},s0=e=>{let t,r=Object.create(sX);return(t=Object.create(sJ)).head=void 0,t.tail=void 0,t._length=0,r.queue=t,r.capacity=e,r},s1=()=>s0(void 0),s2=t.dual(2,(e,t)=>{let r=e.queue._length;return(void 0===e.capacity||r!==e.capacity)&&(sZ(t)(e.queue),!0)}),s5=t.dual(2,(e,t)=>{let r,i=t[Symbol.iterator](),n=m.empty(),a=!0;for(;a&&(r=i.next())&&!r.done;)a=s2(r.value)(e);for(;null!=r&&!r.done;)n=m.prepend(r.value)(n),r=i.next();return m.reverse(n)}),s3=t.dual(2,(e,t)=>{if(0===e.queue._length)return t;var r,i,n=e.queue;let a=n.head;return void 0!==a?(r=n,!(i=a).removed&&(i.removed=!0,void 0!==i.prev&&void 0!==i.next?(i.prev.next=i.next,i.next.prev=i.prev):void 0!==i.prev?(r.tail=i.prev,i.prev.next=void 0):void 0!==i.next?(r.head=i.next,i.next.prev=void 0):(r.tail=void 0,r.head=void 0),r._length>0&&(r._length-=1)),a.value):void 0}),s8=t.dual(2,(e,t)=>{let r=m.empty(),i=0;for(;i<t;){let t=s3(sY)(e);if(t===sY)break;r=m.prepend(t)(r),i+=1}return m.reverse(r)});e.s(["EmptyMutableQueue",0,sY,"bounded",0,e=>s0(e),"capacity",0,e=>void 0===e.capacity?1/0:e.capacity,"isEmpty",0,e=>0===e.queue._length,"length",0,e=>e.queue._length,"offer",0,s2,"offerAll",0,s5,"poll",0,s3,"pollUpTo",0,s8,"unbounded",0,s1],217551);var s4=e.i(432214),s6=e.i(3997316),s9=e.i(1088581);let s7=(e,t,r,i)=>s6.struct({_tag:"Complete",key:e,exit:t,entryStats:r,timeToLiveMillis:i}),oe=(e,t)=>s6.struct({_tag:"Pending",key:e,deferred:t}),ot=Symbol.for("effect/Cache/MapKey");class or{current;[ot]=ot;previous=void 0;next=void 0;constructor(e){this.current=e}[Y.symbol](){return(0,t.pipe)(Y.hash(this.current),Y.combine(Y.hash(this.previous)),Y.combine(Y.hash(this.next)),Y.cached(this))}[J.symbol](e){return this===e||on(e)&&J.equals(this.current,e.current)&&J.equals(this.previous,e.previous)&&J.equals(this.next,e.next)}}let oi=e=>new or(e),on=e=>(0,h.hasProperty)(e,ot);class oa{head=void 0;tail=void 0;add(e){if(e!==this.tail)if(void 0===this.tail)this.head=e,this.tail=e;else{let t=e.previous,r=e.next;void 0!==r&&(e.next=void 0,void 0!==t?(t.next=r,r.previous=t):(this.head=r,this.head.previous=void 0)),this.tail.next=e,e.previous=this.tail,this.tail=e}}remove(){let e=this.head;if(void 0!==e){let t=e.next;void 0!==t?(e.next=void 0,this.head=t,this.head.previous=void 0):(this.head=void 0,this.tail=void 0)}return e}}let os=Symbol.for("effect/Cache"),oo={_Key:e=>e,_Error:e=>e,_Value:e=>e},ol=Symbol.for("effect/ConsumerCache"),ou={_Key:e=>e,_Error:e=>e,_Value:e=>e},oc=e=>({loadedMillis:e});class od{capacity;context;fiberId;lookup;timeToLive;[os]=oo;[ol]=ou;cacheState;constructor(e,t,r,i,n){this.capacity=e,this.context=t,this.fiberId=r,this.lookup=i,this.timeToLive=n,this.cacheState=(()=>{let e,t;return e=X.empty(),t=new oa,{map:e,keys:t,accesses:s1(),updating:s4.make(!1),hits:0,misses:0}})()}get(e){return n.map(this.getEither(e),r$.merge)}get cacheStats(){return n.sync(()=>({hits:this.cacheState.hits,misses:this.cacheState.misses,size:X.size(this.cacheState.map)}))}getOption(e){return n.suspend(()=>g.match(X.get(this.cacheState.map,e),{onNone:()=>{let t=oi(e);return this.trackAccess(t),this.trackMiss(),n.succeed(g.none())},onSome:e=>this.resolveMapValue(e)}))}getOptionComplete(e){return n.suspend(()=>g.match(X.get(this.cacheState.map,e),{onNone:()=>{let t=oi(e);return this.trackAccess(t),this.trackMiss(),n.succeed(g.none())},onSome:e=>this.resolveMapValue(e,!0)}))}contains(e){return n.sync(()=>X.has(this.cacheState.map,e))}entryStats(e){return n.sync(()=>{let t=X.get(this.cacheState.map,e);if(g.isSome(t))switch(t.value._tag){case"Complete":{let e=t.value.entryStats.loadedMillis;return g.some(oc(e))}case"Pending":break;case"Refreshing":{let e=t.value.complete.entryStats.loadedMillis;return g.some(oc(e))}}return g.none()})}getEither(e){return n.suspend(()=>{let t,r,i=g.getOrUndefined(X.get(this.cacheState.map,e));return(void 0===i&&(r=sH(this.fiberId),t=oi(e),X.has(this.cacheState.map,e)?i=g.getOrUndefined(X.get(this.cacheState.map,e)):X.set(this.cacheState.map,e,oe(t,r))),void 0===i)?(this.trackAccess(t),this.trackMiss(),n.map(this.lookupValueOf(e,r),r$.right)):n.flatMap(this.resolveMapValue(i),g.match({onNone:()=>this.getEither(e),onSome:e=>n.succeed(r$.left(e))}))})}invalidate(e){return n.sync(()=>{X.remove(this.cacheState.map,e)})}invalidateWhen(e,t){return n.sync(()=>{let r=X.get(this.cacheState.map,e);g.isSome(r)&&"Complete"===r.value._tag&&"Success"===r.value.exit._tag&&t(r.value.exit.value)&&X.remove(this.cacheState.map,e)})}get invalidateAll(){return n.sync(()=>{this.cacheState.map=X.empty()})}refresh(e){return G.clockWith(r=>n.suspend(()=>{let i=sH(this.fiberId),a=g.getOrUndefined(X.get(this.cacheState.map,e));if(void 0===a&&(X.has(this.cacheState.map,e)?a=g.getOrUndefined(X.get(this.cacheState.map,e)):X.set(this.cacheState.map,e,oe(oi(e),i))),void 0===a)return n.asVoid(this.lookupValueOf(e,i));switch(a._tag){case"Complete":if(this.hasExpired(r,a.timeToLiveMillis)){let t=g.getOrUndefined(X.get(this.cacheState.map,e));return J.equals(t,a)&&X.remove(this.cacheState.map,e),n.asVoid(this.get(e))}return(0,t.pipe)(this.lookupValueOf(e,i),G.when(()=>{let t=g.getOrUndefined(X.get(this.cacheState.map,e));if(J.equals(t,a)){let t,r=(t=a,s6.struct({_tag:"Refreshing",deferred:i,complete:t}));return X.set(this.cacheState.map,e,r),!0}return!1}),n.asVoid);case"Pending":case"Refreshing":return sA(a.deferred)}}))}set(e,t){return G.clockWith(r=>n.sync(()=>{let i=r.unsafeCurrentTimeMillis(),n=Z.succeed(t),a=s7(oi(e),n,oc(i),i+c.toMillis(c.decode(this.timeToLive(n))));X.set(this.cacheState.map,e,a)}))}get size(){return n.sync(()=>X.size(this.cacheState.map))}get values(){return n.sync(()=>{let e=[];for(let t of this.cacheState.map)"Complete"===t[1]._tag&&"Success"===t[1].exit._tag&&e.push(t[1].exit.value);return e})}get entries(){return n.sync(()=>{let e=[];for(let t of this.cacheState.map)"Complete"===t[1]._tag&&"Success"===t[1].exit._tag&&e.push([t[0],t[1].exit.value]);return e})}get keys(){return n.sync(()=>{let e=[];for(let t of this.cacheState.map)"Complete"===t[1]._tag&&"Success"===t[1].exit._tag&&e.push(t[0]);return e})}resolveMapValue(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return G.clockWith(r=>{switch(e._tag){case"Complete":if(this.trackAccess(e.key),this.hasExpired(r,e.timeToLiveMillis))return X.remove(this.cacheState.map,e.key.current),n.succeed(g.none());return this.trackHit(),n.map(e.exit,g.some);case"Pending":if(this.trackAccess(e.key),this.trackHit(),t)return n.succeed(g.none());return n.map(sA(e.deferred),g.some);case"Refreshing":if(this.trackAccess(e.complete.key),this.trackHit(),this.hasExpired(r,e.complete.timeToLiveMillis)){if(t)return n.succeed(g.none());return n.map(sA(e.deferred),g.some)}return n.map(e.complete.exit,g.some)}})}trackHit(){this.cacheState.hits=this.cacheState.hits+1}trackMiss(){this.cacheState.misses=this.cacheState.misses+1}trackAccess(e){if(s2(this.cacheState.accesses,e),s4.compareAndSet(this.cacheState.updating,!1,!0)){let e=!0;for(;e;){let t=s3(this.cacheState.accesses,sY);t===sY?e=!1:this.cacheState.keys.add(t)}let t=X.size(this.cacheState.map);for(e=t>this.capacity;e;){let r=this.cacheState.keys.remove();void 0!==r?X.has(this.cacheState.map,r.current)&&(X.remove(this.cacheState.map,r.current),t-=1,e=t>this.capacity):e=!1}s4.set(this.cacheState.updating,!1)}}hasExpired(e,t){return e.unsafeCurrentTimeMillis()>t}lookupValueOf(e,r){return G.clockWith(i=>n.suspend(()=>(0,t.pipe)(this.lookup(e),n.provideContext(this.context),n.exit,n.flatMap(t=>{let a=i.unsafeCurrentTimeMillis(),s=oc(a),o=s7(oi(e),t,s,a+c.toMillis(c.decode(this.timeToLive(t))));return X.set(this.cacheState.map,e,o),n.zipRight(sM(r,t),t)}),n.onInterrupt(()=>n.zipRight(sW(r),n.sync(()=>{X.remove(this.cacheState.map,e)}))))))}}var op=e.i(4309139);let of=(0,rG.globalValue)(Symbol.for("effect/FiberRef/currentCache"),()=>{let e,t;return n.fiberRefUnsafeMake((e=()=>n.map(n.deferredMake(),e=>({listeners:new op.Listeners,handle:e})),t=()=>(0,c.seconds)(60),new od(65536,i.empty(),s9.none,e,e=>c.decode(t(e)))))}),oh=(0,rG.globalValue)(Symbol.for("effect/FiberRef/currentCacheEnabled"),()=>n.fiberRefUnsafeMake(!1)),om=(e,t)=>n.flatMap(n.isEffect(t)?t:n.succeed(t),t=>n.fiberIdWith(r=>{let i=new Proxy(e,{});return n.fiberRefGetWith(oh,e=>{if(e){let e=n.fiberRefGetWith(of,a=>n.flatMap(a.getEither(i),s=>{switch(s._tag){case"Left":if(s.left.listeners.interrupted)return n.flatMap(a.invalidateWhen(i,e=>e.handle===s.left.handle),()=>e);return s.left.listeners.increment(),n.uninterruptibleMask(e=>n.flatMap(n.exit(n.blocked(sx.empty,e(n.deferredAwait(s.left.handle)))),e=>(s.left.listeners.decrement(),e)));case"Right":return s.right.listeners.increment(),n.uninterruptibleMask(e=>n.flatMap(n.exit(n.blocked(sx.single(t,sx.makeEntry({request:i,result:s.right.handle,listeners:s.right.listeners,ownerId:r,state:{completed:!1}})),e(n.deferredAwait(s.right.handle)))),()=>(s.right.listeners.decrement(),n.deferredAwait(s.right.handle))))}}));return e}let a=new op.Listeners;return a.increment(),n.flatMap(n.deferredMake(),e=>(0,o.ensuring)(n.blocked(sx.single(t,sx.makeEntry({request:i,result:e,listeners:a,ownerId:r,state:{completed:!1}})),n.deferredAwait(e)),n.sync(()=>a.decrement())))})})),og=(e,t)=>n.fiberRefGetWith(oh,r=>r?n.fiberRefGetWith(of,r=>n.flatMap(r.getEither(e),e=>{switch(e._tag){case"Left":return n.void;case"Right":return n.deferredComplete(e.right.handle,t)}})):n.void),oy=(0,t.dual)(2,(e,t)=>n.fiberRefLocally(e,oh,t)),oS=(0,t.dual)(2,(e,t)=>n.fiberRefLocally(e,of,t));e.s(["cacheRequest",0,og,"currentCache",0,of,"currentCacheEnabled",0,oh,"fromRequest",0,om,"withRequestCache",0,oS,"withRequestCaching",0,oy],6902776);let ob=op.RequestTypeId,ov=op.isRequest,oE=op.of,ow=op.tagged,ok=op.Class,oI=op.TaggedClass,oT=op.complete,ox=o.interruptWhenPossible,oC=op.completeEffect,oR=op.fail,oF=op.failCause,oA=op.succeed,oO=Symbol.for("effect/RequestBlock.Entry"),o_=sx.isEntry,oM=sx.makeEntry;e.s(["Class",0,ok,"EntryTypeId",0,oO,"RequestTypeId",0,ob,"TaggedClass",0,oI,"complete",0,oT,"completeEffect",0,oC,"fail",0,oR,"failCause",0,oF,"interruptWhenPossible",0,ox,"isEntry",0,o_,"isRequest",0,ov,"makeCache",0,e=>{var t;let r,i;return t={...e,lookup:()=>n.map(n.deferredMake(),e=>({listeners:new op.Listeners,handle:e}))},r=c.decode(t.timeToLive),i={capacity:t.capacity,lookup:t.lookup,timeToLive:()=>r},n.map(o.all([n.context(),n.fiberId]),e=>{let[t,r]=e;return new od(i.capacity,t,r,i.lookup,e=>c.decode(i.timeToLive(e)))})},"makeEntry",0,oM,"of",0,oE,"succeed",0,oA,"tagged",0,ow],945364);var oD=e.i(4138091);let oN=n.EffectTypeId,oP=n.isEffect,oL=G.memoize,oU=G.once,oz=o.all,oW=o.allWith,oB=o.allSuccesses,oq=G.dropUntil,o$=G.dropWhile,oj=G.takeUntil,oV=G.takeWhile,oH=G.every,oG=o.exists,oK=o.filter,oJ=G.filterMap,oZ=G.findFirst,oQ=o.forEach,oY=G.head,oX=o.mergeAll,o0=o.partition,o1=G.reduce,o2=G.reduceWhile,o5=G.reduceRight,o3=o.reduceEffect,o8=o.replicate,o4=o.replicateEffect,o6=o.validateAll,o9=o.validateFirst,o7=n.async,le=n.custom,lt=n.withFiberRuntime,lr=n.fail,li=n.failSync,ln=n.failCause,la=n.failCauseSync,ls=n.die,lo=n.dieMessage,ll=n.dieSync,lu=n.gen,lc=n.never,ld=G.none,lp=G.promise,lf=n.succeed,lh=G.succeedNone,lm=G.succeedSome,lg=n.suspend,ly=n.sync,lS=n.void,lb=n.yieldNow,lv=G._catch,lE=n.catchAll,lw=n.catchAllCause,lk=G.catchAllDefect,lI=n.catchIf,lT=n.catchSome,lx=G.catchSomeCause,lC=G.catchSomeDefect,lR=G.catchTag,lF=G.catchTags,lA=G.cause,lO=G.eventually,l_=G.ignore,lM=G.ignoreLogged,lD=G.parallelErrors,lN=G.sandbox,lP=G.try_,lL=G.tryMap,lU=G.tryMapPromise,lz=G.tryPromise,lW=G.unsandbox,lB=G.allowInterrupt,lq=n.checkInterruptible,l$=o.disconnect,lj=n.interrupt,lV=n.interruptWith,lH=n.interruptible,lG=n.interruptibleMask,lK=n.onInterrupt,lJ=n.uninterruptible,lZ=n.uninterruptibleMask,lQ=G.liftPredicate,lY=n.as,lX=G.asSome,l0=G.asSomeError,l1=n.asVoid,l2=n.flip,l5=G.flipWith,l3=n.map,l8=G.mapAccum,l4=n.mapBoth,l6=n.mapError,l9=G.mapErrorCause,l7=G.merge,ue=G.negate,ut=o.acquireRelease,ur=o.acquireReleaseInterruptible,ui=n.acquireUseRelease,un=o.addFinalizer,ua=o.ensuring,us=n.onError,uo=n.onExit,ul=o.parallelFinalizers,uu=o.sequentialFinalizers,uc=o.finalizersMask,ud=o.scope,up=o.scopeWith,uf=o.scopedWith,uh=o.scopedEffect,um=o.using,ug=o.withEarlyRelease,uy=o.daemonChildren,uS=G.descriptor,ub=G.descriptorWith,uv=G.diffFiberRefs,uE=n.fiberId,uw=n.fiberIdWith,uk=o.fork,uI=o.forkDaemon,uT=o.forkWithErrorHandler,ux=n.transplant,uC=n.withConcurrency,uR=et.withScheduler,uF=n.withSchedulingPriority,uA=n.withMaxOpsBeforeYield,uO=G.clock,u_=G.clockWith,uM=o.withClockScoped,uD=a.withClock,uN=G.delay,uP=G.sleep,uL=G.timed,uU=G.timedWith,uz=a.configProviderWith,uW=a.withConfigProvider,uB=o.withConfigProviderScoped,uq=n.context,u$=G.contextWith,uj=n.contextWithEffect,uV=n.mapInputContext,uH=G.provideService,uG=G.provideServiceEffect,uK=G.serviceFunction,uJ=G.serviceFunctionEffect,uZ=G.serviceFunctions,uQ=G.serviceConstants,uY=G.serviceMembers,uX=G.serviceOption,u0=G.serviceOptional,u1=G.updateService,u2=G.Do,u5=G.bind,u3=G.bindTo,u8=G.let_,u4=G.option,u6=n.either,u9=n.exit,u7=n.intoDeferred,ce=n.if_,ct=G.filterOrDie,cr=G.filterOrDieMessage,ci=G.filterOrElse,cn=G.filterOrFail,ca=n.filterEffectOrElse,cs=n.filterEffectOrFail,co=G.unless,cl=G.unlessEffect,cu=G.when,cc=n.whenEffect,cd=G.whenFiberRef,cp=G.whenRef,cf=n.flatMap,ch=n.andThen,cm=n.flatten,cg=o.race,cy=o.raceAll,cS=o.raceWith,cb=G.summarized,cv=n.tap,cE=G.tapBoth,cw=G.tapDefect,ck=G.tapError,cI=G.tapErrorTag,cT=G.tapErrorCause,cx=G.forever,cC=G.iterate,cR=G.loop,cF=G.repeatN,cA=n.whileLoop,cO=G.fiberRefs,c_=G.inheritFiberRefs,cM=n.fiberRefLocally,cD=n.fiberRefLocallyWith,cN=o.fiberRefLocallyScoped,cP=o.fiberRefLocallyScopedWith,cL=G.patchFiberRefs,cU=G.setFiberRefs,cz=G.updateFiberRefs,cW=G.isFailure,cB=G.isSuccess,cq=G.match,c$=n.matchCause,cj=n.matchCauseEffect,cV=n.matchEffect,cH=G.log,cG=G.logTrace,cK=G.logDebug,cJ=G.logInfo,cZ=G.logWarning,cQ=G.logError,cY=G.logFatal,cX=G.withLogSpan,c0=G.annotateLogs,c1=o.annotateLogsScoped,c2=G.logAnnotations,c5=n.withUnhandledErrorLogLevel,c3=o.whenLogLevel,c8=n.orDie,c4=n.orDieWith,c6=n.orElse,c9=G.orElseFail,c7=G.orElseSucceed,de=G.firstSuccessOf,dt=G.random,dr=a.randomWith,di=a.withRandom,dn=(0,t.dual)(2,(e,t)=>di(e,n$(t))),da=o.withRandomScoped,ds=n.runtimeFlags,dl=n.updateRuntimeFlags,du=n.withRuntimeFlags,dc=o.withRuntimeFlagsScoped,dd=G.tagMetrics,dp=G.labelMetrics,df=o.tagMetricsScoped,dh=o.labelMetricsScoped,dm=n.metricLabels,dg=G.withMetric,dy=o.validate,dS=o.validateWith,db=o.zipOptions,dv=o.zipLeftOptions,dE=o.zipRightOptions,dw=o.zipWithOptions,dk=(0,t.dual)(2,(e,t)=>dw(e,t,(e,t)=>e(t))),dI=n.blocked,dT=n.runRequestBlock,dx=n.step,dC=(0,t.dual)(e=>ov(e[0]),om),dR=n.withRequestBatching,dF=G.tracer,dA=a.tracerWith,dO=a.withTracer,d_=o.withTracerScoped,dM=n.withTracerEnabled,dD=n.withTracerTiming,dN=G.annotateSpans,dP=G.annotateCurrentSpan,dL=G.currentSpan,dU=G.currentParentSpan,dz=G.spanAnnotations,dW=G.spanLinks,dB=G.linkSpans,dq=G.linkSpanCurrent,d$=G.makeSpan,dj=o.makeSpanScoped,dV=G.useSpan,dH=G.withSpan,dG=G.functionWithSpan,dK=o.withSpanScoped,dJ=G.withParentSpan,dZ=G.fromNullable,dQ=G.optionFromOptional,dY=(0,t.dual)(2,(e,t)=>sT.isNone(e)?lh:l3(t(e.value),sT.some)),dX=e=>{let t=new Map;return new Proxy(e,{get(e,r,i){if(r in e)return Reflect.get(e,r,i);if(t.has(r))return t.get(r);let a=function(){for(var i=arguments.length,a=Array(i),s=0;s<i;s++)a[s]=arguments[s];return n.andThen(e,i=>"function"==typeof i[r]?(t.set(r,function(){for(var t=arguments.length,i=Array(t),a=0;a<t;a++)i[a]=arguments[a];return n.andThen(e,e=>e[r](...i))}),i[r](...a)):(t.set(r,n.andThen(e,e=>e[r])),i[r]))},s=n.andThen(e,e=>e[r]);Object.assign(a,s);let o=a.apply,l=a.bind,u=a.call,c=Object.setPrototypeOf({},Object.getPrototypeOf(s));return c.apply=o,c.bind=l,c.call=u,Object.setPrototypeOf(a,c),t.set(r,a),a}})};function d0(e,t){return Object.defineProperty(t,"length",{value:e,configurable:!0})}function d1(e){let t,i;if((0,oD.isGeneratorFunction)(e.body))t=n.fromIterator(()=>e.body.apply(e.self,e.args));else try{t=e.body.apply(e.self,e.args)}catch(e){i=e,t=ls(e)}if(e.pipeables.length>0)try{for(let r of e.pipeables)t=r(t,...e.args)}catch(e){t=i?ln(r.sequential(r.die(i),r.die(e))):ls(e)}let a=!1,s=e.spanOptions&&"captureStackTrace"in e.spanOptions?e.spanOptions:{captureStackTrace:()=>{if(!1!==a)return a;if(e.errorCall.stack){let t=e.errorDef.stack.trim().split("\n"),r=e.errorCall.stack.trim().split("\n"),i=t.slice(2).join("\n").trim();i.includes("(")||(i=i.replace(/at (.*)/,"at ($1)"));let n=r.slice(2).join("\n").trim();return n.includes("(")||(n=n.replace(/at (.*)/,"at ($1)")),a=`${i}
${n}`}},...e.spanOptions};return dH(t,e.spanName,s)}let d2=n.fnUntraced;e.s(["Do",0,u2,"EffectTypeId",0,oN,"Service",0,function(){return function(){let e,[t,r]=arguments,i="accessors"in r&&r.accessors,a=Error.stackTraceLimit;Error.stackTraceLimit=2;let s=Error();Error.stackTraceLimit=a;let o="unchecked",l=function(e){if("unchecked"===o){let t=Object.getPrototypeOf(e);t===Object.prototype||null===t?o="plain":(Object.setPrototypeOf(Object.getPrototypeOf(this),t),o="patched")}if("plain"===o)Object.assign(this,e);else if("patched"===o)return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e};l.prototype._tag=t,Object.defineProperty(l,"make",{get(){return e=>new this(e)}}),Object.defineProperty(l,"use",{get(){return e=>n.andThen(this,e)}}),l.key=t,Object.assign(l,rq.TagProto),Object.defineProperty(l,"stack",{get:()=>s.stack});let u="dependencies"in r&&r.dependencies.length>0,c=u?"DefaultWithoutDependencies":"Default",d=!1;if("effect"in r?(d="function"==typeof r.effect,Object.defineProperty(l,c,{get(){return d?(function(){return t7(l,l3(r.effect.apply(null,arguments),e=>new this(e)))}).bind(this):e??=t7(l,l3(r.effect,e=>new this(e)))}})):"scoped"in r?(d="function"==typeof r.scoped,Object.defineProperty(l,c,{get(){return d?(function(){return ry(l,l3(r.scoped.apply(null,arguments),e=>new this(e)))}).bind(this):e??=ry(l,l3(r.scoped,e=>new this(e)))}})):"sync"in r?Object.defineProperty(l,c,{get(){return e??=rT(l,()=>new this(r.sync()))}}):Object.defineProperty(l,c,{get(){return e??=rE(l,new this(r.succeed))}}),u){let e;Object.defineProperty(l,"Default",{get(){return d?function(){return rA(this.DefaultWithoutDependencies.apply(null,arguments),r.dependencies)}:e??=rA(this.DefaultWithoutDependencies,r.dependencies)}})}return!0===i?dX(l):l}},"Tag",0,e=>()=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=2;let r=Error();function i(){}return Error.stackTraceLimit=t,Object.setPrototypeOf(i,rq.TagProto),i.key=e,Object.defineProperty(i,"use",{get(){return e=>n.andThen(this,e)}}),Object.defineProperty(i,"stack",{get:()=>r.stack}),dX(i)},"acquireRelease",0,ut,"acquireReleaseInterruptible",0,ur,"acquireUseRelease",0,ui,"addFinalizer",0,un,"all",0,oz,"allSuccesses",0,oB,"allWith",0,oW,"allowInterrupt",0,lB,"andThen",0,ch,"annotateCurrentSpan",0,dP,"annotateLogs",0,c0,"annotateLogsScoped",0,c1,"annotateSpans",0,dN,"ap",0,dk,"as",0,lY,"asSome",0,lX,"asSomeError",0,l0,"asVoid",0,l1,"async",0,o7,"asyncEffect",0,tA,"awaitAllChildren",0,ep,"bind",0,u5,"bindAll",0,eV,"bindTo",0,u3,"blocked",0,dI,"cacheRequestResult",0,og,"cached",0,oL,"cachedFunction",0,eC,"cachedInvalidateWithTTL",0,eh,"cachedWithTTL",0,ef,"catch",0,lv,"catchAll",0,lE,"catchAllCause",0,lw,"catchAllDefect",0,lk,"catchIf",0,lI,"catchSome",0,lT,"catchSomeCause",0,lx,"catchSomeDefect",0,lC,"catchTag",0,lR,"catchTags",0,lF,"cause",0,lA,"checkInterruptible",0,lq,"clock",0,uO,"clockWith",0,u_,"configProviderWith",0,uz,"console",0,rW,"consoleWith",0,e=>n.fiberRefGetWith(a.currentServices,t=>e(i.get(t,s.consoleTag))),"context",0,uq,"contextWith",0,u$,"contextWithEffect",0,uj,"currentParentSpan",0,dU,"currentSpan",0,dL,"custom",0,le,"daemonChildren",0,uy,"delay",0,uN,"descriptor",0,uS,"descriptorWith",0,ub,"die",0,ls,"dieMessage",0,lo,"dieSync",0,ll,"diffFiberRefs",0,uv,"disconnect",0,l$,"dropUntil",0,oq,"dropWhile",0,o$,"either",0,u6,"ensureErrorType",0,()=>e=>e,"ensureRequirementsType",0,()=>e=>e,"ensureSuccessType",0,()=>e=>e,"ensuring",0,ua,"ensuringChild",0,eS,"ensuringChildren",0,eb,"eventually",0,lO,"every",0,oH,"exists",0,oG,"exit",0,u9,"fail",0,lr,"failCause",0,ln,"failCauseSync",0,la,"failSync",0,li,"fiberId",0,uE,"fiberIdWith",0,uw,"filter",0,oK,"filterEffectOrElse",0,ca,"filterEffectOrFail",0,cs,"filterMap",0,oJ,"filterOrDie",0,ct,"filterOrDieMessage",0,cr,"filterOrElse",0,ci,"filterOrFail",0,cn,"finalizersMask",0,uc,"findFirst",0,oZ,"firstSuccessOf",0,de,"flatMap",0,cf,"flatten",0,cm,"flip",0,l2,"flipWith",0,l5,"fn",0,function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];let n=Error.stackTraceLimit;Error.stackTraceLimit=2;let a=Error();if(Error.stackTraceLimit=n,"string"!=typeof e)return d0(e.length,function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];let s=Error.stackTraceLimit;Error.stackTraceLimit=2;let o=Error();return Error.stackTraceLimit=s,d1({self:this,body:e,args:i,pipeables:r,spanName:"<anonymous>",spanOptions:{context:tz.DisablePropagation.context(!0)},errorDef:a,errorCall:o})});let s=r[0];return function(t){for(var r=arguments.length,i=Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];return d0(t.length,{[e](){for(var r=arguments.length,n=Array(r),o=0;o<r;o++)n[o]=arguments[o];let l=Error.stackTraceLimit;Error.stackTraceLimit=2;let u=Error();return Error.stackTraceLimit=l,d1({self:this,body:t,args:n,pipeables:i,spanName:e,spanOptions:s,errorDef:a,errorCall:u})}}[e])}},"fnUntraced",0,d2,"forEach",0,oQ,"forever",0,cx,"fork",0,uk,"forkAll",0,ev,"forkDaemon",0,uI,"forkIn",0,eE,"forkScoped",0,ew,"forkWithErrorHandler",0,uT,"fromFiber",0,ek,"fromFiberEffect",0,eI,"fromNullable",0,dZ,"functionWithSpan",0,dG,"gen",0,lu,"getFiberRefs",0,cO,"getRuntimeFlags",0,ds,"head",0,oY,"if",0,ce,"ignore",0,l_,"ignoreLogged",0,lM,"inheritFiberRefs",0,c_,"interrupt",0,lj,"interruptWith",0,lV,"interruptible",0,lH,"interruptibleMask",0,lG,"intoDeferred",0,u7,"isEffect",0,oP,"isFailure",0,cW,"isSuccess",0,cB,"iterate",0,cC,"labelMetrics",0,dp,"labelMetricsScoped",0,dh,"let",0,u8,"liftPredicate",0,lQ,"linkSpanCurrent",0,dq,"linkSpans",0,dB,"locally",0,cM,"locallyScoped",0,cN,"locallyScopedWith",0,cP,"locallyWith",0,cD,"log",0,cH,"logAnnotations",0,c2,"logDebug",0,cK,"logError",0,cQ,"logFatal",0,cY,"logInfo",0,cJ,"logTrace",0,cG,"logWarning",0,cZ,"logWithLevel",0,function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return G.logWithLevel(e)(...r)},"loop",0,cR,"makeLatch",0,ed,"makeSemaphore",0,el,"makeSpan",0,d$,"makeSpanScoped",0,dj,"map",0,l3,"mapAccum",0,l8,"mapBoth",0,l4,"mapError",0,l6,"mapErrorCause",0,l9,"mapInputContext",0,uV,"match",0,cq,"matchCause",0,c$,"matchCauseEffect",0,cj,"matchEffect",0,cV,"merge",0,l7,"mergeAll",0,oX,"metricLabels",0,dm,"negate",0,ue,"never",0,lc,"none",0,ld,"onError",0,us,"onExit",0,uo,"onInterrupt",0,lK,"once",0,oU,"option",0,u4,"optionFromOptional",0,dQ,"orDie",0,c8,"orDieWith",0,c4,"orElse",0,c6,"orElseFail",0,c9,"orElseSucceed",0,c7,"parallelErrors",0,lD,"parallelFinalizers",0,ul,"partition",0,o0,"patchFiberRefs",0,cL,"patchRuntimeFlags",0,dl,"promise",0,lp,"provide",0,rz,"provideService",0,uH,"provideServiceEffect",0,uG,"race",0,cg,"raceAll",0,cy,"raceFirst",0,eR,"raceWith",0,cS,"random",0,dt,"randomWith",0,dr,"reduce",0,o1,"reduceEffect",0,o3,"reduceRight",0,o5,"reduceWhile",0,o2,"repeat",0,ss,"repeatN",0,cF,"repeatOrElse",0,so,"replicate",0,o8,"replicateEffect",0,o4,"request",0,dC,"retry",0,sc,"retryOrElse",0,sp,"runCallback",0,tI,"runFork",0,tT,"runPromise",0,tx,"runPromiseExit",0,tC,"runRequestBlock",0,dT,"runSync",0,tR,"runSyncExit",0,tF,"runtime",0,tf,"sandbox",0,lN,"schedule",0,sh,"scheduleForked",0,sw,"scheduleFrom",0,sm,"scope",0,ud,"scopeWith",0,up,"scoped",0,uh,"scopedWith",0,uf,"sequentialFinalizers",0,uu,"serviceConstants",0,uQ,"serviceFunction",0,uK,"serviceFunctionEffect",0,uJ,"serviceFunctions",0,uZ,"serviceMembers",0,uY,"serviceOption",0,uX,"serviceOptional",0,u0,"setFiberRefs",0,cU,"sleep",0,uP,"spanAnnotations",0,dz,"spanLinks",0,dW,"step",0,dx,"succeed",0,lf,"succeedNone",0,lh,"succeedSome",0,lm,"summarized",0,cb,"supervised",0,eF,"suspend",0,lg,"sync",0,ly,"tagMetrics",0,dd,"tagMetricsScoped",0,df,"takeUntil",0,oj,"takeWhile",0,oV,"tap",0,cv,"tapBoth",0,cE,"tapDefect",0,cw,"tapError",0,ck,"tapErrorCause",0,cT,"tapErrorTag",0,cI,"timed",0,uL,"timedWith",0,uU,"timeout",0,eA,"timeoutFail",0,eO,"timeoutFailCause",0,e_,"timeoutOption",0,eM,"timeoutTo",0,eD,"tracer",0,dF,"tracerWith",0,dA,"transplant",0,ux,"transposeMapOption",0,dY,"transposeOption",0,e=>sT.isNone(e)?lh:l3(e.value,sT.some),"try",0,lP,"tryMap",0,lL,"tryMapPromise",0,lU,"tryPromise",0,lz,"uninterruptible",0,lJ,"uninterruptibleMask",0,lZ,"unless",0,co,"unlessEffect",0,cl,"unsafeMakeLatch",0,ec,"unsafeMakeSemaphore",0,eo,"unsandbox",0,lW,"updateFiberRefs",0,cz,"updateService",0,u1,"useSpan",0,dV,"using",0,um,"validate",0,dy,"validateAll",0,o6,"validateFirst",0,o9,"validateWith",0,dS,"void",0,lS,"when",0,cu,"whenEffect",0,cc,"whenFiberRef",0,cd,"whenLogLevel",0,c3,"whenRef",0,cp,"whileLoop",0,cA,"withClock",0,uD,"withClockScoped",0,uM,"withConcurrency",0,uC,"withConfigProvider",0,uW,"withConfigProviderScoped",0,uB,"withConsole",0,rB,"withConsoleScoped",0,e=>o.fiberRefLocallyScopedWith(a.currentServices,i.add(s.consoleTag,e)),"withEarlyRelease",0,ug,"withExecutionPlan",0,sk,"withFiberRuntime",0,lt,"withLogSpan",0,cX,"withMaxOpsBeforeYield",0,uA,"withMetric",0,dg,"withParentSpan",0,dJ,"withRandom",0,di,"withRandomFixed",0,dn,"withRandomScoped",0,da,"withRequestBatching",0,dR,"withRequestCache",0,oS,"withRequestCaching",0,oy,"withRuntimeFlagsPatch",0,du,"withRuntimeFlagsPatchScoped",0,dc,"withScheduler",0,uR,"withSchedulingPriority",0,uF,"withSpan",0,dH,"withSpanScoped",0,dK,"withTracer",0,dO,"withTracerEnabled",0,dM,"withTracerScoped",0,d_,"withTracerTiming",0,dD,"withUnhandledErrorLogLevel",0,c5,"yieldNow",0,lb,"zip",0,db,"zipLeft",0,dv,"zipRight",0,dE,"zipWith",0,dw],3322401)},5310088,e=>{"use strict";var t=e.i(210165);let r=t.unsafeFork;t.unsafeRunSyncExit;let i=t.unsafeRunSync,n=t.unsafeRunCallback;t.unsafeRunPromise;let a=t.unsafeRunPromiseExit,s=t.defaultRuntime;t.defaultRuntimeFlags;let o=t.make;t.FiberFailureCauseId,t.isAsyncFiberException,t.isFiberFailure,t.fiberFailure,t.updateRuntimeFlags,t.enableRuntimeFlag,t.disableRuntimeFlag;let l=t.updateContext;t.provideService,t.updateFiberRefs,t.setFiberRef,t.deleteFiberRef,e.s(["defaultRuntime",0,s,"make",0,o,"runCallback",0,n,"runFork",0,r,"runPromiseExit",0,a,"runSync",0,i,"updateContext",0,l])},1661171,e=>{"use strict";let t;var r=e.i(5450905),i=e.i(578549),n=e.i(3322401),a=e.i(7836076),s=e.i(6028004),o=e.i(1150852),l=e.i(3683485),u=e.i(9390854),c=e.i(2873450);e.i(8815901);var d=e.i(9960543),p=e.i(4935619),f=e.i(5310088);let h=Symbol.for("effect/FiberHandle"),m={[h]:h,toString(){return c.format(this.toJSON())},toJSON(){return{_id:"FiberHandle",state:this.state}},[c.NodeInspectSymbol](){return this.toJSON()},pipe(){return(0,d.pipeArguments)(this,arguments)}},g=o.make(-1,0),y=r.reduceWithContext(void 0,{emptyCase:l.constFalse,failCase:l.constFalse,dieCase:l.constFalse,interruptCase:(e,t)=>u.has(o.ids(t),-1),sequentialCase:(e,t,r)=>t||r,parallelCase:(e,t,r)=>t||r}),S=(0,l.dual)(e=>{let t;return t=e[0],p.hasProperty(t,h)},(e,t,n)=>{if("Closed"===e.state._tag)return void t.unsafeInterruptAsFork(o.combine(n?.interruptAs??o.none,g));if(void 0!==e.state.fiber){if(n?.onlyIfMissing===!0)return void t.unsafeInterruptAsFork(o.combine(n?.interruptAs??o.none,g));if(e.state.fiber===t)return;e.state.fiber.unsafeInterruptAsFork(o.combine(n?.interruptAs??o.none,g)),e.state.fiber=void 0}e.state.fiber=t,t.addObserver(s=>{"Open"===e.state._tag&&t===e.state.fiber&&(e.state.fiber=void 0),!a.isFailure(s)||(n?.propagateInterruption===!0?y(s.cause):r.isInterruptedOnly(s.cause))||i.unsafeDone(e.deferred,s)})}),b=()=>(void 0===t&&(t=n.runFork(n.interrupt)),t);e.s(["makeRuntime",0,()=>n.flatMap(n.acquireRelease(n.map(i.make(),e=>{let t;return(t=Object.create(m)).state={_tag:"Open",fiber:void 0},t.deferred=e,t}),e=>n.withFiberRuntime(t=>{let r=e.state;return"Closed"===r._tag?n.void:(e.state={_tag:"Closed"},r.fiber?n.intoDeferred(n.asVoid(s.interruptAs(r.fiber,o.combine(t.id(),g))),e.deferred):i.done(e.deferred,a.void))})),e=>{let t;return(t=e,()=>n.map(n.runtime(),e=>{let r=f.runFork(e);return(e,i)=>{if("Closed"===t.state._tag||void 0!==t.state.fiber&&i?.onlyIfMissing===!0)return b();let n=r(e,i);return S(t,n,i),n}}))()})])},9227260,e=>{"use strict";var t=e.i(5972454),r=e.i(3683485),i=e.i(7948698),n=e.i(7548658),a=e.i(7294722),s=e.i(1658800),o=e.i(2067266),l=e.i(9390854),u=e.i(1191948);e.i(3603490),e.i(5663534);var c=e.i(3427637);u.CooperativeYielding,u.Interruption,u.OpSupervision,u.RuntimeMetrics,u.WindDown,u.CooperativeYielding,u.Interruption,u.OpSupervision,u.RuntimeMetrics,u.WindDown;var d=e.i(6902776),p=e.i(5525866),f=e.i(2916763);let h=o.LayerTypeId,m=o.MemoMapTypeId,g=o.CurrentMemoMap,y=o.isLayer,S=o.isFresh,b=o.annotateLogs,v=o.annotateSpans,E=o.build,w=o.buildWithScope,k=o.catchAll,I=o.catchAllCause,T=o.context,x=o.die,C=o.dieSync,R=o.discard,F=o.fromEffect,A=o.fromEffectDiscard,O=o.fromEffectContext,_=o.empty,M=o.extendScope,D=o.fail,N=o.failSync,P=o.failCause,L=o.failCauseSync,U=o.flatMap,z=o.flatten,W=o.fresh,B=o.mock,q=o.fromFunction,$=o.launch,j=o.map,V=o.mapError,H=o.match,G=o.matchCause,K=o.memoize,J=o.merge,Z=o.mergeAll,Q=o.orDie,Y=o.orElse,X=o.passthrough,ee=o.project,et=o.locallyEffect,er=o.fiberRefLocally,ei=o.fiberRefLocallyWith,en=o.fiberRefLocallyScoped,ea=o.fiberRefLocallyScopedWith,es=o.retry,eo=o.scope,el=o.scoped,eu=o.scopedDiscard,ec=o.scopedContext,ed=o.service,ep=o.succeed,ef=o.succeedContext,eh=o.suspend,em=o.sync,eg=o.syncContext,ey=o.tap,eS=o.tapError,eb=o.tapErrorCause,ev=o.toRuntime,eE=o.toRuntimeWithMemoMap,ew=o.provide,ek=o.provideMerge,eI=o.zipWith,eT=o.unwrapEffect,ex=o.unwrapScoped,eC=o.withSpan,eR=o.withParentSpan,eF=o.makeMemoMap,eA=o.buildWithMemoMap,eO=(0,r.dual)(3,(e,r,i)=>ew(e,j(T(),e=>t.add(e,r,i(t.unsafeGet(e,r))))));e.s(["CurrentMemoMap",0,g,"LayerTypeId",0,h,"MemoMapTypeId",0,m,"annotateLogs",0,b,"annotateSpans",0,v,"build",0,E,"buildWithMemoMap",0,eA,"buildWithScope",0,w,"catchAll",0,k,"catchAllCause",0,I,"context",0,T,"die",0,x,"dieSync",0,C,"discard",0,R,"effect",0,F,"effectContext",0,O,"effectDiscard",0,A,"empty",0,_,"extendScope",0,M,"fail",0,D,"failCause",0,P,"failCauseSync",0,L,"failSync",0,N,"fiberRefLocallyScopedWith",0,ea,"flatMap",0,U,"flatten",0,z,"fresh",0,W,"function",0,q,"isFresh",0,S,"isLayer",0,y,"launch",0,$,"locally",0,er,"locallyEffect",0,et,"locallyScoped",0,en,"locallyWith",0,ei,"makeMemoMap",0,eF,"map",0,j,"mapError",0,V,"match",0,H,"matchCause",0,G,"memoize",0,K,"merge",0,J,"mergeAll",0,Z,"mock",0,B,"orDie",0,Q,"orElse",0,Y,"parentSpan",0,e=>o.succeedContext(t.make(c.spanTag,e)),"passthrough",0,X,"project",0,ee,"provide",0,ew,"provideMerge",0,ek,"retry",0,es,"scope",0,eo,"scoped",0,el,"scopedContext",0,ec,"scopedDiscard",0,eu,"service",0,ed,"setClock",0,e=>eu(s.fiberRefLocallyScopedWith(a.currentServices,t.add(i.clockTag,e))),"setConfigProvider",0,e=>o.scopedDiscard(s.withConfigProviderScoped(e)),"setRandom",0,e=>eu(s.fiberRefLocallyScopedWith(a.currentServices,t.add(p.randomTag,e))),"setRequestBatching",0,e=>eu(s.fiberRefLocallyScoped(n.currentRequestBatching,e)),"setRequestCache",0,e=>eu(n.isEffect(e)?n.flatMap(e,e=>s.fiberRefLocallyScoped(d.currentCache,e)):s.fiberRefLocallyScoped(d.currentCache,e)),"setRequestCaching",0,e=>eu(s.fiberRefLocallyScoped(d.currentCacheEnabled,e)),"setScheduler",0,e=>eu(s.fiberRefLocallyScoped(f.currentScheduler,e)),"setTracer",0,e=>o.scopedDiscard(s.withTracerScoped(e)),"setTracerEnabled",0,e=>eu(s.fiberRefLocallyScoped(n.currentTracerEnabled,e)),"setTracerTiming",0,e=>eu(s.fiberRefLocallyScoped(n.currentTracerTimingEnabled,e)),"setUnhandledErrorLogLevel",0,e=>eu(s.fiberRefLocallyScoped(n.currentUnhandledErrorLogLevel,e)),"setVersionMismatchErrorLogLevel",0,e=>eu(s.fiberRefLocallyScoped(n.currentVersionMismatchErrorLogLevel,e)),"span",0,(e,t)=>(t=c.addSpanStackTrace(t),o.scoped(c.spanTag,t?.onEnd?n.tap(s.makeSpanScoped(e,t),e=>s.addFinalizer(r=>t.onEnd(e,r))):s.makeSpanScoped(e,t))),"succeed",0,ep,"succeedContext",0,ef,"suspend",0,eh,"sync",0,em,"syncContext",0,eg,"tap",0,ey,"tapError",0,eS,"tapErrorCause",0,eb,"toRuntime",0,ev,"toRuntimeWithMemoMap",0,eE,"unwrapEffect",0,eT,"unwrapScoped",0,ex,"updateService",0,eO,"withParentSpan",0,eR,"withSpan",0,eC,"zipWith",0,eI],9227260)},6098979,e=>{"use strict";var t=e.i(7548658),r=e.i(1658800),i=e.i(6902776),n=e.i(2916763);t.FiberRefTypeId,r.fiberRefMake,r.fiberRefMakeWith,r.fiberRefMakeContext,r.fiberRefMakeRuntimeFlags;let a=t.fiberRefUnsafeMake;t.fiberRefUnsafeMakeHashSet,t.fiberRefUnsafeMakeContext,r.fiberRefUnsafeMakeSupervisor,t.fiberRefUnsafeMakePatch;let s=t.fiberRefGet;t.fiberRefGetAndSet,t.fiberRefGetAndUpdate,t.fiberRefGetAndUpdateSome;let o=t.fiberRefGetWith;t.fiberRefSet,t.fiberRefDelete,t.fiberRefReset,t.fiberRefModify,t.fiberRefModifySome,t.fiberRefUpdate,t.fiberRefUpdateSome,t.fiberRefUpdateAndGet,t.fiberRefUpdateSomeAndGet,t.currentConcurrency,t.currentRequestBatching,i.currentCache,i.currentCacheEnabled;let l=t.currentContext,u=t.currentSchedulingPriority;t.currentMaxOpsBeforeYield,t.currentUnhandledErrorLogLevel,t.currentVersionMismatchErrorLogLevel,t.currentLogAnnotations,r.currentLoggers,t.currentLogLevel,r.currentMinimumLogLevel,t.currentLogSpan,r.currentRuntimeFlags;let c=n.currentScheduler;r.currentSupervisor,t.currentMetricLabels;let d=t.currentTracerEnabled,p=t.currentTracerTimingEnabled;t.currentTracerSpanAnnotations,t.currentTracerSpanLinks,t.currentInterruptedCause,e.s(["currentContext",0,l,"currentScheduler",0,c,"currentSchedulingPriority",0,u,"currentTracerEnabled",0,d,"currentTracerTimingEnabled",0,p,"get",0,s,"getWith",0,o,"unsafeMake",0,a])},8398712,e=>{"use strict";var t=e.i(5283034),r=e.i(7862555),i=e.i(7525378),n=e.i(3683485),a=e.i(217551),s=e.i(432214),o=e.i(8815901),l=e.i(9960543),u=e.i(4935619),c=e.i(7548658),d=e.i(1658800);let p=Symbol.for("effect/QueueEnqueue"),f=Symbol.for("effect/QueueDequeue"),h=Symbol.for("effect/QueueStrategy"),m=Symbol.for("effect/BackingQueue"),g={_A:e=>e},y={_A:e=>e},S={_In:e=>e},b={_Out:e=>e};class v extends i.Class{queue;takers;shutdownHook;shutdownFlag;strategy;[p]=S;[f]=b;constructor(e,t,r,i,n){super(),this.queue=e,this.takers=t,this.shutdownHook=r,this.shutdownFlag=i,this.strategy=n}pipe(){return(0,l.pipeArguments)(this,arguments)}commit(){return this.take}capacity(){return this.queue.capacity()}get size(){return c.suspend(()=>c.catchAll(this.unsafeSize(),()=>c.interrupt))}unsafeSize(){return s.get(this.shutdownFlag)?o.none():o.some(this.queue.length()-a.length(this.takers)+this.strategy.surplusSize())}get isEmpty(){return c.map(this.size,e=>e<=0)}get isFull(){return c.map(this.size,e=>e>=this.capacity())}get shutdown(){return c.uninterruptible(c.withFiberRuntime(e=>((0,n.pipe)(this.shutdownFlag,s.set(!0)),(0,n.pipe)(d.forEachConcurrentDiscard(q(this.takers),t=>c.deferredInterruptWith(t,e.id()),!1,!1),c.zipRight(this.strategy.shutdown),c.whenEffect(c.deferredSucceed(this.shutdownHook,void 0)),c.asVoid))))}get isShutdown(){return c.sync(()=>s.get(this.shutdownFlag))}get awaitShutdown(){return c.deferredAwait(this.shutdownHook)}isActive(){return!s.get(this.shutdownFlag)}unsafeOffer(e){let t;if(s.get(this.shutdownFlag))return!1;if(0===this.queue.length()){let r=(0,n.pipe)(this.takers,a.poll(a.EmptyMutableQueue));r!==a.EmptyMutableQueue?(W(r,e),t=!0):t=!1}else t=!1;if(t)return!0;let r=this.queue.offer(e);return V(this.strategy,this.queue,this.takers),r}offer(e){return c.suspend(()=>{let t;if(s.get(this.shutdownFlag))return c.interrupt;if(0===this.queue.length()){let r=(0,n.pipe)(this.takers,a.poll(a.EmptyMutableQueue));r!==a.EmptyMutableQueue?(W(r,e),t=!0):t=!1}else t=!1;if(t)return c.succeed(!0);let r=this.queue.offer(e);return V(this.strategy,this.queue,this.takers),r?c.succeed(!0):this.strategy.handleSurplus([e],this.queue,this.takers,this.shutdownFlag)})}offerAll(e){return c.suspend(()=>{if(s.get(this.shutdownFlag))return c.interrupt;let i=t.fromIterable(e),a=0===this.queue.length()?t.fromIterable($(this.takers,i.length)):t.empty,[o,l]=(0,n.pipe)(i,t.splitAt(a.length));for(let e=0;e<a.length;e++)W(a[e],o[e]);if(0===l.length)return c.succeed(!0);let u=this.queue.offerAll(l);return V(this.strategy,this.queue,this.takers),r.isEmpty(u)?c.succeed(!0):this.strategy.handleSurplus(u,this.queue,this.takers,this.shutdownFlag)})}get take(){return c.withFiberRuntime(e=>{if(s.get(this.shutdownFlag))return c.interrupt;let t=this.queue.poll(a.EmptyMutableQueue);if(t!==a.EmptyMutableQueue)return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),c.succeed(t);{let t=c.deferredUnsafeMake(e.id());return(0,n.pipe)(c.suspend(()=>((0,n.pipe)(this.takers,a.offer(t)),V(this.strategy,this.queue,this.takers),s.get(this.shutdownFlag)?c.interrupt:c.deferredAwait(t))),c.onInterrupt(()=>c.sync(()=>j(this.takers,t))))}})}get takeAll(){return c.suspend(()=>s.get(this.shutdownFlag)?c.interrupt:c.sync(()=>{let e=this.queue.pollUpTo(1/0);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),r.fromIterable(e)}))}takeUpTo(e){return c.suspend(()=>s.get(this.shutdownFlag)?c.interrupt:c.sync(()=>{let t=this.queue.pollUpTo(e);return this.strategy.unsafeOnQueueEmptySpace(this.queue,this.takers),r.fromIterable(t)}))}takeBetween(e,t){return c.suspend(()=>E(this,e,t,r.empty()))}}let E=(e,t,i,a)=>i<t?c.succeed(a):(0,n.pipe)(O(e,i),c.flatMap(s=>{let o=t-s.length;return 1===o?(0,n.pipe)(A(e),c.map(e=>(0,n.pipe)(a,r.appendAll(s),r.append(e)))):o>1?(0,n.pipe)(A(e),c.flatMap(t=>E(e,o-1,i-s.length-1,(0,n.pipe)(a,r.appendAll(s),r.append(t))))):c.succeed((0,n.pipe)(a,r.appendAll(s)))})),w=e=>(0,u.hasProperty)(e,p),k=e=>(0,u.hasProperty)(e,f),I=(e,t)=>(0,n.pipe)(c.deferredMake(),c.map(r=>{let i;return i=a.unbounded(),new v(e,i,r,s.make(!1),t)}));class T{mutable;[m]=y;constructor(e){this.mutable=e}poll(e){return a.poll(this.mutable,e)}pollUpTo(e){return a.pollUpTo(this.mutable,e)}offerAll(e){return a.offerAll(this.mutable,e)}offer(e){return a.offer(this.mutable,e)}capacity(){return a.capacity(this.mutable)}length(){return a.length(this.mutable)}}let x=e=>new T(e),C=(0,n.dual)(2,(e,t)=>e.offer(t)),R=(0,n.dual)(2,(e,t)=>e.unsafeOffer(t)),F=(0,n.dual)(2,(e,t)=>e.offerAll(t)),A=e=>e.take,O=(0,n.dual)(2,(e,t)=>e.takeUpTo(t)),_=(0,n.dual)(3,(e,t,r)=>e.takeBetween(t,r)),M=(0,n.dual)(2,(e,t)=>e.takeBetween(t,t)),D=()=>new L,N=()=>new U,P=()=>new z;class L{[h]=g;putters=a.unbounded();surplusSize(){return a.length(this.putters)}onCompleteTakersWithEmptyQueue(e){for(;!a.isEmpty(this.putters)&&!a.isEmpty(e);){let t=a.poll(e,void 0),r=a.poll(this.putters,void 0);r[2]&&W(r[1],!0),W(t,r[0])}}get shutdown(){return(0,n.pipe)(c.fiberId,c.flatMap(e=>(0,n.pipe)(c.sync(()=>q(this.putters)),c.flatMap(t=>d.forEachConcurrentDiscard(t,t=>{let[r,i,a]=t;return a?(0,n.pipe)(c.deferredInterruptWith(i,e),c.asVoid):c.void},!1,!1)))))}handleSurplus(e,t,r,i){return c.withFiberRuntime(a=>{let o=c.deferredUnsafeMake(a.id());return(0,n.pipe)(c.suspend(()=>(this.unsafeOffer(e,o),this.unsafeOnQueueEmptySpace(t,r),V(this,t,r),s.get(i)?c.interrupt:c.deferredAwait(o))),c.onInterrupt(()=>c.sync(()=>this.unsafeRemove(o))))})}unsafeOnQueueEmptySpace(e,t){let i=!0;for(;i&&(e.capacity()===1/0||e.length()<e.capacity());){let s=(0,n.pipe)(this.putters,a.poll(a.EmptyMutableQueue));if(s===a.EmptyMutableQueue)i=!1;else{let i=e.offer(s[0]);i&&s[2]?W(s[1],!0):i||B(this.putters,(0,n.pipe)(q(this.putters),r.prepend(s))),V(this,e,t)}}}unsafeOffer(e,r){let i=t.fromIterable(e);for(let e=0;e<i.length;e++){let t=i[e];e===i.length-1?(0,n.pipe)(this.putters,a.offer([t,r,!0])):(0,n.pipe)(this.putters,a.offer([t,r,!1]))}}unsafeRemove(e){B(this.putters,(0,n.pipe)(q(this.putters),r.filter(t=>{let[,r]=t;return r!==e})))}}class U{[h]=g;surplusSize(){return 0}get shutdown(){return c.void}onCompleteTakersWithEmptyQueue(){}handleSurplus(e,t,r,i){return c.succeed(!1)}unsafeOnQueueEmptySpace(e,t){}}class z{[h]=g;surplusSize(){return 0}get shutdown(){return c.void}onCompleteTakersWithEmptyQueue(){}handleSurplus(e,t,r,i){return c.sync(()=>(this.unsafeOffer(t,e),V(this,t,r),!0))}unsafeOnQueueEmptySpace(e,t){}unsafeOffer(e,t){let r,i=t[Symbol.iterator](),n=!0;for(;!(r=i.next()).done&&n;){if(0===e.capacity())return;e.poll(a.EmptyMutableQueue),n=e.offer(r.value)}}}let W=(e,t)=>c.deferredUnsafeDone(e,c.succeed(t)),B=(e,t)=>(0,n.pipe)(e,a.offerAll(t)),q=e=>(0,n.pipe)(e,a.pollUpTo(1/0)),$=(e,t)=>(0,n.pipe)(e,a.pollUpTo(t)),j=(e,t)=>{B(e,(0,n.pipe)(q(e),r.filter(e=>t!==e)))},V=(e,t,i)=>{let s=!0;for(;s&&0!==t.length();){let o=(0,n.pipe)(i,a.poll(a.EmptyMutableQueue));if(o!==a.EmptyMutableQueue){let l=t.poll(a.EmptyMutableQueue);l!==a.EmptyMutableQueue?(W(o,l),e.unsafeOnQueueEmptySpace(t,i)):B(i,(0,n.pipe)(q(i),r.prepend(o))),s=!0}else s=!1}s&&0===t.length()&&!a.isEmpty(i)&&e.onCompleteTakersWithEmptyQueue(i)};e.s(["BackingQueueTypeId",0,m,"DequeueTypeId",0,f,"EnqueueTypeId",0,p,"QueueStrategyTypeId",0,h,"awaitShutdown",0,e=>e.awaitShutdown,"backPressureStrategy",0,D,"bounded",0,e=>(0,n.pipe)(c.sync(()=>a.bounded(e)),c.flatMap(e=>I(x(e),D()))),"capacity",0,e=>e.capacity(),"dequeueVariance",0,b,"dropping",0,e=>(0,n.pipe)(c.sync(()=>a.bounded(e)),c.flatMap(e=>I(x(e),N()))),"droppingStrategy",0,N,"enqueueVariance",0,S,"isDequeue",0,k,"isEmpty",0,e=>e.isEmpty,"isEnqueue",0,w,"isFull",0,e=>e.isFull,"isQueue",0,e=>w(e)&&k(e),"isShutdown",0,e=>e.isShutdown,"make",0,I,"offer",0,C,"offerAll",0,F,"poll",0,e=>c.map(e.takeUpTo(1),r.head),"shutdown",0,e=>e.shutdown,"size",0,e=>e.size,"sliding",0,e=>(0,n.pipe)(c.sync(()=>a.bounded(e)),c.flatMap(e=>I(x(e),P()))),"slidingStrategy",0,P,"take",0,A,"takeAll",0,e=>e.takeAll,"takeBetween",0,_,"takeN",0,M,"takeUpTo",0,O,"unbounded",0,()=>(0,n.pipe)(c.sync(()=>a.unbounded()),c.flatMap(e=>I(x(e),N()))),"unsafeOffer",0,R])},1299557,e=>{"use strict";var t=e.i(7862555),r=e.i(7525378),i=e.i(3683485),n=e.i(217551),a=e.i(432214),s=e.i(5921732),o=e.i(8815901),l=e.i(9960543),u=e.i(7548658),c=e.i(592224),d=e.i(1658800),p=e.i(8398712);let f=Symbol.for("effect/PubSub/AbsentValue"),h=(e,t)=>r=>{r.has(e)||r.set(e,new Set),r.get(e).add(t)},m=(e,t)=>r=>{if(!r.has(e))return;let i=r.get(e);i.delete(t),0===i.size&&r.delete(e)},g=(0,i.dual)(2,(e,t)=>e.publish(t)),y=e=>{let t="number"==typeof e?{capacity:e}:e;O(t.capacity);let r=t.replay&&t.replay>0?new j(Math.ceil(t.replay)):void 0;return 1===t.capacity?new w(r):(0,s.nextPow2)(t.capacity)===t.capacity?new v(t.capacity,r):new S(t.capacity,r)};class S{capacity;replayBuffer;array;publisherIndex=0;subscribers;subscriberCount=0;subscribersIndex=0;constructor(e,t){this.capacity=e,this.replayBuffer=t,this.array=Array.from({length:e}),this.subscribers=Array.from({length:e})}replayWindow(){return this.replayBuffer?new V(this.replayBuffer):H}isEmpty(){return this.publisherIndex===this.subscribersIndex}isFull(){return this.publisherIndex===this.subscribersIndex+this.capacity}size(){return this.publisherIndex-this.subscribersIndex}publish(e){if(this.isFull())return!1;if(0!==this.subscriberCount){let t=this.publisherIndex%this.capacity;this.array[t]=e,this.subscribers[t]=this.subscriberCount,this.publisherIndex+=1}return this.replayBuffer&&this.replayBuffer.offer(e),!0}publishAll(e){if(0===this.subscriberCount)return this.replayBuffer&&this.replayBuffer.offerAll(e),t.empty();let r=t.fromIterable(e),i=r.length,n=this.publisherIndex-this.subscribersIndex,a=Math.min(i,this.capacity-n);if(0===a)return r;let s=0,o=this.publisherIndex+a;for(;this.publisherIndex!==o;){let e=t.unsafeGet(r,s++),i=this.publisherIndex%this.capacity;this.array[i]=e,this.subscribers[i]=this.subscriberCount,this.publisherIndex+=1,this.replayBuffer&&this.replayBuffer.offer(e)}return t.drop(r,s)}slide(){if(this.subscribersIndex!==this.publisherIndex){let e=this.subscribersIndex%this.capacity;this.array[e]=f,this.subscribers[e]=0,this.subscribersIndex+=1}this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new b(this,this.publisherIndex,!1)}}class b{self;subscriberIndex;unsubscribed;constructor(e,t,r){this.self=e,this.subscriberIndex=t,this.unsubscribed=r}isEmpty(){return this.unsubscribed||this.self.publisherIndex===this.subscriberIndex||this.self.publisherIndex===this.self.subscribersIndex}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(e){if(this.unsubscribed)return e;if(this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex),this.subscriberIndex!==this.self.publisherIndex){let e=this.subscriberIndex%this.self.capacity,t=this.self.array[e];return this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=f,this.self.subscribersIndex+=1),this.subscriberIndex+=1,t}return e}pollUpTo(e){if(this.unsubscribed)return t.empty();this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);let r=Math.min(e,this.self.publisherIndex-this.subscriberIndex);if(r<=0)return t.empty();let i=[],n=this.subscriberIndex+r;for(;this.subscriberIndex!==n;){let e=this.subscriberIndex%this.self.capacity,t=this.self.array[e];this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=f,this.self.subscribersIndex+=1),i.push(t),this.subscriberIndex+=1}return t.fromIterable(i)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);this.subscriberIndex!==this.self.publisherIndex;){let e=this.subscriberIndex%this.self.capacity;this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=f,this.self.subscribersIndex+=1),this.subscriberIndex+=1}}}class v{capacity;replayBuffer;array;mask;publisherIndex=0;subscribers;subscriberCount=0;subscribersIndex=0;constructor(e,t){this.capacity=e,this.replayBuffer=t,this.array=Array.from({length:e}),this.mask=e-1,this.subscribers=Array.from({length:e})}replayWindow(){return this.replayBuffer?new V(this.replayBuffer):H}isEmpty(){return this.publisherIndex===this.subscribersIndex}isFull(){return this.publisherIndex===this.subscribersIndex+this.capacity}size(){return this.publisherIndex-this.subscribersIndex}publish(e){if(this.isFull())return!1;if(0!==this.subscriberCount){let t=this.publisherIndex&this.mask;this.array[t]=e,this.subscribers[t]=this.subscriberCount,this.publisherIndex+=1}return this.replayBuffer&&this.replayBuffer.offer(e),!0}publishAll(e){if(0===this.subscriberCount)return this.replayBuffer&&this.replayBuffer.offerAll(e),t.empty();let r=t.fromIterable(e),i=r.length,n=this.publisherIndex-this.subscribersIndex,a=Math.min(i,this.capacity-n);if(0===a)return r;let s=0,o=this.publisherIndex+a;for(;this.publisherIndex!==o;){let e=t.unsafeGet(r,s++),i=this.publisherIndex&this.mask;this.array[i]=e,this.subscribers[i]=this.subscriberCount,this.publisherIndex+=1,this.replayBuffer&&this.replayBuffer.offer(e)}return t.drop(r,s)}slide(){if(this.subscribersIndex!==this.publisherIndex){let e=this.subscribersIndex&this.mask;this.array[e]=f,this.subscribers[e]=0,this.subscribersIndex+=1}this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new E(this,this.publisherIndex,!1)}}class E{self;subscriberIndex;unsubscribed;constructor(e,t,r){this.self=e,this.subscriberIndex=t,this.unsubscribed=r}isEmpty(){return this.unsubscribed||this.self.publisherIndex===this.subscriberIndex||this.self.publisherIndex===this.self.subscribersIndex}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(e){if(this.unsubscribed)return e;if(this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex),this.subscriberIndex!==this.self.publisherIndex){let e=this.subscriberIndex&this.self.mask,t=this.self.array[e];return this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=f,this.self.subscribersIndex+=1),this.subscriberIndex+=1,t}return e}pollUpTo(e){if(this.unsubscribed)return t.empty();this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);let r=Math.min(e,this.self.publisherIndex-this.subscriberIndex);if(r<=0)return t.empty();let i=[],n=this.subscriberIndex+r;for(;this.subscriberIndex!==n;){let e=this.subscriberIndex&this.self.mask,t=this.self.array[e];this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=f,this.self.subscribersIndex+=1),i.push(t),this.subscriberIndex+=1}return t.fromIterable(i)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex=Math.max(this.subscriberIndex,this.self.subscribersIndex);this.subscriberIndex!==this.self.publisherIndex;){let e=this.subscriberIndex&this.self.mask;this.self.subscribers[e]-=1,0===this.self.subscribers[e]&&(this.self.array[e]=f,this.self.subscribersIndex+=1),this.subscriberIndex+=1}}}class w{replayBuffer;publisherIndex=0;subscriberCount=0;subscribers=0;value=f;capacity=1;constructor(e){this.replayBuffer=e}replayWindow(){return this.replayBuffer?new V(this.replayBuffer):H}pipe(){return(0,l.pipeArguments)(this,arguments)}isEmpty(){return 0===this.subscribers}isFull(){return!this.isEmpty()}size(){return+!this.isEmpty()}publish(e){return!this.isFull()&&(0!==this.subscriberCount&&(this.value=e,this.subscribers=this.subscriberCount,this.publisherIndex+=1),this.replayBuffer&&this.replayBuffer.offer(e),!0)}publishAll(e){if(0===this.subscriberCount)return this.replayBuffer&&this.replayBuffer.offerAll(e),t.empty();let r=t.fromIterable(e);return t.isEmpty(r)?r:this.publish(t.unsafeHead(r))?t.drop(r,1):r}slide(){this.isFull()&&(this.subscribers=0,this.value=f),this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.subscriberCount+=1,new k(this,this.publisherIndex,!1)}}class k{self;subscriberIndex;unsubscribed;constructor(e,t,r){this.self=e,this.subscriberIndex=t,this.unsubscribed=r}isEmpty(){return this.unsubscribed||0===this.self.subscribers||this.subscriberIndex===this.self.publisherIndex}size(){return+!this.isEmpty()}poll(e){if(this.isEmpty())return e;let t=this.self.value;return this.self.subscribers-=1,0===this.self.subscribers&&(this.self.value=f),this.subscriberIndex+=1,t}pollUpTo(e){if(this.isEmpty()||e<1)return t.empty();let r=this.self.value;return this.self.subscribers-=1,0===this.self.subscribers&&(this.self.value=f),this.subscriberIndex+=1,t.of(r)}unsubscribe(){this.unsubscribed||(this.unsubscribed=!0,this.self.subscriberCount-=1,this.subscriberIndex!==this.self.publisherIndex&&(this.self.subscribers-=1,0===this.self.subscribers&&(this.self.value=f)))}}class I{replayBuffer;publisherHead={value:f,subscribers:0,next:null};publisherTail=this.publisherHead;publisherIndex=0;subscribersIndex=0;capacity=Number.MAX_SAFE_INTEGER;constructor(e){this.replayBuffer=e}replayWindow(){return this.replayBuffer?new V(this.replayBuffer):H}isEmpty(){return this.publisherHead===this.publisherTail}isFull(){return!1}size(){return this.publisherIndex-this.subscribersIndex}publish(e){let t=this.publisherTail.subscribers;return 0!==t&&(this.publisherTail.next={value:e,subscribers:t,next:null},this.publisherTail=this.publisherTail.next,this.publisherIndex+=1),this.replayBuffer&&this.replayBuffer.offer(e),!0}publishAll(e){if(0!==this.publisherTail.subscribers)for(let t of e)this.publish(t);else this.replayBuffer&&this.replayBuffer.offerAll(e);return t.empty()}slide(){this.publisherHead!==this.publisherTail&&(this.publisherHead=this.publisherHead.next,this.publisherHead.value=f,this.subscribersIndex+=1),this.replayBuffer&&this.replayBuffer.slide()}subscribe(){return this.publisherTail.subscribers+=1,new T(this,this.publisherTail,this.publisherIndex,!1)}}class T{self;subscriberHead;subscriberIndex;unsubscribed;constructor(e,t,r,i){this.self=e,this.subscriberHead=t,this.subscriberIndex=r,this.unsubscribed=i}isEmpty(){if(this.unsubscribed)return!0;let e=!0,t=!0;for(;t;)this.subscriberHead===this.self.publisherTail?t=!1:this.subscriberHead.next.value!==f?(e=!1,t=!1):(this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1);return e}size(){return this.unsubscribed?0:this.self.publisherIndex-Math.max(this.subscriberIndex,this.self.subscribersIndex)}poll(e){if(this.unsubscribed)return e;let t=!0,r=e;for(;t;)if(this.subscriberHead===this.self.publisherTail)t=!1;else{let e=this.subscriberHead.next.value;e!==f&&(r=e,this.subscriberHead.subscribers-=1,0===this.subscriberHead.subscribers&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=f,this.self.subscribersIndex+=1),t=!1),this.subscriberHead=this.subscriberHead.next,this.subscriberIndex+=1}return r}pollUpTo(e){let r=[],i=0;for(;i!==e;){let t=this.poll(f);t===f?i=e:(r.push(t),i+=1)}return t.fromIterable(r)}unsubscribe(){if(!this.unsubscribed)for(this.unsubscribed=!0,this.self.publisherTail.subscribers-=1;this.subscriberHead!==this.self.publisherTail;)this.subscriberHead.next.value!==f&&(this.subscriberHead.subscribers-=1,0===this.subscriberHead.subscribers&&(this.self.publisherHead=this.self.publisherHead.next,this.self.publisherHead.value=f,this.self.subscribersIndex+=1)),this.subscriberHead=this.subscriberHead.next}}class x extends r.Class{pubsub;subscribers;subscription;pollers;shutdownHook;shutdownFlag;strategy;replayWindow;[p.DequeueTypeId]=p.dequeueVariance;constructor(e,t,r,i,n,a,s,o){super(),this.pubsub=e,this.subscribers=t,this.subscription=r,this.pollers=i,this.shutdownHook=n,this.shutdownFlag=a,this.strategy=s,this.replayWindow=o}commit(){return this.take}pipe(){return(0,l.pipeArguments)(this,arguments)}capacity(){return this.pubsub.capacity}isActive(){return!a.get(this.shutdownFlag)}get size(){return u.suspend(()=>a.get(this.shutdownFlag)?u.interrupt:u.succeed(this.subscription.size()+this.replayWindow.remaining))}unsafeSize(){return a.get(this.shutdownFlag)?o.none():o.some(this.subscription.size()+this.replayWindow.remaining)}get isFull(){return u.suspend(()=>a.get(this.shutdownFlag)?u.interrupt:u.succeed(this.subscription.size()===this.capacity()))}get isEmpty(){return u.map(this.size,e=>0===e)}get shutdown(){return u.uninterruptible(u.withFiberRuntime(e=>(a.set(this.shutdownFlag,!0),(0,i.pipe)(d.forEachParUnbounded(D(this.pollers),t=>u.deferredInterruptWith(t,e.id()),!1),u.zipRight(u.sync(()=>{this.subscribers.delete(this.subscription),this.subscription.unsubscribe(),this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers)})),u.whenEffect(u.deferredSucceed(this.shutdownHook,void 0)),u.asVoid))))}get isShutdown(){return u.sync(()=>a.get(this.shutdownFlag))}get awaitShutdown(){return u.deferredAwait(this.shutdownHook)}get take(){return u.withFiberRuntime(e=>{if(a.get(this.shutdownFlag))return u.interrupt;if(this.replayWindow.remaining>0){let e=this.replayWindow.take();return u.succeed(e)}let t=n.isEmpty(this.pollers)?this.subscription.poll(n.EmptyMutableQueue):n.EmptyMutableQueue;if(t!==n.EmptyMutableQueue)return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),u.succeed(t);{let t=u.deferredUnsafeMake(e.id());return(0,i.pipe)(u.suspend(()=>((0,i.pipe)(this.pollers,n.offer(t)),(0,i.pipe)(this.subscribers,h(this.subscription,this.pollers)),this.strategy.unsafeCompletePollers(this.pubsub,this.subscribers,this.subscription,this.pollers),a.get(this.shutdownFlag)?u.interrupt:u.deferredAwait(t))),u.onInterrupt(()=>u.sync(()=>U(this.pollers,t))))}})}get takeAll(){return u.suspend(()=>{if(a.get(this.shutdownFlag))return u.interrupt;let e=n.isEmpty(this.pollers)?N(this.subscription):t.empty();return(this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),this.replayWindow.remaining>0)?u.succeed(t.appendAll(this.replayWindow.takeAll(),e)):u.succeed(e)})}takeUpTo(e){return u.suspend(()=>{let r;if(a.get(this.shutdownFlag))return u.interrupt;if(this.replayWindow.remaining>=e){let t=this.replayWindow.takeN(e);return u.succeed(t)}this.replayWindow.remaining>0&&(r=this.replayWindow.takeAll(),e-=r.length);let i=n.isEmpty(this.pollers)?P(this.subscription,e):t.empty();return this.strategy.unsafeOnPubSubEmptySpace(this.pubsub,this.subscribers),r?u.succeed(t.appendAll(r,i)):u.succeed(i)})}takeBetween(e,r){return u.suspend(()=>C(this,e,r,t.empty()))}}let C=(e,r,n,a)=>n<r?u.succeed(a):(0,i.pipe)(e.takeUpTo(n),u.flatMap(s=>{let o=r-s.length;return 1===o?(0,i.pipe)(e.take,u.map(e=>(0,i.pipe)(a,t.appendAll(s),t.append(e)))):o>1?(0,i.pipe)(e.take,u.flatMap(r=>C(e,o-1,n-s.length-1,(0,i.pipe)(a,t.appendAll(s),t.append(r))))):u.succeed((0,i.pipe)(a,t.appendAll(s)))}));class R{pubsub;subscribers;scope;shutdownHook;shutdownFlag;strategy;[p.EnqueueTypeId]=p.enqueueVariance;[p.DequeueTypeId]=p.dequeueVariance;constructor(e,t,r,i,n,a){this.pubsub=e,this.subscribers=t,this.scope=r,this.shutdownHook=i,this.shutdownFlag=n,this.strategy=a}capacity(){return this.pubsub.capacity}get size(){return u.suspend(()=>a.get(this.shutdownFlag)?u.interrupt:u.sync(()=>this.pubsub.size()))}unsafeSize(){return a.get(this.shutdownFlag)?o.none():o.some(this.pubsub.size())}get isFull(){return u.map(this.size,e=>e===this.capacity())}get isEmpty(){return u.map(this.size,e=>0===e)}get awaitShutdown(){return u.deferredAwait(this.shutdownHook)}get isShutdown(){return u.sync(()=>a.get(this.shutdownFlag))}get shutdown(){return u.uninterruptible(u.withFiberRuntime(e=>((0,i.pipe)(this.shutdownFlag,a.set(!0)),(0,i.pipe)(this.scope.close(u.exitInterrupt(e.id())),u.zipRight(this.strategy.shutdown),u.whenEffect(u.deferredSucceed(this.shutdownHook,void 0)),u.asVoid))))}publish(e){return u.suspend(()=>a.get(this.shutdownFlag)?u.interrupt:this.pubsub.publish(e)?(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),u.succeed(!0)):this.strategy.handleSurplus(this.pubsub,this.subscribers,t.of(e),this.shutdownFlag))}isActive(){return!a.get(this.shutdownFlag)}unsafeOffer(e){return!a.get(this.shutdownFlag)&&!!this.pubsub.publish(e)&&(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),!0)}publishAll(e){return u.suspend(()=>{if(a.get(this.shutdownFlag))return u.interrupt;let r=L(this.pubsub,e);return(this.strategy.unsafeCompleteSubscribers(this.pubsub,this.subscribers),t.isEmpty(r))?u.succeed(!0):this.strategy.handleSurplus(this.pubsub,this.subscribers,r,this.shutdownFlag)})}get subscribe(){let e,t,r,i=u.tap(d.all([this.scope.fork(c.sequential),(e=this.pubsub,t=this.subscribers,r=this.strategy,u.map(u.deferredMake(),i=>{let s,o,l,u,c,d;return s=e,o=t,l=e.subscribe(),u=n.unbounded(),c=i,d=a.make(!1),new x(s,o,l,u,c,d,r,s.replayWindow())}))]),e=>e[0].addFinalizer(()=>e[1].shutdown));return u.map(d.acquireRelease(i,(e,t)=>e[0].close(t)),e=>e[1])}offer(e){return this.publish(e)}offerAll(e){return this.publishAll(e)}pipe(){return(0,l.pipeArguments)(this,arguments)}}let F=(e,t)=>u.flatMap(d.scopeMake(),r=>u.map(u.deferredMake(),i=>A(e,new Map,r,i,a.make(!1),t))),A=(e,t,r,i,n,a)=>new R(e,t,r,i,n,a),O=e=>{if(e<=0)throw new u.InvalidPubSubCapacityException(`Cannot construct PubSub with capacity of ${e}`)},_=(e,t)=>{u.deferredUnsafeDone(e,u.succeed(t))},M=(e,t)=>(0,i.pipe)(e,n.offerAll(t)),D=e=>(0,i.pipe)(e,n.pollUpTo(1/0)),N=e=>e.pollUpTo(1/0),P=(e,t)=>e.pollUpTo(t),L=(e,t)=>e.publishAll(t),U=(e,r)=>{M(e,(0,i.pipe)(D(e),t.filter(e=>e!==r)))};class z{publishers=n.unbounded();get shutdown(){return u.flatMap(u.fiberId,e=>u.flatMap(u.sync(()=>D(this.publishers)),t=>d.forEachConcurrentDiscard(t,t=>{let[r,n,a]=t;return a?(0,i.pipe)(u.deferredInterruptWith(n,e),u.asVoid):u.void},!1,!1)))}handleSurplus(e,t,r,n){return u.withFiberRuntime(s=>{let o=u.deferredUnsafeMake(s.id());return(0,i.pipe)(u.suspend(()=>(this.unsafeOffer(r,o),this.unsafeOnPubSubEmptySpace(e,t),this.unsafeCompleteSubscribers(e,t),a.get(n)?u.interrupt:u.deferredAwait(o))),u.onInterrupt(()=>u.sync(()=>this.unsafeRemove(o))))})}unsafeOnPubSubEmptySpace(e,r){let a=!0;for(;a&&!e.isFull();){let s=(0,i.pipe)(this.publishers,n.poll(n.EmptyMutableQueue));if(s===n.EmptyMutableQueue)a=!1;else{let n=e.publish(s[0]);n&&s[2]?_(s[1],!0):n||M(this.publishers,(0,i.pipe)(D(this.publishers),t.prepend(s))),this.unsafeCompleteSubscribers(e,r)}}}unsafeCompletePollers(e,t,r,i){return q(this,e,t,r,i)}unsafeCompleteSubscribers(e,t){return $(this,e,t)}unsafeOffer(e,t){let r=e[Symbol.iterator](),a=r.next();if(!a.done)for(;;){let e=a.value;if((a=r.next()).done){(0,i.pipe)(this.publishers,n.offer([e,t,!0]));break}(0,i.pipe)(this.publishers,n.offer([e,t,!1]))}}unsafeRemove(e){M(this.publishers,(0,i.pipe)(D(this.publishers),t.filter(t=>{let[r,i]=t;return i!==e})))}}class W{get shutdown(){return u.void}handleSurplus(e,t,r,i){return u.succeed(!1)}unsafeOnPubSubEmptySpace(e,t){}unsafeCompletePollers(e,t,r,i){return q(this,e,t,r,i)}unsafeCompleteSubscribers(e,t){return $(this,e,t)}}class B{get shutdown(){return u.void}handleSurplus(e,t,r,i){return u.sync(()=>(this.unsafeSlidingPublish(e,r),this.unsafeCompleteSubscribers(e,t),!0))}unsafeOnPubSubEmptySpace(e,t){}unsafeCompletePollers(e,t,r,i){return q(this,e,t,r,i)}unsafeCompleteSubscribers(e,t){return $(this,e,t)}unsafeSlidingPublish(e,t){let r=t[Symbol.iterator](),i=r.next();if(!i.done&&e.capacity>0){let t=i.value,n=!0;for(;n;){e.slide();let a=e.publish(t);a&&(i=r.next())&&!i.done?t=i.value:a&&(n=!1)}}}}let q=(e,r,a,s,o)=>{let l=!0;for(;l&&!s.isEmpty();){let u=(0,i.pipe)(o,n.poll(n.EmptyMutableQueue));if(u===n.EmptyMutableQueue)(0,i.pipe)(a,m(s,o)),n.isEmpty(o)?l=!1:(0,i.pipe)(a,h(s,o));else{let l=s.poll(n.EmptyMutableQueue);l===n.EmptyMutableQueue?M(o,(0,i.pipe)(D(o),t.prepend(u))):(_(u,l),e.unsafeOnPubSubEmptySpace(r,a))}}},$=(e,t,r)=>{for(let[i,n]of r)for(let a of n)e.unsafeCompletePollers(t,r,i,a)};class j{capacity;constructor(e){this.capacity=e}head={value:f,next:null};tail=this.head;size=0;index=0;slide(){this.index++}offer(e){this.tail.value=e,this.tail.next={value:f,next:null},this.tail=this.tail.next,this.size===this.capacity?this.head=this.head.next:this.size+=1}offerAll(e){for(let t of e)this.offer(t)}}class V{buffer;head;index;remaining;constructor(e){this.buffer=e,this.index=e.index,this.remaining=e.size,this.head=e.head}fastForward(){for(;this.index<this.buffer.index;)this.head=this.head.next,this.index++}take(){if(0===this.remaining)return;this.index<this.buffer.index&&this.fastForward(),this.remaining--;let e=this.head.value;return this.head=this.head.next,e}takeN(e){if(0===this.remaining)return t.empty();this.index<this.buffer.index&&this.fastForward();let r=Math.min(e,this.remaining),i=Array(r);for(let e=0;e<r;e++){let t=this.head.value;this.head=this.head.next,i[e]=t}return this.remaining-=r,t.unsafeFromArray(i)}takeAll(){return this.takeN(this.remaining)}}let H={remaining:0,take:()=>void 0,takeN:()=>t.empty(),takeAll:()=>t.empty()};e.s(["bounded",0,e=>u.suspend(()=>F(y(e),new z)),"dropping",0,e=>u.suspend(()=>F(y(e),new W)),"publish",0,g,"shutdown",0,e=>e.shutdown,"sliding",0,e=>u.suspend(()=>F(y(e),new B)),"subscribe",0,e=>e.subscribe,"unbounded",0,e=>u.suspend(()=>{let t;return F((t=e,new I(t?.replay?new j(t.replay):void 0)),new W)})],1299557)},1072215,e=>{"use strict";var t=e.i(8398712);t.EnqueueTypeId;let r=t.DequeueTypeId;t.QueueStrategyTypeId,t.BackingQueueTypeId,t.isQueue,t.isDequeue,t.isEnqueue,t.backPressureStrategy,t.droppingStrategy,t.slidingStrategy,t.make;let i=t.bounded,n=t.dropping,a=t.sliding,s=t.unbounded,o=t.capacity,l=t.size,u=t.isEmpty,c=t.isFull,d=t.isShutdown,p=t.awaitShutdown,f=t.shutdown,h=t.offer,m=t.unsafeOffer,g=t.offerAll,y=t.poll,S=t.take,b=t.takeAll,v=t.takeUpTo,E=t.takeBetween,w=t.takeN;e.s(["DequeueTypeId",0,r,"awaitShutdown",0,p,"bounded",0,i,"capacity",0,o,"dropping",0,n,"isEmpty",0,u,"isFull",0,c,"isShutdown",0,d,"offer",0,h,"offerAll",0,g,"poll",0,y,"shutdown",0,f,"size",0,l,"sliding",0,a,"take",0,S,"takeAll",0,b,"takeBetween",0,E,"takeN",0,w,"takeUpTo",0,v,"unbounded",0,s,"unsafeOffer",0,m])},6091153,8884753,6379322,1200369,7237733,7534251,9292764,e=>{"use strict";var t=e.i(5450905),r=e.i(7862555),i=e.i(5972454),n=e.i(578549),a=e.i(3322401),s=e.i(1331084),o=e.i(3628392),l=e.i(7836076),u=e.i(6028004),c=e.i(6098979),d=e.i(3683485),p=e.i(9227260),f=e.i(8815901),h=e.i(4935619),m=e.i(1299557),g=e.i(1072215),y=e.i(6532885),S=e.i(5160412),b=e.i(1177850),v=e.i(1150852),E=e.i(9390854),w=e.i(9960543);let k="Continue",I=Symbol.for("effect/ChannelChildExecutorDecision"),T={[I]:I},x=e=>{let t=Object.create(T);return t._tag=k,t},C="ContinuationK",R=Symbol.for("effect/ChannelContinuation"),F={_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutDone:e=>e,_OutErr2:e=>e,_OutElem:e=>e,_OutDone2:e=>e};class A{onSuccess;onHalt;_tag=C;[R]=F;constructor(e,t){this.onSuccess=e,this.onHalt=t}onExit(e){return l.isFailure(e)?this.onHalt(e.cause):this.onSuccess(e.value)}}class O{finalizer;_tag="ContinuationFinalizer";[R]=F;constructor(e){this.finalizer=e}}let _="PullAfterNext",M={[Symbol.for("effect/ChannelUpstreamPullStrategy")]:{_A:e=>e}},D=e=>{let t=Object.create(M);return t._tag=_,t.emitSeparator=e,t},N="BracketOut",P="Bridge",L="ConcatAll",U="Emit",z="Ensuring",W="Fail",B="Fold",q="FromEffect",$="PipeTo",j="Provide",V="Read",H="Succeed",G="SucceedNow",K="Suspend",J=Symbol.for("effect/Channel"),Z={[J]:{_Env:e=>e,_InErr:e=>e,_InElem:e=>e,_InDone:e=>e,_OutErr:e=>e,_OutElem:e=>e,_OutDone:e=>e},pipe(){return(0,w.pipeArguments)(this,arguments)}},Q=e=>(0,h.hasProperty)(e,J)||a.isEffect(e),Y=(0,d.dual)(2,(e,t)=>{let r=Object.create(Z);return r._tag=N,r.acquire=()=>e,r.finalizer=t,r}),X=(0,d.dual)(2,(e,t)=>{let r=Object.create(Z);return r._tag=B,r.channel=e,r.k=new A(eb,t),r}),ee=e=>eE(()=>{let t=[];return ed(eh(e,et(t)),e=>ew(()=>[r.fromIterable(t),e]))}),et=e=>ey({onInput:t=>ed(ew(()=>{e.push(t)}),()=>et(e)),onFailure:el,onDone:ev}),er=e=>ei(e,d.constVoid,d.constVoid),ei=(e,t,r)=>{let i=Object.create(Z);return i._tag=L,i.combineInners=t,i.combineAll=r,i.onPull=()=>D(f.none()),i.onEmit=()=>x,i.value=()=>e,i.k=d.identity,i},en=(0,d.dual)(4,(e,t,r,i)=>{let n=Object.create(Z);return n._tag=L,n.combineInners=r,n.combineAll=i,n.onPull=()=>D(f.none()),n.onEmit=()=>x,n.value=()=>e,n.k=t,n}),ea=(0,d.dual)(6,(e,t,r,i,n,a)=>{let s=Object.create(Z);return s._tag=L,s.combineInners=r,s.combineAll=i,s.onPull=n,s.onEmit=a,s.value=()=>e,s.k=t,s}),es=(0,d.dual)(2,(e,t)=>{let r=Object.create(Z);return r._tag=P,r.input=t,r.channel=e,r}),eo=(0,d.dual)(2,(e,t)=>{let r=Object.create(Z);return r._tag=z,r.channel=e,r.finalizer=t,r}),el=e=>eu(t.fail(e)),eu=e=>ec(()=>e),ec=e=>{let t=Object.create(Z);return t._tag=W,t.error=e,t},ed=(0,d.dual)(2,(e,t)=>{let r=Object.create(Z);return r._tag=B,r.channel=e,r.k=new A(t,eu),r}),ep=(0,d.dual)(2,(e,t)=>{let r=Object.create(Z);return r._tag=B,r.channel=e,r.k=new A(t.onSuccess,t.onFailure),r}),ef=e=>{let t=Object.create(Z);return t._tag=q,t.effect=()=>e,t},eh=(0,d.dual)(2,(e,t)=>{let r=Object.create(Z);return r._tag=$,r.left=()=>e,r.right=()=>t,r}),em=(0,d.dual)(2,(e,t)=>{let r=Object.create(Z);return r._tag=j,r.context=()=>t,r.inner=e,r}),eg=e=>{let t=Object.create(Z);return t._tag=V,t.more=eb,t.done=new A(()=>el(e),()=>el(e)),t},ey=e=>eS({onInput:e.onInput,onFailure:r=>s.match(t.failureOrCause(r),{onLeft:e.onFailure,onRight:eu}),onDone:e.onDone}),eS=e=>{let t=Object.create(Z);return t._tag=V,t.more=e.onInput,t.done=new A(e.onDone,e.onFailure),t},eb=e=>ew(()=>e),ev=e=>{let t=Object.create(Z);return t._tag=G,t.terminal=e,t},eE=e=>{let t=Object.create(Z);return t._tag=K,t.channel=e,t},ew=e=>{let t=Object.create(Z);return t._tag=H,t.evaluate=e,t},ek=ev(void 0),eI=e=>{let t=Object.create(Z);return t._tag=U,t.out=e,t};e.s(["ChannelTypeId",0,J,"acquireReleaseOut",0,Y,"catchAllCause",0,X,"collectElements",0,ee,"concatAll",0,er,"concatAllWith",0,ei,"concatMapWith",0,en,"concatMapWithCustom",0,ea,"embedInput",0,es,"ensuringWith",0,eo,"fail",0,el,"failCause",0,eu,"failCauseSync",0,ec,"failSync",0,e=>ec(()=>t.fail(e())),"flatMap",0,ed,"foldCauseChannel",0,ep,"fromEffect",0,ef,"isChannel",0,Q,"pipeTo",0,eh,"provideContext",0,em,"readOrFail",0,eg,"readWith",0,ey,"readWithCause",0,eS,"succeed",0,eb,"succeedNow",0,ev,"suspend",0,eE,"sync",0,ew,"void",0,ek,"write",0,eI],8884753);let eT="Done",ex="Emit",eC="FromEffect",eR="Read",eF={[Symbol.for("effect/ChannelState")]:{_E:e=>e,_R:e=>e}},eA=()=>{let e=Object.create(eF);return e._tag=eT,e},eO=()=>{let e=Object.create(eF);return e._tag=ex,e},e_=e=>{let t=Object.create(eF);return t._tag=eC,t.effect=e,t},eM=(e,t,r,i)=>{let n=Object.create(eF);return n._tag=eR,n.upstream=e,n.onEffect=t,n.onEmit=r,n.onDone=i,n},eD=e=>e._tag===eC,eN=e=>eD(e)?a.ignore(e.effect):void 0,eP="PullFromChild",eL="PullFromUpstream",eU="DrainChildExecutors",ez="Emit";class eW{childExecutor;parentSubexecutor;onEmit;_tag=eP;constructor(e,t,r){this.childExecutor=e,this.parentSubexecutor=t,this.onEmit=r}close(e){let t=this.childExecutor.close(e),r=this.parentSubexecutor.close(e);return void 0!==t&&void 0!==r?a.zipWith(a.exit(t),a.exit(r),(e,t)=>(0,d.pipe)(e,l.zipRight(t))):void 0!==t?t:void 0!==r?r:void 0}enqueuePullFromChild(e){return this}}class eB{upstreamExecutor;createChild;lastDone;activeChildExecutors;combineChildResults;combineWithChildResult;onPull;onEmit;_tag=eL;constructor(e,t,r,i,n,a,s,o){this.upstreamExecutor=e,this.createChild=t,this.lastDone=r,this.activeChildExecutors=i,this.combineChildResults=n,this.combineWithChildResult=a,this.onPull=s,this.onEmit=o}close(e){let t=this.upstreamExecutor.close(e);return[...this.activeChildExecutors.map(t=>void 0!==t?t.childExecutor.close(e):void 0),t].reduce((e,t)=>void 0!==e&&void 0!==t?a.zipWith(e,a.exit(t),(e,t)=>l.zipRight(e,t)):void 0!==e?e:void 0!==t?a.exit(t):void 0,void 0)}enqueuePullFromChild(e){return new eB(this.upstreamExecutor,this.createChild,this.lastDone,[...this.activeChildExecutors,e],this.combineChildResults,this.combineWithChildResult,this.onPull,this.onEmit)}}class eq{upstreamExecutor;lastDone;activeChildExecutors;upstreamDone;combineChildResults;combineWithChildResult;onPull;_tag=eU;constructor(e,t,r,i,n,a,s){this.upstreamExecutor=e,this.lastDone=t,this.activeChildExecutors=r,this.upstreamDone=i,this.combineChildResults=n,this.combineWithChildResult=a,this.onPull=s}close(e){let t=this.upstreamExecutor.close(e);return[...this.activeChildExecutors.map(t=>void 0!==t?t.childExecutor.close(e):void 0),t].reduce((e,t)=>void 0!==e&&void 0!==t?a.zipWith(e,a.exit(t),(e,t)=>l.zipRight(e,t)):void 0!==e?e:void 0!==t?a.exit(t):void 0,void 0)}enqueuePullFromChild(e){return new eq(this.upstreamExecutor,this.lastDone,[...this.activeChildExecutors,e],this.upstreamDone,this.combineChildResults,this.combineWithChildResult,this.onPull)}}class e${value;next;_tag=ez;constructor(e,t){this.value=e,this.next=t}close(e){return this.next.close(e)}enqueuePullFromChild(e){return this}}let ej={[Symbol.for("effect/ChannelUpstreamPullRequest")]:{_A:e=>e}},eV=e=>{let t=Object.create(ej);return t._tag="Pulled",t.value=e,t};class eH{_activeSubexecutor=void 0;_cancelled=void 0;_closeLastSubstream=void 0;_currentChannel;_done=void 0;_doneStack=[];_emitted=void 0;_executeCloseLastSubstream;_input=void 0;_inProgressFinalizer=void 0;_providedEnv;constructor(e,t,r){this._currentChannel=e,this._executeCloseLastSubstream=r,this._providedEnv=t}run(){let e;for(;void 0===e;)if(void 0!==this._cancelled)e=this.processCancellation();else if(void 0!==this._activeSubexecutor)e=this.runSubexecutor();else try{if(void 0===this._currentChannel)e=eA();else switch(a.isEffect(this._currentChannel)&&(this._currentChannel=ef(this._currentChannel)),this._currentChannel._tag){case N:e=this.runBracketOut(this._currentChannel);break;case P:{let t=this._currentChannel.input;if(this._currentChannel=this._currentChannel.channel,void 0!==this._input){let r=this._input;this._input=void 0;let i=()=>a.flatMap(t.awaitRead(),()=>a.suspend(()=>{let e=r.run();switch(e._tag){case eT:return l.match(r.getDone(),{onFailure:e=>t.error(e),onSuccess:e=>t.done(e)});case ex:return a.flatMap(t.emit(r.getEmit()),()=>i());case eC:return a.matchCauseEffect(e.effect,{onFailure:e=>t.error(e),onSuccess:()=>i()});case eR:return eJ(e,()=>i(),e=>t.error(e))}}));e=e_(a.flatMap(a.forkDaemon(a.interruptible(i())),e=>a.sync(()=>this.addFinalizer(t=>a.flatMap(u.interrupt(e),()=>a.suspend(()=>{let e=this.restorePipe(t,r);return void 0!==e?e:a.void}))))))}break}case L:{let e=new eH(this._currentChannel.value(),this._providedEnv,e=>a.sync(()=>{let t=void 0===this._closeLastSubstream?a.void:this._closeLastSubstream;this._closeLastSubstream=(0,d.pipe)(t,a.zipRight(e))}));e._input=this._input;let t=this._currentChannel;this._activeSubexecutor=new eB(e,e=>t.k(e),void 0,[],(e,r)=>t.combineInners(e,r),(e,r)=>t.combineAll(e,r),e=>t.onPull(e),e=>t.onEmit(e)),this._closeLastSubstream=void 0,this._currentChannel=void 0;break}case U:this._emitted=this._currentChannel.out,this._currentChannel=void 0!==this._activeSubexecutor?void 0:ek,e=eO();break;case z:this.runEnsuring(this._currentChannel);break;case W:e=this.doneHalt(this._currentChannel.error());break;case B:this._doneStack.push(this._currentChannel.k),this._currentChannel=this._currentChannel.channel;break;case q:{let t=void 0===this._providedEnv?this._currentChannel.effect():(0,d.pipe)(this._currentChannel.effect(),a.provide(this._providedEnv));e=e_(a.matchCauseEffect(t,{onFailure:e=>{let t=this.doneHalt(e);return void 0!==t&&eD(t)?t.effect:a.void},onSuccess:e=>{let t=this.doneSucceed(e);return void 0!==t&&eD(t)?t.effect:a.void}}));break}case $:{let e=this._input,t=new eH(this._currentChannel.left(),this._providedEnv,e=>this._executeCloseLastSubstream(e));t._input=e,this._input=t,this.addFinalizer(t=>{let r=this.restorePipe(t,e);return void 0!==r?r:a.void}),this._currentChannel=this._currentChannel.right();break}case j:{let e=this._providedEnv;this._providedEnv=this._currentChannel.context(),this._currentChannel=this._currentChannel.inner,this.addFinalizer(()=>a.sync(()=>{this._providedEnv=e}));break}case V:{let t=this._currentChannel;e=eM(this._input,d.identity,e=>{try{this._currentChannel=t.more(e)}catch(e){this._currentChannel=t.done.onExit(l.die(e))}},e=>{let r=e=>t.done.onExit(e);this._currentChannel=r(e)});break}case H:e=this.doneSucceed(this._currentChannel.evaluate());break;case G:e=this.doneSucceed(this._currentChannel.terminal);break;case K:this._currentChannel=this._currentChannel.channel()}}catch(e){this._currentChannel=eu(t.die(e))}return e}getDone(){return this._done}getEmit(){return this._emitted}cancelWith(e){this._cancelled=e}clearInProgressFinalizer(){this._inProgressFinalizer=void 0}storeInProgressFinalizer(e){this._inProgressFinalizer=e}popAllFinalizers(e){let t=[],r=this._doneStack.pop();for(;r;)"ContinuationFinalizer"===r._tag&&t.push(r.finalizer),r=this._doneStack.pop();let i=0===t.length?a.void:eK(t,e);return this.storeInProgressFinalizer(i),i}popNextFinalizers(){let e=[];for(;0!==this._doneStack.length;){let t=this._doneStack[this._doneStack.length-1];if(t._tag===C)break;e.push(t),this._doneStack.pop()}return e}restorePipe(e,t){let r=this._input;return(this._input=t,void 0!==r)?r.close(e):a.void}close(e){let t,r,i=this._inProgressFinalizer;void 0!==i&&(t=(0,d.pipe)(i,a.ensuring(a.sync(()=>this.clearInProgressFinalizer()))));let n=this.popAllFinalizers(e);void 0!==n&&(r=(0,d.pipe)(n,a.ensuring(a.sync(()=>this.clearInProgressFinalizer()))));let s=void 0===this._activeSubexecutor?void 0:this._activeSubexecutor.close(e);if(void 0!==s||void 0!==t||void 0!==r)return(0,d.pipe)(a.exit(eG(s)),a.zip(a.exit(eG(t))),a.zip(a.exit(eG(r))),a.map(e=>{let[[t,r],i]=e;return(0,d.pipe)(t,l.zipRight(r),l.zipRight(i))}),a.uninterruptible,a.flatMap(e=>a.suspend(()=>e)))}doneSucceed(e){if(0===this._doneStack.length)return this._done=l.succeed(e),this._currentChannel=void 0,eA();let t=this._doneStack[this._doneStack.length-1];if(t._tag===C){this._doneStack.pop(),this._currentChannel=t.onSuccess(e);return}let r=this.popNextFinalizers();if(0===this._doneStack.length)return this._doneStack=r.reverse(),this._done=l.succeed(e),this._currentChannel=void 0,eA();let i=eK(r.map(e=>e.finalizer),l.succeed(e));return this.storeInProgressFinalizer(i),e_((0,d.pipe)(i,a.ensuring(a.sync(()=>this.clearInProgressFinalizer())),a.uninterruptible,a.flatMap(()=>a.sync(()=>this.doneSucceed(e)))))}doneHalt(e){if(0===this._doneStack.length)return this._done=l.failCause(e),this._currentChannel=void 0,eA();let r=this._doneStack[this._doneStack.length-1];if(r._tag===C){this._doneStack.pop();try{this._currentChannel=r.onHalt(e)}catch(e){this._currentChannel=eu(t.die(e))}return}let i=this.popNextFinalizers();if(0===this._doneStack.length)return this._doneStack=i.reverse(),this._done=l.failCause(e),this._currentChannel=void 0,eA();let n=eK(i.map(e=>e.finalizer),l.failCause(e));return this.storeInProgressFinalizer(n),e_((0,d.pipe)(n,a.ensuring(a.sync(()=>this.clearInProgressFinalizer())),a.uninterruptible,a.flatMap(()=>a.sync(()=>this.doneHalt(e)))))}processCancellation(){return this._currentChannel=void 0,this._done=this._cancelled,this._cancelled=void 0,eA()}runBracketOut(e){return e_(a.uninterruptible(a.matchCauseEffect(this.provide(e.acquire()),{onFailure:e=>a.sync(()=>{this._currentChannel=eu(e)}),onSuccess:t=>a.sync(()=>{this.addFinalizer(r=>this.provide(e.finalizer(t,r))),this._currentChannel=eI(t)})})))}provide(e){return void 0===this._providedEnv?e:(0,d.pipe)(e,a.provide(this._providedEnv))}runEnsuring(e){this.addFinalizer(e.finalizer),this._currentChannel=e.channel}addFinalizer(e){this._doneStack.push(new O(e))}runSubexecutor(){let e=this._activeSubexecutor;switch(e._tag){case eP:return this.pullFromChild(e.childExecutor,e.parentSubexecutor,e.onEmit,e);case eL:return this.pullFromUpstream(e);case eU:return this.drainChildExecutors(e);case ez:return this._emitted=e.value,this._activeSubexecutor=e.next,eO()}}replaceSubexecutor(e){this._currentChannel=void 0,this._activeSubexecutor=e}finishWithExit(e){let t=l.match(e,{onFailure:e=>this.doneHalt(e),onSuccess:e=>this.doneSucceed(e)});return this._activeSubexecutor=void 0,void 0===t?a.void:eD(t)?t.effect:a.void}finishSubexecutorWithCloseEffect(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];this.addFinalizer(()=>(0,d.pipe)(r,a.forEach(t=>(0,d.pipe)(a.sync(()=>t(e)),a.flatMap(e=>void 0!==e?e:a.void)),{discard:!0})));let n=(0,d.pipe)(e,l.match({onFailure:e=>this.doneHalt(e),onSuccess:e=>this.doneSucceed(e)}));return this._activeSubexecutor=void 0,n}applyUpstreamPullStrategy(e,t,r){switch(r._tag){case _:{let i=!e||t.some(e=>void 0!==e);return[r.emitSeparator,i?[void 0,...t]:t]}case"PullAfterAllEnqueued":{let i=!e||t.some(e=>void 0!==e);return[r.emitSeparator,i?[...t,void 0]:t]}}}pullFromChild(e,t,r,i){return eM(e,d.identity,n=>{let a=r(n);switch(a._tag){case k:break;case"Close":this.finishWithDoneValue(e,t,a.value);break;case"Yield":{let e=t.enqueuePullFromChild(i);this.replaceSubexecutor(e)}}this._activeSubexecutor=new e$(n,this._activeSubexecutor)},l.match({onFailure:r=>{let i=this.handleSubexecutorFailure(e,t,r);return void 0===i?void 0:eN(i)},onSuccess:r=>{this.finishWithDoneValue(e,t,r)}}))}finishWithDoneValue(e,t,r){switch(t._tag){case eL:{let i=new eB(t.upstreamExecutor,t.createChild,void 0!==t.lastDone?t.combineChildResults(t.lastDone,r):r,t.activeChildExecutors,t.combineChildResults,t.combineWithChildResult,t.onPull,t.onEmit);this._closeLastSubstream=e.close(l.succeed(r)),this.replaceSubexecutor(i);break}case eU:{let i=new eq(t.upstreamExecutor,void 0!==t.lastDone?t.combineChildResults(t.lastDone,r):r,t.activeChildExecutors,t.upstreamDone,t.combineChildResults,t.combineWithChildResult,t.onPull);this._closeLastSubstream=e.close(l.succeed(r)),this.replaceSubexecutor(i)}}}handleSubexecutorFailure(e,t,r){return this.finishSubexecutorWithCloseEffect(l.failCause(r),e=>t.close(e),t=>e.close(t))}pullFromUpstream(e){if(0===e.activeChildExecutors.length)return this.performPullFromUpstream(e);let t=e.activeChildExecutors[0],r=new eB(e.upstreamExecutor,e.createChild,e.lastDone,e.activeChildExecutors.slice(1),e.combineChildResults,e.combineWithChildResult,e.onPull,e.onEmit);if(void 0===t)return this.performPullFromUpstream(r);this.replaceSubexecutor(new eW(t.childExecutor,r,t.onEmit))}performPullFromUpstream(e){return eM(e.upstreamExecutor,e=>{let t=void 0===this._closeLastSubstream?a.void:this._closeLastSubstream;return this._closeLastSubstream=void 0,(0,d.pipe)(this._executeCloseLastSubstream(t),a.zipRight(e))},t=>{if(void 0!==this._closeLastSubstream){let r=this._closeLastSubstream;return this._closeLastSubstream=void 0,(0,d.pipe)(this._executeCloseLastSubstream(r),a.map(()=>{let r=new eH(e.createChild(t),this._providedEnv,this._executeCloseLastSubstream);r._input=this._input;let[i,n]=this.applyUpstreamPullStrategy(!1,e.activeChildExecutors,e.onPull(eV(t)));this._activeSubexecutor=new eW(r,new eB(e.upstreamExecutor,e.createChild,e.lastDone,n,e.combineChildResults,e.combineWithChildResult,e.onPull,e.onEmit),e.onEmit),f.isSome(i)&&(this._activeSubexecutor=new e$(i.value,this._activeSubexecutor))}))}let r=new eH(e.createChild(t),this._providedEnv,this._executeCloseLastSubstream);r._input=this._input;let[i,n]=this.applyUpstreamPullStrategy(!1,e.activeChildExecutors,e.onPull(eV(t)));this._activeSubexecutor=new eW(r,new eB(e.upstreamExecutor,e.createChild,e.lastDone,n,e.combineChildResults,e.combineWithChildResult,e.onPull,e.onEmit),e.onEmit),f.isSome(i)&&(this._activeSubexecutor=new e$(i.value,this._activeSubexecutor))},t=>{if(e.activeChildExecutors.some(e=>void 0!==e)){let t=new eq(e.upstreamExecutor,e.lastDone,[void 0,...e.activeChildExecutors],e.upstreamExecutor.getDone(),e.combineChildResults,e.combineWithChildResult,e.onPull);if(void 0!==this._closeLastSubstream){let e=this._closeLastSubstream;return this._closeLastSubstream=void 0,(0,d.pipe)(this._executeCloseLastSubstream(e),a.map(()=>this.replaceSubexecutor(t)))}return void this.replaceSubexecutor(t)}let r=this._closeLastSubstream,i=this.finishSubexecutorWithCloseEffect((0,d.pipe)(t,l.map(t=>e.combineWithChildResult(e.lastDone,t))),()=>r,t=>e.upstreamExecutor.close(t));return void 0===i?void 0:eN(i)})}drainChildExecutors(e){if(0===e.activeChildExecutors.length){let t=this._closeLastSubstream;return void 0!==t&&this.addFinalizer(()=>a.succeed(t)),this.finishSubexecutorWithCloseEffect(e.upstreamDone,()=>t,t=>e.upstreamExecutor.close(t))}let t=e.activeChildExecutors[0],r=e.activeChildExecutors.slice(1);if(void 0===t){var i;let t,[n,a]=this.applyUpstreamPullStrategy(!0,r,e.onPull((i=r.reduce((e,t)=>void 0!==t?e+1:e,0),(t=Object.create(ej))._tag="NoUpstream",t.activeDownstreamCount=i,t)));return(this.replaceSubexecutor(new eq(e.upstreamExecutor,e.lastDone,a,e.upstreamDone,e.combineChildResults,e.combineWithChildResult,e.onPull)),f.isSome(n))?(this._emitted=n.value,eO()):void 0}let n=new eq(e.upstreamExecutor,e.lastDone,r,e.upstreamDone,e.combineChildResults,e.combineWithChildResult,e.onPull);this.replaceSubexecutor(new eW(t.childExecutor,n,t.onEmit))}}let eG=e=>void 0!==e?e:a.void,eK=(e,t)=>(0,d.pipe)(a.forEach(e,e=>a.exit(e(t))),a.map(e=>(0,d.pipe)(l.all(e),f.getOrElse(()=>l.void))),a.flatMap(e=>a.suspend(()=>e))),eJ=(e,t,r)=>{let i=[e],n=()=>{let e=i.pop();if(void 0===e||void 0===e.upstream)return a.dieMessage("Unexpected end of input for channel execution");let s=e.upstream.run();switch(s._tag){case ex:{let s=e.onEmit(e.upstream.getEmit());if(0===i.length){if(void 0===s)return a.suspend(t);return(0,d.pipe)(s,a.matchCauseEffect({onFailure:r,onSuccess:t}))}if(void 0===s)return a.suspend(()=>n());return(0,d.pipe)(s,a.matchCauseEffect({onFailure:r,onSuccess:()=>n()}))}case eT:{let s=e.onDone(e.upstream.getDone());if(0===i.length){if(void 0===s)return a.suspend(t);return(0,d.pipe)(s,a.matchCauseEffect({onFailure:r,onSuccess:t}))}if(void 0===s)return a.suspend(()=>n());return(0,d.pipe)(s,a.matchCauseEffect({onFailure:r,onSuccess:()=>n()}))}case eC:return i.push(e),(0,d.pipe)(e.onEffect(s.effect),a.catchAllCause(t=>a.suspend(()=>{let r=e.onDone(l.failCause(t));return void 0===r?a.void:r})),a.matchCauseEffect({onFailure:r,onSuccess:()=>n()}));case eR:return i.push(e),i.push(s),a.suspend(()=>n())}};return n()},eZ=(0,d.dual)(2,(e,r)=>a.uninterruptibleMask(i=>a.all([S.fork(r,b.sequential),n.make(),n.make()]).pipe(a.flatMap(s=>{let[o,c,p]=s;return i(a.acquireUseRelease(a.sync(()=>new eH(e,void 0,d.identity)),e=>a.suspend(()=>eQ(e.run(),e).pipe(a.intoDeferred(c),a.zipRight(n.await(c)),a.zipLeft(n.await(p)))),(e,t)=>{let r=e.close(t);return void 0===r?a.void:a.tapErrorCause(r,e=>S.addFinalizer(o,a.failCause(e)))})).pipe(a.forkIn(r),a.flatMap(e=>r.addFinalizer(r=>{let i=l.isFailure(r)?t.interruptors(r.cause):void 0;return n.isDone(c).pipe(a.flatMap(t=>t?n.succeed(p,void 0).pipe(a.zipRight(u.await(e)),a.zipRight(u.inheritAll(e))):n.succeed(p,void 0).pipe(a.zipRight(i&&E.size(i)>0?u.interruptAs(e,v.combineAll(i)):u.interrupt(e)),a.zipRight(u.inheritAll(e)))))}).pipe(a.zipRight(i(n.await(c))))))})))),eQ=(e,t)=>{switch(e._tag){case eC:return(0,d.pipe)(e.effect,a.flatMap(()=>eQ(t.run(),t)));case ex:return eQ(t.run(),t);case eT:return a.suspend(()=>t.getDone());case eR:return eJ(e,()=>eQ(t.run(),t),a.failCause)}};e.s(["ChannelExecutor",0,eH,"readUpstream",0,eJ,"runIn",0,eZ],6379322);let eY="Done",eX="Await",e0=Symbol.for("effect/ChannelMergeDecision"),e1={[e0]:{_R:e=>e,_E0:e=>e,_Z0:e=>e,_E:e=>e,_Z:e=>e}},e2=e=>{let t=Object.create(e1);return t._tag=eY,t.effect=e,t},e5=e=>{let t=Object.create(e1);return t._tag=eX,t.f=e,t},e3=(0,d.dual)(2,(e,t)=>{let{onAwait:r,onDone:i}=t;switch(e._tag){case eY:return i(e.effect);case eX:return r(e.f)}});e.s(["Await",0,e5,"AwaitConst",0,e=>e5(()=>e),"Done",0,e2,"MergeDecisionTypeId",0,e0,"isMergeDecision",0,e=>(0,h.hasProperty)(e,e0),"match",0,e3],1200369);let e8="BothRunning",e4="LeftDone",e6="RightDone",e9=Symbol.for("effect/ChannelMergeState"),e7={[e9]:e9},te=(e,t)=>{let r=Object.create(e7);return r._tag=e8,r.left=e,r.right=t,r},tt=e=>{let t=Object.create(e7);return t._tag=e4,t.f=e,t},tr=e=>{let t=Object.create(e7);return t._tag=e6,t.f=e,t},ti="BackPressure",tn="BufferSliding",ta=Symbol.for("effect/ChannelMergeStrategy"),ts={[ta]:ta},to=e=>{let t=Object.create(ts);return t._tag=ti,t},tl=(0,d.dual)(2,(e,t)=>{let{onBackPressure:r,onBufferSliding:i}=t;switch(e._tag){case ti:return r();case tn:return i()}});e.s(["BackPressure",0,to,"BufferSliding",0,e=>{let t=Object.create(ts);return t._tag=tn,t},"match",0,tl],7237733);let tu="Empty",tc="Emit",td="Error",tp="Done",tf=e=>({_tag:tu,notifyProducer:e}),th=e=>({_tag:tc,notifyConsumers:e});class tm{ref;constructor(e){this.ref=e}awaitRead(){return a.flatten(y.modify(this.ref,e=>e._tag===tu?[n.await(e.notifyProducer),e]:[a.void,e]))}get close(){return a.fiberIdWith(e=>this.error(t.interrupt(e)))}done(e){return a.flatten(y.modify(this.ref,t=>{switch(t._tag){case tu:return[n.await(t.notifyProducer),t];case tc:return[a.forEach(t.notifyConsumers,t=>n.succeed(t,s.left(e)),{discard:!0}),{_tag:tp,done:e}];case td:case tp:return[a.interrupt,t]}}))}emit(e){return a.flatMap(n.make(),t=>a.flatten(y.modify(this.ref,r=>{switch(r._tag){case tu:return[n.await(r.notifyProducer),r];case tc:{let i=r.notifyConsumers[0],a=r.notifyConsumers.slice(1);if(void 0!==i)return[n.succeed(i,s.right(e)),0===a.length?tf(t):th(a)];throw Error("Bug: Channel.SingleProducerAsyncInput.emit - Queue was empty! please report an issue at https://github.com/Effect-TS/effect/issues")}case td:case tp:return[a.interrupt,r]}})))}error(e){return a.flatten(y.modify(this.ref,t=>{switch(t._tag){case tu:return[n.await(t.notifyProducer),t];case tc:return[a.forEach(t.notifyConsumers,t=>n.failCause(t,e),{discard:!0}),{_tag:td,cause:e}];case td:case tp:return[a.interrupt,t]}}))}get take(){return this.takeWith(e=>l.failCause(t.map(e,s.left)),e=>l.succeed(e),e=>l.fail(s.right(e)))}takeWith(e,t,r){return a.flatMap(n.make(),i=>a.flatten(y.modify(this.ref,o=>{switch(o._tag){case tu:return[a.zipRight(n.succeed(o.notifyProducer,void 0),a.matchCause(n.await(i),{onFailure:e,onSuccess:s.match({onLeft:r,onRight:t})})),th([i])];case tc:return[a.matchCause(n.await(i),{onFailure:e,onSuccess:s.match({onLeft:r,onRight:t})}),th([...o.notifyConsumers,i])];case td:return[a.succeed(e(o.cause)),o];case tp:return[a.succeed(r(o.done)),o]}})))}}let tg=()=>(0,d.pipe)(n.make(),a.flatMap(e=>y.make(tf(e))),a.map(e=>new tm(e)));var ty=e.i(4039787),tS=e.i(3427637);let tb=(e,t,r)=>ed(ef(y.make(()=>a.void)),i=>(0,d.pipe)(ef(a.uninterruptible(a.tap(e,e=>y.set(i,t=>r(e,t))))),ed(t),eo(e=>a.flatMap(y.get(i),t=>t(e))))),tv=(0,d.dual)(2,(e,t)=>tV(e,()=>t)),tE=e=>eE(()=>{let t=(e,r,i)=>rd(y.modify(i,n=>r(n)?[ey({onInput:n=>ed(eI(n),()=>t(e,r,i)),onFailure:e=>el(e),onDone:e=>ev(e)}),n]:[ed(eI(n),()=>t(e,r,i)),e]));return t(e.empty,e.isEmpty,e.ref)}),tw=(0,d.dual)(2,(e,r)=>X(e,e=>s.match(t.failureOrCause(e),{onLeft:r,onRight:eu}))),tk=(0,d.dual)(2,(e,t)=>en(e,t,()=>void 0,()=>void 0)),tI=(0,d.dual)(2,(e,t)=>{let r=ey({onInput:e=>f.match(t(e),{onNone:()=>r,onSome:e=>ed(eI(e),()=>r)}),onFailure:el,onDone:ev});return eh(e,r)}),tT=(0,d.dual)(2,(e,t)=>{let r=ey({onInput:e=>ed(eI(e),()=>r),onFailure:el,onDone:e=>ev(t(e))});return eh(r,e)}),tx=(0,d.dual)(2,(e,t)=>{let r=ey({onInput:e=>ed(eI(e),()=>r),onFailure:el,onDone:e=>ef(t(e))});return eh(r,e)}),tC=(0,d.dual)(2,(e,t)=>{let r=ey({onInput:e=>ed(eI(e),()=>r),onFailure:e=>el(t(e)),onDone:ev});return eh(r,e)}),tR=(0,d.dual)(2,(e,t)=>{let r=ey({onInput:e=>ed(eI(e),()=>r),onFailure:e=>ef(t(e)),onDone:ev});return eh(r,e)}),tF=(0,d.dual)(2,(e,t)=>{let r=ey({onInput:e=>ed(eI(t(e)),()=>r),onFailure:el,onDone:ev});return eh(r,e)}),tA=(0,d.dual)(2,(e,t)=>{let r=ey({onInput:e=>ed(ed(ef(t(e)),eI),()=>r),onFailure:el,onDone:ev});return eh(r,e)}),tO=e=>eE(()=>{let t=[];return(0,d.pipe)(eh(e,t_(t)),ed(e=>eb([r.unsafeFromArray(t),e])))}),t_=e=>ey({onInput:t=>ed(ew(()=>{e.push(t)}),()=>t_(e)),onFailure:el,onDone:eb}),tM=e=>{let t=eS({onInput:()=>t,onFailure:eu,onDone:eb});return eh(e,t)},tD=(0,d.dual)(2,(e,t)=>eo(e,()=>t)),tN=()=>ef(a.context()),tP=e=>ed(tN(),e),tL=e=>ed(e,d.identity),tU=(0,d.dual)(2,(e,r)=>ep(e,{onFailure:e=>{let i=t.failureOrCause(e);switch(i._tag){case"Left":return r.onFailure(i.left);case"Right":return eu(i.right)}},onSuccess:r.onSuccess})),tz=e=>rd(e.takeWith(eu,t=>ed(eI(t),()=>tz(e)),eb)),tW=e=>eE(()=>tB(e)),tB=e=>(0,d.pipe)(ef(g.take(e)),ed(s.match({onLeft:l.match({onFailure:eu,onSuccess:ev}),onRight:t=>ed(eI(t),()=>tB(e))}))),tq=()=>ey({onInput:e=>ed(eI(e),()=>tq()),onFailure:el,onDone:ev}),t$=(0,d.dual)(2,(e,t)=>t5(e,{other:ef(t),onSelfDone:e=>e2(a.suspend(()=>e)),onOtherDone:e=>e2(a.suspend(()=>e))})),tj=(0,d.dual)(2,(e,t)=>t$(e,n.await(t))),tV=(0,d.dual)(2,(e,t)=>ed(e,e=>ew(()=>t(e)))),tH=(0,d.dual)(2,(e,t)=>ed(e,e=>ef(t(e)))),tG=(0,d.dual)(2,(e,r)=>tK(e,t.map(r))),tK=(0,d.dual)(2,(e,t)=>X(e,e=>eu(t(e)))),tJ=(0,d.dual)(2,(e,t)=>{let r=ey({onInput:e=>ed(eI(t(e)),()=>r),onFailure:el,onDone:ev});return eh(e,r)}),tZ=(0,d.dual)(2,(e,t)=>{let r=eS({onInput:e=>(0,d.pipe)(ef(t(e)),ed(eI),ed(()=>r)),onFailure:eu,onDone:ev});return eh(e,r)}),tQ=(0,d.dual)(3,(e,t,r)=>rf(i=>a.gen(function*(){let o=yield*tg(),l=tz(o),u=yield*g.bounded(r);yield*S.addFinalizer(i,g.shutdown(u));let c=yield*n.make(),p=r===1/0?e=>d.identity:(yield*a.makeSemaphore(r)).withPermits,f=yield*l.pipe(eh(e),ro(i));yield*f.pipe(a.matchCauseEffect({onFailure:e=>g.offer(u,a.failCause(e)),onSuccess:s.match({onLeft:e=>a.zipRight(a.interruptible(p(r)(a.void)),a.asVoid(g.offer(u,a.succeed(s.left(e))))),onRight:e=>a.gen(function*(){let r=yield*n.make(),o=yield*n.make();yield*g.offer(u,a.map(n.await(r),s.right)),yield*n.succeed(o,void 0).pipe(a.zipRight(a.uninterruptibleMask(r=>a.exit(r(n.await(c))).pipe(a.raceFirst(a.exit(r(t(e)))),a.flatMap(d.identity))).pipe(a.tapErrorCause(e=>n.failCause(c,e)),a.intoDeferred(r))),p(1),a.forkIn(i)),yield*n.await(o)})})}),a.forever,a.interruptible,a.forkIn(i));let h=rd(a.matchCause(a.flatten(g.take(u)),{onFailure:eu,onSuccess:s.match({onLeft:ev,onRight:e=>ed(eI(e),()=>h)})}));return es(h,o)}))),tY=e=>t=>tX(e)(t,d.constVoid),tX=e=>{let{bufferSize:r=16,concurrency:i,mergeStrategy:o=to()}=e;return(e,l)=>rf(c=>a.gen(function*(){let p="unbounded"===i?Number.MAX_SAFE_INTEGER:i,h=yield*tg(),m=tz(h),b=yield*g.bounded(r);yield*S.addFinalizer(c,g.shutdown(b));let v=yield*g.unbounded();yield*S.addFinalizer(c,g.shutdown(v));let E=yield*y.make(f.none()),w=yield*n.make(),k=(yield*a.makeSemaphore(p)).withPermits,I=yield*ro(eh(m,e),c);function T(e){return e.pipe(a.flatMap(s.match({onLeft:e=>a.succeed(f.some(e)),onRight:e=>a.as(g.offer(b,a.succeed(s.right(e))),f.none())})),a.repeat({until:e=>f.isSome(e)}),a.flatMap(e=>y.update(E,f.match({onNone:()=>f.some(e.value),onSome:t=>f.some(l(t,e.value))}))),a.catchAllCause(e=>t.isInterrupted(e)?a.failCause(e):g.offer(b,a.failCause(e)).pipe(a.zipRight(n.succeed(w,void 0)),a.asVoid)))}yield*I.pipe(a.matchCauseEffect({onFailure:e=>g.offer(b,a.failCause(e)).pipe(a.zipRight(a.succeed(!1))),onSuccess:s.match({onLeft:e=>a.raceWith(a.interruptible(n.await(w)),a.interruptible(k(p)(a.void)),{onSelfDone:(e,t)=>a.as(u.interrupt(t),!1),onOtherDone:(t,r)=>a.zipRight(u.interrupt(r),y.get(E).pipe(a.flatMap(f.match({onNone:()=>g.offer(b,a.succeed(s.left(e))),onSome:t=>g.offer(b,a.succeed(s.left(l(t,e))))})),a.as(!1)))}),onRight:e=>tl(o,{onBackPressure:()=>a.gen(function*(){let t=yield*n.make(),r=a.scopedWith(t=>ro(eh(m,e),t).pipe(a.flatMap(e=>a.race(a.exit(T(e)),a.exit(a.interruptible(n.await(w))))),a.flatMap(d.identity)));return yield*n.succeed(t,void 0).pipe(a.zipRight(r),k(1),a.forkIn(c)),yield*n.await(t),!(yield*n.isDone(w))}),onBufferSliding:()=>a.gen(function*(){let t=yield*n.make(),r=yield*n.make(),i=yield*g.size(v);yield*g.take(v).pipe(a.flatMap(e=>n.succeed(e,void 0)),a.when(()=>i>=p)),yield*g.offer(v,t);let s=a.scopedWith(r=>ro(eh(m,e),r).pipe(a.flatMap(e=>a.exit(T(e)).pipe(a.race(a.exit(a.interruptible(n.await(w)))),a.race(a.exit(a.interruptible(n.await(t)))))),a.flatMap(d.identity)));return yield*n.succeed(r,void 0).pipe(a.zipRight(s),k(1),a.forkIn(c)),yield*n.await(r),!(yield*n.isDone(w))})})})}),a.repeat({while:e=>e}),a.forkIn(c));let x=(0,d.pipe)(g.take(b),a.flatten,a.matchCause({onFailure:eu,onSuccess:s.match({onLeft:ev,onRight:e=>ed(eI(e),()=>x)})}),rd);return es(x,h)}))},t0=(0,d.dual)(3,(e,t,r)=>tY(r)(tJ(e,t))),t1=(0,d.dual)(2,(e,t)=>tY({concurrency:t})(tJ(e,d.identity))),t2=(0,d.dual)(3,(e,t,r)=>tX({concurrency:t})(tJ(e,d.identity),r)),t5=(0,d.dual)(2,(e,t)=>rf(function(r){return a.gen(function*(){let i=yield*tg(),n=tz(i),o=yield*ro(eh(n,e),r),c=yield*ro(eh(n,t.other),r);function d(e,t,i){return(n,o,c)=>{function d(e){return e._tag===eY?a.succeed(ef(a.zipRight(u.interrupt(t),e.effect))):a.map(u.await(t),l.match({onFailure:t=>ef(e.f(l.failCause(t))),onSuccess:s.match({onLeft:t=>ef(e.f(l.succeed(t))),onRight:t=>rb(eI(t),p(c(e.f)))})}))}return l.match(e,{onFailure:e=>d(n(l.failCause(e))),onSuccess:s.match({onLeft:e=>d(n(l.succeed(e))),onRight:e=>a.succeed(ed(eI(e),()=>ed(ef(a.forkIn(a.interruptible(i),r)),e=>p(o(e,t)))))})})}}function p(e){switch(e._tag){case e8:{let r=a.interruptible(u.join(e.left)),i=a.interruptible(u.join(e.right));return rd(a.raceWith(r,i,{onSelfDone:(r,i)=>a.zipRight(u.interrupt(i),d(r,e.right,o)(t.onSelfDone,te,e=>tt(e))),onOtherDone:(r,i)=>a.zipRight(u.interrupt(i),d(r,e.left,c)(t.onOtherDone,(e,t)=>te(t,e),e=>tr(e)))}))}case e4:return rd(a.map(a.exit(c),l.match({onFailure:t=>ef(e.f(l.failCause(t))),onSuccess:s.match({onLeft:t=>ef(e.f(l.succeed(t))),onRight:t=>ed(eI(t),()=>p(tt(e.f)))})})));case e6:return rd(a.map(a.exit(o),l.match({onFailure:t=>ef(e.f(l.failCause(t))),onSuccess:s.match({onLeft:t=>ef(e.f(l.succeed(t))),onRight:t=>ed(eI(t),()=>p(tr(e.f)))})})))}}return ef(a.withFiberRuntime(e=>{let t=a.withFiberRuntime(t=>(t.transferChildren(e.scope()),a.void)),i=a.interruptible(o).pipe(a.ensuring(t),a.forkIn(r)),n=a.interruptible(c).pipe(a.ensuring(t),a.forkIn(r));return a.zipWith(i,n,(e,t)=>te(e,t))})).pipe(ed(p),es(i))})})),t3=ef(a.never),t8=(0,d.dual)(2,(e,t)=>t4(e,t)),t4=(0,d.dual)(2,(e,r)=>tw(e,e=>ec(()=>t.die(r(e))))),t6=(0,d.dual)(2,(e,t)=>tw(e,t)),t9=(0,d.dual)(2,(e,r)=>eE(()=>{let i,n=ey({onInput:e=>ed(eI(e),()=>n),onFailure:e=>(i=rE(e),eu(t.die(i))),onDone:ev}),a=eS({onInput:e=>(0,d.pipe)(eI(e),ed(()=>a)),onFailure:e=>t.isDieType(e)&&rw(e.defect)&&o.equals(e.defect,i)?el(e.defect.error):eu(e),onDone:ev});return eh(eh(eh(e,n),r),a)})),t7=(0,d.dual)(3,(e,t,r)=>ed(tN(),n=>em(e,i.add(n,t,r)))),re=(0,d.dual)(2,(e,t)=>rf(r=>a.map(p.buildWithScope(t,r),t=>em(e,t)))),rt=(0,d.dual)(2,(e,t)=>tP(r=>em(e,t(r)))),rr=(0,d.dual)(2,(e,t)=>re(e,p.merge(p.context(),t))),ri=e=>ed(e,()=>ri(e)),rn=e=>a.scopedWith(t=>eZ(e,t)),ra=e=>rd(a.uninterruptibleMask(t=>a.map(S.make(),r=>Y(a.tapErrorCause(t(S.extend(e,r)),e=>S.close(r,l.failCause(e))),(e,t)=>S.close(r,t))))),rs=e=>rp(a.map(a.scope,t=>ed(ef(e(t)),eI))),ro=(0,d.dual)(2,(e,t)=>a.zip(a.sync(()=>new eH(e,void 0,d.identity)),a.runtime()).pipe(a.tap(e=>{let[r,i]=e;return S.addFinalizerExit(t,e=>{let t=r.close(e);return void 0!==t?a.provide(t,i):a.void})}),a.uninterruptible,a.map(e=>{let[t]=e;return a.suspend(()=>rl(t.run(),t))}))),rl=(e,t)=>{switch(e._tag){case eT:return l.match(t.getDone(),{onFailure:a.failCause,onSuccess:e=>a.succeed(s.left(e))});case ex:return a.succeed(s.right(t.getEmit()));case eC:return(0,d.pipe)(e.effect,a.flatMap(()=>rl(t.run(),t)));case eR:return eJ(e,()=>rl(t.run(),t),e=>a.failCause(e))}},ru=e=>eE(()=>rc(e)),rc=e=>eS({onInput:t=>ed(ef(g.offer(e,s.right(t))),()=>rc(e)),onFailure:t=>ef(g.offer(e,s.left(l.failCause(t)))),onDone:t=>ef(g.offer(e,s.left(l.succeed(t))))}),rd=e=>tL(ef(e)),rp=e=>ei(ra(e),(e,t)=>e,(e,t)=>e),rf=e=>ei(rs(e),(e,t)=>e,(e,t)=>e),rh=(0,d.dual)(3,(e,t,r)=>rt(e,e=>i.merge(e,i.make(t,r(i.unsafeGet(e,t)))))),rm=e=>rg(0,e.length,e),rg=(e,t,i)=>e===t?ek:(0,d.pipe)(eI((0,d.pipe)(i,r.unsafeGet(e))),ed(()=>rg(e+1,t,i))),ry=(0,d.dual)(e=>Q(e[1]),(e,t,r)=>r?.concurrent?t5(e,{other:t,onSelfDone:e=>e5(t=>a.suspend(()=>l.zip(e,t))),onOtherDone:e=>e5(t=>a.suspend(()=>l.zip(t,e)))}):ed(e,e=>tV(t,t=>[e,t]))),rS=(0,d.dual)(e=>Q(e[1]),(e,t,r)=>r?.concurrent?tV(ry(e,t,{concurrent:!0}),e=>e[0]):ed(e,e=>tv(t,e))),rb=(0,d.dual)(e=>Q(e[1]),(e,t,r)=>r?.concurrent?tV(ry(e,t,{concurrent:!0}),e=>e[1]):ed(e,()=>t)),rv=Symbol.for("effect/Channel/ChannelException"),rE=e=>({_tag:"ChannelException",[rv]:rv,error:e}),rw=e=>(0,h.hasProperty)(e,rv);e.s(["ChannelException",0,rE,"ChannelExceptionTypeId",0,rv,"acquireUseRelease",0,tb,"as",0,tv,"asVoid",0,e=>tV(e,d.constVoid),"buffer",0,tE,"bufferChunk",0,e=>tE({empty:r.empty(),isEmpty:r.isEmpty,ref:e}),"catchAll",0,tw,"collect",0,tI,"concatMap",0,tk,"concatOut",0,e=>er(e),"context",0,tN,"contextWith",0,e=>tV(tN(),e),"contextWithChannel",0,tP,"contextWithEffect",0,e=>tH(tN(),e),"doneCollect",0,tO,"drain",0,tM,"emitCollect",0,e=>ed(tO(e),eI),"ensuring",0,tD,"flatten",0,tL,"foldChannel",0,tU,"fromEither",0,e=>eE(()=>s.match(e,{onLeft:el,onRight:eb})),"fromInput",0,tz,"fromOption",0,e=>eE(()=>f.match(e,{onNone:()=>el(f.none()),onSome:eb})),"fromPubSub",0,e=>rp(a.map(m.subscribe(e),tW)),"fromPubSubScoped",0,e=>a.map(m.subscribe(e),tW),"fromQueue",0,tW,"identityChannel",0,tq,"interruptWhen",0,t$,"interruptWhenDeferred",0,tj,"isChannelException",0,rw,"map",0,tV,"mapEffect",0,tH,"mapError",0,tG,"mapErrorCause",0,tK,"mapInput",0,tT,"mapInputContext",0,rt,"mapInputEffect",0,tx,"mapInputError",0,tC,"mapInputErrorEffect",0,tR,"mapInputIn",0,tF,"mapInputInEffect",0,tA,"mapOut",0,tJ,"mapOutEffect",0,tZ,"mapOutEffectPar",0,tQ,"mergeAll",0,tY,"mergeAllUnbounded",0,e=>tX({concurrency:"unbounded"})(e,d.constVoid),"mergeAllUnboundedWith",0,(e,t)=>tX({concurrency:"unbounded"})(e,t),"mergeAllWith",0,tX,"mergeMap",0,t0,"mergeOut",0,t1,"mergeOutWith",0,t2,"mergeWith",0,t5,"never",0,t3,"orDie",0,t8,"orDieWith",0,t4,"orElse",0,t6,"pipeToOrFail",0,t9,"provideLayer",0,re,"provideService",0,t7,"provideSomeLayer",0,rr,"read",0,()=>eg(f.none()),"repeated",0,ri,"run",0,rn,"runCollect",0,e=>rn(ee(e)),"runDrain",0,e=>rn(tM(e)),"runScoped",0,e=>a.scopeWith(t=>eZ(e,t)),"scoped",0,ra,"scopedWith",0,rs,"splitLines",0,()=>eE(()=>{let e="",t=!1,i=eS({onInput:n=>{let a,s=(a=[],r.map(n,r=>{if(0!==r.length){let i=0,n=r.indexOf("\r"),s=r.indexOf("\n");for(t&&(0===s?(a.push(e),e="",i=1,s=r.indexOf("\n",i)):e+="\r",t=!1);-1!==n||-1!==s;)-1===n||-1!==s&&s<n?(0===e.length?a.push(r.substring(i,s)):(a.push(e+r.substring(i,s)),e=""),i=s+1,s=r.indexOf("\n",i)):r.length===n+1?(t=!0,n=-1):s===n+1?(0===e.length?a.push(r.substring(i,n)):(e+=r.substring(i,n),a.push(e),e=""),i=n+2,n=r.indexOf("\r",i),s=r.indexOf("\n",i)):n=r.indexOf("\r",n+1);t?e+=r.substring(i,r.length-1):e+=r.substring(i,r.length)}}),r.unsafeFromArray(a));return r.isEmpty(s)?i:ed(eI(s),()=>i)},onFailure:t=>0===e.length?eu(t):ed(eI(r.of(e)),()=>eu(t)),onDone:t=>0===e.length?eb(t):ed(eI(r.of(e)),()=>eb(t))});return i}),"toPubSub",0,e=>ru(e),"toPull",0,e=>a.flatMap(a.scope,t=>ro(e,t)),"toPullIn",0,ro,"toQueue",0,ru,"unwrap",0,rd,"unwrapScoped",0,rp,"unwrapScopedWith",0,rf,"updateService",0,rh,"withSpan",0,function(){let e="string"!=typeof arguments[0],t=e?arguments[1]:arguments[0],r=tS.addSpanStackTrace(e?arguments[2]:arguments[1]),n=a.all([a.makeSpan(t,r),a.context(),a.clock,c.get(c.currentTracerTimingEnabled)]);if(e){let e=arguments[0];return tb(n,t=>{let[r,n]=t;return em(e,i.add(n,tS.spanTag,r))},(e,t)=>{let[r,,i,n]=e;return ty.endSpan(r,t,i,n)})}return e=>tb(n,t=>{let[r,n]=t;return em(e,i.add(n,tS.spanTag,r))},(e,t)=>{let[r,,i,n]=e;return ty.endSpan(r,t,i,n)})},"writeAll",0,function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return rm(r.fromIterable(t))},"writeChunk",0,rm,"zip",0,ry,"zipLeft",0,rS,"zipRight",0,rb],6091153),e.s(["Await",0,e5,"Done",0,e2],7534251);var rk=e.i(8973103),rI=e.i(7525378),rT=e.i(5369340),rx=e.i(7548658),rC=e.i(4026828),rR=e.i(1658800);let rF=Symbol.for("effect/RcRef"),rA={_tag:"Empty"},rO={_tag:"Closed"},r_={_A:d.identity,_E:d.identity};class rM extends rI.Class{acquire;context;scope;idleTimeToLive;[rF]=r_;[rT.TypeId]=rT.TypeId;state=rA;semaphore=rC.unsafeMakeSemaphore(1);constructor(e,t,r,i){super(),this.acquire=e,this.context=t,this.scope=r,this.idleTimeToLive=i,this.get=rD(this)}get;commit(){return this.get}}let rD=e=>rx.uninterruptibleMask(t=>rx.suspend(()=>{switch(e.state._tag){case"Closed":return rx.interrupt;case"Acquired":return e.state.refCount++,e.state.fiber?rx.as(rx.interruptFiber(e.state.fiber),e.state):rx.succeed(e.state);case"Empty":return rR.scopeMake().pipe(ty.bindTo("scope"),ty.bind("value",r=>{let{scope:n}=r;return t(rx.fiberRefLocally(e.acquire,rx.currentContext,i.add(e.context,rR.scopeTag,n)))}),rx.map(t=>{let{scope:r,value:i}=t,n={_tag:"Acquired",value:i,scope:r,fiber:void 0,refCount:1};return e.state=n,n}))}})).pipe(e.semaphore.withPermits(1),ty.bindTo("state"),ty.bind("scope",()=>rR.scopeTag),rx.tap(t=>{let{scope:r,state:i}=t;return r.addFinalizer(()=>rx.suspend(()=>(i.refCount--,i.refCount>0)?rx.void:void 0===e.idleTimeToLive?(e.state=rA,rx.scopeClose(i.scope,rx.exitVoid)):ty.sleep(e.idleTimeToLive).pipe(rx.interruptible,rx.zipRight(rx.suspend(()=>"Acquired"===e.state._tag&&0===e.state.refCount?(e.state=rA,rx.scopeClose(i.scope,rx.exitVoid)):rx.void)),rR.ensuring(rx.sync(()=>{i.fiber=void 0})),rC.forkIn(e.scope),rx.tap(e=>{i.fiber=e}),e.semaphore.withPermits(1))))}),rx.map(e=>{let{state:t}=e;return t.value}));e.s(["get",0,rD,"make",0,e=>rx.withFiberRuntime(t=>{let r=t.getFiberRef(rx.currentContext),n=i.get(r,rR.scopeTag),a=new rM(e.acquire,r,n,e.idleTimeToLive?rk.decode(e.idleTimeToLive):void 0);return rx.as(n.addFinalizer(()=>a.semaphore.withPermits(1)(rx.suspend(()=>{let e="Acquired"===a.state._tag?rx.scopeClose(a.state.scope,rx.exitVoid):rx.void;return a.state=rO,e}))),a)})],9292764)},469137,7703391,7365553,5806407,e=>{"use strict";var t=e.i(5450905),r=e.i(7862555),i=e.i(219787),n=e.i(5972454),a=e.i(578549),s=e.i(8973103),o=e.i(3322401),l=e.i(1331084),u=e.i(3628392),c=e.i(7836076),d=e.i(6028004),p=e.i(6098979),f=e.i(3683485),h=e.i(1650035),m=e.i(9227260),g=e.i(7534251),y=e.i(8815901),S=e.i(9960543),b=e.i(4935619),v=e.i(1299557),E=e.i(1072215),w=e.i(9292764),k=e.i(6532885),I=e.i(5310088),T=e.i(9992093);let x=T.ScheduleTypeId,C=T.ScheduleDriverTypeId,R=T.makeWithState,F=T.isSchedule,A=T.addDelay,O=T.addDelayEffect,_=T.andThen,M=T.andThenEither,D=T.as,N=T.asVoid,P=T.bothInOut,L=T.check,U=T.checkEffect,z=T.collectAllInputs,W=T.collectAllOutputs,B=T.collectUntil,q=T.collectUntilEffect,$=T.collectWhile,j=T.collectWhileEffect,V=T.compose,H=T.mapInput,G=T.mapInputEffect,K=T.mapInputContext,J=T.count,Z=T.cron,Q=T.secondOfMinute,Y=T.minuteOfHour,X=T.hourOfDay,ee=T.dayOfMonth,et=T.dayOfWeek,er=T.delayed,ei=T.delayedEffect,en=T.delayedSchedule,ea=T.delays,es=T.mapBoth,eo=T.mapBothEffect,el=T.driver,eu=T.duration,ec=T.either,ed=T.eitherWith,ep=T.elapsed,ef=T.ensuring,eh=T.exponential,em=T.fibonacci,eg=T.fixed,ey=T.forever,eS=T.fromDelay,eb=T.fromDelays,ev=T.fromFunction,eE=T.identity,ew=T.passthrough,ek=T.intersect,eI=T.intersectWith,eT=T.jittered,ex=T.jitteredWith,eC=T.linear,eR=T.map,eF=T.mapEffect,eA=T.modifyDelay,eO=T.modifyDelayEffect,e_=T.onDecision,eM=T.once,eD=T.provideContext,eN=T.provideService,eP=T.recurUntil,eL=T.recurUntilEffect,eU=T.recurUntilOption,ez=T.recurUpTo,eW=T.recurWhile,eB=T.recurWhileEffect,eq=T.recurs,e$=T.reduce,ej=T.reduceEffect,eV=T.forever,eH=T.repetitions,eG=T.resetAfter,eK=T.resetWhen,eJ=T.run,eZ=T.spaced,eQ=T.stop,eY=T.succeed,eX=T.sync,e0=T.tapInput,e1=T.tapOutput,e2=T.unfold,e5=T.union,e3=T.unionWith,e8=T.untilInput,e4=T.untilInputEffect,e6=T.untilOutput,e9=T.untilOutputEffect,e7=T.upTo,te=T.whileInput,tt=T.whileInputEffect,tr=T.whileOutput,ti=T.whileOutputEffect,tn=T.windowed,ta=T.zipLeft,ts=T.zipRight,to=T.zipWith,tl=T.CurrentIterationMetadata;e.s(["CurrentIterationMetadata",0,tl,"ScheduleDriverTypeId",0,C,"ScheduleTypeId",0,x,"addDelay",0,A,"addDelayEffect",0,O,"andThen",0,_,"andThenEither",0,M,"as",0,D,"asVoid",0,N,"bothInOut",0,P,"check",0,L,"checkEffect",0,U,"collectAllInputs",0,z,"collectAllOutputs",0,W,"collectUntil",0,B,"collectUntilEffect",0,q,"collectWhile",0,$,"collectWhileEffect",0,j,"compose",0,V,"count",0,J,"cron",0,Z,"dayOfMonth",0,ee,"dayOfWeek",0,et,"delayed",0,er,"delayedEffect",0,ei,"delayedSchedule",0,en,"delays",0,ea,"driver",0,el,"duration",0,eu,"either",0,ec,"eitherWith",0,ed,"elapsed",0,ep,"ensuring",0,ef,"exponential",0,eh,"fibonacci",0,em,"fixed",0,eg,"forever",0,ey,"fromDelay",0,eS,"fromDelays",0,eb,"fromFunction",0,ev,"hourOfDay",0,X,"identity",0,eE,"intersect",0,ek,"intersectWith",0,eI,"isSchedule",0,F,"jittered",0,eT,"jitteredWith",0,ex,"linear",0,eC,"makeWithState",0,R,"map",0,eR,"mapBoth",0,es,"mapBothEffect",0,eo,"mapEffect",0,eF,"mapInput",0,H,"mapInputContext",0,K,"mapInputEffect",0,G,"minuteOfHour",0,Y,"modifyDelay",0,eA,"modifyDelayEffect",0,eO,"onDecision",0,e_,"once",0,eM,"passthrough",0,ew,"provideContext",0,eD,"provideService",0,eN,"recurUntil",0,eP,"recurUntilEffect",0,eL,"recurUntilOption",0,eU,"recurUpTo",0,ez,"recurWhile",0,eW,"recurWhileEffect",0,eB,"recurs",0,eq,"reduce",0,e$,"reduceEffect",0,ej,"repeatForever",0,eV,"repetitions",0,eH,"resetAfter",0,eG,"resetWhen",0,eK,"run",0,eJ,"secondOfMinute",0,Q,"spaced",0,eZ,"stop",0,eQ,"succeed",0,eY,"sync",0,eX,"tapInput",0,e0,"tapOutput",0,e1,"unfold",0,e2,"union",0,e5,"unionWith",0,e3,"untilInput",0,e8,"untilInputEffect",0,e4,"untilOutput",0,e6,"untilOutputEffect",0,e9,"upTo",0,e7,"whileInput",0,te,"whileInputEffect",0,tt,"whileOutput",0,tr,"whileOutputEffect",0,ti,"windowed",0,tn,"zipLeft",0,ta,"zipRight",0,ts,"zipWith",0,to],7703391);let tu={_tag:"Left"},tc={_tag:"Right"},td={_tag:"Both"},tp={_tag:"Either"};var tf=e.i(5283034),th=e.i(9390854),tm=e.i(2090854),tg=e.i(4138091),ty=e.i(8884753),tS=e.i(7548658),tb=e.i(5242335),tv=e.i(6187448),tE=e.i(4807844),tw=e.i(5015632),tk=e.i(5160412),tI=e.i(6091153),tT=e.i(1200369);let tx=Symbol.for("effect/Sink"),tC={_A:e=>e,_In:e=>e,_L:e=>e,_E:e=>e,_R:e=>e};class tR{channel;[tx]=tC;constructor(e){this.channel=e}pipe(){return(0,S.pipeArguments)(this,arguments)}}let tF=e=>(0,b.hasProperty)(e,tx),tA=e=>new tR(ty.suspend(()=>rJ(e()))),tO=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,r_(()=>t))),t_=()=>new tR(tM(r.empty())),tM=e=>ty.readWithCause({onInput:t=>tM((0,f.pipe)(e,r.appendAll(t))),onFailure:ty.failCause,onDone:()=>ty.succeed(e)}),tD=e=>tA(()=>rT(tN(e,r.empty()))),tN=(e,t)=>ty.readWithCause({onInput:i=>{let[n,a]=r.splitAt(i,e);return n.length<e?tN(e-n.length,r.appendAll(t,n)):r.isEmpty(a)?ty.succeed(r.appendAll(t,n)):ty.flatMap(ty.write(a),()=>ty.succeed(r.appendAll(t,n)))},onFailure:ty.failCause,onDone:()=>ty.succeed(t)}),tP=(e,t)=>ty.readWith({onInput:i=>{let[n,a]=(0,f.pipe)(r.toReadonlyArray(i),tf.span(e));return 0===a.length?tP(e,(0,f.pipe)(t,r.appendAll(r.unsafeFromArray(n)))):(0,f.pipe)(ty.write(r.unsafeFromArray(a)),tI.zipRight(ty.succeed((0,f.pipe)(t,r.appendAll(r.unsafeFromArray(n))))))},onFailure:ty.fail,onDone:()=>ty.succeed(t)}),tL=(e,t)=>ty.readWith({onInput:i=>(0,f.pipe)(ty.fromEffect((0,f.pipe)(i,o.takeWhile(e),o.map(r.unsafeFromArray))),ty.flatMap(n=>{let a=(0,f.pipe)(i,r.drop(n.length));return r.isEmpty(a)?tL(e,(0,f.pipe)(t,r.appendAll(n))):(0,f.pipe)(ty.write(a),tI.zipRight(ty.succeed((0,f.pipe)(t,r.appendAll(n)))))})),onFailure:ty.fail,onDone:()=>ty.succeed(t)}),tU=(0,f.dual)(2,(e,t)=>{let i=(0,f.pipe)(k.make(r.empty()),o.zip(k.make(!1)));return new tR((0,f.pipe)(ty.fromEffect(i),ty.flatMap(r=>{let[i,n]=r,a=ty.readWith({onInput:e=>(0,f.pipe)(ty.write(e),ty.flatMap(()=>a)),onFailure:ty.fail,onDone:e=>(0,f.pipe)(ty.fromEffect(k.set(n,!0)),tI.as(e))});return(0,f.pipe)(a,ty.pipeTo(tI.bufferChunk(i)),ty.pipeTo(tz(e,i,n,t.initial,t.while,t.body)))})))}),tz=(e,t,i,n,a,s)=>(0,f.pipe)(rJ(e),tI.doneCollect,tI.foldChannel({onFailure:ty.fail,onSuccess:o=>{let[l,u]=o;return a(u)?(0,f.pipe)(ty.fromEffect(k.set(t,r.flatten(l))),ty.flatMap(()=>(0,f.pipe)(ty.fromEffect(k.get(i)),ty.flatMap(o=>{let c=s(n,u);return o?(0,f.pipe)(ty.write(r.flatten(l)),tI.as(c)):tz(e,t,i,c,a,s)})))):(0,f.pipe)(ty.write(r.flatten(l)),tI.as(n))}})),tW=e=>new tR((0,f.pipe)(ty.collectElements(rJ(e)),tI.map(e=>{let[t,i]=e;return[i,r.flatten(t)]}))),tB=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,t$(r.map(t)))),tq=(0,f.dual)(2,(e,t)=>tj(e,e=>o.map(o.forEach(e,e=>t(e)),r.unsafeFromArray))),t$=(0,f.dual)(2,(e,t)=>{let r=ty.readWith({onInput:e=>(0,f.pipe)(ty.write(t(e)),ty.flatMap(()=>r)),onFailure:ty.fail,onDone:ty.succeed});return new tR((0,f.pipe)(r,ty.pipeTo(rJ(e))))}),tj=(0,f.dual)(2,(e,t)=>{let r=ty.readWith({onInput:e=>(0,f.pipe)(ty.fromEffect(t(e)),ty.flatMap(ty.write),ty.flatMap(()=>r)),onFailure:ty.fail,onDone:ty.succeed});return new tR((0,f.pipe)(r,tI.pipeToOrFail(rJ(e))))}),tV=(0,f.dual)(2,(e,t)=>r_(tB(e,t.onInput),t.onDone)),tH=(0,f.dual)(2,(e,t)=>rM(tq(e,t.onInput),t.onDone)),tG=(0,f.dual)(2,(e,t)=>r_(t$(e,t.onInput),t.onDone)),tK=(0,f.dual)(2,(e,t)=>rM(tj(e,t.onInput),t.onDone)),tJ=new tR(tI.drain(tI.identityChannel())),tZ=e=>tA(()=>new tR(tQ(e))),tQ=e=>ty.readWith({onInput:t=>{let i=(0,f.pipe)(t,r.drop(e)),n=Math.max(e-t.length,0);return r.isEmpty(t)||n>0?tQ(n):(0,f.pipe)(ty.write(i),tI.zipRight(tI.identityChannel()))},onFailure:ty.fail,onDone:()=>ty.void}),tY=e=>ty.readWith({onInput:t=>(0,f.pipe)(t,o.dropUntil(e),o.map(t=>0===t.length?tY(e):(0,f.pipe)(ty.write(r.unsafeFromArray(t)),tI.zipRight(tI.identityChannel()))),tI.unwrap),onFailure:ty.fail,onDone:()=>ty.void}),tX=e=>new tR(t0(e)),t0=e=>ty.readWith({onInput:t=>{let i=(0,f.pipe)(t,r.dropWhile(e));return r.isEmpty(i)?t0(e):(0,f.pipe)(ty.write(i),tI.zipRight(tI.identityChannel()))},onFailure:ty.fail,onDone:ty.succeedNow}),t1=e=>ty.readWith({onInput:t=>(0,f.pipe)(t,o.dropWhile(e),o.map(t=>0===t.length?t1(e):(0,f.pipe)(ty.write(r.unsafeFromArray(t)),tI.zipRight(tI.identityChannel()))),tI.unwrap),onFailure:ty.fail,onDone:()=>ty.void}),t2=(0,f.dual)(2,(e,t)=>new tR((0,f.pipe)(e,rJ,tI.ensuring(t)))),t5=(0,f.dual)(2,(e,t)=>new tR((0,f.pipe)(e,rJ,ty.ensuringWith(t)))),t3=()=>rx(o.context()),t8=e=>new tR(ty.fail(e)),t4=e=>new tR(ty.failCause(e)),t6=e=>new tR(ty.failCauseSync(e)),t9=(0,f.dual)(2,(e,t)=>tj(e,e=>o.map(o.filter(e,t),r.unsafeFromArray))),t7=(0,f.dual)(2,(e,t)=>new tR((0,f.pipe)(ty.fromEffect((0,f.pipe)(k.make(r.empty()),o.zip(k.make(!1)))),ty.flatMap(i=>{let[n,a]=i,s=ty.readWith({onInput:e=>(0,f.pipe)(ty.write(e),ty.flatMap(()=>s)),onFailure:ty.fail,onDone:e=>(0,f.pipe)(ty.fromEffect(k.set(a,!0)),tI.as(e))}),o=tI.foldChannel(ty.collectElements(rJ(e)),{onFailure:ty.fail,onSuccess:e=>{let[i,s]=e;return(0,f.pipe)(ty.fromEffect(t(s)),ty.flatMap(e=>(0,f.pipe)(ty.fromEffect(k.set(n,r.flatten(i))),tI.zipRight((0,f.pipe)(ty.fromEffect(k.get(a)),ty.flatMap(t=>e?(0,f.pipe)(ty.write(r.flatten(i)),tI.as(y.some(s))):t?(0,f.pipe)(ty.write(r.flatten(i)),tI.as(y.none())):o))))))}});return(0,f.pipe)(s,ty.pipeTo(tI.bufferChunk(n)),ty.pipeTo(o))})))),re=(e,t,r)=>tA(()=>new tR(rt(e,t,r))),rt=(e,t,i)=>t(e)?ty.readWith({onInput:n=>{let[a,s]=rr(e,n,t,i,0,n.length);return r.isNonEmpty(s)?(0,f.pipe)(ty.write(s),tI.as(a)):rt(a,t,i)},onFailure:ty.fail,onDone:()=>ty.succeedNow(e)}):ty.succeedNow(e),rr=(e,t,i,n,a,s)=>{if(a===s)return[e,r.empty()];let o=n(e,(0,f.pipe)(t,r.unsafeGet(a)));return i(o)?rr(o,t,i,n,a+1,s):[o,(0,f.pipe)(t,r.drop(a+1))]},ri=(0,f.dual)(2,(e,t)=>new tR((0,f.pipe)(rJ(e),ty.collectElements,tI.foldChannel({onFailure:e=>rJ(t.onFailure(e)),onSuccess:e=>{let[i,n]=e;return ty.suspend(()=>{let e={ref:(0,f.pipe)(i,r.filter(r.isNonEmpty))},a=(0,f.pipe)(ty.sync(()=>{let t=e.ref;return e.ref=r.empty(),t}),ty.flatMap(e=>tI.writeChunk(e))),s=tI.identityChannel(),o=(0,f.pipe)(a,tI.zipRight(s),ty.pipeTo(rJ(t.onSuccess(n))));return ty.flatMap(ty.collectElements(o),t=>{let[r,i]=t;return(0,f.pipe)(ty.succeed(e.ref),ty.flatMap(tI.writeChunk),tI.zipRight(tI.writeChunk(r)),tI.as(i))})})}})))),rn=(e,t,r)=>tA(()=>new tR(ra(e,t,r))),ra=(e,t,r)=>t(e)?ty.readWith({onInput:i=>ra(r(e,i),t,r),onFailure:ty.fail,onDone:()=>ty.succeedNow(e)}):ty.succeedNow(e),rs=(e,t,r)=>tA(()=>new tR(ro(e,t,r))),ro=(e,t,r)=>t(e)?ty.readWith({onInput:i=>(0,f.pipe)(ty.fromEffect(r(e,i)),ty.flatMap(e=>ro(e,t,r))),onFailure:ty.fail,onDone:()=>ty.succeedNow(e)}):ty.succeedNow(e),rl=(e,t,r)=>tA(()=>new tR(ru(e,t,r))),ru=(e,t,r)=>t(e)?ty.readWith({onInput:i=>(0,f.pipe)(ty.fromEffect(rc(e,i,t,r)),ty.flatMap(e=>{let[i,n]=e;return(0,f.pipe)(n,y.match({onNone:()=>ru(i,t,r),onSome:e=>(0,f.pipe)(ty.write(e),tI.as(i))}))})),onFailure:ty.fail,onDone:()=>ty.succeedNow(e)}):ty.succeedNow(e),rc=(e,t,r,i)=>rd(e,t,0,t.length,r,i),rd=(e,t,i,n,a,s)=>i===n?o.succeed([e,y.none()]):(0,f.pipe)(s(e,(0,f.pipe)(t,r.unsafeGet(i))),o.flatMap(e=>a(e)?rd(e,t,i+1,n,a,s):o.succeed([e,y.some((0,f.pipe)(t,r.drop(i+1)))]))),rp=(e,t)=>rn(e,f.constTrue,t),rf=e=>rh({...e,decompose:r.of}),rh=e=>tA(()=>new tR(rm(e.initial,0,!1,e.maxCost,e.cost,e.decompose,e.body))),rm=(e,t,i,n,a,s,o)=>ty.readWith({onInput:l=>{let[u,c,d,p]=rg(l,e,t,i,n,a,s,o);return r.isNonEmpty(p)?(0,f.pipe)(ty.write(p),tI.zipRight(ty.succeedNow(u))):t>n?ty.succeedNow(u):rm(u,c,d,n,a,s,o)},onFailure:ty.fail,onDone:()=>ty.succeedNow(e)}),rg=(e,t,i,n,a,s,o,l)=>{for(let u=0;u<e.length;u++){let c=r.unsafeGet(e,u),d=i;if((i+=s(t,c))<=a){t=l(t,c),n=!0;continue}let p=o(c);if(p.length<=1&&!n)return[l(t,c),i,!0,r.drop(e,u+1)];if(p.length<=1&&n)return[t,d,n,r.drop(e,u)];e=r.appendAll(p,r.drop(e,u+1)),i=d,u=-1}return[t,i,n,r.empty()]},ry=e=>tA(()=>new tR(rS(e.initial,e.maxCost,e.cost,e.decompose,e.body,0,!1))),rS=(e,t,i,n,a,s,o)=>ty.readWith({onInput:l=>(0,f.pipe)(ty.fromEffect(rb(e,t,i,n,a,l,o,s,0)),ty.flatMap(e=>{let[o,l,u,c]=e;return r.isNonEmpty(c)?(0,f.pipe)(ty.write(c),tI.zipRight(ty.succeedNow(o))):s>t?ty.succeedNow(o):rS(o,t,i,n,a,l,u)})),onFailure:ty.fail,onDone:()=>ty.succeedNow(e)}),rb=(e,t,i,n,a,s,l,u,c)=>{if(c===s.length)return o.succeed([e,u,l,r.empty()]);let d=(0,f.pipe)(s,r.unsafeGet(c));return(0,f.pipe)(i(e,d),o.map(e=>u+e),o.flatMap(p=>p<=t?(0,f.pipe)(a(e,d),o.flatMap(e=>rb(e,t,i,n,a,s,!0,p,c+1))):(0,f.pipe)(n(d),o.flatMap(h=>h.length<=1&&!l?(0,f.pipe)(a(e,d),o.map(e=>[e,p,!0,(0,f.pipe)(s,r.drop(c+1))])):h.length<=1&&l?o.succeed([e,u,l,(0,f.pipe)(s,r.drop(c))]):rb(e,t,i,n,a,(0,f.pipe)(h,r.appendAll((0,f.pipe)(s,r.drop(c+1)))),l,u,0)))))},rv=(0,f.dual)(2,(e,t)=>ri(e,{onFailure:t8,onSuccess:t})),rE=e=>{let t=ty.readWithCause({onInput:r=>(0,f.pipe)(ty.fromEffect(o.forEach(r,t=>e(t),{discard:!0})),ty.flatMap(()=>t)),onFailure:ty.failCause,onDone:()=>ty.void});return new tR(t)},rw=e=>{let t=ty.readWithCause({onInput:r=>(0,f.pipe)(ty.fromEffect(e(r)),ty.flatMap(()=>t)),onFailure:ty.failCause,onDone:()=>ty.void});return new tR(t)},rk=e=>{let t=ty.readWithCause({onInput:r=>rI(e,r,0,r.length,t),onFailure:ty.failCause,onDone:()=>ty.void});return new tR(t)},rI=(e,t,i,n,a)=>i===n?a:(0,f.pipe)(ty.fromEffect(e((0,f.pipe)(t,r.unsafeGet(i)))),ty.flatMap(s=>s?rI(e,t,i+1,n,a):ty.write((0,f.pipe)(t,r.drop(i)))),tI.catchAll(e=>(0,f.pipe)(ty.write((0,f.pipe)(t,r.drop(i))),tI.zipRight(ty.fail(e))))),rT=e=>new tR(e),rx=e=>new tR(ty.fromEffect(e)),rC=e=>ty.readWith({onInput:t=>tI.foldChannel(ty.fromEffect(e(y.some(t))),{onFailure:e=>{let[t,r]=e;return l.match(t,{onLeft:e=>(0,f.pipe)(ty.write(r),tI.zipRight(ty.fail(e))),onRight:e=>(0,f.pipe)(ty.write(r),tI.zipRight(ty.succeedNow(e)))})},onSuccess:()=>rC(e)}),onFailure:ty.fail,onDone:()=>tI.foldChannel(ty.fromEffect(e(y.none())),{onFailure:e=>{let[t,r]=e;return l.match(t,{onLeft:e=>(0,f.pipe)(ty.write(r),tI.zipRight(ty.fail(e))),onRight:e=>(0,f.pipe)(ty.write(r),tI.zipRight(ty.succeedNow(e)))})},onSuccess:()=>ty.fromEffect(o.dieMessage("BUG: Sink.fromPush - please report an issue at https://github.com/Effect-TS/effect/issues"))})}),rR=(e,t)=>t?.shutdown?rZ(o.map(o.acquireRelease(o.succeed(e),E.shutdown),rR)):rw(t=>E.offerAll(e,t)),rF=()=>re(y.none(),y.isNone,(e,t)=>y.match(e,{onNone:()=>y.some(t),onSome:()=>e})),rA=e=>new tR(tI.drain(rJ(e))),rO=()=>rp(y.none(),(e,t)=>y.orElse(r.last(t),()=>e)),r_=(0,f.dual)(2,(e,t)=>new tR((0,f.pipe)(rJ(e),tI.map(t)))),rM=(0,f.dual)(2,(e,t)=>new tR((0,f.pipe)(rJ(e),tI.mapEffect(t)))),rD=(0,f.dual)(2,(e,t)=>new tR((0,f.pipe)(rJ(e),tI.mapError(t)))),rN=(0,f.dual)(2,(e,t)=>new tR((0,f.pipe)(rJ(e),tI.mapOut(r.map(t))))),rP=rx(o.never),rL=(0,f.dual)(2,(e,t)=>new tR((0,f.pipe)(rJ(e),tI.orElse(()=>rJ(t()))))),rU=(0,f.dual)(2,(e,t)=>new tR((0,f.pipe)(rJ(e),ty.provideContext(t)))),rz=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,rW(t),r_(l.merge))),rW=(0,f.dual)(e=>tF(e[1]),(e,t,r)=>rB(e,{other:t,onSelfDone:e=>tT.Done(o.map(e,l.left)),onOtherDone:e=>tT.Done(o.map(e,l.right)),capacity:r?.capacity??16})),rB=(0,f.dual)(2,(e,t)=>rQ(function(r){return o.gen(function*(){let i=yield*v.bounded(t?.capacity??16),n=yield*tk.extend(v.subscribe(i),r),a=yield*tk.extend(v.subscribe(i),r),s=tI.toPubSub(i),o=tI.fromQueue(n).pipe(ty.pipeTo(rJ(e)),tI.zipLeft(ty.fromEffect(E.shutdown(n))),tI.mergeWith({other:tI.fromQueue(a).pipe(ty.pipeTo(rJ(t.other)),tI.zipLeft(ty.fromEffect(E.shutdown(a)))),onSelfDone:t.onSelfDone,onOtherDone:t.onOtherDone}));return new tR(tI.mergeWith(s,{other:o,onSelfDone:()=>tT.Await(f.identity),onOtherDone:e=>tT.Done(e)}))})})),rq=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,r$(t,f.identity))),r$=(0,f.dual)(3,(e,r,i)=>new tR((0,f.pipe)(e,rJ,tI.catchAll(e=>y.match(r(e),{onNone:()=>ty.failCauseSync(()=>t.die(i(e))),onSome:ty.fail}))))),rj=(0,f.dual)(2,(e,t)=>new tR((0,f.pipe)(ty.fromEffect(k.make(r.empty())),ty.flatMap(i=>(0,f.pipe)(rV(!1,i,t),tI.pipeToOrFail(rJ(e)),ty.collectElements,ty.flatMap(e=>{let[t,n]=e;return(0,f.pipe)(ty.fromEffect(k.get(i)),ty.flatMap(e=>(0,f.pipe)(ty.write((0,f.pipe)(e,r.appendAll(r.flatten(t)))),tI.zipRight(ty.succeed(n)))))})))))),rV=(e,t,i)=>ty.readWithCause({onInput:n=>{if(r.isEmpty(n))return rV(e,t,i);if(e){let e=rH(n,i);if(-1===e)return tI.zipRight(ty.write(n),rV(!0,t,i));let[a,s]=r.splitAt(n,e);return tI.zipRight(ty.write(a),ty.fromEffect(k.set(t,s)))}let a=rH(n,i,1);if(-1===a)return tI.zipRight(ty.write(n),rV(!0,t,i));let[s,o]=(0,f.pipe)(n,r.splitAt(Math.max(a,1)));return tI.zipRight(ty.write(s),ty.fromEffect(k.set(t,o)))},onFailure:ty.failCause,onDone:ty.succeed}),rH=function(e,t){let r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=e[Symbol.iterator](),a=0,s=-1;for(;s<0&&(r=n.next())&&!r.done;){let e=r.value;a>=i&&t(e)&&(s=a),a+=1}return s},rG=rp(0,(e,t)=>e+r.reduce(t,0,(e,t)=>e+t)),rK=(0,f.dual)(3,(e,t,r)=>new tR((0,f.pipe)(ty.fromEffect(t),ty.flatMap(i=>(0,f.pipe)(e,rJ,ty.flatMap(e=>(0,f.pipe)(ty.fromEffect(t),tI.map(t=>[e,r(i,t)])))))))),rJ=e=>o.isEffect(e)?rJ(rx(e)):e.channel,rZ=e=>new tR(tI.unwrapScoped(e.pipe(o.map(e=>rJ(e))))),rQ=e=>new tR(tI.unwrapScopedWith(t=>e(t).pipe(o.map(e=>rJ(e))))),rY=e=>(0,f.pipe)(e,rK(i.currentTimeMillis,(e,t)=>s.millis(t-e))),rX=(0,f.dual)(e=>tF(e[1]),(e,t,r)=>r2(e,t,(e,t)=>[e,t],r)),r0=(0,f.dual)(e=>tF(e[1]),(e,t,r)=>r2(e,t,(e,t)=>e,r)),r1=(0,f.dual)(e=>tF(e[1]),(e,t,r)=>r2(e,t,(e,t)=>t,r)),r2=(0,f.dual)(e=>tF(e[1]),(e,t,r,i)=>i?.concurrent?rB(e,{other:t,onSelfDone:c.match({onFailure:e=>tT.Done(o.failCause(e)),onSuccess:e=>tT.Await(c.match({onFailure:o.failCause,onSuccess:t=>o.succeed(r(e,t))}))}),onOtherDone:c.match({onFailure:e=>tT.Done(o.failCause(e)),onSuccess:e=>tT.Await(c.match({onFailure:o.failCause,onSuccess:t=>o.succeed(r(t,e))}))})}):rv(e,e=>r_(t,t=>r(e,t)))),r5=rp(0,(e,t)=>e+t.length),r3=tA(()=>{let e=[];return(0,f.pipe)(rp(void 0,(t,i)=>r.map(i,t=>{e.push(String(t))})),r_(()=>e.join("")))}),r8=(0,f.pipe)(rY(tJ),r_(e=>e[1]));e.s(["SinkTypeId",0,tx,"as",0,tO,"channelToSink",0,e=>new tR(e),"collectAll",0,t_,"collectAllFrom",0,e=>tU(e,{initial:r.empty(),while:f.constTrue,body:(e,t)=>(0,f.pipe)(e,r.append(t))}),"collectAllN",0,tD,"collectAllToMap",0,(e,t)=>rp(tw.empty(),(i,n)=>(0,f.pipe)(n,r.reduce(i,(r,i)=>{let n=e(i),a=(0,f.pipe)(r,tw.has(n))?t((0,f.pipe)(r,tw.unsafeGet(n)),i):i;return(0,f.pipe)(r,tw.set(n,a))}))),"collectAllToMapN",0,(e,t,r)=>rf({initial:tw.empty(),maxCost:e,cost:(e,r)=>+!(0,f.pipe)(e,tw.has(t(r))),body:(e,i)=>{let n=t(i),a=(0,f.pipe)(e,tw.has(n))?r((0,f.pipe)(e,tw.unsafeGet(n)),i):i;return(0,f.pipe)(e,tw.set(n,a))}}),"collectAllToSet",0,()=>rp(th.empty(),(e,t)=>(0,f.pipe)(t,r.reduce(e,(e,t)=>(0,f.pipe)(e,th.add(t))))),"collectAllToSetN",0,e=>rf({initial:th.empty(),maxCost:e,cost:(e,t)=>+!th.has(e,t),body:(e,t)=>th.add(e,t)}),"collectAllUntil",0,e=>(0,f.pipe)(re([r.empty(),!0],e=>e[1],(t,i)=>{let[n,a]=t;return[(0,f.pipe)(n,r.append(i)),!e(i)]}),r_(e=>e[0])),"collectAllUntilEffect",0,e=>(0,f.pipe)(rl([r.empty(),!0],e=>e[1],(t,i)=>{let[n,a]=t;return(0,f.pipe)(e(i),o.map(e=>[(0,f.pipe)(n,r.append(i)),!e]))}),r_(e=>e[0])),"collectAllWhile",0,e=>rT(tP(e,r.empty())),"collectAllWhileEffect",0,e=>rT(tL(e,r.empty())),"collectAllWhileWith",0,tU,"collectLeftover",0,tW,"context",0,t3,"contextWith",0,e=>(0,f.pipe)(t3(),r_(e)),"contextWithEffect",0,e=>(0,f.pipe)(t3(),rM(e)),"contextWithSink",0,e=>new tR(tI.unwrap(o.contextWith(t=>rJ(e(t))))),"count",0,r5,"die",0,e=>t4(t.die(e)),"dieMessage",0,e=>t4(t.die(new t.RuntimeException(e))),"dieSync",0,e=>t6(()=>t.die(e())),"dimap",0,tV,"dimapChunks",0,tG,"dimapChunksEffect",0,tK,"dimapEffect",0,tH,"drain",0,tJ,"drop",0,tZ,"dropUntil",0,e=>new tR((0,f.pipe)(rJ(tX(t=>!e(t))),tI.pipeToOrFail(rJ(tZ(1))))),"dropUntilEffect",0,e=>tA(()=>new tR(tY(e))),"dropWhile",0,tX,"dropWhileEffect",0,e=>tA(()=>new tR(t1(e))),"ensuring",0,t2,"ensuringWith",0,t5,"every",0,e=>re(!0,f.identity,(t,r)=>t&&e(r)),"fail",0,t8,"failCause",0,t4,"failCauseSync",0,t6,"failSync",0,e=>new tR(ty.failSync(e)),"filterInput",0,e=>t=>(0,f.pipe)(t,t$(r.filter(e))),"filterInputEffect",0,t9,"findEffect",0,t7,"flatMap",0,rv,"fold",0,re,"foldChunks",0,rn,"foldChunksEffect",0,rs,"foldEffect",0,rl,"foldLeft",0,(e,t)=>rA(re(e,f.constTrue,t)),"foldLeftChunks",0,rp,"foldLeftChunksEffect",0,(e,t)=>rA(rs(e,f.constTrue,t)),"foldLeftEffect",0,(e,t)=>rl(e,f.constTrue,t),"foldSink",0,ri,"foldUntil",0,(e,t,r)=>(0,f.pipe)(re([e,0],e=>e[1]<t,(e,t)=>{let[i,n]=e;return[r(i,t),n+1]}),r_(e=>e[0])),"foldUntilEffect",0,(e,t,r)=>(0,f.pipe)(rl([e,0],e=>e[1]<t,(e,t)=>{let[i,n]=e;return(0,f.pipe)(r(i,t),o.map(e=>[e,n+1]))}),r_(e=>e[0])),"foldWeighted",0,rf,"foldWeightedDecompose",0,rh,"foldWeightedDecomposeEffect",0,ry,"foldWeightedEffect",0,e=>ry({...e,decompose:e=>o.succeed(r.of(e))}),"forEach",0,rE,"forEachChunk",0,rw,"forEachChunkWhile",0,e=>{let t=ty.readWith({onInput:r=>(0,f.pipe)(ty.fromEffect(e(r)),ty.flatMap(e=>e?t:ty.void)),onFailure:ty.fail,onDone:()=>ty.void});return new tR(t)},"forEachWhile",0,rk,"fromChannel",0,rT,"fromEffect",0,rx,"fromPubSub",0,(e,t)=>rR(e,t),"fromPush",0,e=>new tR(tI.unwrapScoped((0,f.pipe)(e,o.map(rC)))),"fromQueue",0,rR,"head",0,rF,"ignoreLeftover",0,rA,"last",0,rO,"leftover",0,e=>new tR(ty.suspend(()=>ty.write(e))),"map",0,r_,"mapEffect",0,rM,"mapError",0,rD,"mapInput",0,tB,"mapInputChunks",0,t$,"mapInputChunksEffect",0,tj,"mapInputEffect",0,tq,"mapLeftover",0,rN,"mkString",0,r3,"never",0,rP,"orElse",0,rL,"provideContext",0,rU,"race",0,rz,"raceBoth",0,rW,"raceWith",0,rB,"refineOrDie",0,rq,"refineOrDieWith",0,r$,"some",0,e=>re(!1,e=>!e,(t,r)=>t||e(r)),"splitWhere",0,rj,"succeed",0,e=>new tR(ty.succeed(e)),"sum",0,rG,"summarized",0,rK,"suspend",0,tA,"sync",0,e=>new tR(ty.sync(e)),"take",0,e=>(0,f.pipe)(rn(r.empty(),t=>t.length<e,(e,t)=>(0,f.pipe)(e,r.appendAll(t))),rv(t=>{let[i,n]=(0,f.pipe)(t,r.splitAt(e));return new tR((0,f.pipe)(ty.write(n),tI.zipRight(ty.succeedNow(i))))})),"timed",0,r8,"toChannel",0,rJ,"unwrap",0,e=>new tR(tI.unwrap((0,f.pipe)(e,o.map(e=>rJ(e))))),"unwrapScoped",0,rZ,"unwrapScopedWith",0,rQ,"withDuration",0,rY,"zip",0,rX,"zipLeft",0,r0,"zipRight",0,r1,"zipWith",0,r2],7365553);class r4{value;constructor(e){this.value=e}}let r6=(e,t)=>({ref:e,isNew:t,isChanged:!1,expected:e.versioned,newValue:e.versioned.value}),r9=(e,t)=>{e.isChanged=!0,e.newValue=t},r7=e=>{e.ref.versioned=new r4(e.newValue)},ie=e=>({ref:e.ref,isNew:e.isNew,isChanged:e.isChanged,expected:e.expected,newValue:e.newValue}),it=e=>e.ref.versioned!==e.expected,ir=e=>e.isChanged,ii="Invalid",ia="ReadWrite",is=e=>{for(let t of e)r7(t[1])},io=e=>{let t="ReadOnly";for(let[,r]of e)if((t=it(r)?ii:ir(r)?ia:t)===ii)break;return t},il="WithSTMRuntime",iu="OnFailure",ic="OnRetry",id="OnSuccess",ip="Provide",ih="Sync",im="Succeed",ig="Retry",iy="Fail",iS="Interrupt",ib="Fail",iv="Interrupt",iE="Succeed",iw="Retry",ik="Done",iI="Suspend",iT="Done",ix="Interrupted",iC="Running",iR="effect/STM/State",iF=Symbol.for(iR),iA=e=>(0,b.hasProperty)(e,iF),iO=e=>({[iF]:iF,_tag:iT,exit:e,[tm.symbol](){return(0,f.pipe)(tm.hash(iR),tm.combine(tm.hash(iT)),tm.combine(tm.hash(e)),tm.cached(this))},[u.symbol]:t=>iA(t)&&t._tag===iT&&u.equals(e,t.exit)}),i_=(0,f.pipe)(tm.hash(iR),tm.combine(tm.hash(ix)),tm.combine(tm.hash("interrupted"))),iM={[iF]:iF,_tag:ix,[tm.symbol]:()=>i_,[u.symbol]:e=>iA(e)&&e._tag===ix},iD=(0,f.pipe)(tm.hash(iR),tm.combine(tm.hash(iC)),tm.combine(tm.hash("running"))),iN={[iF]:iF,_tag:iC,[tm.symbol]:()=>iD,[u.symbol]:e=>iA(e)&&e._tag===iC},iP=e=>{switch(e._tag){case ib:return iO(c.fail(e.error));case"Die":return iO(c.die(e.defect));case iv:return iO(c.interrupt(e.fiberId));case iE:return iO(c.succeed(e.value));case iw:throw Error("BUG: STM.STMState.fromTExit - please report an issue at https://github.com/Effect-TS/effect/issues")}},iL="effect/TExit",iU=Symbol.for(iL),iz={_A:e=>e,_E:e=>e},iW=e=>(0,b.hasProperty)(e,iU),iB=e=>({[iU]:iz,_tag:ib,error:e,[tm.symbol](){return(0,f.pipe)(tm.hash(iL),tm.combine(tm.hash(ib)),tm.combine(tm.hash(e)),tm.cached(this))},[u.symbol]:t=>iW(t)&&t._tag===ib&&u.equals(e,t.error)}),iq=e=>({[iU]:iz,_tag:"Die",defect:e,[tm.symbol](){return(0,f.pipe)(tm.hash(iL),tm.combine(tm.hash("Die")),tm.combine(tm.hash(e)),tm.cached(this))},[u.symbol]:t=>iW(t)&&"Die"===t._tag&&u.equals(e,t.defect)}),i$=e=>({[iU]:iz,_tag:iv,fiberId:e,[tm.symbol](){return(0,f.pipe)(tm.hash(iL),tm.combine(tm.hash(iv)),tm.combine(tm.hash(e)),tm.cached(this))},[u.symbol]:t=>iW(t)&&t._tag===iv&&u.equals(e,t.fiberId)}),ij=e=>({[iU]:iz,_tag:iE,value:e,[tm.symbol](){return(0,f.pipe)(tm.hash(iL),tm.combine(tm.hash(iE)),tm.combine(tm.hash(e)),tm.cached(this))},[u.symbol]:t=>iW(t)&&t._tag===iE&&u.equals(e,t.value)}),iV=(0,f.pipe)(tm.hash(iL),tm.combine(tm.hash(iw)),tm.combine(tm.hash("retry"))),iH={[iU]:iz,_tag:iw,[tm.symbol]:()=>iV,[u.symbol]:e=>iW(e)&&e._tag===iw},iG=e=>({_tag:iI,journal:e}),iK={ref:0},iJ=Symbol.for("effect/STM"),iZ={_R:e=>e,_E:e=>e,_A:e=>e};class iQ{effect_instruction_i0;_op=tv.OP_COMMIT;effect_instruction_i1=void 0;effect_instruction_i2=void 0;[o.EffectTypeId];[tb.StreamTypeId];[tx];[ty.ChannelTypeId];get[iJ](){return iZ}constructor(e){this.effect_instruction_i0=e,this[o.EffectTypeId]=tb.effectVariance,this[tb.StreamTypeId]=iZ,this[tx]=iZ,this[ty.ChannelTypeId]=iZ}[u.symbol](e){return this===e}[tm.symbol](){return tm.cached(this,tm.random(this))}[Symbol.iterator](){return new tE.SingleShotGen(new tg.YieldWrap(this))}commit(){return iY(this,f.constVoid,f.constVoid)}pipe(){return(0,S.pipeArguments)(this,arguments)}}let iY=(e,t,r)=>(0,tS.withFiberRuntime)(i=>{let n=i.id(),a=i.getFiberRef(p.currentContext),s=i.getFiberRef(p.currentScheduler),l=i.getFiberRef(p.currentSchedulingPriority),u=iX(n,e,a,s,l);switch(u._tag){case ik:return t(u.exit),u.exit;case iI:{let i,u=(i=iK.ref+1,iK.ref=i,i),c={value:iN},d=o.async(t=>i0(n,e,u,c,a,s,l,t));return o.uninterruptibleMask(e=>(0,f.pipe)(e(d),o.catchAllCause(e=>{let i=c.value;return i._tag===iC&&(c.value=iM),(i=c.value)._tag===iT?(t(i.exit),i.exit):(r(),o.failCause(e))})))}}}),iX=(e,r,i,n,a)=>{let s=new Map,o=new i5(r,s,e,i).run(),l=io(s);if(l===ia&&o._tag===iE)is(s);else if(l===ii)throw Error("BUG: STM.TryCommit.tryCommitSync - please report an issue at https://github.com/Effect-TS/effect/issues");switch(o._tag){case iE:return i1(c.succeed(o.value),s,n,a);case ib:{let e=t.fail(o.error);return i1(c.failCause(e),s,n,a)}case"Die":{let e=t.die(o.defect);return i1(c.failCause(e),s,n,a)}case iv:{let r=t.interrupt(e);return i1(c.failCause(r),s,n,a)}case iw:return iG(s)}},i0=(e,r,i,n,a,s,o,l)=>{if(n.value._tag===iC){let u=((e,r,i,n,a,s)=>{let o=new Map,l=new i5(r,o,e,n).run(),u=io(o);if(u===ia)is(o);else if(u===ii)throw Error("BUG: STM.TryCommit.tryCommit - please report an issue at https://github.com/Effect-TS/effect/issues");switch(l._tag){case iE:return i.value=iP(l),i1(c.succeed(l.value),o,a,s);case ib:{i.value=iP(l);let e=t.fail(l.error);return i1(c.failCause(e),o,a,s)}case"Die":{i.value=iP(l);let e=t.die(l.defect);return i1(c.failCause(e),o,a,s)}case iv:{i.value=iP(l);let r=t.interrupt(e);return i1(c.failCause(r),o,a,s)}case iw:return iG(o)}})(e,r,n,a,s,o);switch(u._tag){case ik:i2(u.exit,l);break;case iI:((e,t,r)=>{for(let[,i]of t)i.ref.todos.has(e)||i.ref.todos.set(e,r)})(i,u.journal,()=>i0(e,r,i,n,a,s,o,l))}}},i1=(e,t,r,i)=>{let n=(e=>{let t=new Map;for(let[,r]of e){for(let e of r.ref.todos)t.set(e[0],e[1]);r.ref.todos=new Map}return t})(t);return n.size>0&&r.scheduleTask(()=>(e=>{for(let[t,r]of Array.from(e.entries()).sort((e,t)=>e[0]-t[0]))r()})(n),i),{_tag:ik,exit:e}},i2=(e,t)=>{t(e)};class i5{self;journal;fiberId;contStack=[];env;constructor(e,t,r,i){this.self=e,this.journal=t,this.fiberId=r,this.env=i}getEnv(){return this.env}pushStack(e){this.contStack.push(e)}popStack(){return this.contStack.pop()}nextSuccess(){let e=this.popStack();for(;void 0!==e&&e.effect_instruction_i0!==id;)e=this.popStack();return e}nextFailure(){let e=this.popStack();for(;void 0!==e&&e.effect_instruction_i0!==iu;)e=this.popStack();return e}nextRetry(){let e=this.popStack();for(;void 0!==e&&e.effect_instruction_i0!==ic;)e=this.popStack();return e}run(){let e,r=this.self;for(;void 0===e&&void 0!==r;)try{let i=r;if(i)switch(i._op){case"Tag":r=i9((e,t,r)=>n.unsafeGet(r,i));break;case"Left":r=ne(i.left);break;case"None":r=ne(new t.NoSuchElementException);break;case"Right":r=nu(i.right);break;case"Some":r=nu(i.value);break;case"Commit":switch(i.effect_instruction_i0){case"Die":e=iq((0,tg.internalCall)(()=>i.effect_instruction_i1()));break;case iy:{let t=this.nextFailure();void 0===t?e=iB((0,tg.internalCall)(()=>i.effect_instruction_i1())):r=(0,tg.internalCall)(()=>t.effect_instruction_i2((0,tg.internalCall)(()=>i.effect_instruction_i1())));break}case ig:{let t=this.nextRetry();void 0===t?e=iH:r=(0,tg.internalCall)(()=>t.effect_instruction_i2());break}case iS:e=i$(this.fiberId);break;case il:r=(0,tg.internalCall)(()=>i.effect_instruction_i1(this));break;case id:case iu:case ic:this.pushStack(i),r=i.effect_instruction_i1;break;case ip:{let e=this.env;this.env=(0,tg.internalCall)(()=>i.effect_instruction_i2(e)),r=(0,f.pipe)(i.effect_instruction_i1,i7(nc(()=>this.env=e)));break}case im:{let t=i.effect_instruction_i1,n=this.nextSuccess();void 0===n?e=ij(t):r=(0,tg.internalCall)(()=>n.effect_instruction_i2(t));break}case ih:{let t=(0,tg.internalCall)(()=>i.effect_instruction_i1()),n=this.nextSuccess();void 0===n?e=ij(t):r=(0,tg.internalCall)(()=>n.effect_instruction_i2(t))}}}}catch(e){r=i4(e)}return e}}let i3=(0,f.dual)(2,(e,t)=>{let r=new iQ(iu);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),i8=(0,f.dual)(2,(e,t)=>{let r=new iQ(ip);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),i4=e=>i6(()=>e),i6=e=>{let t=new iQ("Die");return t.effect_instruction_i1=e,t},i9=e=>nn(t=>nu(e(t.journal,t.fiberId,t.getEnv()))),i7=(0,f.dual)(2,(e,t)=>ni(e,{onFailure:e=>nd(t,ne(e)),onSuccess:e=>nd(t,nu(e))})),ne=e=>nt(()=>e),nt=e=>{let t=new iQ(iy);return t.effect_instruction_i1=e,t},nr=(0,f.dual)(2,(e,t)=>{let r=new iQ(id);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),ni=(0,f.dual)(2,(e,t)=>{let{onFailure:r,onSuccess:i}=t;return(0,f.pipe)(e,ns(l.right),i3(e=>(0,f.pipe)(r(e),ns(l.left))),nr(e=>{switch(e._tag){case"Left":return nu(e.left);case"Right":return i(e.right)}}))}),nn=e=>{let t=new iQ(il);return t.effect_instruction_i1=e,t},na=e=>{let t=new iQ(iS);return t.effect_instruction_i1=e,t},ns=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,nr(e=>nc(()=>t(e))))),no=(0,f.dual)(2,(e,t)=>{let r=new iQ(ic);return r.effect_instruction_i1=e,r.effect_instruction_i2=t,r}),nl=new iQ(ig),nu=e=>{let t=new iQ(im);return t.effect_instruction_i1=e,t},nc=e=>{let t=new iQ(ih);return t.effect_instruction_i1=e,t},nd=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,nr(()=>t))),np=(0,f.dual)(3,(e,t,r)=>(0,f.pipe)(e,nr(e=>(0,f.pipe)(t,ns(t=>r(e,t)))))),nf=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,ns(()=>t))),nh=((e,t)=>ni(e,{onFailure:ne,onSuccess:e=>{let r=t(e);return y.isSome(r)?r.value:nl}}),(0,f.dual)(2,(e,t)=>{let{onFailure:r,onSuccess:i}=t;return ni(e,{onFailure:e=>nu(r(e)),onSuccess:e=>nu(i(e))})})),nm=(0,f.dual)(e=>b.isIterable(e[0]),(e,t,r)=>r?.discard?(0,f.pipe)(nc(()=>e[Symbol.iterator]()),nr(e=>{let r=ny(()=>{let i=e.next();return i.done?nb:(0,f.pipe)(t(i.value),nr(()=>r))});return r})):ny(()=>tf.fromIterable(e).reduce((e,r)=>np(e,t(r),(e,t)=>(e.push(t),e)),nu([])))),ng=((e,t)=>ni(e,{onFailure:e=>ne(t(e)),onSuccess:nu}),(0,f.dual)(2,(e,t)=>i8(e,e=>t))),ny=((e,t,r)=>{let i;return i=i=>nr(r,r=>ng(e,n.add(i,t,r))),nr(i9((e,t,r)=>r),i)},e=>nr(nc(e),f.identity)),nS=(0,f.dual)(2,(e,t)=>nr(e,e=>nf(t(e),e))),nb=nu(void 0),nv=Symbol.for("effect/TRef"),nE={_A:e=>e};class nw{[nv]=nE;todos;versioned;constructor(e){this.versioned=new r4(e),this.todos=new Map}modify(e){return i9(t=>{let r=nT(this,t),[i,n]=e(r.newValue);return r9(r,n),i})}pipe(){return(0,S.pipeArguments)(this,arguments)}}let nk=e=>e.modify(e=>[e,e]),nI=(0,f.dual)(2,(e,t)=>e.modify(()=>[void 0,t])),nT=(e,t)=>{if(t.has(e))return t.get(e);let r=r6(e,!1);return t.set(e,r),r},nx=(0,f.dual)(2,(e,t)=>nT(e,t).newValue),nC=(0,f.dual)(3,(e,t,r)=>{r9(nT(e,r),t)}),nR=Symbol.for("effect/TQueue/TDequeue"),nF={_Out:e=>e},nA=((e,t,i)=>ny(()=>{let n=(t,i,a)=>i<t?nu(a):(0,f.pipe)(e.takeUpTo(i),nr(s=>{let o=t-s.length;return 1===o?(0,f.pipe)(e.take,ns(e=>(0,f.pipe)(a,r.appendAll(r.unsafeFromArray(s)),r.append(e)))):o>1?(0,f.pipe)(e.take,nr(e=>n(o-1,i-s.length-1,(0,f.pipe)(a,r.appendAll(r.unsafeFromArray(s)),r.append(e))))):nu((0,f.pipe)(a,r.appendAll(r.unsafeFromArray(s))))}));return ns(n(t,i,r.empty()),e=>Array.from(e))}),Symbol.for("effect/TPubSub")),nO=Symbol.for("effect/TPubSub/AbsentValue"),n_=(e,t,r)=>({head:e,subscribers:t,tail:r});class nM{pubsubSize;publisherHead;requestedCapacity;subscriberHead;subscriberCount;subscribers;[nA]=nA;[nR]=nF;constructor(e,t,r,i,n,a){this.pubsubSize=e,this.publisherHead=t,this.requestedCapacity=r,this.subscriberHead=i,this.subscriberCount=n,this.subscribers=a}isShutdown=i9(e=>void 0===nx(this.subscriberHead,e));awaitShutdown=nr(this.isShutdown,e=>e?nb:nl);capacity(){return this.requestedCapacity}size=nn(e=>{let t=nx(this.subscriberHead,e.journal);if(void 0===t)return na(e.fiberId);let r=!0,i=0;for(;r;){let n=nx(t,e.journal);void 0===n?r=!1:(n.head!==nO&&(i+=1)>=Number.MAX_SAFE_INTEGER&&(r=!1),t=n.tail)}return nu(i)});isEmpty=ns(this.size,e=>0===e);isFull=ns(this.size,e=>e===this.capacity());peek=nn(e=>{let t=nx(this.subscriberHead,e.journal);if(void 0===t)return na(e.fiberId);let r=nO,i=!0;for(;i;){let n=nx(t,e.journal);if(void 0===n)return nl;let a=n.head,s=n.tail;a!==nO?(r=a,i=!1):t=s}return nu(r)});peekOption=nn(e=>{let t=nx(this.subscriberHead,e.journal);if(void 0===t)return na(e.fiberId);let r=y.none(),i=!0;for(;i;){let n=nx(t,e.journal);if(void 0===n)r=y.none(),i=!1;else{let e=n.head,a=n.tail;e!==nO?(r=y.some(e),i=!1):t=a}}return nu(r)});shutdown=i9(e=>{let t=nx(this.subscriberHead,e);if(void 0!==t){nC(this.subscriberHead,void 0,e);let r=!0;for(;r;){let i=nx(t,e);if(void 0===i)r=!1;else{let r=i.head,n=i.tail;if(r!==nO){let a=i.subscribers;if(1===a){let r=nx(this.pubsubSize,e);nC(t,n_(nO,0,n),e),nC(this.publisherHead,n,e),nC(this.pubsubSize,r-1,e)}else nC(t,n_(r,a-1,n),e)}t=n}}let i=nx(this.subscriberCount,e);nC(this.subscriberCount,i-1,e),nC(this.subscribers,th.remove(nx(this.subscribers,e),this.subscriberHead),e)}});take=nn(e=>{let t=nx(this.subscriberHead,e.journal);if(void 0===t)return na(e.fiberId);let r=nO,i=!0;for(;i;){let n=nx(t,e.journal);if(void 0===n)return nl;let a=n.head,s=n.tail;if(a!==nO){let o=n.subscribers;if(1===o){let r=nx(this.pubsubSize,e.journal);nC(t,n_(nO,0,s),e.journal),nC(this.publisherHead,s,e.journal),nC(this.pubsubSize,r-1,e.journal)}else nC(t,n_(a,o-1,s),e.journal);nC(this.subscriberHead,s,e.journal),r=a,i=!1}else t=s}return nu(r)});takeAll=this.takeUpTo(1/0);takeUpTo(e){return nn(t=>{let r=nx(this.subscriberHead,t.journal);if(void 0===r)return na(t.fiberId);let i=[],n=0;for(;n!==e;){let a=nx(r,t.journal);if(void 0===a)n=e;else{let e=a.head,s=a.tail;if(e!==nO){let o=a.subscribers;if(1===o){let e=nx(this.pubsubSize,t.journal);nC(r,n_(nO,0,s),t.journal),nC(this.publisherHead,s,t.journal),nC(this.pubsubSize,e-1,t.journal)}else nC(r,n_(e,o-1,s),t.journal);i.push(e),n+=1}r=s}}return nC(this.subscriberHead,r,t.journal),nu(i)})}}var nD=e.i(9966047),nN=e.i(6379322),nP=e.i(7237733),nL=e.i(5246317);class nU{capacity;array;size=0;current=0;constructor(e){this.capacity=e,this.array=Array.from({length:e},f.constUndefined)}head(){return y.fromNullable(this.array[this.current])}lastOrNull(){if(0===this.size)return;let e=0===this.current?this.array.length-1:this.current-1;return this.array[e]??void 0}put(e){this.array[this.current]=e,this.increment()}dropLast(){this.size>0&&(this.decrement(),this.array[this.current]=void 0)}toChunk(){let e=this.current-this.size,t=e<0?[...this.array.slice(this.capacity+e,this.capacity),...this.array.slice(0,this.current)]:this.array.slice(e,this.current);return r.fromIterable(t)}increment(){this.size<this.capacity&&(this.size+=1),this.current=(this.current+1)%this.capacity}decrement(){this.size-=1,this.current>0?this.current-=1:this.current=this.capacity-1}}let nz="NotStarted",nW="Previous",nB="Current",nq={_tag:nz},n$=e=>Object.assign(e,{chunk(e){return this(o.succeed(e))},die(e){return this(o.die(e))},dieMessage(e){return this(o.dieMessage(e))},done(e){return this(o.suspend(()=>c.mapBoth(e,{onFailure:y.some,onSuccess:r.of})))},end(){return this(o.fail(y.none()))},fail(e){return this(o.fail(y.some(e)))},fromEffect(e){return this(o.mapBoth(e,{onFailure:y.some,onSuccess:r.of}))},fromEffectChunk(e){return this((0,f.pipe)(e,o.mapError(y.some)))},halt(e){return this(o.failCause((0,f.pipe)(e,t.map(y.some))))},single(e){return this(o.succeed(r.of(e)))}}),nj=Symbol.for("effect/Stream/Handoff"),nV="Empty",nH="Full",nG=e=>({_tag:nV,notifyConsumer:e}),nK=(e,t)=>r=>{switch(r._tag){case nV:return e(r.notifyConsumer);case nH:return t(r.value,r.notifyProducer)}},nJ={_A:e=>e},nZ=()=>(0,f.pipe)(a.make(),o.flatMap(e=>k.make(nG(e))),o.map(e=>({[nj]:nJ,ref:e}))),nQ=(0,f.dual)(2,(e,t)=>o.flatMap(a.make(),r=>o.flatten(k.modify(e.ref,i=>(0,f.pipe)(i,nK(e=>[o.zipRight(a.succeed(e,void 0),a.await(r)),{_tag:nH,value:t,notifyProducer:r}],(r,n)=>[o.flatMap(a.await(n),()=>(0,f.pipe)(e,nQ(t))),i])))))),nY=e=>o.flatMap(a.make(),t=>o.flatten(k.modify(e.ref,r=>(0,f.pipe)(r,nK(t=>[o.flatMap(a.await(t),()=>nY(e)),r],(e,r)=>[o.as(a.succeed(r,void 0),e),nG(t)]))))),nX="Emit",n0="Halt",n1=e=>({_tag:nX,elements:e}),n2=e=>({_tag:n0,cause:e}),n5=e=>({_tag:"End",reason:e}),n3=Symbol.for("effect/Take"),n8={_A:e=>e,_E:e=>e};class n4{exit;[n3]=n8;constructor(e){this.exit=e}pipe(){return(0,S.pipeArguments)(this,arguments)}}let n6=e=>new n4(c.succeed(e)),n9=e=>o.suspend(()=>e.exit),n7=new n4(c.fail(y.none())),ae=e=>new n4(c.failCause((0,f.pipe)(e,t.map(y.some)))),at=e=>o.matchCause(e,{onFailure:e=>y.match(t.flipCauseOption(e),{onNone:()=>n7,onSome:ae}),onSuccess:n6}),ar=(0,f.dual)(2,(e,r)=>{let{onEnd:i,onFailure:n,onSuccess:a}=r;return c.match(e.exit,{onFailure:e=>y.match(t.flipCauseOption(e),{onNone:i,onSome:n}),onSuccess:a})}),ai=e=>new n4(c.succeed(r.of(e)));e.s(["TakeImpl",0,n4,"chunk",0,n6,"done",0,n9,"end",0,n7,"failCause",0,ae,"fromPull",0,at,"match",0,ar,"of",0,ai],5806407);let an=()=>o.fail(y.none()),aa=e=>o.mapError(o.failCause(e),y.some),as="ScheduleEnd",ao="UpstreamEnd",al={_tag:as},au={_tag:ao},ac="DrainLeft",ad="DrainRight",ap="PullBoth",af="PullLeft",ah="PullRight",am={_tag:ac},ag={_tag:ad},ay={_tag:ap},aS=e=>({_tag:af,rightChunk:e}),ab=e=>({_tag:ah,leftChunk:e}),av="PullBoth",aE="PullLet",aw="PullRight",ak={_tag:av},aI=e=>({_tag:aE,rightChunk:e}),aT=e=>({_tag:aw,leftChunk:e});var ax=e.i(3427637);let aC=Symbol.for("effect/Stream"),aR={_R:e=>e,_E:e=>e,_A:e=>e};class aF{channel;[aC]=aR;constructor(e){this.channel=e}pipe(){return(0,S.pipeArguments)(this,arguments)}}let aA=e=>(0,b.hasProperty)(e,aC)||o.isEffect(e),aO=e=>{let t=e=>ty.readWith({onInput:i=>{let n=r.appendAll(e,i);return ty.flatMap(ty.write(n),()=>t(n))},onFailure:ty.fail,onDone:()=>ty.void});return new aF(ty.pipeTo(sJ(e),t(r.empty())))},a_=(e,t)=>lV(o.acquireRelease(e,t)),aM=(0,f.dual)(2,(e,t)=>aD(e,t,ey)),aD=(0,f.dual)(3,(e,t,r)=>sM(aN(e,t,r),e=>l.match(e,{onLeft:y.none,onRight:y.some}))),aN=(0,f.dual)(3,(e,i,n)=>sY(o.all([nZ(),k.make(al),k.make(r.empty()),el(n),k.make(!1),k.make(!1)])).pipe(sz(n=>{let[a,s,u,c,p,h]=n,m=ty.readWithCause({onInput:e=>ty.flatMap(ty.fromEffect((0,f.pipe)(a,nQ(n1(e)),o.when(()=>r.isNonEmpty(e)))),()=>m),onFailure:e=>ty.fromEffect(nQ(a,n2(e))),onDone:()=>ty.fromEffect(nQ(a,n5(au)))}),g=(0,f.pipe)(k.getAndSet(u,r.empty()),o.flatMap(e=>r.isNonEmpty(e)?(0,f.pipe)(k.set(p,!0),o.zipRight(o.succeed((0,f.pipe)(ty.write(e),ty.flatMap(()=>g))))):(0,f.pipe)(nY(a),o.map(e=>{switch(e._tag){case nX:return(0,f.pipe)(ty.fromEffect(k.set(p,!0)),tI.zipRight(ty.write(e.elements)),tI.zipRight(ty.fromEffect(k.get(h))),ty.flatMap(e=>e?ty.void:g));case n0:return ty.failCause(e.cause);case"End":if(e.reason._tag===as)return(0,f.pipe)(k.get(p),o.map(e=>e?ty.fromEffect((0,f.pipe)(k.set(s,al),o.zipRight(k.set(h,!0)))):(0,f.pipe)(ty.fromEffect((0,f.pipe)(k.set(s,al),o.zipRight(k.set(h,!0)))),ty.flatMap(()=>g))),tI.unwrap);return(0,f.pipe)(k.set(s,e.reason),o.zipRight(k.set(h,!0)),ty.fromEffect)}}))),tI.unwrap),S=(e,n,m)=>{let b=(0,f.pipe)(k.set(p,!1),o.zipRight(k.set(h,!1)),o.zipRight((0,f.pipe)(g,tI.pipeToOrFail(rJ(i)),ty.collectElements,tI.run,o.forkIn(m)))),v=(e,t,i)=>(0,f.pipe)(k.set(u,r.flatten(e)),o.zipRight(o.map(k.get(s),e=>{switch(e._tag){case as:let n;return(0,f.pipe)(o.all([k.get(p),b,(0,f.pipe)((n=y.some(t),c.next(n)),o.forkIn(m))]),o.map(e=>{let[n,a,s]=e,o=(0,f.pipe)(i,y.match({onNone:()=>r.of(l.right(t)),onSome:e=>r.make(l.right(t),l.left(e))}));return n?(0,f.pipe)(ty.write(o),ty.flatMap(()=>S(a,s,m))):S(a,s,m)}),tI.unwrap);case ao:return(0,f.pipe)(k.get(p),o.map(e=>e?ty.write(r.of(l.right(t))):ty.void),tI.unwrap)}})),tI.unwrap);return tI.unwrap(o.raceWith(d.join(e),d.join(n),{onSelfDone:(e,t)=>(0,f.pipe)(d.interrupt(n),o.zipRight((0,f.pipe)(o.suspend(()=>e),o.map(e=>{let[t,r]=e;return v(t,r,y.none())})))),onOtherDone:(r,i)=>o.matchCauseEffect(o.suspend(()=>r),{onFailure:r=>l.match(t.failureOrCause(r),{onLeft:()=>(0,f.pipe)(a,nQ(n5(al)),o.forkDaemon,o.zipRight((0,f.pipe)(d.join(e),o.map(e=>{let[t,r]=e;return v(t,r,y.none())})))),onRight:t=>(0,f.pipe)(a,nQ(n2(t)),o.forkDaemon,o.zipRight((0,f.pipe)(d.join(e),o.map(e=>{let[t,r]=e;return v(t,r,y.none())}))))}),onSuccess:t=>(0,f.pipe)(a,nQ(n5(al)),o.forkDaemon,o.zipRight((0,f.pipe)(d.join(e),o.map(e=>{let[r,i]=e;return v(r,i,y.some(t))}))))})}))};return uC(t=>ty.pipeTo(sJ(e),m).pipe(tI.run,o.forkIn(t),o.zipRight(tI.pipeToOrFail(g,rJ(i)).pipe(ty.collectElements,tI.run,o.forkIn(t),o.flatMap(e=>{let r;return(r=y.none(),c.next(r)).pipe(o.forkIn(t),o.map(r=>new aF(S(e,r,t))))})))))}))),aP=(0,f.dual)(2,(e,t)=>op(e,()=>t)),aL=e=>{if("unbounded"===e)return E.unbounded();if("number"==typeof e||void 0===e)return E.bounded(e??16);switch(e.strategy){case"dropping":return E.dropping(e.bufferSize??16);case"sliding":return E.sliding(e.bufferSize??16);default:return E.bounded(e.bufferSize??16)}},aU=(e,t)=>o.acquireRelease(t?.bufferSize==="unbounded"||t?.bufferSize===void 0&&t?.strategy===void 0?E.unbounded():t?.strategy==="sliding"?E.sliding(t.bufferSize??16):E.dropping(t?.bufferSize??16),E.shutdown).pipe(o.tap(t=>p.getWith(p.currentScheduler,i=>e(((e,t)=>{let i=!1,n=[],a=!1;function s(e){if(i)return!1;if(e.length<=5e4)n.push.apply(n,e);else for(let t=0;t<e.length;t++)n.push(e[0]);return a||(a=!0,t.scheduleTask(o,0)),!0}function o(){a=!1,n.length>0&&(e.unsafeOffer(n),n=[])}function l(t){i||(i=!0,"Success"===t._tag&&n.push(t.value),o(),e.unsafeOffer("Success"===t._tag?c.void:t))}return{single:e=>!i&&(n.push(e),a||(a=!0,t.scheduleTask(o,0)),!0),array:s,chunk:e=>s(r.toReadonlyArray(e)),done:l,end(){i||(i=!0,o(),e.unsafeOffer(c.void))},halt:e=>l(c.failCause(e)),fail:e=>l(c.fail(e)),die:e=>l(c.die(e)),dieMessage:e=>l(c.die(Error(e)))}})(t,i)))),o.map(e=>{let t=ty.flatMap(E.take(e),e=>c.isExit(e)?c.isSuccess(e)?ty.void:ty.failCause(e.cause):tI.zipRight(ty.write(r.unsafeFromArray(e)),t));return t}),tI.unwrapScoped,sK),az=(0,f.dual)(3,(e,t,i)=>l1(()=>{let n=e=>ty.readWith({onInput:i=>{if(e.length+i.length>=t){let[n,s]=(0,f.pipe)(i,r.splitAt(t-e.length));return a((0,f.pipe)(e,r.appendAll(n)),s)}return n((0,f.pipe)(e,r.appendAll(i)))},onFailure:ty.fail,onDone:()=>a(e,r.empty())}),a=(e,t)=>ty.pipeTo(tI.zipRight(ty.write(t),tI.identityChannel()),sJ(i(e)));return new aF((0,f.pipe)(sJ(e),tI.pipeToOrFail(n(r.empty()))))})),aW=(0,f.dual)(3,(e,t,r)=>(0,f.pipe)(e,a$(t,r),o.map(e=>e.map(e=>sH(s3(e,{shutdown:!0})))))),aB=(0,f.dual)(2,(e,t)=>o.map(ud(e,t),e=>sH(s0(e)))),aq=(0,f.dual)(2,(e,t)=>o.map(w.make({acquire:aB(e,t),idleTimeToLive:t.idleTimeToLive}),e=>ux(w.get(e)))),a$=(0,f.dual)(3,(e,t,r)=>o.flatMap(uc(r),r=>(0,f.pipe)(o.all(Array.from({length:t},()=>v.subscribe(r))),o.tap(()=>o.forkScoped(lD(e,r)))))),aj=(0,f.dual)(2,(e,t)=>o.map(ud(e,t),v.subscribe)),aV=(0,f.dual)(2,(e,i)=>{if("unbounded"===i.capacity)return aQ(e);if("dropping"===i.strategy)return aJ(e,i.capacity);if("sliding"===i.strategy)return aZ(e,i.capacity);let n=uh(e,i);return new aF(tI.unwrapScoped(o.map(n,e=>{let i=(0,f.pipe)(ty.fromEffect(E.take(e)),ty.flatMap(c.match({onFailure:e=>(0,f.pipe)(t.flipCauseOption(e),y.match({onNone:()=>ty.void,onSome:ty.failCause})),onSuccess:e=>ty.flatMap(ty.write(r.of(e)),()=>i)})));return i})))}),aH=(0,f.dual)(2,(e,t)=>{if("dropping"===t.strategy)return aG(e,t.capacity);if("sliding"===t.strategy)return aK(e,t.capacity);let r=uf(e,t);return new aF(tI.unwrapScoped(o.map(r,e=>{let t=(0,f.pipe)(ty.fromEffect(E.take(e)),ty.flatMap(ar({onEnd:()=>ty.void,onFailure:ty.failCause,onSuccess:e=>(0,f.pipe)(ty.write(e),ty.flatMap(()=>t))})));return t})))}),aG=(0,f.dual)(2,(e,t)=>new aF(aY(o.acquireRelease(E.dropping(t),e=>E.shutdown(e)),sJ(e)))),aK=(0,f.dual)(2,(e,t)=>new aF(aY(o.acquireRelease(E.sliding(t),e=>E.shutdown(e)),sJ(e)))),aJ=(0,f.dual)(2,(e,t)=>new aF(aY(o.acquireRelease(E.dropping(t),e=>E.shutdown(e)),sJ(lr(1)(e))))),aZ=(0,f.dual)(2,(e,t)=>new aF(aY(o.acquireRelease(E.sliding(t),e=>E.shutdown(e)),sJ((0,f.pipe)(e,lr(1)))))),aQ=e=>{let t=uf(e,{strategy:"unbounded"});return new aF(tI.unwrapScoped(o.map(t,e=>{let t=(0,f.pipe)(ty.fromEffect(E.take(e)),ty.flatMap(ar({onEnd:()=>ty.void,onFailure:ty.failCause,onSuccess:e=>ty.flatMap(ty.write(e),()=>t)})));return t})))},aY=(e,t)=>{let r=(e,t)=>{let i=r=>(0,f.pipe)(k.get(t),o.tap(a.await),o.zipRight(a.make()),o.flatMap(i=>(0,f.pipe)(E.offer(e,[r,i]),o.zipRight(k.set(t,i)),o.zipRight(a.await(i)))),o.asVoid,ty.fromEffect);return ty.readWithCause({onInput:i=>(0,f.pipe)(a.make(),o.flatMap(r=>(0,f.pipe)(E.offer(e,[n6(i),r]),o.flatMap(e=>(0,f.pipe)(k.set(t,r),o.when(()=>e))))),o.asVoid,ty.fromEffect,ty.flatMap(()=>r(e,t))),onFailure:e=>i(ae(e)),onDone:()=>i(n7)})};return tI.unwrapScoped((0,f.pipe)(e,o.flatMap(e=>(0,f.pipe)(a.make(),o.tap(e=>a.succeed(e,void 0)),o.flatMap(i=>{let n;return(0,f.pipe)(k.make(i),o.flatMap(i=>(0,f.pipe)(t,ty.pipeTo(r(e,i)),tI.runScoped,o.forkScoped)),o.as(n=(0,f.pipe)(ty.fromEffect(E.take(e)),ty.flatMap(e=>{let[t,r]=e;return tI.zipRight(ty.fromEffect(a.succeed(r,void 0)),ar(t,{onEnd:()=>ty.void,onFailure:ty.failCause,onSuccess:e=>(0,f.pipe)(ty.write(e),ty.flatMap(()=>n))}))}))))})))))},aX=(0,f.dual)(2,(e,r)=>a0(e,e=>l.match(t.failureOrCause(e),{onLeft:r,onRight:sA}))),a0=(0,f.dual)(2,(e,t)=>new aF((0,f.pipe)(sJ(e),ty.catchAllCause(e=>sJ(t(e)))))),a1=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,aX(e=>(0,f.pipe)(t(e),y.getOrElse(()=>sR(e)))))),a2=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,a0(e=>(0,f.pipe)(t(e),y.getOrElse(()=>sA(e)))))),a5=(0,f.dual)(3,(e,t,r)=>aX(e,e=>"_tag"in e&&e._tag===t?r(e):sR(e))),a3=(0,f.dual)(2,(e,t)=>aX(e,e=>{let r=Object.keys(t);return"_tag"in e&&r.includes(e._tag)?t[e._tag](e):sR(e)})),a8=(0,f.dual)(2,(e,t)=>{let i=e=>ty.readWithCause({onInput:n=>{let[a,s]=r.reduce(n,[e,r.empty()],(e,i)=>{let[n,a]=e;return y.isSome(n)&&t(n.value,i)?[y.some(i),a]:[y.some(i),(0,f.pipe)(a,r.append(i))]});return ty.flatMap(ty.write(s),()=>i(a))},onFailure:ty.failCause,onDone:()=>ty.void});return new aF((0,f.pipe)(sJ(e),ty.pipeTo(i(y.none()))))}),a4=(0,f.dual)(2,(e,t)=>{let i=e=>ty.readWithCause({onInput:n=>(0,f.pipe)(n,o.reduce([e,r.empty()],(e,i)=>{let[n,a]=e;return y.isSome(n)?(0,f.pipe)(t(n.value,i),o.map(e=>e?[y.some(i),a]:[y.some(i),(0,f.pipe)(a,r.append(i))])):o.succeed([y.some(i),(0,f.pipe)(a,r.append(i))])}),ty.fromEffect,ty.flatMap(e=>{let[t,r]=e;return(0,f.pipe)(ty.write(r),ty.flatMap(()=>i(t)))})),onFailure:ty.failCause,onDone:()=>ty.void});return new aF((0,f.pipe)(sJ(e),ty.pipeTo(i(y.none()))))}),a6=e=>(0,f.pipe)(e,og(r.of)),a9=(0,f.dual)(2,(e,t)=>s$(t(a6(e)))),a7=e=>o.catchAll(o.asSome(e),e=>"None"===e._tag?o.succeedNone:o.fail(e.value)),se=(0,f.dual)(4,(e,r,i,n)=>{function a(e,r){return ty.fromEffect(nY(r)).pipe(tI.zipRight(ty.readWithCause({onInput:t=>ty.flatMap(ty.fromEffect(nQ(e,c.succeed(t))),()=>a(e,r)),onFailure:r=>ty.fromEffect(nQ(e,c.failCause((0,f.pipe)(r,t.map(y.some))))),onDone:()=>ty.flatMap(ty.fromEffect(nQ(e,c.fail(y.none()))),()=>a(e,r))})))}return new aF(tI.unwrapScopedWith(t=>o.all([nZ(),nZ(),nZ(),nZ()]).pipe(o.tap(r=>{let[i,n,s]=r;return sJ(e).pipe(tI.concatMap(tI.writeChunk),ty.pipeTo(a(i,s)),nN.runIn(t),o.forkIn(t))}),o.tap(e=>{let[,i,n,s]=e;return sJ(r).pipe(tI.concatMap(tI.writeChunk),ty.pipeTo(a(i,s)),nN.runIn(t),o.forkIn(t))}),o.map(e=>{let[t,r,a,s]=e,l=nQ(a,void 0).pipe(o.zipRight(nY(t).pipe(o.flatMap(f.identity)))),u=nQ(s,void 0).pipe(o.zipRight(nY(r).pipe(o.flatMap(f.identity))));return sJ(uk(i,e=>o.flatMap(n(e,l,u),a7)))}))))}),st=(0,f.dual)(4,(e,t,r,i)=>{let n=(e,t)=>tI.zipRight(ty.fromEffect(nY(t)),ty.readWithCause({onInput:r=>ty.flatMap(ty.fromEffect((0,f.pipe)(e,nQ(n6(r)))),()=>n(e,t)),onFailure:t=>ty.fromEffect(nQ(e,ae(t))),onDone:()=>ty.fromEffect(nQ(e,n7))}));return new aF(tI.unwrapScopedWith(a=>o.all([nZ(),nZ(),nZ(),nZ()]).pipe(o.tap(t=>{let[r,i,s]=t;return ty.pipeTo(sJ(e),n(r,s)).pipe(nN.runIn(a),o.forkIn(a))}),o.tap(e=>{let[r,i,s,l]=e;return ty.pipeTo(sJ(t),n(i,l)).pipe(nN.runIn(a),o.forkIn(a))}),o.map(e=>{let[t,n,a,s]=e,l=nQ(a,void 0).pipe(o.zipRight(nY(t).pipe(o.flatMap(n9)))),u=nQ(s,void 0).pipe(o.zipRight(nY(n).pipe(o.flatMap(n9))));return sJ(uw(r,e=>o.flatMap(i(e,l,u),a7)))}))))}),sr=(0,f.dual)(2,(e,t)=>new aF((0,f.pipe)(sJ(e),tI.zipRight(sJ(t))))),si=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,ss(t,(e,t)=>[e,t]))),sn=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,ss(t,(e,t)=>e))),sa=(0,f.dual)(2,(e,t)=>sz(e,()=>t)),ss=(0,f.dual)(3,(e,t,r)=>(0,f.pipe)(e,sz(e=>(0,f.pipe)(t,op(t=>r(e,t)))))),so=(0,f.dual)(2,(e,t)=>uC(n=>o.gen(function*(){let a=yield*nZ();function s(e){return i.sleep(t).pipe(o.as(e),o.forkIn(n),o.map(e=>u({_tag:nW,fiber:e})))}let l=ty.readWithCause({onInput:e=>y.match(r.last(e),{onNone:()=>l,onSome:e=>ty.fromEffect(nQ(a,n1(r.of(e)))).pipe(ty.flatMap(()=>l))}),onFailure:e=>ty.fromEffect(nQ(a,n2(e))),onDone:()=>ty.fromEffect(nQ(a,n5(au)))});function u(e){switch(e._tag){case nz:return tI.unwrap(nY(a).pipe(o.map(e=>{switch(e._tag){case nX:return tI.unwrap(s(e.elements));case n0:return ty.failCause(e.cause);case"End":return ty.void}})));case nW:return tI.unwrap(nY(a).pipe(o.forkIn(n),o.flatMap(t=>o.raceWith(d.join(e.fiber),d.join(t),{onSelfDone:(e,r)=>c.match(e,{onFailure:e=>d.interrupt(r).pipe(o.as(ty.failCause(e))),onSuccess:e=>d.interrupt(r).pipe(o.zipRight(o.succeed(ty.write(e).pipe(ty.flatMap(()=>u({_tag:nB,fiber:t}))))))}),onOtherDone:(e,t)=>c.match(e,{onFailure:e=>d.interrupt(t).pipe(o.as(ty.failCause(e))),onSuccess:e=>{switch(e._tag){case nX:return d.interrupt(t).pipe(o.zipRight(s(e.elements)));case n0:return d.interrupt(t).pipe(o.as(ty.failCause(e.cause)));case"End":return d.join(t).pipe(o.map(e=>ty.write(e).pipe(tI.zipRight(ty.void))))}}})}))));case nB:return tI.unwrap(d.join(e.fiber).pipe(o.map(e=>{switch(e._tag){case nX:return tI.unwrap(s(e.elements));case n0:return ty.failCause(e.cause);case"End":return ty.void}})))}}return lH(t=>ty.pipeTo(sJ(e),l).pipe(nN.runIn(t),o.forkIn(t))).pipe(sa(new aF(u(nq))))}))),sl=e=>sY(o.die(e)),su=(0,f.dual)(2,(e,t)=>(0,f.pipe)(a.make(),o.flatMap(i=>(0,f.pipe)(e,sp({maximumLag:t.maximumLag,decide:e=>o.flatMap(a.await(i),t=>t(e))}),o.flatMap(e=>(0,f.pipe)(o.all(r.map(r.range(0,t.size-1),t=>o.map(e,e=>{let[r,i]=e;return[[r,t],i]}))),o.map(r.unsafeFromArray),o.flatMap(e=>{let[n,s]=r.reduceRight(e,[new Map,r.empty()],(e,t)=>{let[i,n]=e,[a,s]=t;return[i.set(a[0],a[1]),(0,f.pipe)(n,r.prepend(s))]});return(0,f.pipe)(a.succeed(i,e=>o.map(t.decide(e),e=>t=>e(n.get(t)))),o.as(Array.from(s)))}))))))),sc={ref:0},sd=()=>{let e=sc.ref;return sc.ref=e+1,e},sp=(0,f.dual)(2,(e,t)=>sf(e,t.maximumLag,t.decide,()=>o.void)),sf=(0,f.dual)(4,(e,i,n,a)=>(0,f.pipe)(o.acquireRelease(k.make(new Map),(e,t)=>(0,f.pipe)(k.get(e),o.flatMap(e=>(0,f.pipe)(e.values(),o.forEach(E.shutdown))))),o.flatMap(s=>o.gen(function*(){let l=yield*o.makeSemaphore(1),u=yield*k.make((0,f.pipe)(E.bounded(i),o.flatMap(e=>{let t=sd();return(0,f.pipe)(k.update(s,r=>r.set(t,e)),o.as([t,e]))}))),d=e=>l.withPermits(1)((0,f.pipe)(k.set(u,(0,f.pipe)(E.bounded(1),o.tap(t=>E.offer(t,e)),o.flatMap(e=>{let t=sd();return(0,f.pipe)(k.update(s,r=>r.set(t,e)),o.as(nD.make(t,e)))}))),o.zipRight((0,f.pipe)(k.get(s),o.flatMap(i=>(0,f.pipe)(r.fromIterable(i.values()),o.forEach(r=>(0,f.pipe)(E.offer(r,e),o.catchSomeCause(e=>t.isInterrupted(e)?y.some(o.void):y.none()))))))),o.zipRight(a(e)),o.asVoid));return yield*(0,f.pipe)(e,lA(e=>(0,f.pipe)(n(e),o.flatMap(i=>(0,f.pipe)(k.get(s),o.flatMap(n=>(0,f.pipe)(n.entries(),o.reduce(r.empty(),(n,a)=>{let[s,l]=a;return i(s)?(0,f.pipe)(E.offer(l,c.succeed(e)),o.matchCauseEffect({onFailure:e=>t.isInterrupted(e)?o.succeed((0,f.pipe)(n,r.prepend(s))):o.failCause(e),onSuccess:()=>o.succeed(n)})):o.succeed(n)}),o.flatMap(e=>r.isNonEmpty(e)?k.update(s,t=>{for(let r of e)t.delete(r);return t}):o.void))))),o.asVoid)),o.matchCauseEffect({onFailure:e=>d(c.failCause((0,f.pipe)(e,t.map(y.some)))),onSuccess:()=>d(c.fail(y.none()))}),o.forkScoped),l.withPermits(1)(o.flatten(k.get(u)))})))),sh=e=>new aF(tI.drain(sJ(e))),sm=(0,f.dual)(2,(e,t)=>sY(a.make()).pipe(sz(r=>lH(e=>sJ(t).pipe(tI.drain,nN.runIn(e),o.catchAllCause(e=>a.failCause(r,e)),o.forkIn(e))).pipe(sa(oc(e,r)))))),sg=(0,f.dual)(2,(e,t)=>{let i=e=>ty.readWith({onInput:t=>{let n=(0,f.pipe)(t,r.drop(e)),a=Math.max(0,e-t.length);return r.isEmpty(t)||a>0?i(a):(0,f.pipe)(ty.write(n),tI.zipRight(tI.identityChannel()))},onFailure:ty.fail,onDone:()=>ty.void});return new aF((0,f.pipe)(sJ(e),tI.pipeToOrFail(i(t))))}),sy=(0,f.dual)(2,(e,t)=>t<=0?oi():l1(()=>{let i=new nU(t),n=ty.readWith({onInput:e=>{let t=(0,f.pipe)(e,r.filterMap(e=>{let t=i.head();return i.put(e),t}));return(0,f.pipe)(ty.write(t),ty.flatMap(()=>n))},onFailure:ty.fail,onDone:()=>ty.void});return new aF((0,f.pipe)(sJ(e),tI.pipeToOrFail(n)))})),sS=(0,f.dual)(2,(e,t)=>sg(sv(e,e=>!t(e)),1)),sb=(0,f.dual)(2,(e,t)=>{let i=ty.readWith({onInput:e=>(0,f.pipe)(o.dropUntil(e,t),o.map(r.unsafeFromArray),o.map(e=>r.isEmpty(e)?ty.suspend(()=>i):(0,f.pipe)(ty.write(e),tI.zipRight(tI.identityChannel()))),tI.unwrap),onFailure:ty.fail,onDone:()=>ty.void});return new aF((0,f.pipe)(sJ(e),tI.pipeToOrFail(i)))}),sv=(0,f.dual)(2,(e,t)=>{let i=ty.readWith({onInput:e=>{let n=r.dropWhile(e,t);return r.isEmpty(n)?ty.suspend(()=>i):tI.zipRight(ty.write(n),tI.identityChannel())},onFailure:ty.fail,onDone:ty.succeedNow});return new aF(tI.pipeToOrFail(sJ(e),i))}),sE=(0,f.dual)(2,(e,t)=>{let i=ty.readWith({onInput:e=>(0,f.pipe)(o.dropWhile(e,t),o.map(r.unsafeFromArray),o.map(e=>r.isEmpty(e)?ty.suspend(()=>i):tI.zipRight(ty.write(e),tI.identityChannel())),tI.unwrap),onFailure:ty.fail,onDone:()=>ty.void});return new aF(tI.pipeToOrFail(sJ(e),i))}),sw=new aF(ty.void),sk=(0,f.dual)(2,(e,t)=>new aF((0,f.pipe)(sJ(e),tI.ensuring(t)))),sI=(0,f.dual)(2,(e,t)=>new aF(ty.ensuringWith(sJ(e),t))),sT=()=>sY(o.context()),sx=e=>(0,f.pipe)(sT(),sz(e)),sC=e=>sh(sY(e)),sR=e=>sX(o.fail(y.some(e))),sF=e=>sX(o.failSync(()=>y.some(e()))),sA=e=>sY(o.failCause(e)),sO=(0,f.dual)(2,(e,t)=>og(e,r.filter(t))),s_=(0,f.dual)(2,(e,t)=>{let i=e=>{let n=e.next();return n.done?ty.readWithCause({onInput:e=>i(e[Symbol.iterator]()),onFailure:ty.failCause,onDone:ty.succeed}):(0,f.pipe)(t(n.value),o.map(t=>t?(0,f.pipe)(ty.write(r.of(n.value)),ty.flatMap(()=>i(e))):i(e)),tI.unwrap)};return new aF(ty.suspend(()=>(0,f.pipe)(sJ(e),ty.pipeTo(i(r.empty()[Symbol.iterator]())))))}),sM=(0,f.dual)(2,(e,t)=>og(e,r.filterMap(t))),sD=(0,f.dual)(2,(e,t)=>l1(()=>{let i=e=>{let n=e.next();return n.done?ty.readWithCause({onInput:e=>i(e[Symbol.iterator]()),onFailure:ty.failCause,onDone:ty.succeed}):(0,f.pipe)(t(n.value),y.match({onNone:()=>o.sync(()=>i(e)),onSome:o.map(t=>ty.flatMap(ty.write(r.of(t)),()=>i(e)))}),tI.unwrap)};return new aF((0,f.pipe)(sJ(e),ty.pipeTo(i(r.empty()[Symbol.iterator]()))))})),sN=(0,f.dual)(2,(e,t)=>{let i=ty.readWith({onInput:e=>{let n=r.filterMapWhile(e,t);return n.length===e.length?(0,f.pipe)(ty.write(n),ty.flatMap(()=>i)):ty.write(n)},onFailure:ty.fail,onDone:ty.succeed});return new aF((0,f.pipe)(sJ(e),tI.pipeToOrFail(i)))}),sP=(0,f.dual)(2,(e,t)=>l1(()=>{let i=e=>{let n=e.next();return n.done?ty.readWithCause({onInput:e=>i(e[Symbol.iterator]()),onFailure:ty.failCause,onDone:ty.succeed}):tI.unwrap(y.match(t(n.value),{onNone:()=>o.succeed(ty.void),onSome:o.map(t=>ty.flatMap(ty.write(r.of(t)),()=>i(e)))}))};return new aF((0,f.pipe)(sJ(e),tI.pipeToOrFail(i(r.empty()[Symbol.iterator]()))))})),sL=(0,f.dual)(2,(e,t)=>{let i=ty.readWith({onInput:e=>y.match(r.findFirst(e,t),{onNone:()=>i,onSome:e=>ty.write(r.of(e))}),onFailure:ty.fail,onDone:()=>ty.void});return new aF((0,f.pipe)(sJ(e),ty.pipeTo(i)))}),sU=(0,f.dual)(2,(e,t)=>{let i=ty.readWith({onInput:e=>(0,f.pipe)(o.findFirst(e,t),o.map(y.match({onNone:()=>i,onSome:e=>ty.write(r.of(e))})),tI.unwrap),onFailure:ty.fail,onDone:()=>ty.void});return new aF((0,f.pipe)(sJ(e),ty.pipeTo(i)))}),sz=(0,f.dual)(e=>aA(e[0]),(e,t,i)=>{let n=i?.bufferSize??16;return i?.switch?sW(i?.concurrency,()=>sB(e,1,n,t),r=>sB(e,r,n,t)):sW(i?.concurrency,()=>new aF(tI.concatMap(sJ(e),e=>(0,f.pipe)(e,r.map(e=>sJ(t(e))),r.reduce(ty.void,(e,t)=>(0,f.pipe)(e,tI.zipRight(t)))))),r=>new aF((0,f.pipe)(sJ(e),tI.concatMap(tI.writeChunk),tI.mergeMap(e=>sJ(t(e)),i))))}),sW=(e,t,r)=>{switch(e){case void 0:return t();case"unbounded":return r(Number.MAX_SAFE_INTEGER);default:return e>1?r(e):t()}},sB=(0,f.dual)(4,(e,t,r,i)=>new aF((0,f.pipe)(sJ(e),tI.concatMap(tI.writeChunk),tI.mergeMap(e=>sJ(i(e)),{concurrency:t,mergeStrategy:nP.BufferSliding(),bufferSize:r})))),sq=(0,f.dual)(e=>aA(e[0]),(e,t)=>sz(e,f.identity,t)),s$=e=>{let t=ty.readWithCause({onInput:e=>ty.flatMap(tI.writeChunk(e),()=>t),onFailure:ty.failCause,onDone:()=>ty.void});return new aF((0,f.pipe)(sJ(e),ty.pipeTo(t)))},sj=(0,f.dual)(e=>aA(e[0]),(e,t)=>t?.unordered?sz(e,e=>sY(e),{concurrency:t.concurrency}):sW(t?.concurrency,()=>ow(e,f.identity),t=>new aF((0,f.pipe)(sJ(e),tI.concatMap(tI.writeChunk),tI.mapOutEffectPar(f.identity,t),tI.mapOut(r.of))))),sV=e=>{let i=ty.readWithCause({onInput:e=>((e,i)=>{let[n,a]=(0,f.pipe)(e,r.splitWhere(e=>!c.isSuccess(e))),s=(0,f.pipe)(r.head(a),y.match({onNone:()=>i,onSome:c.match({onFailure:e=>y.match(t.flipCauseOption(e),{onNone:()=>ty.void,onSome:ty.failCause}),onSuccess:()=>ty.void})}));return(0,f.pipe)(ty.write((0,f.pipe)(n,r.filterMap(e=>c.isSuccess(e)?y.some(e.value):y.none()))),ty.flatMap(()=>s))})(e,i),onFailure:e=>ty.failCause(e),onDone:()=>ty.void});return new aF((0,f.pipe)(sJ(e),ty.pipeTo(i)))},sH=e=>s$(sV((0,f.pipe)(e,op(e=>e.exit)))),sG=e=>new aF(tI.repeated(sJ(e))),sK=e=>new aF(e),sJ=e=>{if("channel"in e)return e.channel;if(o.isEffect(e))return sJ(sY(e));throw TypeError("Expected a Stream.")},sZ=e=>new aF(r.isEmpty(e)?ty.void:ty.write(e)),sQ=(e,r)=>(0,f.pipe)(E.take(e),o.catchAllCause(r=>(0,f.pipe)(E.isShutdown(e),o.flatMap(e=>e&&t.isInterrupted(r)?an():aa(r)))),ll,r?.shutdown?sk(E.shutdown(e)):f.identity),sY=e=>(0,f.pipe)(e,o.mapError(y.some),sX),sX=e=>new aF(tI.unwrap(o.match(e,{onFailure:y.match({onNone:()=>ty.void,onSome:ty.fail}),onSuccess:e=>ty.write(r.of(e))}))),s0=(e,t)=>{let r=t?.maxChunkSize??4096;if(t?.scoped){let i=o.map(v.subscribe(e),e=>s3(e,{maxChunkSize:r,shutdown:!0}));return t.shutdown?o.map(i,sk(v.shutdown(e))):i}let i=sz(lV(v.subscribe(e)),e=>s3(e,{maxChunkSize:r}));return t?.shutdown?sk(i,v.shutdown(e)):i},s1=e=>l1(()=>r.isChunk(e)?sZ(e):s2(e[Symbol.iterator]())),s2=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4096;return(0,f.pipe)(o.sync(()=>{let i=[],n=e=>(0,f.pipe)(o.sync(()=>{let a=e.next();if(1===t)return a.done?ty.void:(0,f.pipe)(ty.write(r.of(a.value)),ty.flatMap(()=>n(e)));i=[];let s=0;for(;!1===a.done&&(i.push(a.value),!((s+=1)>=t));)a=e.next();return s>0?(0,f.pipe)(ty.write(r.unsafeFromArray(i)),ty.flatMap(()=>n(e))):ty.void}),tI.unwrap);return new aF(n(e))}),uT)},s5=e=>(0,f.pipe)(e,o.map(ll),ux),s3=(e,r)=>(0,f.pipe)(E.takeBetween(e,1,r?.maxChunkSize??4096),o.catchAllCause(r=>(0,f.pipe)(E.isShutdown(e),o.flatMap(e=>e&&t.isInterrupted(r)?an():aa(r)))),ll,r?.shutdown?sk(E.shutdown(e)):f.identity),s8=e=>(0,f.pipe)(e.take,o.map(r.of),o.catchAllCause(r=>(0,f.pipe)(e.isShutdown,o.flatMap(e=>e&&t.isInterrupted(r)?an():aa(r)))),ll),s4=Symbol.for("effect/Stream/EOF"),s6=(0,f.dual)(2,(e,t)=>{let i=e=>ty.readWithCause({onInput:n=>{let[a,s]=((e,i)=>{let n;if(r.isEmpty(i))return[e,r.empty()];let a=[],s=0,o=0,l=r.empty();switch(e._tag){case"Some":{let c=e.value;n=c[0];let d=!0;for(;d&&o<i.length;){let e=t(r.unsafeGet(i,o));if(!u.equals(n,e)){let t=c[1],l=r.unsafeFromArray(Array.from(i).slice(s,o)),u=r.appendAll(t,l);a.push([n,u]),n=e,s=o,d=!1}o+=1}d&&(l=c[1]);break}case"None":n=t(r.unsafeGet(i,o)),o+=1}for(;o<i.length;){let e=t(r.unsafeGet(i,o));u.equals(n,e)||(a.push([n,r.unsafeFromArray(Array.from(i).slice(s,o))]),n=e,s=o),o+=1}let c=r.appendAll(l,r.unsafeFromArray(Array.from(i).slice(s,o))),d=r.unsafeFromArray(a);return[y.some([n,c]),d]})(e,n);return r.isEmpty(s)?i(a):ty.flatMap(ty.write(s),()=>i(a))},onFailure:t=>y.match(e,{onNone:()=>ty.failCause(t),onSome:e=>ty.flatMap(ty.write(r.of(e)),()=>ty.failCause(t))}),onDone:t=>y.match(e,{onNone:()=>ty.succeedNow(t),onSome:e=>ty.flatMap(ty.write(r.of(e)),()=>ty.succeedNow(t))})});return new aF(tI.pipeToOrFail(sJ(e),i(y.none())))}),s9=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,lr(t),a6)),s7=(0,f.dual)(3,(e,t,r)=>aD(e,tD(t),eZ(r))),oe=(0,f.dual)(2,(e,t)=>{let r=e=>(0,f.pipe)(d.poll(e),o.map(y.match({onNone:()=>ty.readWith({onInput:t=>ty.flatMap(ty.write(t),()=>r(e)),onFailure:ty.fail,onDone:()=>ty.void}),onSome:c.match({onFailure:ty.failCause,onSuccess:()=>ty.void})})),tI.unwrap);return new aF(tI.unwrapScopedWith(i=>t.pipe(o.forkIn(i),o.map(t=>sJ(e).pipe(ty.pipeTo(r(t)))))))}),ot=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,oe(i.sleep(t)))),or=(0,f.dual)(2,(e,t)=>{let r=(0,f.pipe)(a.poll(t),o.map(y.match({onNone:()=>ty.readWith({onInput:e=>(0,f.pipe)(ty.write(e),ty.flatMap(()=>r)),onFailure:ty.fail,onDone:()=>ty.void}),onSome:e=>tI.unwrap(o.match(e,{onFailure:ty.fail,onSuccess:()=>ty.void}))})),tI.unwrap);return new aF((0,f.pipe)(sJ(e),ty.pipeTo(r)))}),oi=()=>new aF(tI.identityChannel()),on=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,oa(t,sG(od(!0,!1))))),oa=(0,f.dual)(3,(e,t,r)=>{let i=e=>ty.readWithCause({onInput:t=>ty.flatMap(ty.fromEffect(nQ(e,ai(t))),()=>i(e)),onFailure:t=>ty.fromEffect(nQ(e,ae(t))),onDone:()=>ty.fromEffect(nQ(e,n7))});return new aF(tI.unwrapScopedWith(n=>(0,f.pipe)(nZ(),o.zip(nZ()),o.tap(t=>{let[r]=t;return sJ(e).pipe(tI.concatMap(tI.writeChunk),ty.pipeTo(i(r)),nN.runIn(n),o.forkIn(n))}),o.tap(e=>{let[r,a]=e;return sJ(t).pipe(tI.concatMap(tI.writeChunk),ty.pipeTo(i(a)),nN.runIn(n),o.forkIn(n))}),o.map(e=>{let[t,i]=e,n=(e,r)=>ty.readWithCause({onInput:a=>a&&!e?(0,f.pipe)(ty.fromEffect(nY(t)),ty.flatMap(ar({onEnd:()=>r?ty.void:n(!0,r),onFailure:ty.failCause,onSuccess:t=>(0,f.pipe)(ty.write(t),ty.flatMap(()=>n(e,r)))}))):a||r?n(e,r):(0,f.pipe)(ty.fromEffect(nY(i)),ty.flatMap(ar({onEnd:()=>e?ty.void:n(e,!0),onFailure:ty.failCause,onSuccess:t=>(0,f.pipe)(ty.write(t),ty.flatMap(()=>n(e,r)))}))),onFailure:ty.failCause,onDone:()=>ty.void});return(0,f.pipe)(sJ(r),tI.concatMap(tI.writeChunk),ty.pipeTo(n(!1,!1)))}))))}),os=(0,f.dual)(2,(e,t)=>new aF((0,f.pipe)(sJ(e),tI.pipeToOrFail(ty.suspend(()=>{let e=i=>ty.readWithCause({onInput:n=>{let a=[],s=i;for(let e of n)s?s=!1:a.push(t),a.push(e);return(0,f.pipe)(ty.write(r.unsafeFromArray(a)),ty.flatMap(()=>e(s)))},onFailure:ty.failCause,onDone:()=>ty.void});return e(!0)}))))),oo=(0,f.dual)(2,(e,t)=>{let{end:r,middle:i,start:n}=t;return(0,f.pipe)(od(n),sr((0,f.pipe)(e,os(i))),sr(od(r)))}),ol=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,ou(i.sleep(t)))),ou=(0,f.dual)(2,(e,t)=>new aF((0,f.pipe)(sJ(e),tI.interruptWhen(t)))),oc=(0,f.dual)(2,(e,t)=>new aF((0,f.pipe)(sJ(e),tI.interruptWhenDeferred(t)))),od=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return s1(t)},op=(0,f.dual)(2,(e,t)=>new aF((0,f.pipe)(sJ(e),tI.mapOut(r.map(t))))),of=(0,f.dual)(3,(e,t,i)=>{let n=e=>ty.readWith({onInput:t=>{let[a,s]=r.mapAccum(t,e,i);return ty.flatMap(ty.write(s),()=>n(a))},onFailure:ty.fail,onDone:()=>ty.void});return new aF((0,f.pipe)(sJ(e),ty.pipeTo(n(t))))}),oh=(0,f.dual)(3,(e,t,i)=>l1(()=>{let n=e=>ty.readWith({onInput:t=>(0,f.pipe)(o.suspend(()=>{let a=[];return(0,f.pipe)(t,o.reduce(e,(e,t)=>(0,f.pipe)(i(e,t),o.flatMap(e=>{let[t,r]=e;return(0,f.pipe)(o.sync(()=>{a.push(r)}),o.as(t))}))),o.match({onFailure:e=>0!==a.length?tI.zipRight(ty.write(r.unsafeFromArray(a)),ty.fail(e)):ty.fail(e),onSuccess:e=>ty.flatMap(ty.write(r.unsafeFromArray(a)),()=>n(e))}))}),tI.unwrap),onFailure:ty.fail,onDone:()=>ty.void});return new aF((0,f.pipe)(sJ(e),tI.pipeToOrFail(n(t))))})),om=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,oI(t.onFailure),op(t.onSuccess))),og=(0,f.dual)(2,(e,t)=>new aF((0,f.pipe)(sJ(e),tI.mapOut(t)))),oy=(0,f.dual)(2,(e,t)=>new aF((0,f.pipe)(sJ(e),tI.mapOutEffect(t)))),oS=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,ob(e=>r.fromIterable(t(e))))),ob=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,og(r.flatMap(t)))),ov=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,ow(t),ob(f.identity))),oE=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,ow(e=>(0,f.pipe)(t(e),o.map(r.fromIterable))),ob(f.identity))),ow=(0,f.dual)(2,(e,t)=>{let i=e=>{let n=e.next();if(n.done)return ty.readWithCause({onInput:e=>i(e[Symbol.iterator]()),onFailure:ty.failCause,onDone:ty.succeed});{let a=n.value;return tI.unwrap(o.map(t(a),t=>ty.flatMap(ty.write(r.of(t)),()=>i(e))))}};return new aF((0,f.pipe)(sJ(e),ty.pipeTo(ty.suspend(()=>i(r.empty()[Symbol.iterator]())))))}),ok=(0,f.dual)(3,(e,t,i)=>new aF((0,f.pipe)(sJ(e),tI.concatMap(tI.writeChunk),tI.mapOutEffectPar(i,t),tI.mapOut(r.of)))),oI=(0,f.dual)(2,(e,t)=>new aF((0,f.pipe)(sJ(e),tI.mapError(t)))),oT=(0,f.dual)(2,(e,t)=>new aF((0,f.pipe)(sJ(e),tI.mapErrorCause(t)))),ox=(0,f.dual)(e=>aA(e[1]),(e,t,r)=>o_(e,t,{onSelf:f.identity,onOther:f.identity,haltStrategy:r?.haltStrategy})),oC=(0,f.dual)(e=>Symbol.iterator in e[0],(e,t)=>sq(s1(e),t)),oR=(0,f.dual)(2,(e,t)=>oC(Object.keys(e).map(t=>e[t].pipe(op(e=>({_tag:t,value:e})))),t)),oF=(0,f.dual)(2,(e,t)=>o_(e,t,{onSelf:l.left,onOther:l.right})),oA=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,ox(sh(t)))),oO=(0,f.dual)(2,(e,t)=>(0,f.pipe)(sh(e),ox(t))),o_=(0,f.dual)(3,(e,t,r)=>{let i=r.haltStrategy?(e=>{switch(e){case"left":return tu;case"right":return tc;case"both":return td;case"either":return tp;default:return e}})(r.haltStrategy):td,n=e=>t=>e||!c.isSuccess(t)?g.Done(o.suspend(()=>t)):g.Await(e=>o.suspend(()=>e));return new aF(tI.mergeWith(sJ(op(e,r.onSelf)),{other:sJ(op(t,r.onOther)),onSelfDone:n("Either"===i._tag||"Left"===i._tag),onOtherDone:n("Either"===i._tag||"Right"===i._tag)}))}),oM=sY(o.never),oD=(0,f.dual)(2,(e,t)=>sr(e,sh(sY(t)))),oN=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,a0(e=>sY((0,f.pipe)(t(e),o.zipRight(o.failCause(e))))))),oP=(0,f.dual)(2,(e,t)=>new aF((0,f.pipe)(sJ(e),ty.ensuringWith(e=>c.isSuccess(e)?t():o.void)))),oL=(0,f.dual)(2,(e,t)=>uT(o.as(t,e))),oU=(0,f.dual)(2,(e,t)=>new aF((0,f.pipe)(sJ(e),tI.orDieWith(t)))),oz=(0,f.dual)(2,(e,t)=>new aF((0,f.pipe)(sJ(e),tI.orElse(()=>sJ(t()))))),oW=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,op(l.left),oz(()=>(0,f.pipe)(t(),op(l.right))))),oB=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,oz(()=>sF(t)))),oq=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,o$(()=>r.of(t())))),o$=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,oj(()=>new aF(ty.write(t()))))),oj=(0,f.dual)(2,(e,t)=>{let i=ty.readWith({onInput:e=>r.isEmpty(e)?ty.suspend(()=>i):(0,f.pipe)(ty.write(e),tI.zipRight(tI.identityChannel())),onFailure:ty.fail,onDone:()=>ty.suspend(()=>sJ(t()))});return new aF((0,f.pipe)(sJ(e),ty.pipeTo(i)))}),oV=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,oz(()=>l0(t)))),oH=(e,t)=>{let r=e=>{let i=t(e);return y.match(i[1],{onNone:()=>tI.zipRight(ty.write(i[0]),ty.void),onSome:e=>ty.flatMap(ty.write(i[0]),()=>r(e))})};return new aF(ty.suspend(()=>r(e)))},oG=(e,t)=>{let r=e=>tI.unwrap(o.map(t(e),e=>{let[t,i]=e;return y.match(i,{onNone:()=>tI.zipRight(ty.write(t),ty.void),onSome:e=>ty.flatMap(ty.write(t),()=>r(e))})}));return new aF(ty.suspend(()=>r(e)))},oK=(e,t)=>oG(e,e=>(0,f.pipe)(t(e),o.map(e=>{let[t,i]=e;return[r.of(t),i]}))),oJ=(0,f.dual)(2,(e,t)=>{let r="Emit",i="Halt";return(0,f.pipe)(a.make(),o.flatMap(n=>(0,f.pipe)(nZ(),o.map(s=>{let l=ri(tW(t),{onFailure:e=>r1(rx(a.fail(n,e)),t8(e)),onSuccess:e=>{let[t,o]=e,l=ty.readWithCause({onInput:e=>ty.flatMap(ty.fromEffect(nQ(s,{_tag:r,elements:e})),()=>l),onFailure:e=>tI.zipRight(ty.fromEffect(nQ(s,{_tag:i,cause:e})),ty.failCause(e)),onDone:e=>tI.zipRight(ty.fromEffect(nQ(s,{_tag:"End"})),ty.void)});return rT((0,f.pipe)(ty.fromEffect(a.succeed(n,t)),tI.zipRight(ty.fromEffect((0,f.pipe)(s,nQ({_tag:r,elements:o})))),tI.zipRight(l)))}}),u=(0,f.pipe)(nY(s),o.map(e=>{switch(e._tag){case r:return(0,f.pipe)(ty.write(e.elements),ty.flatMap(()=>u));case i:return ty.failCause(e.cause);case"End":return ty.void}}),tI.unwrap);return(0,f.pipe)(e,ue(e=>a.failCause(n,e)),lS(l),o.forkScoped,o.zipRight(a.await(n)),o.map(e=>[e,new aF(u)]))}))),o.flatten)}),oZ=(0,f.dual)(e=>"function"==typeof e[1],(e,t,r)=>oQ(e,e=>o.succeed(t(e)?l.right(e):l.left(e)),r)),oQ=(0,f.dual)(e=>"function"==typeof e[1],(e,t,r)=>(0,f.pipe)(ow(e,t),su({size:2,maximumLag:r?.bufferSize??16,decide:l.match({onLeft:()=>o.succeed(e=>0===e),onRight:()=>o.succeed(e=>1===e)})}),o.flatMap(e=>{let[t,r]=e;return o.succeed([sM(sV(s3(t,{shutdown:!0})),e=>l.match(e,{onLeft:y.some,onRight:y.none})),sM(sV(s3(r,{shutdown:!0})),e=>l.match(e,{onLeft:y.none,onRight:y.some}))])}))),oY=(0,f.dual)(2,(e,t)=>new aF((0,f.pipe)(sJ(e),tI.pipeToOrFail(rJ(t))))),oX=(0,f.dual)(2,(e,t)=>new aF(ty.pipeTo(sJ(e),t))),o0=(0,f.dual)(2,(e,t)=>new aF((0,f.pipe)(sJ(e),tI.pipeToOrFail(t)))),o1=(0,f.dual)(2,(e,t)=>new aF(tI.zipRight(ty.write(t),sJ(e)))),o2=(0,f.dual)(2,(e,t)=>new aF((0,f.pipe)(sJ(e),ty.provideContext(t)))),o5=(0,f.dual)(2,(e,t)=>o9(e,n.merge(t))),o3=(0,f.dual)(2,(e,t)=>new aF(tI.unwrapScopedWith(r=>m.buildWithScope(t,r).pipe(o.map(t=>(0,f.pipe)(sJ(e),ty.provideContext(t))))))),o8=(0,f.dual)(3,(e,t,r)=>o4(e,t,o.succeed(r))),o4=(0,f.dual)(3,(e,t,r)=>o6(e,t,sY(r))),o6=(0,f.dual)(3,(e,t,r)=>sx(i=>sz(r,r=>(0,f.pipe)(e,o2(n.add(i,t,r)))))),o9=(0,f.dual)(2,(e,t)=>sx(r=>(0,f.pipe)(e,o2(t(r))))),o7=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,o3((0,f.pipe)(m.context(),m.merge(t))))),le=(0,f.dual)(2,(e,t)=>lt(e,t)),lt=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return a.make().pipe(o.map(e=>{let r=null;return oC(t.map((t,i)=>t.pipe(l4(()=>null===r?(r=i,a.unsafeDone(e,c.void),!0):r===i),ou(a.await(e).pipe(o.flatMap(()=>r===i?o.never:o.void))))),{concurrency:t.length})}),uT)},lr=(0,f.dual)(2,(e,t)=>l1(()=>{let r=Math.max(t,1),i=li(new ln(r),r);return new aF((0,f.pipe)(sJ(e),ty.pipeTo(i)))})),li=(e,t)=>ty.readWithCause({onInput:i=>{if(i.length===t&&e.isEmpty())return ty.flatMap(ty.write(i),()=>li(e,t));if(i.length>0){let n,a=[],s=0;for(;s<i.length;){for(;s<i.length&&void 0===n;)n=e.write((0,f.pipe)(i,r.unsafeGet(s))),s+=1;void 0!==n&&(a.push(n),n=void 0)}return ty.flatMap(tI.writeAll(...a),()=>li(e,t))}return ty.suspend(()=>li(e,t))},onFailure:t=>tI.zipRight(e.emitIfNotEmpty(),ty.failCause(t)),onDone:()=>e.emitIfNotEmpty()});class ln{n;builder=[];pos=0;constructor(e){this.n=e}isEmpty(){return 0===this.pos}write(e){if(this.builder.push(e),this.pos+=1,this.pos===this.n){let e=r.unsafeFromArray(this.builder);return this.builder=[],this.pos=0,e}}emitIfNotEmpty(){return 0!==this.pos?ty.write(r.unsafeFromArray(this.builder)):ty.void}}let la=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,ls(t,f.identity))),ls=(0,f.dual)(3,(e,r,i)=>new aF(tI.catchAll(sJ(e),e=>y.match(r(e),{onNone:()=>ty.failCause(t.die(i(e))),onSome:ty.fail})))),lo=(0,f.dual)(2,(e,t)=>sM(lc(e,t),e=>l.match(e,{onLeft:y.none,onRight:y.some}))),ll=e=>uw(e,e=>(0,f.pipe)(o.map(e,t=>y.some([t,e])),o.catchAll(y.match({onNone:()=>o.succeed(y.none()),onSome:o.fail})))),lu=e=>ll((0,f.pipe)(e,o.map(r.of))),lc=(0,f.dual)(2,(e,t)=>lf(e,t,{onElement:e=>l.right(e),onSchedule:l.left})),ld=(0,f.dual)(2,(e,t)=>sM(lp(e,t,{onElement:e=>y.some(e),onSchedule:y.none}),f.identity)),lp=(0,f.dual)(3,(e,t,i)=>{let n=(0,f.pipe)(el(t),o.map(e=>{let t=e=>y.match(r.head(e),{onNone:()=>a,onSome:t=>tI.zipRight(ty.write(r.of(i.onElement(t))),n((0,f.pipe)(e,r.drop(1)),t))}),n=(a,s)=>{let l=(0,f.pipe)(e.next(s),o.as((0,f.pipe)(ty.write(r.of(i.onElement(s))),ty.flatMap(()=>n(a,s))))),u=(0,f.pipe)(e.last,o.orDie,o.flatMap(n=>(0,f.pipe)(e.reset,o.map(()=>(0,f.pipe)(ty.write(r.of(i.onSchedule(n))),tI.zipRight(t(a)))))));return(0,f.pipe)(l,o.orElse(()=>u),tI.unwrap)},a=ty.readWith({onInput:t,onFailure:ty.fail,onDone:()=>ty.void});return a}),tI.unwrap);return new aF((0,f.pipe)(sJ(e),ty.pipeTo(n)))}),lf=(0,f.dual)(3,(e,t,i)=>(0,f.pipe)(el(t),o.map(t=>{let n=o4(tl,k.get(t.iterationMeta)),a=(0,f.pipe)(e,n,op(i.onElement),sJ),s=tI.unwrap(o.match(t.next(void 0),{onFailure:()=>ty.void,onSuccess:e=>ty.flatMap(a,()=>tI.zipRight(ty.write(r.of(i.onSchedule(e))),s))}));return new aF(tI.zipRight(a,s))}),uT)),lh=(e,t)=>sz(sY(o.zip(e,el(t))),t=>{let[r,i]=t,n=o.provideServiceEffect(tl,k.get(i.iterationMeta));return sr(lX(r),uk(r,t=>o.matchEffect(i.next(t),{onFailure:o.succeed,onSuccess:()=>o.map(n(e),e=>y.some([e,e]))})))}),lm=(0,f.dual)(2,(e,t)=>el(t).pipe(o.map(t=>{let r=sJ(o4(tl,k.get(t.iterationMeta))(e)).pipe(tI.mapOutEffect(e=>o.as(t.reset,e)),tI.catchAll(e=>t.next(e).pipe(o.match({onFailure:()=>ty.fail(e),onSuccess:()=>r}),tI.unwrap)));return r}),tI.unwrap,sK)),lg=(0,f.dual)(e=>aA(e[0]),(e,t,r)=>l1(()=>{let i=r?.preventFallbackOnPartialStream??!1,a=0,s=y.none(),o=l1(()=>{let r=t.steps[a++];if(!r)return sR(y.getOrThrow(s));let l=n.isContext(r.provide)?o5(e,r.provide):o7(e,r.provide),u=!1;if(y.isSome(s)){let e=s.value,t=!1,i=l;l=ly(lm(l=l1(()=>t?i:(t=!0,sR(e))),h.scheduleFromStep(r,!1)))}else{let e=h.scheduleFromStep(r,!0);l=e?ly(lm(l,e)):l}return aX(i?og(l,e=>(u=!0,e)):l,e=>i&&u?sR(e):(s=y.some(e),o))});return o})),ly=e=>a0(e,e=>sA(T.scheduleDefectRefailCause(e))),lS=(0,f.dual)(2,(e,t)=>sJ(e).pipe(tI.pipeToOrFail(rJ(t)),tI.runDrain)),lb=(0,f.dual)(3,(e,t,r)=>lk(e,t,f.constTrue,r)),lv=(0,f.dual)(3,(e,t,r)=>lI(e,t,f.constTrue,r)),lE=(0,f.dual)(3,(e,t,r)=>(0,f.pipe)(e,lT(t,f.constTrue,r))),lw=(0,f.dual)(3,(e,t,r)=>(0,f.pipe)(e,lx(t,f.constTrue,r))),lk=(0,f.dual)(4,(e,t,r,i)=>lS(e,re(t,r,i))),lI=(0,f.dual)(4,(e,t,r,i)=>lS(e,rl(t,r,i))),lT=(0,f.dual)(4,(e,t,r,i)=>(0,f.pipe)(e,lU(re(t,r,i)))),lx=(0,f.dual)(4,(e,t,r,i)=>(0,f.pipe)(e,lU(rl(t,r,i)))),lC=(0,f.dual)(2,(e,t)=>lS(e,rE(t))),lR=(0,f.dual)(2,(e,t)=>lS(e,rw(t))),lF=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,lU(rw(t)))),lA=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,lU(rE(t)))),lO=(0,f.dual)(2,(e,t)=>lS(e,rk(t))),l_=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,lU(rk(t)))),lM=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,lN(t))),lD=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,lL(t))),lN=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,lL(t),o.scoped)),lP=(0,f.dual)(2,(e,i)=>{let n=ty.readWithCause({onInput:e=>ty.flatMap(ty.fromEffect(E.offerAll(i,r.map(e,c.succeed))),()=>n),onFailure:e=>ty.fromEffect(E.offer(i,c.failCause(t.map(e,y.some)))),onDone:()=>ty.fromEffect(E.offer(i,c.fail(y.none())))});return(0,f.pipe)(ty.pipeTo(sJ(e),n),tI.drain,tI.runScoped,o.asVoid)}),lL=(0,f.dual)(2,(e,t)=>{let r=ty.readWithCause({onInput:e=>ty.flatMap(ty.write(n6(e)),()=>r),onFailure:e=>ty.write(ae(e)),onDone:()=>ty.write(n7)});return(0,f.pipe)(ty.pipeTo(sJ(e),r),tI.mapOutEffect(e=>E.offer(t,e)),tI.drain,tI.runScoped,o.asVoid)}),lU=(0,f.dual)(2,(e,t)=>(0,f.pipe)(sJ(e),tI.pipeToOrFail(rJ(t)),tI.drain,tI.runScoped)),lz=(0,f.dual)(3,(e,t,r)=>(0,f.pipe)(e,lj(t,(e,t)=>o.succeed(r(e,t))))),lW=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,lB((e,r)=>o.succeed(t(e,r))))),lB=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,oh(y.none(),(e,r)=>{switch(e._tag){case"None":return o.succeed([y.some(r),r]);case"Some":return(0,f.pipe)(t(e.value,r),o.map(e=>[y.some(e),e]))}}))),lq=(0,f.dual)(2,(e,t)=>sM(l$(e,t,{onElement:y.some,onSchedule:y.none}),f.identity)),l$=(0,f.dual)(3,(e,t,i)=>{let n=(e,t)=>{let a=t.next();return a.done?ty.readWithCause({onInput:t=>n(e,t[Symbol.iterator]()),onFailure:ty.failCause,onDone:ty.succeedNow}):tI.unwrap(o.matchEffect(e.next(a.value),{onFailure:()=>(0,f.pipe)(e.last,o.orDie,o.map(s=>(0,f.pipe)(ty.write(r.make(i.onElement(a.value),i.onSchedule(s))),ty.flatMap(()=>n(e,t)))),o.zipLeft(e.reset)),onSuccess:()=>o.succeed((0,f.pipe)(ty.write(r.of(i.onElement(a.value))),ty.flatMap(()=>n(e,t))))}))};return new aF((0,f.pipe)(ty.fromEffect(el(t)),ty.flatMap(t=>(0,f.pipe)(sJ(e),ty.pipeTo(n(t,r.empty()[Symbol.iterator]()))))))}),lj=(0,f.dual)(3,(e,t,i)=>new aF((0,f.pipe)(ty.write(r.of(t)),ty.flatMap(()=>sJ((0,f.pipe)(e,oh(t,(e,t)=>(0,f.pipe)(i(e,t),o.map(e=>[e,e]))))))))),lV=e=>new aF(tI.ensuring(tI.scoped((0,f.pipe)(e,o.map(r.of))),o.void)),lH=e=>new aF(tI.scopedWith(t=>e(t).pipe(o.map(r.of)))),lG=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,op(y.getOrElse(t)))),lK=(0,f.dual)(2,(e,t)=>ow(e,y.match({onNone:()=>o.failSync(t),onSome:o.succeed}))),lJ=(0,f.dual)(2,(e,t)=>lZ(e,t,1)),lZ=(0,f.dual)(3,(e,i,n)=>i<=0||n<=0?sl(new t.IllegalArgumentException("Invalid bounds - `chunkSize` and `stepSize` must be greater than zero")):new aF(ty.suspend(()=>{let t=new nU(i),a=(e,a)=>{if(e<i){let e=t.toChunk(),i=r.isEmpty(e)?r.empty():r.of(e);return(0,f.pipe)(ty.write(i),ty.flatMap(()=>a))}let s=e-(e-i)%n;if(s===e)return a;let o=(0,f.pipe)(t.toChunk(),r.takeRight(e-(s-i+n))),l=r.isEmpty(o)?r.empty():r.of(o);return(0,f.pipe)(ty.write(l),ty.flatMap(()=>a))},s=e=>ty.readWithCause({onInput:a=>ty.flatMap(ty.write(r.filterMap(a,(r,a)=>{t.put(r);let s=e+a+1;return s<i||(s-i)%n>0?y.none():y.some(t.toChunk())})),()=>s(e+a.length)),onFailure:t=>a(e,ty.failCause(t)),onDone:()=>a(e,ty.void)});return(0,f.pipe)(sJ(e),ty.pipeTo(s(0)))}))),lQ=(0,f.dual)(2,(e,t)=>{let i=(e,a)=>{let[s,o]=(0,f.pipe)(e,r.appendAll(a),r.splitWhere(t));return r.isEmpty(s)||r.isEmpty(o)?n((0,f.pipe)(s,r.appendAll((0,f.pipe)(o,r.drop(1))))):(0,f.pipe)(ty.write(r.of(s)),ty.flatMap(()=>i(r.empty(),(0,f.pipe)(o,r.drop(1)))))},n=e=>ty.readWith({onInput:t=>i(e,t),onFailure:ty.fail,onDone:()=>r.isEmpty(e)?ty.void:y.isNone((0,f.pipe)(e,r.findFirst(t)))?tI.zipRight(ty.write(r.of(e)),ty.void):tI.zipRight(i(r.empty(),e),ty.void)});return new aF((0,f.pipe)(sJ(e),ty.pipeTo(n(r.empty()))))}),lY=(0,f.dual)(2,(e,t)=>{let i=(e,n)=>ty.readWithCause({onInput:a=>{let s,[o,l]=(0,f.pipe)(a,r.reduce([(0,f.pipe)(e,y.getOrElse(()=>r.empty())),n],(e,i)=>{let[n,a]=e,o=(0,f.pipe)(n,r.append(i));return a<t.length&&u.equals(i,(0,f.pipe)(t,r.unsafeGet(a)))?a+1===t.length?(void 0===s&&(s=[]),s.push((0,f.pipe)(o,r.take(o.length-t.length))),[r.empty(),0]):[o,a+1]:[o,+!!u.equals(i,(0,f.pipe)(t,r.unsafeGet(0)))]})),c=void 0===s?r.empty():r.unsafeFromArray(s);return ty.flatMap(ty.write(c),()=>i(r.isNonEmpty(o)?y.some(o):y.none(),l))},onFailure:t=>y.match(e,{onNone:()=>ty.failCause(t),onSome:e=>tI.zipRight(ty.write(r.of(e)),ty.failCause(t))}),onDone:t=>y.match(e,{onNone:()=>ty.succeed(t),onSome:e=>tI.zipRight(ty.write(r.of(e)),ty.succeed(t))})});return new aF((0,f.pipe)(sJ(e),ty.pipeTo(i(y.none(),0))))}),lX=e=>sZ(r.of(e)),l0=e=>l1(()=>sZ(r.of(e()))),l1=e=>new aF(ty.suspend(()=>sJ(e()))),l2=(0,f.dual)(2,(e,i)=>{if(!Number.isInteger(i))return sl(new t.IllegalArgumentException(`${i} must be an integer`));let n=e=>ty.readWith({onInput:t=>{let i=(0,f.pipe)(t,r.take(Math.min(e,1/0))),a=Math.max(0,e-i.length);return a>0?(0,f.pipe)(ty.write(i),ty.flatMap(()=>n(a))):ty.write(i)},onFailure:ty.fail,onDone:ty.succeed});return new aF((0,f.pipe)(sJ(e),tI.pipeToOrFail(0<i?n(i):ty.void)))}),l5=(0,f.dual)(2,(e,t)=>t<=0?sw:new aF((0,f.pipe)(o.succeed(new nU(t)),o.map(t=>{let r=ty.readWith({onInput:e=>{for(let r of e)t.put(r);return r},onFailure:ty.fail,onDone:()=>(0,f.pipe)(ty.write(t.toChunk()),tI.zipRight(ty.void))});return(0,f.pipe)(sJ(e),ty.pipeTo(r))}),tI.unwrap))),l3=(0,f.dual)(2,(e,t)=>{let i=ty.readWith({onInput:e=>{let n=(0,f.pipe)(e,r.takeWhile(e=>!t(e))),a=(0,f.pipe)(e,r.drop(n.length),r.take(1));return r.isEmpty(a)?(0,f.pipe)(ty.write(n),ty.flatMap(()=>i)):ty.write((0,f.pipe)(n,r.appendAll(a)))},onFailure:ty.fail,onDone:ty.succeed});return new aF((0,f.pipe)(sJ(e),tI.pipeToOrFail(i)))}),l8=(0,f.dual)(2,(e,t)=>{let i=e=>{let n=e.next();return n.done?ty.readWithCause({onInput:e=>i(e[Symbol.iterator]()),onFailure:ty.failCause,onDone:ty.succeed}):(0,f.pipe)(t(n.value),o.map(t=>t?ty.write(r.of(n.value)):(0,f.pipe)(ty.write(r.of(n.value)),ty.flatMap(()=>i(e)))),tI.unwrap)};return new aF((0,f.pipe)(sJ(e),ty.pipeTo(i(r.empty()[Symbol.iterator]()))))}),l4=(0,f.dual)(2,(e,t)=>{let i=ty.readWith({onInput:e=>{let n=(0,f.pipe)(e,r.takeWhile(t));return n.length===e.length?(0,f.pipe)(ty.write(n),ty.flatMap(()=>i)):ty.write(n)},onFailure:ty.fail,onDone:ty.succeed});return new aF((0,f.pipe)(sJ(e),tI.pipeToOrFail(i)))}),l6=(0,f.dual)(2,(e,t)=>ow(e,e=>o.as(t(e),e))),l9=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,l7(t.onFailure),l6(t.onSuccess))),l7=(0,f.dual)(2,(e,t)=>aX(e,e=>sY(o.zipRight(t(e),o.fail(e))))),ue=(0,f.dual)(2,(e,t)=>{let r=ty.readWithCause({onInput:e=>ty.flatMap(ty.write(e),()=>r),onFailure:e=>ty.fromEffect(o.zipRight(t(e),o.failCause(e))),onDone:ty.succeedNow});return new aF((0,f.pipe)(sJ(e),ty.pipeTo(r)))}),ut=(0,f.dual)(2,(e,t)=>(0,f.pipe)(sY(o.all([E.bounded(1),a.make()])),sz(r=>{let[i,n]=r,s=sH(s3(i,{maxChunkSize:1})),l=ty.readWithCause({onInput:e=>(0,f.pipe)(ty.fromEffect(E.offer(i,n6(e))),ty.foldCauseChannel({onFailure:()=>ty.flatMap(ty.write(e),()=>tI.identityChannel()),onSuccess:()=>ty.flatMap(ty.write(e),()=>l)})),onFailure:e=>(0,f.pipe)(ty.fromEffect(E.offer(i,ae(e))),ty.foldCauseChannel({onFailure:()=>ty.failCause(e),onSuccess:()=>ty.failCause(e)})),onDone:()=>(0,f.pipe)(ty.fromEffect(E.offer(i,n7)),ty.foldCauseChannel({onFailure:()=>ty.void,onSuccess:()=>ty.void}))});return(0,f.pipe)(new aF((0,f.pipe)(ty.pipeTo(sJ(e),l),tI.ensuring(o.zipRight(o.forkDaemon(E.offer(i,n7)),a.await(n))))),ox(sC((0,f.pipe)(lS(s,t),o.ensuring(o.zipRight(E.shutdown(i),a.succeed(n,void 0)))))))}))),ur=(0,f.dual)(2,(e,t)=>ui(e,{...t,cost:e=>o.succeed(t.cost(e))})),ui=(0,f.dual)(2,(e,t)=>"enforce"===t.strategy?un(e,t.cost,t.units,t.duration,t.burst??0):ua(e,t.cost,t.units,t.duration,t.burst??0)),un=(e,t,r,n,a)=>{let l=(e,u)=>ty.readWithCause({onInput:c=>(0,f.pipe)(t(c),o.zip(i.currentTimeMillis),o.map(t=>{let[i,o]=t,d=e+(o-u)/s.toMillis(n)*r,p=r+a<0?1/0:r+a,h=d<0?p:Math.min(d,p);return i<=h?(0,f.pipe)(ty.write(c),ty.flatMap(()=>l(h-i,o))):l(e,u)}),tI.unwrap),onFailure:ty.failCause,onDone:()=>ty.void}),u=(0,f.pipe)(i.currentTimeMillis,o.map(e=>l(r,e)),tI.unwrap);return new aF((0,f.pipe)(sJ(e),tI.pipeToOrFail(u)))},ua=(e,t,r,n,a)=>{let l=(e,u)=>ty.readWithCause({onInput:c=>(0,f.pipe)(t(c),o.zip(i.currentTimeMillis),o.map(t=>{let[o,d]=t,p=e+(d-u)/s.toMillis(n)*r,h=r+a<0?1/0:r+a,m=(p<0?h:Math.min(p,h))-o,g=m>=0?0:-m/r,y=s.millis(Math.max(0,g*s.toMillis(n)));return s.greaterThan(y,s.zero)?(0,f.pipe)(ty.fromEffect(i.sleep(y)),tI.zipRight(ty.write(c)),ty.flatMap(()=>l(m,d))):ty.flatMap(ty.write(c),()=>l(m,d))}),tI.unwrap),onFailure:ty.failCause,onDone:()=>ty.void}),u=(0,f.pipe)(i.currentTimeMillis,o.map(e=>l(r,e)),tI.unwrap);return new aF((0,f.pipe)(sJ(e),tI.pipeToOrFail(u)))},us=(0,f.dual)(2,(e,t)=>(0,f.pipe)(up(e),o.map(o.timeoutFail({onTimeout:()=>y.none(),duration:t})),s5)),uo=(0,f.dual)(3,(e,t,r)=>(0,f.pipe)(e,uu(r,sF(t)))),ul=(0,f.dual)(3,(e,r,i)=>(0,f.pipe)(up(e),o.map(o.timeoutFailCause({onTimeout:()=>t.map(r(),y.some),duration:i})),s5)),uu=(0,f.dual)(3,(e,r,i)=>{let n=new t.RuntimeException("Stream Timeout");return(0,f.pipe)(e,ul(()=>t.die(n),r),a2(e=>t.isDieType(e)&&t.isRuntimeException(e.defect)&&void 0!==e.defect.message&&"Stream Timeout"===e.defect.message?y.some(i):y.none()))}),uc=e=>{if("number"==typeof e)return v.bounded(e);if("unbounded"===e.capacity)return v.unbounded({replay:e.replay});switch(e.strategy){case"dropping":return v.dropping(e);case"sliding":return v.sliding(e);default:return v.bounded(e)}},ud=(0,f.dual)(2,(e,t)=>(0,f.pipe)(o.acquireRelease(uc(t),e=>v.shutdown(e)),o.tap(t=>(0,f.pipe)(e,lD(t),o.forkScoped)))),up=e=>o.map(tI.toPull(sJ(e)),e=>(0,f.pipe)(e,o.mapError(y.some),o.flatMap(l.match({onLeft:()=>o.fail(y.none()),onRight:o.succeed})))),uf=(0,f.dual)(e=>aA(e[0]),(e,t)=>o.tap(o.acquireRelease(t?.strategy==="unbounded"?E.unbounded():t?.strategy==="dropping"?E.dropping(t.capacity??2):t?.strategy==="sliding"?E.sliding(t.capacity??2):E.bounded(t?.capacity??2),e=>E.shutdown(e)),t=>o.forkScoped(lL(e,t)))),uh=(0,f.dual)(e=>aA(e[0]),(e,t)=>o.tap(o.acquireRelease(E.bounded(t?.capacity??2),e=>E.shutdown(e)),t=>o.forkScoped(lP(e,t)))),um=(0,f.dual)(e=>aA(e[0]),(e,t)=>uy(e,I.defaultRuntime,t)),ug=(0,f.dual)(e=>aA(e[0]),(e,t)=>o.map(o.runtime(),r=>uy(e,r,t))),uy=(0,f.dual)(e=>aA(e[0]),(e,r,i)=>{let n,a,s=I.runFork(r),l=o.unsafeMakeLatch(!1);return new ReadableStream({start(r){(a=s(lR(e,e=>0===e.length?o.void:l.whenOpen(o.sync(()=>{for(let t of(l.unsafeClose(),e))r.enqueue(t);n(),n=void 0}))))).addObserver(e=>{try{"Failure"===e._tag?r.error(t.squash(e.cause)):r.close()}catch{}})},pull:()=>new Promise(e=>{n=e,o.runSync(l.open)}),cancel(){if(a)return o.runPromise(o.asVoid(d.interrupt(a)))}},i?.strategy)}),uS=(0,f.dual)(2,(e,t)=>new aF(ty.suspend(()=>{let i={ref:r.empty()},n={ref:!1},a=ty.suspend(()=>{let e=i.ref;return r.isEmpty(e)?ty.readWith({onInput:e=>(0,f.pipe)(ty.write(e),ty.flatMap(()=>a)),onFailure:ty.fail,onDone:ty.succeedNow}):(i.ref=r.empty(),(0,f.pipe)(tI.writeChunk(e),ty.flatMap(()=>a)))}),s=ty.readWith({onInput:e=>ty.flatMap(ty.write(e),()=>s),onFailure:ty.fail,onDone:e=>tI.zipRight(ty.sync(()=>{n.ref=!0}),ty.succeedNow(e))}),o=(0,f.pipe)(t,rJ,ty.collectElements,ty.flatMap(e=>{let t,a,[s,l]=e;return(0,f.pipe)(ty.succeed([n.ref,(t=i.ref,i.ref=a=r.appendAll(t,r.filter(s,e=>0!==e.length)),a)]),ty.flatMap(e=>{let[t,i]=e,n=t&&r.isEmpty(i)?ty.void:o;return(0,f.pipe)(ty.write(r.of(l)),ty.flatMap(()=>n))}))}));return(0,f.pipe)(sJ(e),ty.pipeTo(s),ty.pipeTo(a),tI.pipeToOrFail(o))}))),ub=(0,f.dual)(e=>aA(e[0]),(e,r)=>{let i=I.runFork(r);return{[Symbol.asyncIterator](){let r,n,a,s=o.unsafeMakeLatch(!1),l=!1;return{next:()=>(a||(a=i(lC(e,e=>s.whenOpen(o.sync(()=>{s.unsafeClose(),r({done:!1,value:e}),r=n=void 0}))))).addObserver(e=>{l||(a=o.runFork(s.whenOpen(o.sync(()=>{"Failure"===e._tag?n(t.squash(e.cause)):r({done:!0,value:void 0}),r=n=void 0}))))}),new Promise((e,t)=>{r=e,n=t,s.unsafeOpen()})),return:()=>(l=!0,a)?o.runPromise(o.as(d.interrupt(a),{done:!0,value:void 0})):Promise.resolve({done:!0,value:void 0})}}}}),uv=(e,t)=>uE(e,e=>(0,f.pipe)(t(e),y.map(e=>{let[t,i]=e;return[r.of(t),i]}))),uE=(e,t)=>{let r=e=>y.match(t(e),{onNone:()=>ty.void,onSome:e=>{let[t,i]=e;return ty.flatMap(ty.write(t),()=>r(i))}});return new aF(ty.suspend(()=>r(e)))},uw=(e,t)=>l1(()=>{let r=e=>tI.unwrap(o.map(t(e),y.match({onNone:()=>ty.void,onSome:e=>{let[t,i]=e;return ty.flatMap(ty.write(t),()=>r(i))}})));return new aF(r(e))}),uk=(e,t)=>uw(e,e=>(0,f.pipe)(t(e),o.map(y.map(e=>{let[t,i]=e;return[r.of(t),i]})))),uI=lX(void 0),uT=e=>sq(sY(e)),ux=e=>sq(lV(e)),uC=e=>sq(lH(t=>e(t))),uR=(0,f.dual)(3,(e,t,r)=>(0,f.pipe)(e,o9(e=>(0,f.pipe)(e,n.add(t,r((0,f.pipe)(e,n.unsafeGet(t)))))))),uF=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,uO(o.sync(t)))),uA=(0,f.dual)(2,(e,t)=>(0,f.pipe)(sY(e),sz(e=>(0,f.pipe)(t(e),y.getOrElse(()=>sw))))),uO=(0,f.dual)(2,(e,t)=>(0,f.pipe)(sY(t),sz(t=>t?e:sw))),u_=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,uG(t,(e,t)=>[e,t]))),uM=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,uG(t,(e,t)=>[...e,t]))),uD=(0,f.dual)(2,(e,t)=>uB(e,{other:t.other,onSelf:e=>[e,t.defaultOther],onOther:e=>[t.defaultSelf,e],onBoth:(e,t)=>[e,t]})),uN=(0,f.dual)(3,(e,t,r)=>uB(e,{other:t,onSelf:f.identity,onOther:()=>r,onBoth:e=>e})),uP=(0,f.dual)(3,(e,t,r)=>uB(e,{other:t,onSelf:()=>r,onOther:f.identity,onBoth:(e,t)=>t})),uL=(0,f.dual)(2,(e,t)=>uW(e,{other:t.other,onSelf:e=>[e,t.defaultOther],onOther:e=>[t.defaultSelf,e],onBoth:(e,t)=>[e,t],order:t.order})),uU=(0,f.dual)(2,(e,t)=>uW(e,{other:t.other,onSelf:f.identity,onOther:()=>t.defaultSelf,onBoth:e=>e,order:t.order})),uz=(0,f.dual)(2,(e,t)=>uW(e,{other:t.other,onSelf:()=>t.defaultOther,onOther:f.identity,onBoth:(e,t)=>t,order:t.order})),uW=(0,f.dual)(2,(e,t)=>{let i=(e,a,s)=>{switch(e._tag){case ac:return(0,f.pipe)(a,o.match({onFailure:c.fail,onSuccess:e=>c.succeed([r.map(e,e=>{let[r,i]=e;return[r,t.onSelf(i)]}),am])}));case ad:return(0,f.pipe)(s,o.match({onFailure:c.fail,onSuccess:e=>c.succeed([r.map(e,e=>{let[r,i]=e;return[r,t.onOther(i)]}),ag])}));case ap:return(0,f.pipe)(a7(a),o.zip(a7(s),{concurrent:!0}),o.matchEffect({onFailure:e=>o.succeed(c.fail(y.some(e))),onSuccess:e=>{let[l,u]=e;return y.isSome(l)&&y.isSome(u)?r.isEmpty(l.value)&&r.isEmpty(u.value)?i(ay,a,s):r.isEmpty(l.value)?i(aS(u.value),a,s):r.isEmpty(u.value)?i(ab(l.value),a,s):o.succeed(c.succeed(n(l.value,u.value))):y.isSome(l)&&y.isNone(u)?r.isEmpty(l.value)?i(am,a,s):o.succeed(c.succeed([(0,f.pipe)(l.value,r.map(e=>{let[r,i]=e;return[r,t.onSelf(i)]})),am])):y.isNone(l)&&y.isSome(u)?r.isEmpty(u.value)?i(ag,a,s):o.succeed(c.succeed([(0,f.pipe)(u.value,r.map(e=>{let[r,i]=e;return[r,t.onOther(i)]})),ag])):o.succeed(c.fail(y.none()))}}));case af:return o.matchEffect(a,{onFailure:y.match({onNone:()=>o.succeed(c.succeed([(0,f.pipe)(e.rightChunk,r.map(e=>{let[r,i]=e;return[r,t.onOther(i)]})),ag])),onSome:e=>o.succeed(c.fail(y.some(e)))}),onSuccess:t=>r.isEmpty(t)?i(aS(e.rightChunk),a,s):o.succeed(c.succeed(n(t,e.rightChunk)))});case ah:return o.matchEffect(s,{onFailure:y.match({onNone:()=>o.succeed(c.succeed([r.map(e.leftChunk,e=>{let[r,i]=e;return[r,t.onSelf(i)]}),am])),onSome:e=>o.succeed(c.fail(y.some(e)))}),onSuccess:t=>r.isEmpty(t)?i(ab(e.leftChunk),a,s):o.succeed(c.succeed(n(e.leftChunk,t)))})}},n=(e,i)=>{let n,a=(e,t)=>t<e.length-1,s=[],o=0,l=0,u=(0,f.pipe)(e,r.unsafeGet(o)),c=(0,f.pipe)(i,r.unsafeGet(l)),d=u[0],p=u[1],h=c[0],m=c[1],g=!0;for(;g;){let y=t.order(d,h);if(0===y)s.push([d,t.onBoth(p,m)]),a(e,o)&&a(i,l)?(o+=1,l+=1,u=(0,f.pipe)(e,r.unsafeGet(o)),c=(0,f.pipe)(i,r.unsafeGet(l)),d=u[0],p=u[1],h=c[0],m=c[1]):(n=a(e,o)?ab((0,f.pipe)(e,r.drop(o+1))):a(i,l)?aS((0,f.pipe)(i,r.drop(l+1))):ay,g=!1);else if(y<0)if(s.push([d,t.onSelf(p)]),a(e,o))o+=1,d=(u=(0,f.pipe)(e,r.unsafeGet(o)))[0],p=u[1];else{let e=[];for(e.push(c);a(i,l);)l+=1,c=(0,f.pipe)(i,r.unsafeGet(l)),e.push(c);n=aS(r.unsafeFromArray(e)),g=!1}else if(s.push([h,t.onOther(m)]),a(i,l))l+=1,h=(c=(0,f.pipe)(i,r.unsafeGet(l)))[0],m=c[1];else{let t=[];for(t.push(u);a(e,o);)o+=1,u=(0,f.pipe)(e,r.unsafeGet(o)),t.push(u);n=ab(r.unsafeFromArray(t)),g=!1}}return[r.unsafeFromArray(s),n]};return st(e,t.other,ay,i)}),uB=(0,f.dual)(2,(e,t)=>{let i=(e,a,s)=>{switch(e._tag){case ac:return o.matchEffect(a,{onFailure:e=>o.succeed(c.fail(e)),onSuccess:e=>o.succeed(c.succeed([r.map(e,t.onSelf),am]))});case ad:return o.matchEffect(s,{onFailure:e=>o.succeed(c.fail(e)),onSuccess:e=>o.succeed(c.succeed([r.map(e,t.onOther),ag]))});case ap:return(0,f.pipe)(a7(a),o.zip(a7(s),{concurrent:!0}),o.matchEffect({onFailure:e=>o.succeed(c.fail(y.some(e))),onSuccess:e=>{let[l,u]=e;return y.isSome(l)&&y.isSome(u)?r.isEmpty(l.value)&&r.isEmpty(u.value)?i(ay,a,s):r.isEmpty(l.value)?i(aS(u.value),a,s):r.isEmpty(u.value)?i(ab(l.value),a,s):o.succeed(c.succeed(n(l.value,u.value,t.onBoth))):y.isSome(l)&&y.isNone(u)?o.succeed(c.succeed([r.map(l.value,t.onSelf),am])):y.isNone(l)&&y.isSome(u)?o.succeed(c.succeed([r.map(u.value,t.onOther),ag])):o.succeed(c.fail(y.none()))}}));case af:return o.matchEffect(a,{onFailure:y.match({onNone:()=>o.succeed(c.succeed([r.map(e.rightChunk,t.onOther),ag])),onSome:e=>o.succeed(c.fail(y.some(e)))}),onSuccess:l=>r.isEmpty(l)?i(aS(e.rightChunk),a,s):r.isEmpty(e.rightChunk)?i(ab(l),a,s):o.succeed(c.succeed(n(l,e.rightChunk,t.onBoth)))});case ah:return o.matchEffect(s,{onFailure:y.match({onNone:()=>o.succeed(c.succeed([r.map(e.leftChunk,t.onSelf),am])),onSome:e=>o.succeed(c.fail(y.some(e)))}),onSuccess:l=>r.isEmpty(l)?i(ab(e.leftChunk),a,s):r.isEmpty(e.leftChunk)?i(aS(l),a,s):o.succeed(c.succeed(n(e.leftChunk,l,t.onBoth)))})}},n=(e,t,i)=>{let[n,a]=uQ(e,t,i);switch(a._tag){case"Left":if(r.isEmpty(a.left))return[n,ay];return[n,ab(a.left)];case"Right":if(r.isEmpty(a.right))return[n,ay];return[n,aS(a.right)]}};return st(e,t.other,ay,i)}),uq=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,uj(t,(e,t)=>[e,t]))),u$=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(0===t.length)return sw;if(1===t.length)return op(t[0],e=>[e]);let[i,...n]=t;return uj(i,u$(...n),(e,t)=>[e,...t])},uj=(0,f.dual)(3,(e,t,i)=>{let n=e=>(0,f.pipe)(e,o.flatMap(t=>r.isEmpty(t)?n(e):o.succeed(t)));return(0,f.pipe)(up(e),o.map(n),o.zip((0,f.pipe)(up(t),o.map(n))),o.flatMap(e=>{let[t,n]=e;return(0,f.pipe)(sX(o.raceWith(t,n,{onSelfDone:(e,t)=>(0,f.pipe)(o.suspend(()=>e),o.zipWith(d.join(t),(e,t)=>[e,t,!0])),onOtherDone:(e,t)=>(0,f.pipe)(o.suspend(()=>e),o.zipWith(d.join(t),(e,t)=>[t,e,!1]))})),sz(e=>{let[a,s,o]=e;return(0,f.pipe)(sY(k.make([r.unsafeLast(a),r.unsafeLast(s)])),sz(e=>(0,f.pipe)(sZ(o?(0,f.pipe)(s,r.map(e=>i(r.unsafeLast(a),e))):(0,f.pipe)(a,r.map(e=>i(e,r.unsafeLast(s))))),sr((0,f.pipe)(lu(t),oF(lu(n)),ow(l.match({onLeft:t=>k.modify(e,e=>{let[n,a]=e;return[(0,f.pipe)(t,r.map(e=>i(e,a))),[r.unsafeLast(t),a]]}),onRight:t=>k.modify(e,e=>{let[n,a]=e;return[(0,f.pipe)(t,r.map(e=>i(n,e))),[n,r.unsafeLast(t)]]})})),sz(sZ))))))}),up)}),s5)}),uV=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,uK(t,(e,t)=>e.length>t.length?[(0,f.pipe)(e,r.take(t.length)),l.left((0,f.pipe)(e,r.take(t.length)))]:[e,l.right((0,f.pipe)(t,r.drop(e.length)))]))),uH=(0,f.dual)(2,(e,t)=>(0,f.pipe)(e,uK(t,(e,t)=>e.length>t.length?[t,l.left((0,f.pipe)(e,r.take(t.length)))]:[(0,f.pipe)(t,r.take(e.length)),l.right((0,f.pipe)(t,r.drop(e.length)))]))),uG=(0,f.dual)(3,(e,t,r)=>(0,f.pipe)(e,uK(t,(e,t)=>uQ(e,t,r)))),uK=(0,f.dual)(3,(e,t,i)=>{let n=(e,t,i)=>{switch(e._tag){case av:return(0,f.pipe)(a7(t),o.zip(a7(i),{concurrent:!0}),o.matchEffect({onFailure:e=>o.succeed(c.fail(y.some(e))),onSuccess:e=>{let[s,l]=e;return y.isSome(s)&&y.isSome(l)?r.isEmpty(s.value)&&r.isEmpty(l.value)?n(ak,t,i):r.isEmpty(s.value)?n(aI(l.value),t,i):r.isEmpty(l.value)?n(aT(s.value),t,i):o.succeed(c.succeed(a(s.value,l.value))):o.succeed(c.fail(y.none()))}}));case aE:return o.matchEffect(t,{onFailure:e=>o.succeed(c.fail(e)),onSuccess:s=>r.isEmpty(s)?n(aI(e.rightChunk),t,i):r.isEmpty(e.rightChunk)?n(aT(s),t,i):o.succeed(c.succeed(a(s,e.rightChunk)))});case aw:return o.matchEffect(i,{onFailure:e=>o.succeed(c.fail(e)),onSuccess:s=>r.isEmpty(s)?n(aT(e.leftChunk),t,i):r.isEmpty(e.leftChunk)?n(aI(s),t,i):o.succeed(c.succeed(a(e.leftChunk,s)))})}},a=(e,t)=>{let[n,a]=i(e,t);switch(a._tag){case"Left":if(r.isEmpty(a.left))return[n,ak];return[n,aT(a.left)];case"Right":if(r.isEmpty(a.right))return[n,ak];return[n,aI(a.right)]}};return(0,f.pipe)(e,st(t,ak,n))}),uJ=e=>{let t=e=>ty.readWithCause({onInput:i=>{let[n,a]=r.mapAccum(i,e,(e,t)=>[y.some(t),(0,f.pipe)(e,y.map(e=>[e,t]))]),s=r.filterMap(a,e=>y.isSome(e)?y.some([e.value[0],y.some(e.value[1])]):y.none());return ty.flatMap(ty.write(s),()=>t(n))},onFailure:ty.failCause,onDone:()=>y.match(e,{onNone:()=>ty.void,onSome:e=>tI.zipRight(ty.write(r.of([e,y.none()])),ty.void)})});return new aF((0,f.pipe)(sJ(e),tI.pipeToOrFail(t(y.none()))))},uZ=e=>(0,f.pipe)(e,of(y.none(),(e,t)=>[y.some(t),[e,t]])),uQ=(e,t,i)=>e.length>t.length?[(0,f.pipe)(e,r.take(t.length),r.zipWith(t,i)),l.left((0,f.pipe)(e,r.drop(t.length)))]:[(0,f.pipe)(e,r.zipWith((0,f.pipe)(t,r.take(e.length)),i)),l.right((0,f.pipe)(t,r.drop(e.length)))],uY=lX({}),uX=(0,f.dual)(e=>"string"!=typeof e[0],(e,t,r,i)=>sz(e,e=>op(r(e),r=>({...e,[t]:r})),i)),u0=nL.bindTo(op),u1=nL.let_(op),u2=(0,f.dual)(e=>aA(e[0]),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return l1(()=>{let r=new TextDecoder(t);return op(e,e=>r.decode(e))})});e.s(["DefaultChunkSize",0,4096,"Do",0,uY,"StreamTypeId",0,aC,"_async",0,(e,r)=>o.acquireRelease(aL(r),e=>E.shutdown(e)).pipe(o.flatMap(r=>o.runtime().pipe(o.flatMap(i=>o.sync(()=>{let n=I.runPromiseExit(i);return e(n$(e=>at(e).pipe(o.flatMap(e=>E.offer(r,e)),o.asVoid,n).then(e=>{if(c.isFailure(e)&&!t.isInterrupted(e.cause))throw t.squash(e.cause)})))})),o.map(e=>{let t=E.take(r).pipe(o.flatMap(e=>n9(e)),o.match({onFailure:e=>ty.fromEffect(E.shutdown(r)).pipe(tI.zipRight(y.match(e,{onNone:()=>ty.void,onSome:e=>ty.fail(e)}))),onSuccess:e=>ty.write(e).pipe(ty.flatMap(()=>t))}),tI.unwrap);return sK(t).pipe(sk(e??o.void))}))),ux),"accumulate",0,e=>a6(aO(e)),"accumulateChunks",0,aO,"acquireRelease",0,a_,"aggregate",0,aM,"aggregateWithin",0,aD,"aggregateWithinEither",0,aN,"as",0,aP,"asyncEffect",0,(e,r)=>(0,f.pipe)(o.acquireRelease(aL(r),e=>E.shutdown(e)),o.flatMap(r=>(0,f.pipe)(o.runtime(),o.flatMap(i=>(0,f.pipe)(e(n$(e=>(0,f.pipe)(at(e),o.flatMap(e=>E.offer(r,e)),o.asVoid,I.runPromiseExit(i)).then(e=>{if(c.isFailure(e)&&!t.isInterrupted(e.cause))throw t.squash(e.cause)}))),o.map(()=>{let e=(0,f.pipe)(E.take(r),o.flatMap(n9),o.match({onFailure:e=>(0,f.pipe)(ty.fromEffect(E.shutdown(r)),tI.zipRight(y.match(e,{onNone:()=>ty.void,onSome:ty.fail}))),onSuccess:t=>(0,f.pipe)(ty.write(t),ty.flatMap(()=>e))}),tI.unwrap);return e}))))),tI.unwrapScoped,sK),"asyncPush",0,aU,"asyncScoped",0,(e,r)=>(0,f.pipe)(o.acquireRelease(aL(r),e=>E.shutdown(e)),o.flatMap(r=>(0,f.pipe)(o.runtime(),o.flatMap(i=>(0,f.pipe)(e(n$(e=>(0,f.pipe)(at(e),o.flatMap(e=>E.offer(r,e)),o.asVoid,I.runPromiseExit(i)).then(e=>{if(c.isFailure(e)&&!t.isInterrupted(e.cause))throw t.squash(e.cause)}))),o.zipRight(k.make(!1)),o.flatMap(e=>(0,f.pipe)(k.get(e),o.map(t=>t?an():(0,f.pipe)(E.take(r),o.flatMap(n9),o.onError(()=>(0,f.pipe)(k.set(e,!0),o.zipRight(E.shutdown(r)))))))))))),lV,sz(ll)),"bind",0,uX,"bindTo",0,u0,"branchAfter",0,az,"broadcast",0,aW,"broadcastDynamic",0,aB,"broadcastedQueues",0,a$,"broadcastedQueuesDynamic",0,aj,"buffer",0,aV,"bufferChunks",0,aH,"catchAll",0,aX,"catchAllCause",0,a0,"catchSome",0,a1,"catchSomeCause",0,a2,"catchTag",0,a5,"catchTags",0,a3,"changes",0,e=>(0,f.pipe)(e,a8((e,t)=>u.equals(t)(e))),"changesWith",0,a8,"changesWithEffect",0,a4,"channelToStream",0,e=>new aF(e),"chunks",0,a6,"chunksWith",0,a9,"combine",0,se,"combineChunks",0,st,"concat",0,sr,"concatAll",0,e=>l1(()=>(0,f.pipe)(e,r.reduce(sw,(e,t)=>sr(t)(e)))),"context",0,sT,"contextWith",0,e=>(0,f.pipe)(sT(),op(e)),"contextWithEffect",0,e=>(0,f.pipe)(sT(),ow(e)),"contextWithStream",0,sx,"cross",0,si,"crossLeft",0,sn,"crossRight",0,sa,"crossWith",0,ss,"debounce",0,so,"decodeText",0,u2,"die",0,sl,"dieMessage",0,e=>sY(o.dieMessage(e)),"dieSync",0,e=>sY(o.dieSync(e)),"distributedWith",0,su,"distributedWithDynamic",0,sp,"distributedWithDynamicCallback",0,sf,"drain",0,sh,"drainFork",0,sm,"drop",0,sg,"dropRight",0,sy,"dropUntil",0,sS,"dropUntilEffect",0,sb,"dropWhile",0,sv,"dropWhileEffect",0,sE,"either",0,e=>(0,f.pipe)(e,op(l.right),aX(e=>od(l.left(e)))),"empty",0,sw,"encodeText",0,e=>l1(()=>{let t=new TextEncoder;return op(e,e=>t.encode(e))}),"ensuring",0,sk,"ensuringWith",0,sI,"execute",0,sC,"fail",0,sR,"failCause",0,sA,"failCauseSync",0,e=>sY(o.failCauseSync(e)),"failSync",0,sF,"filter",0,sO,"filterEffect",0,s_,"filterMap",0,sM,"filterMapEffect",0,sD,"filterMapWhile",0,sN,"filterMapWhileEffect",0,sP,"finalizer",0,e=>a_(o.void,()=>e),"find",0,sL,"findEffect",0,sU,"flatMap",0,sz,"flatten",0,sq,"flattenChunks",0,s$,"flattenEffect",0,sj,"flattenExitOption",0,sV,"flattenIterables",0,e=>(0,f.pipe)(e,op(r.fromIterable),s$),"flattenTake",0,sH,"forever",0,sG,"fromAsyncIterable",0,(e,t)=>(0,f.pipe)(o.acquireRelease(o.sync(()=>e[Symbol.asyncIterator]()),e=>e.return?o.promise(async()=>e.return()):o.void),o.map(e=>lu((0,f.pipe)(o.tryPromise({try:async()=>e.next(),catch:e=>y.some(t(e))}),o.flatMap(e=>e.done?o.fail(y.none()):o.succeed(e.value))))),ux),"fromChannel",0,sK,"fromChunk",0,sZ,"fromChunkPubSub",0,(e,t)=>{if(t?.scoped){let r=o.map(v.subscribe(e),sQ);return t.shutdown?o.map(r,sk(v.shutdown(e))):r}let r=sz(lV(v.subscribe(e)),sQ);return t?.shutdown?sk(r,v.shutdown(e)):r},"fromChunkQueue",0,sQ,"fromChunks",0,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,f.pipe)(s1(t),sz(sZ))},"fromEffect",0,sY,"fromEffectOption",0,sX,"fromEventListener",0,(e,t,r)=>aU(i=>o.acquireRelease(o.sync(()=>e.addEventListener(t,i.single,r)),()=>o.sync(()=>e.removeEventListener(t,i.single,r))),{bufferSize:"object"==typeof r?r.bufferSize:void 0}),"fromIterable",0,s1,"fromIterableEffect",0,e=>(0,f.pipe)(e,o.map(s1),uT),"fromIteratorSucceed",0,s2,"fromPubSub",0,s0,"fromPull",0,s5,"fromQueue",0,s3,"fromReadableStream",0,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let i=1===t.length?t[0].evaluate:t[0],n=1===t.length?t[0].onError:t[1],a=1===t.length&&!0===t[0].releaseLockOnEnd;return ux(o.map(o.acquireRelease(o.sync(()=>i().getReader()),e=>a?o.sync(()=>e.releaseLock()):o.promise(()=>e.cancel())),e=>lu(o.flatMap(o.tryPromise({try:()=>e.read(),catch:e=>y.some(n(e))}),e=>{let{done:t,value:r}=e;return t?o.fail(y.none()):o.succeed(r)}))))},"fromReadableStreamByob",0,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let i=1===t.length?t[0].evaluate:t[0],n=1===t.length?t[0].onError:t[1],a=(1===t.length?t[0].bufferSize:t[2])??4096,s=1===t.length&&!0===t[0].releaseLockOnEnd;return ux(o.map(o.acquireRelease(o.sync(()=>i().getReader({mode:"byob"})),e=>s?o.sync(()=>e.releaseLock()):o.promise(()=>e.cancel())),e=>{var t,r;let i;return aX(sG((t=e,r=n,i=new ArrayBuffer(a),oK(0,e=>o.flatMap(o.tryPromise({try:()=>t.read(new Uint8Array(i,e,i.byteLength-e)),catch:e=>r(e)}),t=>{let{done:r,value:n}=t;if(r)return o.fail(s4);let a=e+n.byteLength;return o.succeed([n,a>=i.byteLength?y.none():y.some(a)])})))),e=>e===s4?sw:sR(e))}))},"fromSchedule",0,e=>(0,f.pipe)(el(e),o.map(e=>lu(e.next(void 0))),uT),"fromTPubSub",0,e=>{let t,r,i,n,a,s;return ux(o.map(o.acquireRelease((t=e.pubsubSize,r=e.publisherHead,i=e.publisherTail,n=e.requestedCapacity,a=e.subscriberCount,s=e.subscribers,(0,f.pipe)(nk(i),nr(e=>{let i,o;return(0,f.pipe)(Symbol.iterator in(i=[i9(t=>{let r=new nw(e);return t.set(r,r6(r,!0)),r}),nk(a),nk(s)])?nm(i,f.identity,o):o?.discard?nm(Object.values(i),f.identity,o):ns(nm(Object.entries(i),e=>{let[t,r]=e;return ns(r,e=>[t,e])}),e=>{let t={};for(let[r,i]of e)t[r]=i;return t}),nS(e=>{let[t,r]=e;return(0,f.pipe)(a,nI(r+1))}),nS(e=>{let[t,r,i]=e;return(0,f.pipe)(s,nI((0,f.pipe)(i,th.add(t))))}),ns(e=>{let[i]=e;return new nM(t,r,n,i,a,s)}))}))),e=>e.shutdown),e=>s8(e)))},"fromTQueue",0,s8,"groupAdjacentBy",0,s6,"grouped",0,s9,"groupedWithin",0,s7,"haltAfter",0,ot,"haltWhen",0,oe,"haltWhenDeferred",0,or,"identityStream",0,oi,"interleave",0,on,"interleaveWith",0,oa,"interruptAfter",0,ol,"interruptWhen",0,ou,"interruptWhenDeferred",0,oc,"intersperse",0,os,"intersperseAffixes",0,oo,"isStream",0,aA,"iterate",0,(e,t)=>uv(e,e=>y.some([e,t(e)])),"let_",0,u1,"make",0,od,"map",0,op,"mapAccum",0,of,"mapAccumEffect",0,oh,"mapBoth",0,om,"mapChunks",0,og,"mapChunksEffect",0,oy,"mapConcat",0,oS,"mapConcatChunk",0,ob,"mapConcatChunkEffect",0,ov,"mapConcatEffect",0,oE,"mapEffectPar",0,ok,"mapEffectSequential",0,ow,"mapError",0,oI,"mapErrorCause",0,oT,"mapInputContext",0,o9,"matchConcurrency",0,sW,"merge",0,ox,"mergeAll",0,oC,"mergeEither",0,oF,"mergeLeft",0,oA,"mergeRight",0,oO,"mergeWith",0,o_,"mergeWithTag",0,oR,"mkString",0,e=>lS(e,r3),"never",0,oM,"onDone",0,oP,"onEnd",0,oD,"onError",0,oN,"onStart",0,oL,"orDie",0,e=>(0,f.pipe)(e,oU(f.identity)),"orDieWith",0,oU,"orElse",0,oz,"orElseEither",0,oW,"orElseFail",0,oB,"orElseIfEmpty",0,oq,"orElseIfEmptyChunk",0,o$,"orElseIfEmptyStream",0,oj,"orElseSucceed",0,oV,"paginate",0,(e,t)=>oH(e,e=>{let i=t(e);return[r.of(i[0]),i[1]]}),"paginateChunk",0,oH,"paginateChunkEffect",0,oG,"paginateEffect",0,oK,"partition",0,oZ,"partitionEither",0,oQ,"peel",0,oJ,"pipeThrough",0,oY,"pipeThroughChannel",0,oX,"pipeThroughChannelOrFail",0,o0,"prepend",0,o1,"provideContext",0,o2,"provideLayer",0,o3,"provideService",0,o8,"provideServiceEffect",0,o4,"provideServiceStream",0,o6,"provideSomeContext",0,o5,"provideSomeLayer",0,o7,"race",0,le,"raceAll",0,lt,"range",0,function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4096;return l1(()=>{if(e>t)return sw;let n=(e,t,i)=>{let a=t-e+1;return a>i?(0,f.pipe)(ty.write(r.range(e,e+i-1)),ty.flatMap(()=>n(e+i,t,i))):ty.write(r.range(e,e+a-1))};return new aF(n(e,t,i))})},"rechunk",0,lr,"refineOrDie",0,la,"refineOrDieWith",0,ls,"repeat",0,lo,"repeatEffect",0,e=>lu((0,f.pipe)(e,o.mapError(y.some))),"repeatEffectChunk",0,e=>ll((0,f.pipe)(e,o.mapError(y.some))),"repeatEffectChunkOption",0,ll,"repeatEffectOption",0,lu,"repeatEffectWithSchedule",0,lh,"repeatEither",0,lc,"repeatElements",0,ld,"repeatElementsWith",0,lp,"repeatValue",0,e=>new aF(tI.repeated(ty.write(r.of(e)))),"repeatWith",0,lf,"retry",0,lm,"run",0,lS,"runCollect",0,e=>lS(e,t_()),"runCount",0,e=>lS(e,r5),"runDrain",0,e=>lS(e,tJ),"runFold",0,lb,"runFoldEffect",0,lv,"runFoldScoped",0,lE,"runFoldScopedEffect",0,lw,"runFoldWhile",0,lk,"runFoldWhileEffect",0,lI,"runFoldWhileScoped",0,lT,"runFoldWhileScopedEffect",0,lx,"runForEach",0,lC,"runForEachChunk",0,lR,"runForEachChunkScoped",0,lF,"runForEachScoped",0,lA,"runForEachWhile",0,lO,"runForEachWhileScoped",0,l_,"runHead",0,e=>lS(e,rF()),"runIntoPubSub",0,lM,"runIntoPubSubScoped",0,lD,"runIntoQueue",0,lN,"runIntoQueueElementsScoped",0,lP,"runIntoQueueScoped",0,lL,"runLast",0,e=>lS(e,rO()),"runScoped",0,lU,"runSum",0,e=>lS(e,rG),"scan",0,lz,"scanEffect",0,lj,"scanReduce",0,lW,"scanReduceEffect",0,lB,"schedule",0,lq,"scheduleWith",0,l$,"scoped",0,lV,"scopedWith",0,lH,"share",0,aq,"sliding",0,lJ,"slidingSize",0,lZ,"some",0,e=>(0,f.pipe)(e,oI(y.some),lK(()=>y.none())),"someOrElse",0,lG,"someOrFail",0,lK,"split",0,lQ,"splitLines",0,e=>oX(e,tI.splitLines()),"splitOnChunk",0,lY,"succeed",0,lX,"suspend",0,l1,"sync",0,l0,"take",0,l2,"takeRight",0,l5,"takeUntil",0,l3,"takeUntilEffect",0,l8,"takeWhile",0,l4,"tap",0,l6,"tapBoth",0,l9,"tapError",0,l7,"tapErrorCause",0,ue,"tapSink",0,ut,"throttle",0,ur,"throttleEffect",0,ui,"tick",0,e=>{let t,r;return t=void 0,r=eZ(e),lh(o.succeed(t),r)},"timeout",0,us,"timeoutFail",0,uo,"timeoutFailCause",0,ul,"timeoutTo",0,uu,"toAsyncIterable",0,e=>ub(e,I.defaultRuntime),"toAsyncIterableEffect",0,e=>o.map(o.runtime(),t=>ub(e,t)),"toAsyncIterableRuntime",0,ub,"toChannel",0,sJ,"toPubSub",0,ud,"toPull",0,up,"toQueue",0,uf,"toQueueOfElements",0,uh,"toReadableStream",0,um,"toReadableStreamEffect",0,ug,"toReadableStreamRuntime",0,uy,"transduce",0,uS,"unfold",0,uv,"unfoldChunk",0,uE,"unfoldChunkEffect",0,uw,"unfoldEffect",0,uk,"unwrap",0,uT,"unwrapScoped",0,ux,"unwrapScopedWith",0,uC,"updateService",0,uR,"void",0,uI,"when",0,uF,"whenCase",0,(e,t)=>uA(t)(o.sync(e)),"whenCaseEffect",0,uA,"whenEffect",0,uO,"withExecutionPlan",0,lg,"withSpan",0,function(){let e="string"!=typeof arguments[0],t=e?arguments[1]:arguments[0],r=ax.addSpanStackTrace(e?arguments[2]:arguments[1]);if(e){let e=arguments[0];return new aF(tI.withSpan(sJ(e),t,r))}return e=>new aF(tI.withSpan(sJ(e),t,r))},"zip",0,u_,"zipAll",0,uD,"zipAllLeft",0,uN,"zipAllRight",0,uP,"zipAllSortedByKey",0,uL,"zipAllSortedByKeyLeft",0,uU,"zipAllSortedByKeyRight",0,uz,"zipAllSortedByKeyWith",0,uW,"zipAllWith",0,uB,"zipFlatten",0,uM,"zipLatest",0,uq,"zipLatestAll",0,u$,"zipLatestWith",0,uj,"zipLeft",0,uV,"zipRight",0,uH,"zipWith",0,uG,"zipWithChunks",0,uK,"zipWithIndex",0,e=>(0,f.pipe)(e,of(0,(e,t)=>[e+1,[t,e]])),"zipWithNext",0,uJ,"zipWithPrevious",0,uZ,"zipWithPreviousAndNext",0,e=>(0,f.pipe)(uJ(uZ(e)),op(e=>{let[[t,r],i]=e;return[t,r,(0,f.pipe)(i,y.map(e=>e[1]))]}))],469137)},1737036,e=>{"use strict";var t=e.i(5283034),r=e.i(5450905),i=e.i(7862555),n=e.i(7525378),a=e.i(3683485),s=e.i(2873450),o=e.i(6816077),l=e.i(8815901),u=e.i(9960543),c=e.i(4935619),d=e.i(6091153),p=(e.i(6379322),e.i(8884753)),f=e.i(7548658),h=(e.i(4026828),e.i(1658800),e.i(469137));let m=Symbol.for("effect/Mailbox"),g=Symbol.for("effect/Mailbox/ReadonlyMailbox"),y=i.empty(),S=f.exitSucceed(y),b=f.exitSucceed(!1),v=f.exitSucceed(!0),E=[y,!0];class w extends n.Class{scheduler;capacity;strategy;[m]=m;[g]=g;state={_tag:"Open",takers:new Set,offers:new Set,awaiters:new Set};messages=[];messagesChunk=i.empty();constructor(e,t,r){super(),this.scheduler=e,this.capacity=t,this.strategy=r}offer(e){return f.suspend(()=>{if("Open"!==this.state._tag)return b;if(this.messages.length+this.messagesChunk.length>=this.capacity)switch(this.strategy){case"dropping":return b;case"suspend":if(this.capacity<=0&&this.state.takers.size>0)return this.messages.push(e),this.releaseTaker(),v;return this.offerRemainingSingle(e);case"sliding":return this.unsafeTake(),this.messages.push(e),v}return this.messages.push(e),this.scheduleReleaseTaker(),v})}unsafeOffer(e){return"Open"===this.state._tag&&(this.messages.length+this.messagesChunk.length>=this.capacity?"sliding"===this.strategy?(this.unsafeTake(),this.messages.push(e),!0):this.capacity<=0&&this.state.takers.size>0&&(this.messages.push(e),this.releaseTaker(),!0):(this.messages.push(e),this.scheduleReleaseTaker(),!0))}offerAll(e){return f.suspend(()=>{if("Open"!==this.state._tag)return f.succeed(i.fromIterable(e));let t=this.unsafeOfferAllArray(e);return 0===t.length?S:"dropping"===this.strategy?f.succeed(i.unsafeFromArray(t)):this.offerRemainingArray(t)})}unsafeOfferAll(e){return i.unsafeFromArray(this.unsafeOfferAllArray(e))}unsafeOfferAllArray(e){if("Open"!==this.state._tag)return t.fromIterable(e);if(this.capacity===1/0||"sliding"===this.strategy)return this.messages.length>0&&(this.messagesChunk=i.appendAll(this.messagesChunk,i.unsafeFromArray(this.messages))),"sliding"===this.strategy?this.messagesChunk=this.messagesChunk.pipe(i.appendAll(i.fromIterable(e)),i.takeRight(this.capacity)):i.isChunk(e)?this.messagesChunk=i.appendAll(this.messagesChunk,e):this.messages=t.fromIterable(e),this.scheduleReleaseTaker(),[];let r=this.capacity<=0?this.state.takers.size:this.capacity-this.messages.length-this.messagesChunk.length;if(0===r)return t.fromIterable(e);let n=[],a=0;for(let t of e)a<r?this.messages.push(t):n.push(t),a++;return this.scheduleReleaseTaker(),n}fail(e){return this.done(f.exitFail(e))}failCause(e){return this.done(f.exitFailCause(e))}unsafeDone(e){return"Open"===this.state._tag&&(0===this.state.offers.size&&0===this.messages.length&&0===this.messagesChunk.length?this.finalize(e):this.state={...this.state,_tag:"Closing",exit:e},!0)}shutdown=f.sync(()=>{if("Done"===this.state._tag)return!0;this.messages=[],this.messagesChunk=y;let e=this.state.offers;if(this.finalize("Open"===this.state._tag?f.exitVoid:this.state.exit),e.size>0){for(let t of e)"Single"===t._tag?t.resume(b):t.resume(f.exitSucceed(i.unsafeFromArray(t.remaining.slice(t.offset))));e.clear()}return!0});done(e){return f.sync(()=>this.unsafeDone(e))}end=this.done(f.exitVoid);clear=f.suspend(()=>{if("Done"===this.state._tag)return f.exitAs(this.state.exit,y);let e=this.unsafeTakeAll();return this.releaseCapacity(),f.succeed(e)});takeAll=f.suspend(()=>{if("Done"===this.state._tag)return f.exitAs(this.state.exit,E);let e=this.unsafeTakeAll();return 0===e.length?f.zipRight(this.awaitTake,this.takeAll):f.succeed([e,this.releaseCapacity()])});takeN(e){return f.suspend(()=>{let t;if("Done"===this.state._tag)return f.exitAs(this.state.exit,E);if(e<=0)return f.succeed([y,!1]);if((e=Math.min(e,this.capacity))<=this.messagesChunk.length)t=i.take(this.messagesChunk,e),this.messagesChunk=i.drop(this.messagesChunk,e);else{if(!(e<=this.messages.length+this.messagesChunk.length))return f.zipRight(this.awaitTake,this.takeN(e));this.messagesChunk=i.appendAll(this.messagesChunk,i.unsafeFromArray(this.messages)),this.messages=[],t=i.take(this.messagesChunk,e),this.messagesChunk=i.drop(this.messagesChunk,e)}return f.succeed([t,this.releaseCapacity()])})}unsafeTake(){let e;if("Done"===this.state._tag)return f.exitZipRight(this.state.exit,f.exitFail(new r.NoSuchElementException));if(this.messagesChunk.length>0)e=i.unsafeHead(this.messagesChunk),this.messagesChunk=i.drop(this.messagesChunk,1);else if(this.messages.length>0)e=this.messages[0],this.messagesChunk=i.drop(i.unsafeFromArray(this.messages),1),this.messages=[];else if(this.capacity<=0&&this.state.offers.size>0)return this.capacity=1,this.releaseCapacity(),this.capacity=0,this.messages.length>0?f.exitSucceed(this.messages.pop()):void 0;else return;return this.releaseCapacity(),f.exitSucceed(e)}take=f.suspend(()=>this.unsafeTake()??f.zipRight(this.awaitTake,this.take));await=f.asyncInterrupt(e=>"Done"===this.state._tag?e(this.state.exit):(this.state.awaiters.add(e),f.sync(()=>{"Done"!==this.state._tag&&this.state.awaiters.delete(e)})));unsafeSize(){let e=this.messages.length+this.messagesChunk.length;return"Done"===this.state._tag?l.none():l.some(e)}size=f.sync(()=>this.unsafeSize());commit(){return this.takeAll}pipe(){return(0,u.pipeArguments)(this,arguments)}toJSON(){return{_id:"effect/Mailbox",state:this.state._tag,size:this.unsafeSize().toJSON()}}toString(){return s.format(this)}[s.NodeInspectSymbol](){return s.format(this)}offerRemainingSingle(e){return f.asyncInterrupt(t=>{if("Open"!==this.state._tag)return t(b);let r={_tag:"Single",message:e,resume:t};return this.state.offers.add(r),f.sync(()=>{"Open"===this.state._tag&&this.state.offers.delete(r)})})}offerRemainingArray(e){return f.asyncInterrupt(t=>{if("Open"!==this.state._tag)return t(f.exitSucceed(i.unsafeFromArray(e)));let r={_tag:"Array",remaining:e,offset:0,resume:t};return this.state.offers.add(r),f.sync(()=>{"Open"===this.state._tag&&this.state.offers.delete(r)})})}releaseCapacity(){if("Done"===this.state._tag)return"Success"===this.state.exit._tag;if(0===this.state.offers.size)return"Closing"===this.state._tag&&0===this.messages.length&&0===this.messagesChunk.length&&(this.finalize(this.state.exit),"Success"===this.state.exit._tag);let e=this.capacity-this.messages.length-this.messagesChunk.length;for(let t of this.state.offers)if(0===e)break;else if("Single"===t._tag)this.messages.push(t.message),e--,t.resume(v),this.state.offers.delete(t);else{for(;t.offset<t.remaining.length;t.offset++){if(0===e)return!1;this.messages.push(t.remaining[t.offset]),e--}t.resume(S),this.state.offers.delete(t)}return!1}awaitTake=f.asyncInterrupt(e=>"Done"===this.state._tag?e(this.state.exit):(this.state.takers.add(e),f.sync(()=>{"Done"!==this.state._tag&&this.state.takers.delete(e)})));scheduleRunning=!1;scheduleReleaseTaker(){this.scheduleRunning||(this.scheduleRunning=!0,this.scheduler.scheduleTask(this.releaseTaker,0))}releaseTaker=()=>{if(this.scheduleRunning=!1,"Done"===this.state._tag||0===this.state.takers.size)return;let e=o.unsafeHead(this.state.takers);this.state.takers.delete(e),e(f.exitVoid)};unsafeTakeAll(){if(this.messagesChunk.length>0){let e=this.messages.length>0?i.appendAll(this.messagesChunk,i.unsafeFromArray(this.messages)):this.messagesChunk;return this.messagesChunk=y,this.messages=[],e}if(this.messages.length>0){let e=i.unsafeFromArray(this.messages);return this.messages=[],e}return"Done"!==this.state._tag&&this.state.offers.size>0?(this.capacity=1,this.releaseCapacity(),this.capacity=0,i.of(this.messages.pop())):y}finalize(e){if("Done"===this.state._tag)return;let t=this.state;for(let r of(this.state={_tag:"Done",exit:e},t.takers))r(e);for(let r of(t.takers.clear(),t.awaiters))r(e);t.awaiters.clear()}}let k=(0,a.dual)(2,(e,t)=>f.uninterruptibleMask(r=>f.matchCauseEffect(r(e),{onFailure:e=>t.failCause(e),onSuccess:e=>t.end}))),I=e=>{let t=p.flatMap(e.takeAll,e=>{let[r,i]=e;return i?0===r.length?p.void:p.write(r):d.zipRight(p.write(r),t)});return t};e.s(["into",0,k,"isMailbox",0,e=>(0,c.hasProperty)(e,m),"make",0,e=>f.withFiberRuntime(t=>f.succeed(new w(t.currentScheduler,"number"==typeof e?e:e?.capacity??1/0,"number"==typeof e?"suspend":e?.strategy??"suspend"))),"toChannel",0,I,"toStream",0,e=>h.fromChannel(I(e))],1737036)},8554418,e=>{"use strict";var t=e.i(5450905),r=e.i(7862555),i=e.i(578549),n=e.i(3322401),a=e.i(7525378),s=e.i(7836076),o=e.i(3683485),l=e.i(8815901),u=e.i(9960543),c=e.i(4935619),d=e.i(1072215),p=e.i(6532885),f=e.i(5160412),h=e.i(6091153),m=e.i(6379322),g=e.i(8884753),y=e.i(469137),S=e.i(5806407);let b=Symbol.for("effect/GroupBy"),v={_R:e=>e,_E:e=>e,_K:e=>e,_V:e=>e},E=(0,o.dual)(e=>{let t;return t=e[0],(0,c.hasProperty)(t,b)},(e,t,r)=>y.flatMap(e.grouped,e=>{let[r,i]=e;return t(r,y.flattenTake(y.fromQueue(i,{shutdown:!0})))},{concurrency:"unbounded",bufferSize:r?.bufferSize??16})),w=e=>({[b]:v,pipe(){return(0,u.pipeArguments)(this,arguments)},grouped:e}),k=(0,o.dual)(e=>y.isStream(e[0]),(e,t,a)=>w(y.unwrapScoped(n.gen(function*(){let u=yield*i.make(),c=yield*n.acquireRelease(d.bounded(a?.bufferSize??16),e=>d.shutdown(e)),f=yield*p.make(new Map),h=yield*(0,o.pipe)(y.mapEffectSequential(e,t),y.distributedWithDynamicCallback(a?.bufferSize??16,e=>{let[t,r]=e;return n.flatMap(i.await(u),e=>e(t,r))},e=>d.offer(c,e)));return yield*i.succeed(u,(e,t)=>(0,o.pipe)(p.get(f),n.map(t=>l.fromNullable(t.get(e))),n.flatMap(l.match({onNone:()=>n.flatMap(h,t=>{let[i,a]=t;return n.zipRight(p.update(f,t=>t.set(e,i)),(0,o.pipe)(d.offer(c,s.succeed([e,x(a,e=>new S.TakeImpl((0,o.pipe)(e,s.map(e=>r.of(e[1])))))])),n.as(e=>e===i)))}),onSome:e=>n.succeed(t=>t===e)})))),y.flattenExitOption(y.fromQueue(c,{shutdown:!0}))})))),I=(0,o.dual)(e=>"function"!=typeof e[0],(e,t,r)=>r?.key?E(R(e,r.key,{bufferSize:r.bufferSize}),(e,r)=>y.mapEffectSequential(r,t)):y.matchConcurrency(r?.concurrency,()=>y.mapEffectSequential(e,t),i=>r?.unordered?y.flatMap(e,e=>y.fromEffect(t(e)),{concurrency:i}):y.mapEffectPar(e,i,t))),T=(0,o.dual)(e=>"string"!=typeof e[0],(e,t,r,i)=>I(e,e=>n.map(r(e),r=>({...e,[t]:r})),i)),x=(e,t)=>new C(e,t);class C extends a.Class{dequeue;f;[d.DequeueTypeId]={_Out:e=>e};constructor(e,t){super(),this.dequeue=e,this.f=t}capacity(){return d.capacity(this.dequeue)}get size(){return d.size(this.dequeue)}unsafeSize(){return this.dequeue.unsafeSize()}get awaitShutdown(){return d.awaitShutdown(this.dequeue)}isActive(){return this.dequeue.isActive()}get isShutdown(){return d.isShutdown(this.dequeue)}get shutdown(){return d.shutdown(this.dequeue)}get isFull(){return d.isFull(this.dequeue)}get isEmpty(){return d.isEmpty(this.dequeue)}get take(){return(0,o.pipe)(d.take(this.dequeue),n.map(e=>this.f(e)))}get takeAll(){return(0,o.pipe)(d.takeAll(this.dequeue),n.map(r.map(e=>this.f(e))))}takeUpTo(e){return(0,o.pipe)(d.takeUpTo(this.dequeue,e),n.map(r.map(e=>this.f(e))))}takeBetween(e,t){return(0,o.pipe)(d.takeBetween(this.dequeue,e,t),n.map(r.map(e=>this.f(e))))}takeN(e){return(0,o.pipe)(d.takeN(this.dequeue,e),n.map(r.map(e=>this.f(e))))}poll(){return(0,o.pipe)(d.poll(this.dequeue),n.map(l.map(e=>this.f(e))))}pipe(){return(0,u.pipeArguments)(this,arguments)}commit(){return this.take}}let R=(0,o.dual)(e=>"function"!=typeof e[0],(e,r,i)=>{let a=(e,s)=>g.readWithCause({onInput:u=>g.flatMap(g.fromEffect(n.forEach(F(u,r),r=>{let[a,u]=r,c=e.get(a);return void 0===c?(0,o.pipe)(d.bounded(i?.bufferSize??16),n.flatMap(r=>(0,o.pipe)(n.sync(()=>{e.set(a,r)}),n.zipRight(d.offer(s,S.of([a,r]))),n.zipRight((0,o.pipe)(d.offer(r,S.chunk(u)),n.catchSomeCause(e=>t.isInterruptedOnly(e)?l.some(n.void):l.none())))))):n.catchSomeCause(d.offer(c,S.chunk(u)),e=>t.isInterruptedOnly(e)?l.some(n.void):l.none())},{discard:!0})),()=>a(e,s)),onFailure:e=>g.fromEffect(d.offer(s,S.failCause(e))),onDone:()=>g.fromEffect((0,o.pipe)(n.forEach(e.entries(),e=>{let[r,i]=e;return(0,o.pipe)(d.offer(i,S.end),n.catchSomeCause(e=>t.isInterruptedOnly(e)?l.some(n.void):l.none()))},{discard:!0}),n.zipRight(d.offer(s,S.end))))});return w(y.unwrapScopedWith(t=>n.gen(function*(){let r=new Map,i=yield*d.unbounded();return yield*f.addFinalizer(t,d.shutdown(i)),yield*y.toChannel(e).pipe(g.pipeTo(a(r,i)),h.drain,m.runIn(t),n.forkIn(t),n.as(y.flattenTake(y.fromQueue(i,{shutdown:!0}))))})))}),F=(0,o.dual)(2,(e,t)=>{let i,n=[],a=e[Symbol.iterator](),s=new Map;for(;(i=a.next())&&!i.done;){let e=i.value,r=t(e);if(s.has(r))s.get(r).push(e);else{let t=[e];n.push([r,t]),s.set(r,t)}}return r.unsafeFromArray(n.map(e=>[e[0],r.unsafeFromArray(e[1])]))}),A=y.StreamTypeId,O=y.DefaultChunkSize,_=y.accumulate,M=y.accumulateChunks,D=y.acquireRelease,N=y.aggregate,P=y.aggregateWithin,L=y.aggregateWithinEither,U=y.as,z=y._async,W=y.asyncEffect,B=y.asyncPush,q=y.asyncScoped,$=y.branchAfter,j=y.broadcast,V=y.share,H=y.broadcastDynamic,G=y.broadcastedQueues,K=y.broadcastedQueuesDynamic,J=y.buffer,Z=y.bufferChunks,Q=y.catchAll,Y=y.catchAllCause,X=y.catchSome,ee=y.catchTag,et=y.catchTags,er=y.catchSomeCause,ei=y.changes,en=y.changesWith,ea=y.changesWithEffect,es=y.chunks,eo=y.chunksWith,el=y.combine,eu=y.combineChunks,ec=y.concat,ed=y.concatAll,ep=y.cross,ef=y.crossLeft,eh=y.crossRight,em=y.crossWith,eg=y.debounce,ey=y.die,eS=y.dieSync,eb=y.dieMessage,ev=y.distributedWith,eE=y.distributedWithDynamic,ew=y.drain,ek=y.drainFork,eI=y.drop,eT=y.dropRight,ex=y.dropUntil,eC=y.dropUntilEffect,eR=y.dropWhile,eF=y.dropWhileEffect,eA=y.either,eO=y.empty,e_=y.ensuring,eM=y.ensuringWith,eD=y.context,eN=y.contextWith,eP=y.contextWithEffect,eL=y.contextWithStream,eU=y.execute,ez=y.fail,eW=y.failSync,eB=y.failCause,eq=y.failCauseSync,e$=y.filter,ej=y.filterEffect,eV=y.filterMap,eH=y.filterMapEffect,eG=y.filterMapWhile,eK=y.filterMapWhileEffect,eJ=y.finalizer,eZ=y.find,eQ=y.findEffect,eY=y.flatMap,eX=y.flatten,e0=y.flattenChunks,e1=y.flattenEffect,e2=y.flattenExitOption,e5=y.flattenIterables,e3=y.flattenTake,e8=y.forever,e4=y.fromAsyncIterable,e6=y.fromChannel,e9=y.toChannel,e7=y.fromChunk,te=y.fromChunkPubSub,tt=y.fromChunkQueue,tr=y.fromChunks,ti=y.fromEffect,tn=y.fromEffectOption,ta=y.fromPubSub,ts=y.fromTPubSub,to=y.fromIterable,tl=y.fromIterableEffect,tu=y.fromIteratorSucceed,tc=y.fromPull,td=y.fromQueue,tp=y.fromTQueue,tf=y.fromReadableStream,th=y.fromReadableStreamByob,tm=y.fromSchedule,tg=y.groupAdjacentBy,ty=y.grouped,tS=y.groupedWithin,tb=y.haltAfter,tv=y.haltWhen,tE=y.haltWhenDeferred,tw=y.identityStream,tk=y.interleave,tI=y.interleaveWith,tT=y.intersperse,tx=y.intersperseAffixes,tC=y.interruptAfter,tR=y.interruptWhen,tF=y.interruptWhenDeferred,tA=y.iterate,tO=y.make,t_=y.map,tM=y.mapAccum,tD=y.mapAccumEffect,tN=y.mapBoth,tP=y.mapChunks,tL=y.mapChunksEffect,tU=y.mapConcat,tz=y.mapConcatChunk,tW=y.mapConcatChunkEffect,tB=y.mapConcatEffect,tq=y.mapError,t$=y.mapErrorCause,tj=y.merge,tV=y.mergeAll,tH=y.mergeWithTag,tG=y.mergeWith,tK=y.mergeEither,tJ=y.mergeLeft,tZ=y.mergeRight,tQ=y.mkString,tY=y.never,tX=y.onEnd,t0=y.onError,t1=y.onDone,t2=y.onStart,t5=y.orDie,t3=y.orDieWith,t8=y.orElse,t4=y.orElseEither,t6=y.orElseFail,t9=y.orElseIfEmpty,t7=y.orElseIfEmptyChunk,re=y.orElseIfEmptyStream,rt=y.orElseSucceed,rr=y.paginate,ri=y.paginateChunk,rn=y.paginateChunkEffect,ra=y.paginateEffect,rs=y.partition,ro=y.partitionEither,rl=y.peel,ru=y.pipeThrough,rc=y.pipeThroughChannel,rd=y.pipeThroughChannelOrFail,rp=y.prepend,rf=y.provideContext,rh=y.provideSomeContext,rm=y.provideLayer,rg=y.provideService,ry=y.provideServiceEffect,rS=y.provideServiceStream,rb=y.mapInputContext,rv=y.provideSomeLayer,rE=y.race,rw=y.raceAll,rk=y.range,rI=y.rechunk,rT=y.refineOrDie,rx=y.refineOrDieWith,rC=y.repeat,rR=y.repeatEffect,rF=y.repeatEffectChunk,rA=y.repeatEffectChunkOption,rO=y.repeatEffectOption,r_=y.repeatEffectWithSchedule,rM=y.repeatEither,rD=y.repeatElements,rN=y.repeatElementsWith,rP=y.repeatValue,rL=y.repeatWith,rU=y.retry,rz=y.withExecutionPlan,rW=y.run,rB=y.runCollect,rq=y.runCount,r$=y.runDrain,rj=y.runFold,rV=y.runFoldEffect,rH=y.runFoldScoped,rG=y.runFoldScopedEffect,rK=y.runFoldWhile,rJ=y.runFoldWhileEffect,rZ=y.runFoldWhileScoped,rQ=y.runFoldWhileScopedEffect,rY=y.runForEach,rX=y.runForEachChunk,r0=y.runForEachChunkScoped,r1=y.runForEachScoped,r2=y.runForEachWhile,r5=y.runForEachWhileScoped,r3=y.runHead,r8=y.runIntoPubSub,r4=y.runIntoPubSubScoped,r6=y.runIntoQueue,r9=y.runIntoQueueElementsScoped,r7=y.runIntoQueueScoped,ie=y.runLast,it=y.runScoped,ir=y.runSum,ii=y.scan,ia=y.scanEffect,is=y.scanReduce,io=y.scanReduceEffect,il=y.schedule,iu=y.scheduleWith,ic=y.scoped,id=y.scopedWith,ip=y.sliding,ih=y.slidingSize,im=y.some,ig=y.someOrElse,iy=y.someOrFail,iS=y.split,ib=y.splitOnChunk,iv=y.splitLines,iE=y.succeed,iw=y.sync,ik=y.suspend,iI=y.take,iT=y.takeRight,ix=y.takeUntil,iC=y.takeUntilEffect,iR=y.takeWhile,iF=y.tap,iA=y.tapBoth,iO=y.tapError,i_=y.tapErrorCause,iM=y.tapSink,iD=y.throttle,iN=y.throttleEffect,iP=y.tick,iL=y.timeout,iU=y.timeoutFail,iz=y.timeoutFailCause,iW=y.timeoutTo,iB=y.toPubSub,iq=y.toPull,i$=y.toQueue,ij=y.toQueueOfElements,iV=y.toReadableStream,iH=y.toReadableStreamEffect,iG=y.toReadableStreamRuntime,iK=y.toAsyncIterableRuntime,iJ=y.toAsyncIterableEffect,iZ=y.toAsyncIterable,iQ=y.transduce,iY=y.unfold,iX=y.unfoldChunk,i0=y.unfoldChunkEffect,i1=y.unfoldEffect,i2=y.void,i5=y.unwrap,i3=y.unwrapScoped,i8=y.unwrapScopedWith,i4=y.updateService,i6=y.when,i9=y.whenCase,i7=y.whenCaseEffect,ne=y.whenEffect,nt=y.withSpan,nr=y.zip,ni=y.zipFlatten,nn=y.zipAll,na=y.zipAllLeft,ns=y.zipAllRight,no=y.zipAllSortedByKey,nl=y.zipAllSortedByKeyLeft,nu=y.zipAllSortedByKeyRight,nc=y.zipAllSortedByKeyWith,nd=y.zipAllWith,np=y.zipLatest,nf=y.zipLatestAll,nh=y.zipLatestWith,nm=y.zipLeft,ng=y.zipRight,ny=y.zipWith,nS=y.zipWithChunks,nb=y.zipWithNext,nv=y.zipWithPrevious,nE=y.zipWithPreviousAndNext,nw=y.zipWithIndex,nk=y.Do,nI=y.bind,nT=y.bindTo,nx=y.let_,nC=y.decodeText,nR=y.encodeText,nF=y.fromEventListener;e.s(["DefaultChunkSize",0,O,"Do",0,nk,"StreamTypeId",0,A,"accumulate",0,_,"accumulateChunks",0,M,"acquireRelease",0,D,"aggregate",0,N,"aggregateWithin",0,P,"aggregateWithinEither",0,L,"as",0,U,"async",0,z,"asyncEffect",0,W,"asyncPush",0,B,"asyncScoped",0,q,"bind",0,nI,"bindEffect",0,T,"bindTo",0,nT,"branchAfter",0,$,"broadcast",0,j,"broadcastDynamic",0,H,"broadcastedQueues",0,G,"broadcastedQueuesDynamic",0,K,"buffer",0,J,"bufferChunks",0,Z,"catchAll",0,Q,"catchAllCause",0,Y,"catchSome",0,X,"catchSomeCause",0,er,"catchTag",0,ee,"catchTags",0,et,"changes",0,ei,"changesWith",0,en,"changesWithEffect",0,ea,"chunks",0,es,"chunksWith",0,eo,"combine",0,el,"combineChunks",0,eu,"concat",0,ec,"concatAll",0,ed,"context",0,eD,"contextWith",0,eN,"contextWithEffect",0,eP,"contextWithStream",0,eL,"cross",0,ep,"crossLeft",0,ef,"crossRight",0,eh,"crossWith",0,em,"debounce",0,eg,"decodeText",0,nC,"die",0,ey,"dieMessage",0,eb,"dieSync",0,eS,"distributedWith",0,ev,"distributedWithDynamic",0,eE,"drain",0,ew,"drainFork",0,ek,"drop",0,eI,"dropRight",0,eT,"dropUntil",0,ex,"dropUntilEffect",0,eC,"dropWhile",0,eR,"dropWhileEffect",0,eF,"either",0,eA,"empty",0,eO,"encodeText",0,nR,"ensuring",0,e_,"ensuringWith",0,eM,"execute",0,eU,"fail",0,ez,"failCause",0,eB,"failCauseSync",0,eq,"failSync",0,eW,"filter",0,e$,"filterEffect",0,ej,"filterMap",0,eV,"filterMapEffect",0,eH,"filterMapWhile",0,eG,"filterMapWhileEffect",0,eK,"finalizer",0,eJ,"find",0,eZ,"findEffect",0,eQ,"flatMap",0,eY,"flatten",0,eX,"flattenChunks",0,e0,"flattenEffect",0,e1,"flattenExitOption",0,e2,"flattenIterables",0,e5,"flattenTake",0,e3,"forever",0,e8,"fromAsyncIterable",0,e4,"fromChannel",0,e6,"fromChunk",0,e7,"fromChunkPubSub",0,te,"fromChunkQueue",0,tt,"fromChunks",0,tr,"fromEffect",0,ti,"fromEffectOption",0,tn,"fromEventListener",0,nF,"fromIterable",0,to,"fromIterableEffect",0,tl,"fromIteratorSucceed",0,tu,"fromPubSub",0,ta,"fromPull",0,tc,"fromQueue",0,td,"fromReadableStream",0,tf,"fromReadableStreamByob",0,th,"fromSchedule",0,tm,"fromTPubSub",0,ts,"fromTQueue",0,tp,"groupAdjacentBy",0,tg,"groupBy",0,k,"groupByKey",0,R,"grouped",0,ty,"groupedWithin",0,tS,"haltAfter",0,tb,"haltWhen",0,tv,"haltWhenDeferred",0,tE,"identity",0,tw,"interleave",0,tk,"interleaveWith",0,tI,"interruptAfter",0,tC,"interruptWhen",0,tR,"interruptWhenDeferred",0,tF,"intersperse",0,tT,"intersperseAffixes",0,tx,"iterate",0,tA,"let",0,nx,"make",0,tO,"map",0,t_,"mapAccum",0,tM,"mapAccumEffect",0,tD,"mapBoth",0,tN,"mapChunks",0,tP,"mapChunksEffect",0,tL,"mapConcat",0,tU,"mapConcatChunk",0,tz,"mapConcatChunkEffect",0,tW,"mapConcatEffect",0,tB,"mapEffect",0,I,"mapError",0,tq,"mapErrorCause",0,t$,"mapInputContext",0,rb,"merge",0,tj,"mergeAll",0,tV,"mergeEither",0,tK,"mergeLeft",0,tJ,"mergeRight",0,tZ,"mergeWith",0,tG,"mergeWithTag",0,tH,"mkString",0,tQ,"never",0,tY,"onDone",0,t1,"onEnd",0,tX,"onError",0,t0,"onStart",0,t2,"orDie",0,t5,"orDieWith",0,t3,"orElse",0,t8,"orElseEither",0,t4,"orElseFail",0,t6,"orElseIfEmpty",0,t9,"orElseIfEmptyChunk",0,t7,"orElseIfEmptyStream",0,re,"orElseSucceed",0,rt,"paginate",0,rr,"paginateChunk",0,ri,"paginateChunkEffect",0,rn,"paginateEffect",0,ra,"partition",0,rs,"partitionEither",0,ro,"peel",0,rl,"pipeThrough",0,ru,"pipeThroughChannel",0,rc,"pipeThroughChannelOrFail",0,rd,"prepend",0,rp,"provideContext",0,rf,"provideLayer",0,rm,"provideService",0,rg,"provideServiceEffect",0,ry,"provideServiceStream",0,rS,"provideSomeContext",0,rh,"provideSomeLayer",0,rv,"race",0,rE,"raceAll",0,rw,"range",0,rk,"rechunk",0,rI,"refineOrDie",0,rT,"refineOrDieWith",0,rx,"repeat",0,rC,"repeatEffect",0,rR,"repeatEffectChunk",0,rF,"repeatEffectChunkOption",0,rA,"repeatEffectOption",0,rO,"repeatEffectWithSchedule",0,r_,"repeatEither",0,rM,"repeatElements",0,rD,"repeatElementsWith",0,rN,"repeatValue",0,rP,"repeatWith",0,rL,"retry",0,rU,"run",0,rW,"runCollect",0,rB,"runCount",0,rq,"runDrain",0,r$,"runFold",0,rj,"runFoldEffect",0,rV,"runFoldScoped",0,rH,"runFoldScopedEffect",0,rG,"runFoldWhile",0,rK,"runFoldWhileEffect",0,rJ,"runFoldWhileScoped",0,rZ,"runFoldWhileScopedEffect",0,rQ,"runForEach",0,rY,"runForEachChunk",0,rX,"runForEachChunkScoped",0,r0,"runForEachScoped",0,r1,"runForEachWhile",0,r2,"runForEachWhileScoped",0,r5,"runHead",0,r3,"runIntoPubSub",0,r8,"runIntoPubSubScoped",0,r4,"runIntoQueue",0,r6,"runIntoQueueElementsScoped",0,r9,"runIntoQueueScoped",0,r7,"runLast",0,ie,"runScoped",0,it,"runSum",0,ir,"scan",0,ii,"scanEffect",0,ia,"scanReduce",0,is,"scanReduceEffect",0,io,"schedule",0,il,"scheduleWith",0,iu,"scoped",0,ic,"scopedWith",0,id,"share",0,V,"sliding",0,ip,"slidingSize",0,ih,"some",0,im,"someOrElse",0,ig,"someOrFail",0,iy,"split",0,iS,"splitLines",0,iv,"splitOnChunk",0,ib,"succeed",0,iE,"suspend",0,ik,"sync",0,iw,"take",0,iI,"takeRight",0,iT,"takeUntil",0,ix,"takeUntilEffect",0,iC,"takeWhile",0,iR,"tap",0,iF,"tapBoth",0,iA,"tapError",0,iO,"tapErrorCause",0,i_,"tapSink",0,iM,"throttle",0,iD,"throttleEffect",0,iN,"tick",0,iP,"timeout",0,iL,"timeoutFail",0,iU,"timeoutFailCause",0,iz,"timeoutTo",0,iW,"toAsyncIterable",0,iZ,"toAsyncIterableEffect",0,iJ,"toAsyncIterableRuntime",0,iK,"toChannel",0,e9,"toPubSub",0,iB,"toPull",0,iq,"toQueue",0,i$,"toQueueOfElements",0,ij,"toReadableStream",0,iV,"toReadableStreamEffect",0,iH,"toReadableStreamRuntime",0,iG,"transduce",0,iQ,"unfold",0,iY,"unfoldChunk",0,iX,"unfoldChunkEffect",0,i0,"unfoldEffect",0,i1,"unwrap",0,i5,"unwrapScoped",0,i3,"unwrapScopedWith",0,i8,"updateService",0,i4,"void",0,i2,"when",0,i6,"whenCase",0,i9,"whenCaseEffect",0,i7,"whenEffect",0,ne,"withExecutionPlan",0,rz,"withSpan",0,nt,"zip",0,nr,"zipAll",0,nn,"zipAllLeft",0,na,"zipAllRight",0,ns,"zipAllSortedByKey",0,no,"zipAllSortedByKeyLeft",0,nl,"zipAllSortedByKeyRight",0,nu,"zipAllSortedByKeyWith",0,nc,"zipAllWith",0,nd,"zipFlatten",0,ni,"zipLatest",0,np,"zipLatestAll",0,nf,"zipLatestWith",0,nh,"zipLeft",0,nm,"zipRight",0,ng,"zipWith",0,ny,"zipWithChunks",0,nS,"zipWithIndex",0,nw,"zipWithNext",0,nb,"zipWithPrevious",0,nv,"zipWithPreviousAndNext",0,nE],8554418)},889957,e=>{"use strict";var t=e.i(5972454),r=e.i(3322401),i=e.i(7836076),n=e.i(1661171),a=e.i(3683485),s=e.i(2090854),o=e.i(9227260),l=e.i(1737036),u=e.i(5160412),c=e.i(8554418);class d extends t.Tag("@effect/experimental/Reactivity")(){}let p=r.sync(()=>{let e=new Map,t=t=>{if(Array.isArray(t))for(let r=0;r<t.length;r++){let i=e.get(m(t[r]));if(void 0!==i)for(let e of i)e()}else for(let r in t){let i=g(r,t[r]);for(let t=0;t<i.length;t++){let r=e.get(i[t]);if(void 0!==r)for(let e of r)e()}let n=e.get(r);if(void 0!==n)for(let e of n)e()}},a=e=>r.sync(()=>t(e)),s=(t,r)=>{let i=Array.isArray(t)?t.map(m):y(t);for(let t=0;t<i.length;t++){let n=e.get(i[t]);void 0===n&&(n=new Set,e.set(i[t],n)),n.add(r)}return()=>{for(let t=0;t<i.length;t++){let n=e.get(i[t]);n.delete(r),0===n.size&&e.delete(i[t])}}},o=(e,t)=>r.gen(function*(){let a=yield*r.scope,o=yield*l.make(),c=yield*n.makeRuntime(),d=!1,p=!1,f=e=>{"Failure"===e._tag?o.unsafeDone(i.failCause(e.cause)):o.unsafeOffer(e.value),p?(p=!1,c(t).addObserver(f)):d=!1};function h(){if(d){p=!0;return}d=!0,c(t).addObserver(f)}let m=s(e,h);return yield*u.addFinalizer(a,r.sync(m)),h(),o});return d.of({mutation:(e,t)=>r.zipLeft(t,a(e)),query:o,stream:(e,t)=>o(e,t).pipe(r.map(l.toStream),c.unwrapScoped),unsafeInvalidate:t,invalidate:a,unsafeRegister:s})}),f=(0,a.dual)(2,(e,t)=>r.flatMap(d,r=>r.mutation(t,e))),h=o.scoped(d,p);function m(e){return"string"==typeof e?e:s.hash(e)}let g=(e,t)=>{let r=Array(t.length);for(let i=0;i<t.length;i++)r[i]=`${e}:${m(t[i])}`;return r},y=e=>{let t=[];for(let r in e)for(let i of(t.push(r),g(r,e[r])))t.push(i);return t};e.s(["Reactivity",0,d,"invalidate",0,e=>r.flatMap(d,t=>t.invalidate(e)),"layer",0,h,"mutation",0,f])},8477203,e=>{"use strict";var t=e.i(1331084),r=e.i(4935619);let i=Symbol.for("effect/Encoding/errors/Decode"),n=(e,t)=>{let n={_tag:"DecodeException",[i]:i,input:e};return(0,r.isString)(t)&&(n.message=t),n},a=Symbol.for("effect/Encoding/errors/Encode"),s=new TextEncoder,o=new TextDecoder,l=e=>{let t,r=e.length,i="";for(t=2;t<r;t+=3)i+=p[e[t-2]>>2],i+=p[(3&e[t-2])<<4|e[t-1]>>4],i+=p[(15&e[t-1])<<2|e[t]>>6],i+=p[63&e[t]];return t===r+1&&(i+=p[e[t-2]>>2],i+=p[(3&e[t-2])<<4],i+="=="),t===r&&(i+=p[e[t-2]>>2],i+=p[(3&e[t-2])<<4|e[t-1]>>4],i+=p[(15&e[t-1])<<2],i+="="),i},u=e=>{let r=c(e),i=r.length;if(i%4!=0)return t.left(n(r,`Length must be a multiple of 4, but is ${i}`));let a=r.indexOf("=");if(-1!==a&&(a<i-2||a===i-2&&"="!==r[i-1]))return t.left(n(r,"Found a '=' character, but it is not at the end"));try{let e=r.endsWith("==")?2:+!!r.endsWith("="),n=new Uint8Array(i/4*3-e);for(let e=0,t=0;e<i;e+=4,t+=3){let i=d(r.charCodeAt(e))<<18|d(r.charCodeAt(e+1))<<12|d(r.charCodeAt(e+2))<<6|d(r.charCodeAt(e+3));n[t]=i>>16,n[t+1]=i>>8&255,n[t+2]=255&i}return t.right(n)}catch(e){return t.left(n(r,e instanceof Error?e.message:"Invalid input"))}},c=e=>e.replace(/[\n\r]/g,"");function d(e){if(e>=f.length)throw TypeError(`Invalid character ${String.fromCharCode(e)}`);let t=f[e];if(255===t)throw TypeError(`Invalid character ${String.fromCharCode(e)}`);return t}let p=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"],f=[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,62,255,255,255,63,52,53,54,55,56,57,58,59,60,61,255,255,255,0,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],h=e=>l(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),m=e=>{let t="";for(let r=0;r<e.length;++r)t+=g[e[r]];return t},g=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],y=e=>{if(48<=e&&e<=57)return e-48;if(97<=e&&e<=102)return e-97+10;if(65<=e&&e<=70)return e-65+10;throw TypeError("Invalid input")},S=e=>u(e),b=e=>(e=>{let r=c(e),i=r.length;if(i%4==1)return t.left(n(r,`Length should be a multiple of 4, but is ${i}`));if(!/^[-_A-Z0-9]*?={0,2}$/i.test(r))return t.left(n(r,"Invalid input"));let a=i%4==2?`${r}==`:i%4==3?`${r}=`:r;return u(a=a.replace(/-/g,"+").replace(/_/g,"/"))})(e),v=e=>(e=>{let r=new TextEncoder().encode(e);if(r.length%2!=0)return t.left(n(e,`Length must be a multiple of 2, but is ${r.length}`));try{let e=r.length/2,i=new Uint8Array(e);for(let t=0;t<e;t++){let e=y(r[2*t]),n=y(r[2*t+1]);i[t]=e<<4|n}return t.right(i)}catch(r){return t.left(n(e,r instanceof Error?r.message:"Invalid input"))}})(e);e.s(["decodeBase64",0,S,"decodeBase64String",0,e=>t.map(S(e),e=>o.decode(e)),"decodeBase64Url",0,b,"decodeBase64UrlString",0,e=>t.map(b(e),e=>o.decode(e)),"decodeHex",0,v,"decodeHexString",0,e=>t.map(v(e),e=>o.decode(e)),"decodeUriComponent",0,e=>t.try({try:()=>decodeURIComponent(e),catch:t=>n(e,t instanceof Error?t.message:"Invalid input")}),"encodeBase64",0,e=>"string"==typeof e?l(s.encode(e)):l(e),"encodeBase64Url",0,e=>"string"==typeof e?h(s.encode(e)):h(e),"encodeHex",0,e=>"string"==typeof e?m(s.encode(e)):m(e),"encodeUriComponent",0,e=>t.try({try:()=>encodeURIComponent(e),catch:t=>{var i,n;let s;return i=e,n=t instanceof Error?t.message:"Invalid input",s={_tag:"EncodeException",[a]:a,input:i},(0,r.isString)(n)&&(s.message=n),s}})],8477203)},5648992,3345355,e=>{"use strict";var t=e.i(3628392),r=e.i(138042),i=e.i(3683485),n=e.i(2090854),a=e.i(2873450),s=e.i(8815901),o=e.i(6712028),l=e.i(9960543),u=e.i(4935619);let c=/^[+-]?\d+$/,d=Symbol.for("effect/BigDecimal"),p={[d]:d,[n.symbol](){let e=v(this);return(0,i.pipe)(n.hash(e.value),n.combine(n.number(e.scale)),n.cached(this))},[t.symbol](e){return f(e)&&_(this,e)},toString(){return`BigDecimal(${D(this)})`},toJSON(){return{_id:"BigDecimal",value:String(this.value),scale:this.scale}},[a.NodeInspectSymbol](){return this.toJSON()},pipe(){return(0,l.pipeArguments)(this,arguments)}},f=e=>(0,u.hasProperty)(e,d),h=(e,t)=>{let r=Object.create(p);return r.value=e,r.scale=t,r},m=(e,t)=>{if(e!==g&&e%S===g)throw RangeError("Value must be normalized");let r=h(e,t);return r.normalized=r,r},g=BigInt(0),y=BigInt(1),S=BigInt(10),b=m(g,0),v=e=>{if(void 0===e.normalized)if(e.value===g)e.normalized=b;else{let t=`${e.value}`,r=0;for(let e=t.length-1;e>=0;e--)if("0"===t[e])r++;else break;0===r&&(e.normalized=e);let i=BigInt(t.substring(0,t.length-r)),n=e.scale-r;e.normalized=m(i,n)}return e.normalized},E=(0,i.dual)(2,(e,t)=>t>e.scale?h(e.value*S**BigInt(t-e.scale),t):t<e.scale?h(e.value/S**BigInt(e.scale-t),t):e),w=(0,i.dual)(2,(e,t)=>t.value===g?e:e.value===g?t:e.scale>t.scale?h(E(t,e.scale).value+e.value,e.scale):e.scale<t.scale?h(E(e,t.scale).value+t.value,t.scale):h(e.value+t.value,e.scale)),k=o.make((e,t)=>{let r=o.number(A(e),A(t));return 0!==r?r:e.scale>t.scale?o.bigint(e.value,E(t,e.scale).value):e.scale<t.scale?o.bigint(E(e,t.scale).value,t.value):o.bigint(e.value,t.value)}),I=o.lessThan(k),T=o.lessThanOrEqualTo(k),x=o.greaterThan(k),C=o.greaterThanOrEqualTo(k),R=o.between(k),F=o.clamp(k),A=e=>e.value===g?0:e.value<g?-1:1,O=r.make((e,t)=>e.scale>t.scale?E(t,e.scale).value===e.value:e.scale<t.scale?E(e,t.scale).value===t.value:e.value===t.value),_=(0,i.dual)(2,(e,t)=>O(e,t)),M=e=>{let t,r,i,n;if(""===e)return s.some(b);let a=e.search(/[eE]/);if(-1!==a){let i=e.slice(a+1);if(t=e.slice(0,a),r=Number(i),""===t||!Number.isSafeInteger(r)||!c.test(i))return s.none()}else t=e,r=0;let o=t.search(/\./);if(-1!==o){let e=t.slice(0,o),r=t.slice(o+1);i=`${e}${r}`,n=r.length}else i=t,n=0;if(!c.test(i))return s.none();let l=n-r;return Number.isSafeInteger(l)?s.some(h(BigInt(i),l)):s.none()},D=e=>{let t,r,i=v(e);if(Math.abs(i.scale)>=16)return N(i);let n=i.value<g,a=n?`${i.value}`.substring(1):`${i.value}`;if(i.scale>=a.length)t="0",r="0".repeat(i.scale-a.length)+a;else{let e=a.length-i.scale;if(e>a.length){let i=e-a.length;t=`${a}${"0".repeat(i)}`,r=""}else r=a.slice(e),t=a.slice(0,e)}let s=""===r?t:`${t}.${r}`;return n?`-${s}`:s},N=e=>{if(P(e))return"0e+0";let t=v(e),r=`${(t.value<g?h(-t.value,t.scale):t).value}`,i=r.slice(0,1),n=r.slice(1),a=`${L(t)?"-":""}${i}`;""!==n&&(a+=`.${n}`);let s=n.length-t.scale;return`${a}e${s>=0?"+":""}${s}`},P=e=>e.value===g,L=e=>e.value<g,U=e=>e.value>g,z=e=>f(e[0]),W=(0,i.dual)(z,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.scale<=t?e:h(e.value/10n**BigInt(e.scale-t),t)});(e,t)=>e.scale<t?0n:e.value/10n**BigInt(e.scale-t)%10n,e.s(["Equivalence",0,O,"between",0,R,"clamp",0,F,"format",0,D,"fromString",0,M,"greaterThan",0,x,"greaterThanOrEqualTo",0,C,"isBigDecimal",0,f,"isNegative",0,L,"isPositive",0,U,"lessThan",0,I,"lessThanOrEqualTo",0,T,"make",0,h,"normalize",0,v,"unsafeFromNumber",0,e=>s.getOrThrowWith((e=>{if(!Number.isFinite(e))return s.none();let t=`${e}`;if(t.includes("e"))return M(t);let[r,i=""]=t.split(".");return s.some(h(BigInt(`${r}${i}`),i.length))})(e),()=>RangeError(`Number must be finite, got ${e}`)),"unsafeToNumber",0,e=>Number(D(e))],5648992);let B=BigInt(0);u.isBigInt,r.bigint;let q=o.bigint,$=o.clamp(q);(e,t)=>{for(;t!==B;){let r=t;t=e%t,e=r}return e},e.s(["clamp",0,$,"fromNumber",0,e=>{if(e>Number.MAX_SAFE_INTEGER||e<Number.MIN_SAFE_INTEGER)return s.none();try{return s.some(BigInt(e))}catch{return s.none()}},"fromString",0,e=>{try{return""===e.trim()?s.none():s.some(BigInt(e))}catch{return s.none()}},"toNumber",0,e=>e>BigInt(Number.MAX_SAFE_INTEGER)||e<BigInt(Number.MIN_SAFE_INTEGER)?s.none():s.some(Number(e))],3345355)},4772691,e=>{"use strict";var t=e.i(194400);t.ConfigErrorTypeId,t.And,t.Or,t.MissingData;let r=t.InvalidData;t.SourceUnavailable,t.Unsupported,t.isConfigError,t.isAnd,t.isOr,t.isInvalidData,t.isMissingData;let i=t.isMissingDataOnly;t.isSourceUnavailable,t.isUnsupported,t.prefixed,t.reduceWithContext,e.s(["InvalidData",0,r,"isMissingDataOnly",0,i])},8295197,8611396,e=>{"use strict";e.i(7862555),e.i(4772691),e.i(8973103);var t=e.i(1331084),r=e.i(3683485);e.i(9390854),e.i(8815901);var i=e.i(4935619);e.i(194400),e.i(7548658);var n=e.i(7294722),a=e.i(5242335),s=e.i(5166253),o=e.i(3628392),l=e.i(9159985),u=e.i(2090854),c=e.i(2873450),d=e.i(9960543);let p="effect/Redacted",f=(0,l.globalValue)("effect/Redacted/redactedRegistry",()=>new WeakMap),h=Symbol.for(p),m={[h]:{_A:e=>e},pipe(){return(0,d.pipeArguments)(this,arguments)},toString:()=>"<redacted>",toJSON:()=>"<redacted>",[c.NodeInspectSymbol]:()=>"<redacted>",[u.symbol](){return(0,r.pipe)(u.hash(p),u.combine(u.hash(f.get(this))),u.cached(this))},[o.symbol](e){return g(e)&&o.equals(f.get(this),f.get(e))}},g=e=>(0,i.hasProperty)(e,h);e.s(["RedactedTypeId",0,h,"isRedacted",0,g,"make",0,e=>{let t=Object.create(m);return f.set(t,e),t},"proto",0,m,"redactedRegistry",0,f,"unsafeWipe",0,e=>f.delete(e),"value",0,e=>{if(f.has(e))return f.get(e);throw Error("Unable to get redacted value")}],8611396),e.i(5283034);let y=Symbol.for("effect/Secret");({...m,[y]:y});let S=Symbol.for("effect/Config"),b={...a.CommitPrototype,[S]:{_A:e=>e},commit(){return n.config(this)}},v=((e,r)=>v(e,e=>t.right(r(e))),(0,r.dual)(2,(e,t)=>{let r=Object.create(b);return r._tag=s.OP_MAP_OR_FAIL,r.original=e,r.mapOrFail=t,r})),E=(0,r.dual)(2,(e,t)=>{let r=Object.create(b);return r._tag=s.OP_NESTED,r.name=t,r.config=e,r}),w=((e,t)=>{let r=Object.create(b);return r._tag=s.OP_FALLBACK,r.first=e,r.second=w(t.orElse),r.condition=t.if,r},e=>{let t=Object.create(b);return t._tag=s.OP_LAZY,t.config=e,t});(e,t,r)=>{let i=Object.create(b);return i._tag=s.OP_ZIP_WITH,i.left=e,i.right=t,i.zip=r,i},e.s(["mapOrFail",0,v,"string",0,e=>{var r;let i,n=(r=t.right,(i=Object.create(b))._tag=s.OP_PRIMITIVE,i.description="a text property",i.parse=r,i);return void 0===e?n:E(n,e)}],8295197)},1939315,e=>{"use strict";var t=e.i(5972454);e.i(3322401),e.i(3683485);var r=e.i(5331375);e.i(9227260),r.TypeId,r.TimeZoneTypeId;let i=r.isDateTime;r.isTimeZone;let n=r.isTimeZoneOffset,a=r.isTimeZoneNamed,s=r.isUtc,o=r.isZoned,l=r.Equivalence;r.Order,r.clamp;let u=r.unsafeFromDate,c=r.unsafeMake,d=r.unsafeMakeZoned;r.makeZoned,r.make;let p=r.makeZonedFromString;r.now,r.nowAsDate,r.unsafeNow,r.toUtc,r.setZone,r.setZoneOffset;let f=r.zoneUnsafeMakeNamed,h=r.zoneMakeOffset;r.zoneMakeNamed,r.zoneMakeNamedEffect,r.zoneMakeLocal;let m=r.zoneFromString,g=r.zoneToString;r.setZoneNamed,r.unsafeSetZoneNamed,r.distance,r.distanceDurationEither,r.distanceDuration,r.min,r.max,r.greaterThan,r.greaterThanOrEqualTo,r.lessThan,r.lessThanOrEqualTo,r.between,r.isFuture,r.unsafeIsFuture,r.isPast,r.unsafeIsPast;let y=r.toDateUtc;r.toDate,r.zonedOffset,r.zonedOffsetIso;let S=r.toEpochMillis;r.removeTime,r.toParts,r.toPartsUtc,r.getPartUtc,r.getPart,r.setParts,r.setPartsUtc,r.mutate,r.mutateUtc,r.mapEpochMillis,r.withDate,r.withDateUtc,r.match,r.addDuration,r.subtractDuration,r.add,r.subtract,r.startOf,r.endOf,r.nearest,r.format,r.formatLocal,r.formatUtc,r.formatIntl;let b=r.formatIso;r.formatIsoDate,r.formatIsoDateUtc,r.formatIsoOffset;let v=r.formatIsoZoned;e.s(["Equivalence",0,l,"formatIso",0,b,"formatIsoZoned",0,v,"isDateTime",0,i,"isTimeZoneNamed",0,a,"isTimeZoneOffset",0,n,"isUtc",0,s,"isZoned",0,o,"makeZonedFromString",0,p,"toDateUtc",0,y,"toEpochMillis",0,S,"unsafeFromDate",0,u,"unsafeMake",0,c,"unsafeMakeZoned",0,d,"zoneFromString",0,m,"zoneMakeOffset",0,h,"zoneToString",0,g,"zoneUnsafeMakeNamed",0,f])},9973079,1932814,9552070,4434603,8558266,e=>{"use strict";var t,r,i,n,a,s,o=e.i(5283034),l=e.i(5648992),u=e.i(3345355),c=e.i(2725920),d=e.i(5450905),p=e.i(7862555),f=e.i(8295197),h=e.i(4772691),m=e.i(5305881),g=e.i(1939315),y=e.i(8973103),S=e.i(3322401),b=e.i(1331084),v=e.i(8477203),E=e.i(3628392),w=e.i(138042),k=e.i(7836076);class I extends Error{constructor(e=!1){super(),this.interruptExecution=e,this.footprint=I.SharedFootPrint}static isFailure(e){return null!=e&&e.footprint===I.SharedFootPrint}}I.SharedFootPrint=Symbol.for("fast-check/PreconditionFailure");class T{[Symbol.iterator](){return this}next(e){return{value:e,done:!0}}}T.nil=new T;let x=Symbol.iterator;class C{static nil(){return new C(T.nil)}static of(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new C(t[x]())}constructor(e){this.g=e}next(){return this.g.next()}[Symbol.iterator](){return this.g}map(e){return new C(function*(e,t){for(let r of e)yield t(r)}(this.g,e))}flatMap(e){return new C(function*(e,t){for(let r of e)yield*t(r)}(this.g,e))}dropWhile(e){let t=!1;return this.flatMap(function*(r){(t||!e(r))&&(t=!0,yield r)})}drop(e){if(e<=0)return this;let t=0;return this.dropWhile(function(){return t++<e})}takeWhile(e){return new C(function*(e,t){let r=e.next();for(;!r.done&&t(r.value);)yield r.value,r=e.next()}(this.g,e))}take(e){return new C(function*(e,t){for(let r=0;r<t;++r){let t=e.next();if(t.done)break;yield t.value}}(this.g,e))}filter(e){return new C(function*(e,t){for(let r of e)t(r)&&(yield r)}(this.g,e))}every(e){for(let t of this.g)if(!e(t))return!1;return!0}has(e){for(let t of this.g)if(e(t))return[!0,t];return[!1,null]}join(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new C(function*(e,t){for(let t=e.next();!t.done;t=e.next())yield t.value;for(let e of t)for(let t=e.next();!t.done;t=e.next())yield t.value}(this.g,t))}getNthOrLast(e){let t=e,r=null;for(let e of this.g){if(0==t--)return e;r=e}return r}}let R=Symbol.for("fast-check/cloneMethod");function F(e){return null!==e&&("object"==typeof e||"function"==typeof e)&&R in e&&"function"==typeof e[R]}function A(e){return F(e)?e[R]():e}let O=Object.defineProperty;class _{constructor(e,t,r){this.value_=e,this.context=t,this.hasToBeCloned=void 0!==r||F(e),this.readOnce=!1,this.hasToBeCloned?O(this,"value",{get:void 0!==r?r:this.getValue}):this.value=e}getValue(){return this.hasToBeCloned?this.readOnce?this.value_[R]():(this.readOnce=!0,this.value_):this.value_}}let M=Object.assign;class D{filter(e){return new L(this,e)}map(e,t){return new P(this,e,t)}chain(e){return new N(this,e)}noShrink(){return new U(this)}noBias(){return new z(this)}}class N extends D{constructor(e,t){super(),this.arb=e,this.chainer=t}generate(e,t){let r=e.clone(),i=this.arb.generate(e,t);return this.valueChainer(i,e,r,t)}canShrinkWithoutContext(e){return!1}shrink(e,t){return this.isSafeContext(t)?(!t.stoppedForOriginal?this.arb.shrink(t.originalValue,t.originalContext).map(e=>this.valueChainer(e,t.clonedMrng.clone(),t.clonedMrng,t.originalBias)):C.nil()).join(t.chainedArbitrary.shrink(e,t.chainedContext).map(e=>{let r=M(M({},t),{chainedContext:e.context,stoppedForOriginal:!0});return new _(e.value_,r)})):C.nil()}valueChainer(e,t,r,i){let n=this.chainer(e.value_),a=n.generate(t,i),s={originalBias:i,originalValue:e.value_,originalContext:e.context,stoppedForOriginal:!1,chainedArbitrary:n,chainedContext:a.context,clonedMrng:r};return new _(a.value_,s)}isSafeContext(e){return null!=e&&"object"==typeof e&&"originalBias"in e&&"originalValue"in e&&"originalContext"in e&&"stoppedForOriginal"in e&&"chainedArbitrary"in e&&"chainedContext"in e&&"clonedMrng"in e}}class P extends D{constructor(e,t,r){super(),this.arb=e,this.mapper=t,this.unmapper=r,this.bindValueMapper=e=>this.valueMapper(e)}generate(e,t){let r=this.arb.generate(e,t);return this.valueMapper(r)}canShrinkWithoutContext(e){if(void 0!==this.unmapper)try{let t=this.unmapper(e);return this.arb.canShrinkWithoutContext(t)}catch(e){}return!1}shrink(e,t){if(this.isSafeContext(t))return this.arb.shrink(t.originalValue,t.originalContext).map(this.bindValueMapper);if(void 0!==this.unmapper){let t=this.unmapper(e);return this.arb.shrink(t,void 0).map(this.bindValueMapper)}return C.nil()}mapperWithCloneIfNeeded(e){let t=e.value,r=this.mapper(t);return e.hasToBeCloned&&("object"==typeof r&&null!==r||"function"==typeof r)&&Object.isExtensible(r)&&!F(r)&&Object.defineProperty(r,R,{get:()=>()=>this.mapperWithCloneIfNeeded(e)[0]}),[r,t]}valueMapper(e){let[t,r]=this.mapperWithCloneIfNeeded(e);return new _(t,{originalValue:r,originalContext:e.context})}isSafeContext(e){return null!=e&&"object"==typeof e&&"originalValue"in e&&"originalContext"in e}}class L extends D{constructor(e,t){super(),this.arb=e,this.refinement=t,this.bindRefinementOnValue=e=>this.refinementOnValue(e)}generate(e,t){for(;;){let r=this.arb.generate(e,t);if(this.refinementOnValue(r))return r}}canShrinkWithoutContext(e){return this.arb.canShrinkWithoutContext(e)&&this.refinement(e)}shrink(e,t){return this.arb.shrink(e,t).filter(this.bindRefinementOnValue)}refinementOnValue(e){return this.refinement(e.value)}}class U extends D{constructor(e){super(),this.arb=e}generate(e,t){return this.arb.generate(e,t)}canShrinkWithoutContext(e){return this.arb.canShrinkWithoutContext(e)}shrink(e,t){return C.nil()}noShrink(){return this}}class z extends D{constructor(e){super(),this.arb=e}generate(e,t){return this.arb.generate(e,void 0)}canShrinkWithoutContext(e){return this.arb.canShrinkWithoutContext(e)}shrink(e,t){return this.arb.shrink(e,t)}noBias(){return this}}let W=Function.prototype.apply,B=Symbol("apply");function q(e,t,r){let i;return function(e){try{return e.apply}catch(e){return}}(e)===W?e.apply(t,r):(e[B]=W,i=e[B](t,r),delete e[B],i)}let $="u">typeof Array?Array:void 0;"u">typeof BigInt64Array&&BigInt64Array,"u">typeof BigUint64Array&&BigUint64Array;let j="u">typeof Error?Error:void 0;"u">typeof Float32Array&&Float32Array,"u">typeof Float64Array&&Float64Array,"u">typeof Int8Array&&Int8Array,"u">typeof Int16Array&&Int16Array,"u">typeof Int32Array&&Int32Array;let V="u">typeof String?String:void 0;"u">typeof Uint8Array&&Uint8Array,"u">typeof Uint8ClampedArray&&Uint8ClampedArray,"u">typeof Uint16Array&&Uint16Array,"u">typeof Uint32Array&&Uint32Array;let H="u">typeof encodeURIComponent?encodeURIComponent:void 0,G=Symbol;Array.prototype.forEach;let K=Array.prototype.indexOf,J=Array.prototype.join,Z=Array.prototype.map,Q=Array.prototype.filter,Y=Array.prototype.push;Array.prototype.pop,Array.prototype.splice;let X=Array.prototype.slice;function ee(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return function(e){try{return e.indexOf}catch(e){return}}(e)===K?e.indexOf(...r):q(K,e,r)}function et(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return function(e){try{return e.join}catch(e){return}}(e)===J?e.join(...r):q(J,e,r)}function er(e,t){return function(e){try{return e.map}catch(e){return}}(e)===Z?e.map(t):q(Z,e,[t])}function ei(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return function(e){try{return e.push}catch(e){return}}(e)===Y?e.push(...r):q(Y,e,r)}function en(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return function(e){try{return e.slice}catch(e){return}}(e)===X?e.slice(...r):q(X,e,r)}Array.prototype.sort,Array.prototype.every;let ea=Date.prototype.getTime,es=Date.prototype.toISOString;Set.prototype.add,Set.prototype.has,WeakMap.prototype.set,WeakMap.prototype.get;let eo=Map.prototype.set,el=Map.prototype.get,eu=String.prototype.split;String.prototype.startsWith,String.prototype.endsWith,String.prototype.substring,String.prototype.toLowerCase,String.prototype.toUpperCase,String.prototype.padStart;let ec=String.prototype.charCodeAt;function ed(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return function(e){try{return e.split}catch(e){return}}(e)===eu?e.split(...r):q(eu,e,r)}function ep(e,t){return function(e){try{return e.charCodeAt}catch(e){return}}(e)===ec?e.charCodeAt(t):q(ec,e,[t])}String.prototype.normalize,String.prototype.replace;let ef=Number.prototype.toString;Object.prototype.hasOwnProperty;let eh=Object.prototype.toString;class em{constructor(e){this.producer=e}[Symbol.iterator](){return void 0===this.it&&(this.it=this.producer()),this.it}next(){return void 0===this.it&&(this.it=this.producer()),this.it.next()}}let eg=Math.log;function ey(e){return 2+~~(.4342944819032518*eg(e+1))}let eS={},eb=Symbol("UndefinedContextPlaceholder");function ev(e){return void 0!==e.context?e:e.hasToBeCloned?new _(e.value_,eb,()=>e.value):new _(e.value_,eb)}class eE{constructor(e,t){this.arb=e,this.predicate=t;const{asyncBeforeEach:r,asyncAfterEach:i,beforeEach:n,afterEach:a}=eS||{};if(void 0!==r&&void 0!==n)throw j('Global "asyncBeforeEach" and "beforeEach" parameters can\'t be set at the same time when running async properties');if(void 0!==i&&void 0!==a)throw j('Global "asyncAfterEach" and "afterEach" parameters can\'t be set at the same time when running async properties');this.beforeEachHook=r||n||eE.dummyHook,this.afterEachHook=i||a||eE.dummyHook}isAsync(){return!0}generate(e,t){return ev(this.arb.generate(e,null!=t?ey(t):void 0))}shrink(e){if(void 0===e.context&&!this.arb.canShrinkWithoutContext(e.value_))return C.nil();let t=e.context!==eb?e.context:void 0;return this.arb.shrink(e.value_,t).map(ev)}async runBeforeEach(){await this.beforeEachHook()}async runAfterEach(){await this.afterEachHook()}async run(e,t){t||await this.beforeEachHook();try{let t=await this.predicate(e);return null==t||!0===t?null:{error:new j("Property failed by returning false"),errorMessage:"Error: Property failed by returning false"}}catch(e){if(I.isFailure(e))return e;if(e instanceof j&&e.stack)return{error:e,errorMessage:e.stack};return{error:e,errorMessage:V(e)}}finally{t||await this.afterEachHook()}}beforeEach(e){let t=this.beforeEachHook;return this.beforeEachHook=()=>e(t),this}afterEach(e){let t=this.afterEachHook;return this.afterEachHook=()=>e(t),this}}eE.dummyHook=()=>{};class ew{constructor(e,t){this.arb=e,this.predicate=t;const{beforeEach:r=ew.dummyHook,afterEach:i=ew.dummyHook,asyncBeforeEach:n,asyncAfterEach:a}=eS||{};if(void 0!==n)throw j('"asyncBeforeEach" can\'t be set when running synchronous properties');if(void 0!==a)throw j('"asyncAfterEach" can\'t be set when running synchronous properties');this.beforeEachHook=r,this.afterEachHook=i}isAsync(){return!1}generate(e,t){return ev(this.arb.generate(e,null!=t?ey(t):void 0))}shrink(e){if(void 0===e.context&&!this.arb.canShrinkWithoutContext(e.value_))return C.nil();let t=e.context!==eb?e.context:void 0;return this.arb.shrink(e.value_,t).map(ev)}runBeforeEach(){this.beforeEachHook()}runAfterEach(){this.afterEachHook()}run(e,t){t||this.beforeEachHook();try{let t=this.predicate(e);return null==t||!0===t?null:{error:new j("Property failed by returning false"),errorMessage:"Error: Property failed by returning false"}}catch(e){if(I.isFailure(e))return e;if(e instanceof j&&e.stack)return{error:e,errorMessage:e.stack};return{error:e,errorMessage:V(e)}}finally{t||this.afterEachHook()}}beforeEach(e){let t=this.beforeEachHook;return this.beforeEachHook=()=>e(t),this}afterEach(e){let t=this.afterEachHook;return this.afterEachHook=()=>e(t),this}}function ek(e,t){for(var r=[],i=0;i!=t;++i)r.push(e.unsafeNext());return r}function eI(e,t){for(var r=0;r!=t;++r)e.unsafeNext()}ew.dummyHook=()=>{};var eT=-0x80000000-1,ex=function(e){return 214013*e+2531011|0},eC=function(e){return(e&eT)>>16},eR=function(){function e(e){this.seed=e}return e.prototype.clone=function(){return new e(this.seed)},e.prototype.next=function(){var t=new e(this.seed);return[t.unsafeNext(),t]},e.prototype.unsafeNext=function(){var e=ex(this.seed),t=eC(e),r=ex(e),i=eC(r);return this.seed=ex(r),0|eC(this.seed)+(i+(t<<15)<<15)},e.prototype.getState=function(){return[this.seed]},e}(),eF=Object.assign(function(e){return new eR(e)},{fromState:function(e){if(1!==e.length)throw Error("The state must have been produced by a congruential32 RandomGenerator");return new eR(e[0])}}),eA=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,a=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)s.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return s},eO=function(e,t,r){if(r||2==arguments.length)for(var i,n=0,a=t.length;n<a;n++)!i&&n in t||(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return e.concat(i||Array.prototype.slice.call(t))},e_=function(){function e(e,t){this.states=e,this.index=t}return e.twist=function(t){for(var r=t.slice(),i=0;i!==e.N-e.M;++i){var n=(r[i]&e.MASK_UPPER)+(r[i+1]&e.MASK_LOWER);r[i]=r[i+e.M]^n>>>1^-(1&n)&e.A}for(var i=e.N-e.M;i!==e.N-1;++i){var a=(r[i]&e.MASK_UPPER)+(r[i+1]&e.MASK_LOWER);r[i]=r[i+e.M-e.N]^a>>>1^-(1&a)&e.A}var s=(r[e.N-1]&e.MASK_UPPER)+(r[0]&e.MASK_LOWER);return r[e.N-1]=r[e.M-1]^s>>>1^-(1&s)&e.A,r},e.seeded=function(t){var r=Array(e.N);r[0]=t;for(var i=1;i!==e.N;++i){var n=r[i-1]^r[i-1]>>>30;r[i]=Math.imul(e.F,n)+i|0}return r},e.from=function(t){return new e(e.twist(e.seeded(t)),0)},e.prototype.clone=function(){return new e(this.states,this.index)},e.prototype.next=function(){var t=new e(this.states,this.index);return[t.unsafeNext(),t]},e.prototype.unsafeNext=function(){var t=this.states[this.index];return t^=this.states[this.index]>>>e.U,t^=t<<e.S&e.B,t^=t<<e.T&e.C,t^=t>>>e.L,++this.index>=e.N&&(this.states=e.twist(this.states),this.index=0),t},e.prototype.getState=function(){return eO([this.index],eA(this.states),!1)},e.fromState=function(t){if(!(t.length===e.N+1&&t[0]>=0&&t[0]<e.N))throw Error("The state must have been produced by a mersenne RandomGenerator");return new e(t.slice(1),t[0])},e.N=624,e.M=397,e.R=31,e.A=0x9908b0df,e.F=0x6c078965,e.U=11,e.S=7,e.B=0x9d2c5680,e.T=15,e.C=0xefc60000,e.L=18,e.MASK_LOWER=Math.pow(2,e.R)-1,e.MASK_UPPER=Math.pow(2,e.R),e}();let eM=Object.assign(function(e){return e_.from(e)},{fromState:function(e){return e_.fromState(e)}});var eD=function(){function e(e,t,r,i){this.s01=e,this.s00=t,this.s11=r,this.s10=i}return e.prototype.clone=function(){return new e(this.s01,this.s00,this.s11,this.s10)},e.prototype.next=function(){var t=new e(this.s01,this.s00,this.s11,this.s10);return[t.unsafeNext(),t]},e.prototype.unsafeNext=function(){var e=this.s00^this.s00<<23,t=this.s01^(this.s01<<23|this.s00>>>9),r=e^this.s10^(e>>>18|t<<14)^(this.s10>>>5|this.s11<<27),i=t^this.s11^t>>>18^this.s11>>>5,n=this.s00+this.s10|0;return this.s01=this.s11,this.s00=this.s10,this.s11=i,this.s10=r,n},e.prototype.jump=function(){var t=new e(this.s01,this.s00,this.s11,this.s10);return t.unsafeJump(),t},e.prototype.unsafeJump=function(){for(var e=0,t=0,r=0,i=0,n=[0x635d2dff,0x8a5cd789,0x5c472f96,0x121fd215],a=0;4!==a;++a)for(var s=1;s;s<<=1)n[a]&s&&(e^=this.s01,t^=this.s00,r^=this.s11,i^=this.s10),this.unsafeNext();this.s01=e,this.s00=t,this.s11=r,this.s10=i},e.prototype.getState=function(){return[this.s01,this.s00,this.s11,this.s10]},e}(),eN=Object.assign(function(e){return new eD(-1,~e,0|e,0)},{fromState:function(e){if(4!==e.length)throw Error("The state must have been produced by a xorshift128plus RandomGenerator");return new eD(e[0],e[1],e[2],e[3])}}),eP=function(){function e(e,t,r,i){this.s01=e,this.s00=t,this.s11=r,this.s10=i}return e.prototype.clone=function(){return new e(this.s01,this.s00,this.s11,this.s10)},e.prototype.next=function(){var t=new e(this.s01,this.s00,this.s11,this.s10);return[t.unsafeNext(),t]},e.prototype.unsafeNext=function(){var e=this.s00+this.s10|0,t=this.s10^this.s00,r=this.s11^this.s01,i=this.s00,n=this.s01;return this.s00=i<<24^n>>>8^t^t<<16,this.s01=n<<24^i>>>8^r^(r<<16|t>>>16),this.s10=r<<5^t>>>27,this.s11=t<<5^r>>>27,e},e.prototype.jump=function(){var t=new e(this.s01,this.s00,this.s11,this.s10);return t.unsafeJump(),t},e.prototype.unsafeJump=function(){for(var e=0,t=0,r=0,i=0,n=[0xd8f554a5,0xdf900294,0x4b3201fc,0x170865df],a=0;4!==a;++a)for(var s=1;s;s<<=1)n[a]&s&&(e^=this.s01,t^=this.s00,r^=this.s11,i^=this.s10),this.unsafeNext();this.s01=e,this.s00=t,this.s11=r,this.s10=i},e.prototype.getState=function(){return[this.s01,this.s00,this.s11,this.s10]},e}(),eL=Object.assign(function(e){return new eP(-1,~e,0|e,0)},{fromState:function(e){if(4!==e.length)throw Error("The state must have been produced by a xoroshiro128plus RandomGenerator");return new eP(e[0],e[1],e[2],e[3])}});function eU(e,t){if(e.sign!==t.sign)return ez(e,{sign:-t.sign,data:t.data});for(var r=[],i=0,n=e.data,a=t.data,s=n.length-1,o=a.length-1;s>=0||o>=0;--s,--o){var l=(s>=0?n[s]:0)+(o>=0?a[o]:0)+i;r.push(l>>>0),i=~~(l/0x100000000)}return 0!==i&&r.push(i),{sign:e.sign,data:r.reverse()}}function ez(e,t){if(e.sign!==t.sign)return eU(e,{sign:-t.sign,data:t.data});var r=e.data,i=t.data;if(function(e,t){for(var r=Math.max(e.length,t.length),i=0;i<r;++i){var n=i+e.length-r,a=i+t.length-r,s=n>=0?e[n]:0,o=a>=0?t[a]:0;if(s<o)return!0;if(s>o)break}return!1}(r,i)){var n=ez(t,e);return n.sign=-n.sign,n}for(var a=[],s=0,o=r.length-1,l=i.length-1;o>=0||l>=0;--o,--l){var u=(o>=0?r[o]:0)-(l>=0?i[l]:0)-s;a.push(u>>>0),s=+(u<0)}return{sign:e.sign,data:a.reverse()}}function eW(e){for(var t=e.data,r=0;r!==t.length&&0===t[r];++r);return r===t.length?(e.sign=1,e.data=[0]):t.splice(0,r),e}function eB(e,t){if(t<0){var r=-t;e.sign=-1,e.data[0]=~~(r/0x100000000),e.data[1]=r>>>0}else e.sign=1,e.data[0]=~~(t/0x100000000),e.data[1]=t>>>0;return e}function eq(e,t){for(var r=e>2?~~(0x100000000/e)*e:0x100000000,i=t.unsafeNext()+0x80000000;i>=r;)i=t.unsafeNext()+0x80000000;return i%e}function e$(e,t,r){for(var i=t.length;;){for(var n=0;n!==i;++n){var a=eq(0===n?t[0]+1:0x100000000,r);e[n]=a}for(var n=0;n!==i;++n){var s=e[n],o=t[n];if(s<o)return e;if(s>o)break}}}function ej(e,t,r){var i=eW(function(e){e.sign=1;for(var t=e.data,r=t.length-1;r>=0;--r)if(0xffffffff!==t[r])return t[r]+=1,e;else t[r]=0;return t.unshift(1),e}(ez(t,e)));return eW(eU({sign:1,data:e$(i.data.slice(0),i.data,r)},e))}var eV="u">typeof BigInt?BigInt:void 0;function eH(e,t,r){for(var i=t-e+eV(1),n=eV(-0x80000000),a=eV(0x100000000),s=a,o=1;s<i;)s*=a,++o;for(var l=s-s%i;;){for(var u=eV(0),c=0;c!==o;++c)u=a*u+(eV(r.unsafeNext())-n);if(u<l)return u%i+e}}var eG=Number.MAX_SAFE_INTEGER,eK={sign:1,data:[0,0]},eJ={sign:1,data:[0,0]},eZ={sign:1,data:[0,0]},eQ=[0,0];function eY(e,t,r){var i,n=t-e;return n<=0xffffffff?eq(n+1,r)+e:(0xffffffff===(i=n<=eG?eB(eZ,n):function(e,t,r){var i=t.data[1],n=t.data[0],a=t.sign,s=r.data[1],o=r.data[0],l=r.sign;if(e.sign=1,1===a&&-1===l){var u=i+s;return e.data[0]=n+o+ +(u>0xffffffff)>>>0,e.data[1]=u>>>0,e}var c=i,d=n,p=s,f=o;-1===a&&(c=s,d=o,p=i,f=n);var h=0,m=c-p;return m<0&&(h=1,m>>>=0),e.data[0]=d-f-h,e.data[1]=m,e}(eZ,eB(eK,t),eB(eJ,e))).data[1]?(i.data[0]+=1,i.data[1]=0):i.data[1]+=1,e$(eQ,i.data,r),0x100000000*eQ[0]+eQ[1]+e)}var eX="module",e0="6.1.0",e1="a413dd2b721516be2ef29adffb515c5ae67bfbad";e.s(["__commitHash",0,e1,"__type",0,eX,"__version",0,e0],8865016),e.i(8865016),e.s(["__commitHash",0,e1,"__type",0,eX,"__version",0,e0,"congruential32",0,eF,"generateN",0,function(e,t){var r=e.clone();return[ek(r,t),r]},"mersenne",0,eM,"skipN",0,function(e,t){var r=e.clone();return eI(r,t),r},"uniformArrayIntDistribution",0,function(e,t,r){if(null!=r){var i=r.clone();return[ej(e,t,i),i]}return function(r){var i=r.clone();return[ej(e,t,i),i]}},"uniformBigIntDistribution",0,function(e,t,r){if(null!=r){var i=r.clone();return[eH(e,t,i),i]}return function(r){var i=r.clone();return[eH(e,t,i),i]}},"uniformIntDistribution",0,function(e,t,r){if(null!=r){var i=r.clone();return[eY(e,t,i),i]}return function(r){var i=r.clone();return[eY(e,t,i),i]}},"unsafeGenerateN",0,ek,"unsafeSkipN",0,eI,"unsafeUniformArrayIntDistribution",0,ej,"unsafeUniformBigIntDistribution",0,eH,"unsafeUniformIntDistribution",0,eY,"xoroshiro128plus",0,eL,"xorshift128plus",0,eN],6346344);var e2=e.i(6346344);(t=n||(n={}))[t.None=0]="None",t[t.Verbose=1]="Verbose",t[t.VeryVerbose=2]="VeryVerbose";let e5=Date.now,e3=Math.min,e8=Math.random;class e4{constructor(e){const t=e||{};this.seed=e4.readSeed(t),this.randomType=e4.readRandomType(t),this.numRuns=e4.readNumRuns(t),this.verbose=e4.readVerbose(t),this.maxSkipsPerRun=e4.readOrDefault(t,"maxSkipsPerRun",100),this.timeout=e4.safeTimeout(e4.readOrDefault(t,"timeout",null)),this.skipAllAfterTimeLimit=e4.safeTimeout(e4.readOrDefault(t,"skipAllAfterTimeLimit",null)),this.interruptAfterTimeLimit=e4.safeTimeout(e4.readOrDefault(t,"interruptAfterTimeLimit",null)),this.markInterruptAsFailure=e4.readBoolean(t,"markInterruptAsFailure"),this.skipEqualValues=e4.readBoolean(t,"skipEqualValues"),this.ignoreEqualValues=e4.readBoolean(t,"ignoreEqualValues"),this.logger=e4.readOrDefault(t,"logger",e=>{console.log(e)}),this.path=e4.readOrDefault(t,"path",""),this.unbiased=e4.readBoolean(t,"unbiased"),this.examples=e4.readOrDefault(t,"examples",[]),this.endOnFailure=e4.readBoolean(t,"endOnFailure"),this.reporter=e4.readOrDefault(t,"reporter",null),this.asyncReporter=e4.readOrDefault(t,"asyncReporter",null),this.errorWithCause=e4.readBoolean(t,"errorWithCause")}toParameters(){let e=e=>null!==e?e:void 0;return{seed:this.seed,randomType:this.randomType,numRuns:this.numRuns,maxSkipsPerRun:this.maxSkipsPerRun,timeout:e(this.timeout),skipAllAfterTimeLimit:e(this.skipAllAfterTimeLimit),interruptAfterTimeLimit:e(this.interruptAfterTimeLimit),markInterruptAsFailure:this.markInterruptAsFailure,skipEqualValues:this.skipEqualValues,ignoreEqualValues:this.ignoreEqualValues,path:this.path,logger:this.logger,unbiased:this.unbiased,verbose:this.verbose,examples:this.examples,endOnFailure:this.endOnFailure,reporter:e(this.reporter),asyncReporter:e(this.asyncReporter),errorWithCause:this.errorWithCause}}static read(e){return new e4(e)}}e4.createQualifiedRandomGenerator=e=>t=>{let r=e(t);return void 0===r.unsafeJump&&(r.unsafeJump=()=>eI(r,42)),r},e4.readSeed=e=>{if(null==e.seed)return e5()^0x100000000*e8();let t=0|e.seed;if(e.seed===t)return t;let r=e.seed-t;return t^0x100000000*r},e4.readRandomType=e=>{if(null==e.randomType)return e2.xorshift128plus;if("string"==typeof e.randomType)switch(e.randomType){case"mersenne":return e4.createQualifiedRandomGenerator(e2.mersenne);case"congruential":case"congruential32":return e4.createQualifiedRandomGenerator(e2.congruential32);case"xorshift128plus":return e2.xorshift128plus;case"xoroshiro128plus":return e2.xoroshiro128plus;default:throw Error(`Invalid random specified: '${e.randomType}'`)}let t=e.randomType(0);if("min"in t&&-0x80000000!==t.min)throw Error(`Invalid random number generator: min must equal -0x80000000, got ${String(t.min)}`);if("max"in t&&0x7fffffff!==t.max)throw Error(`Invalid random number generator: max must equal 0x7fffffff, got ${String(t.max)}`);return"unsafeJump"in t?e.randomType:e4.createQualifiedRandomGenerator(e.randomType)},e4.readNumRuns=e=>null!=e.numRuns?e.numRuns:null!=e.num_runs?e.num_runs:100,e4.readVerbose=e=>null==e.verbose?n.None:"boolean"==typeof e.verbose?!0===e.verbose?n.Verbose:n.None:e.verbose<=n.None?n.None:e.verbose>=n.VeryVerbose?n.VeryVerbose:0|e.verbose,e4.readBoolean=(e,t)=>!0===e[t],e4.readOrDefault=(e,t,r)=>{let i=e[t];return null!=i?i:r},e4.safeTimeout=e=>null===e?null:e3(e,0x7fffffff);var e6=e.i(8107641);let e9=Array.from,e7=void 0!==e6.Buffer?e6.Buffer.isBuffer:void 0,te=JSON.stringify,tt=Number.isNaN,tr=Object.keys,ti=Object.getOwnPropertySymbols,tn=Object.getOwnPropertyDescriptor,ta=Object.getPrototypeOf,ts=-1/0,to=1/0,tl=Symbol.for("fast-check/toStringMethod"),tu=Symbol.for("fast-check/asyncToStringMethod"),tc=/^Symbol\((.*)\)$/;function td(e){switch(e){case 0:return 1/e===ts?"-0":"0";case ts:return"Number.NEGATIVE_INFINITY";case to:return"Number.POSITIVE_INFINITY";default:return e==e?V(e):"Number.NaN"}}function tp(e){return function e(t,r,i){var n,a;let s=[...r,t];if("object"==typeof t&&-1!==ee(r,t))return"[cyclic]";if(null!==t&&("object"==typeof t||"function"==typeof t)&&tu in t&&"function"==typeof t[tu]){let e=i(t);if("fulfilled"===e.state)return e.value}if(null!==t&&("object"==typeof t||"function"==typeof t)&&tl in t&&"function"==typeof t[tl])try{return t[tl]()}catch(e){}switch(q(eh,t,[])){case"[object Array]":{if(t.length>=50&&function(e){let t=-1;for(let r in e){let e=Number(r);if(e!==t+1)return!0;t=e}return t+1!==e.length}(t)){let r=[];for(let n in t)tt(Number(n))||ei(r,`${n}:${e(t[n],s,i)}`);return 0!==r.length?`Object.assign(Array(${t.length}),{${et(r,",")}})`:`Array(${t.length})`}let r=et(er(t,t=>e(t,s,i)),",");return 0===t.length||t.length-1 in t?`[${r}]`:`[${r},]`}case"[object BigInt]":return`${t}n`;case"[object Boolean]":{let e=!0==t?"true":"false";return"boolean"==typeof t?e:`new Boolean(${e})`}case"[object Date]":return tt(function(e){try{return e.getTime}catch(e){return}}(t)===ea?t.getTime():q(ea,t,[]))?"new Date(NaN)":`new Date(${te(function(e){try{return e.toISOString}catch(e){return}}(t)===es?t.toISOString():q(es,t,[]))})`;case"[object Map]":return`new Map(${e(Array.from(t),s,i)})`;case"[object Null]":return"null";case"[object Number]":return"number"==typeof t?td(t):`new Number(${td(Number(t))})`;case"[object Object]":{try{let e=t.toString;if("function"==typeof e&&e!==Object.prototype.toString)return t.toString()}catch(e){return"[object Object]"}let r=r=>`${"__proto__"===r?'["__proto__"]':"symbol"==typeof r?`[${e(r,s,i)}]`:te(r)}:${e(t[r],s,i)}`,o="{"+et([...er(tr(t),r),...er((n=ti(t),a=e=>{let r=tn(t,e);return r&&r.enumerable},function(e){try{return e.filter}catch(e){return}}(n)===Q?n.filter(a):q(Q,n,[a])),r)],",")+"}";if(null===ta(t))return"{}"===o?"Object.create(null)":`Object.assign(Object.create(null),${o})`;return o}case"[object Set]":return`new Set(${e(Array.from(t),s,i)})`;case"[object String]":return"string"==typeof t?te(t):`new String(${te(t)})`;case"[object Symbol]":{if(void 0!==G.keyFor(t))return`Symbol.for(${te(G.keyFor(t))})`;let e=function(e){if(void 0!==e.description)return e.description;let t=tc.exec(V(e));return t&&t[1].length?t[1]:null}(t);if(null===e)return"Symbol()";return t===(e.startsWith("Symbol.")&&G[e.substring(7)])?e:`Symbol(${te(e)})`}case"[object Promise]":{let r=i(t);switch(r.state){case"fulfilled":return`Promise.resolve(${e(r.value,s,i)})`;case"rejected":return`Promise.reject(${e(r.value,s,i)})`;case"pending":return"new Promise(() => {/*pending*/})";default:return"new Promise(() => {/*unknown*/})"}}case"[object Error]":if(t instanceof Error)return`new Error(${e(t.message,s,i)})`;break;case"[object Undefined]":return"undefined";case"[object Int8Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Int16Array]":case"[object Uint16Array]":case"[object Int32Array]":case"[object Uint32Array]":case"[object Float32Array]":case"[object Float64Array]":case"[object BigInt64Array]":case"[object BigUint64Array]":{if("function"==typeof e7&&e7(t))return`Buffer.from(${e(e9(t.values()),s,i)})`;let r=ta(t),n=r&&r.constructor&&r.constructor.name;if("string"==typeof n){let r=t.values();return`${n}.from(${e(e9(r),s,i)})`}}}try{return t.toString()}catch(e){return q(eh,t,[])}}(e,[],()=>({state:"unknown",value:void 0}))}(r=a||(a={}))[r.Success=0]="Success",r[r.Skipped=-1]="Skipped",r[r.Failure=1]="Failure";class tf{constructor(e,t){this.verbosity=e,this.interruptedAsFailure=t,this.isSuccess=()=>null==this.pathToFailure,this.firstFailure=()=>this.pathToFailure?+ed(this.pathToFailure,":")[0]:-1,this.numShrinks=()=>this.pathToFailure?ed(this.pathToFailure,":").length-1:0,this.rootExecutionTrees=[],this.currentLevelExecutionTrees=this.rootExecutionTrees,this.failure=null,this.numSkips=0,this.numSuccesses=0,this.interrupted=!1}appendExecutionTree(e,t){let r={status:e,value:t,children:[]};return this.currentLevelExecutionTrees.push(r),r}fail(e,t,r){if(this.verbosity>=n.Verbose){let t=this.appendExecutionTree(a.Failure,e);this.currentLevelExecutionTrees=t.children}null==this.pathToFailure?this.pathToFailure=`${t}`:this.pathToFailure+=`:${t}`,this.value=e,this.failure=r}skip(e){this.verbosity>=n.VeryVerbose&&this.appendExecutionTree(a.Skipped,e),null==this.pathToFailure&&++this.numSkips}success(e){this.verbosity>=n.VeryVerbose&&this.appendExecutionTree(a.Success,e),null==this.pathToFailure&&++this.numSuccesses}interrupt(){this.interrupted=!0}extractFailures(){if(this.isSuccess())return[];let e=[],t=this.rootExecutionTrees;for(;t.length>0&&t[t.length-1].status===a.Failure;){let r=t[t.length-1];e.push(r.value),t=r.children}return e}toRunDetails(e,t,r,i){if(!this.isSuccess())return{failed:!0,interrupted:this.interrupted,numRuns:this.firstFailure()+1-this.numSkips,numSkips:this.numSkips,numShrinks:this.numShrinks(),seed:e,counterexample:this.value,counterexamplePath:tf.mergePaths(t,this.pathToFailure),error:this.failure.errorMessage,errorInstance:this.failure.error,failures:this.extractFailures(),executionSummary:this.rootExecutionTrees,verbose:this.verbosity,runConfiguration:i.toParameters()};let n=this.interruptedAsFailure||0===this.numSuccesses;return{failed:this.numSkips>r||this.interrupted&&n,interrupted:this.interrupted,numRuns:this.numSuccesses,numSkips:this.numSkips,numShrinks:0,seed:e,counterexample:null,counterexamplePath:null,error:null,errorInstance:null,failures:[],executionSummary:this.rootExecutionTrees,verbose:this.verbosity,runConfiguration:i.toParameters()}}}tf.mergePaths=(e,t)=>{if(0===e.length)return t;let r=e.split(":"),i=t.split(":"),n=+r[r.length-1]+ +i[0];return[...r.slice(0,r.length-1),`${n}`,...i.slice(1)].join(":")};class th{constructor(e){this.internalRng=e.clone()}clone(){return new th(this.internalRng)}next(e){return eY(0,(1<<e)-1,this.internalRng)}nextBoolean(){return 1==eY(0,1,this.internalRng)}nextInt(e,t){return eY(null==e?th.MIN_INT:e,null==t?th.MAX_INT:t,this.internalRng)}nextBigInt(e,t){return eH(e,t,this.internalRng)}nextArrayInt(e,t){return ej(e,t,this.internalRng)}nextDouble(){let e=this.next(26),t=this.next(27);return(e*th.DBL_FACTOR+t)*th.DBL_DIVISOR}getState(){if("getState"in this.internalRng&&"function"==typeof this.internalRng.getState)return this.internalRng.getState()}}th.MIN_INT=-0x80000000,th.MAX_INT=0x7fffffff,th.DBL_FACTOR=0x8000000,th.DBL_DIVISOR=11102230246251565e-32;let tm=Math.floor,tg=Math.log;function ty(e){return tm(tg(e)/tg(2))}let tS=Math.ceil,tb=Math.floor;function tv(e,t,r){let i=e-t;return new C(i>0?function*(){let n=r?void 0:t,a=r?i:tb(i/2);for(let r=a;r>0;r=tb(r/2)){let a=r===i?t:e-r;yield new _(a,n),n=a}}():function*(){let n=r?void 0:t,a=r?i:tS(i/2);for(let r=a;r<0;r=tS(r/2)){let a=r===i?t:e-r;yield new _(a,n),n=a}}())}let tE=Math.sign,tw=Number.isInteger,tk=Object.is;class tI extends D{constructor(e,t){super(),this.min=e,this.max=t}generate(e,t){let r=this.computeGenerateRange(e,t);return new _(e.nextInt(r.min,r.max),void 0)}canShrinkWithoutContext(e){return"number"==typeof e&&tw(e)&&!tk(e,-0)&&this.min<=e&&e<=this.max}shrink(e,t){return tI.isValidContext(e,t)?this.isLastChanceTry(e,t)?C.of(new _(t,void 0)):tv(e,t,!1):tv(e,this.defaultTarget(),!0)}defaultTarget(){return this.min<=0&&this.max>=0?0:this.min<0?this.max:this.min}computeGenerateRange(e,t){if(void 0===t||1!==e.nextInt(1,t))return{min:this.min,max:this.max};let r=function(e,t,r){if(e===t)return[{min:e,max:t}];if(e<0&&t>0){let i=r(-e),n=r(t);return[{min:-i,max:n},{min:t-n,max:t},{min:e,max:e+i}]}let i=r(t-e),n={min:e,max:e+i},a={min:t-i,max:t};return e<0?[a,n]:[n,a]}(this.min,this.max,ty);if(1===r.length)return r[0];let i=e.nextInt(-2*(r.length-1),r.length-2);return i<0?r[0]:r[i+1]}isLastChanceTry(e,t){return e>0?e===t+1&&e>this.min:e<0&&e===t-1&&e<this.max}static isValidContext(e,t){if(void 0===t)return!1;if("number"!=typeof t)throw Error("Invalid context type passed to IntegerArbitrary (#1)");if(0!==t&&tE(e)!==tE(t))throw Error("Invalid context value passed to IntegerArbitrary (#2)");return!0}}let tT=Number.isInteger;function tx(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={min:void 0!==e.min?e.min:-0x80000000,max:void 0!==e.max?e.max:0x7fffffff};if(t.min>t.max)throw Error("fc.integer maximum value should be equal or greater than the minimum one");if(!tT(t.min))throw Error("fc.integer minimum value should be an integer");if(!tT(t.max))throw Error("fc.integer maximum value should be an integer");return new tI(t.min,t.max)}let tC=new Map;class tR{constructor(e,t,r){this.arb=e,this.mrng=t,this.biasFactor=r}attemptExact(){}next(){return this.arb.generate(this.mrng,this.biasFactor)}}let tF=Math.min,tA=Math.max;class tO{constructor(e,t,r,i){this.arb=e,this.mrng=t,this.slices=r,this.biasFactor=i,this.activeSliceIndex=0,this.nextIndexInSlice=0,this.lastIndexInSlice=-1}attemptExact(e){if(0!==e&&1===this.mrng.nextInt(1,this.biasFactor)){let t=[];for(let r=0;r!==this.slices.length;++r)this.slices[r].length===e&&ei(t,r);0!==t.length&&(this.activeSliceIndex=t[this.mrng.nextInt(0,t.length-1)],this.nextIndexInSlice=0,this.lastIndexInSlice=e-1)}}next(){if(this.nextIndexInSlice<=this.lastIndexInSlice)return new _(this.slices[this.activeSliceIndex][this.nextIndexInSlice++],void 0);if(1!==this.mrng.nextInt(1,this.biasFactor))return this.arb.generate(this.mrng,this.biasFactor);this.activeSliceIndex=this.mrng.nextInt(0,this.slices.length-1);let e=this.slices[this.activeSliceIndex];if(1!==this.mrng.nextInt(1,this.biasFactor))return this.nextIndexInSlice=1,this.lastIndexInSlice=e.length-1,new _(e[0],void 0);let t=this.mrng.nextInt(0,e.length-1),r=this.mrng.nextInt(0,e.length-1);return this.nextIndexInSlice=tF(t,r),this.lastIndexInSlice=tA(t,r),new _(e[this.nextIndexInSlice++],void 0)}}function t_(e,t,r,i){return void 0===i||0===r.length||1!==t.nextInt(1,i)?new tR(e,t,i):new tO(e,t,r,i)}let tM=Math.floor,tD=Math.log,tN=Math.max,tP=Array.isArray;function tL(e,t){return e===t?e:e+tM(tD(t-e)/tD(2))}class tU extends D{constructor(e,t,r,i,n,a,s){super(),this.arb=e,this.minLength=t,this.maxGeneratedLength=r,this.maxLength=i,this.setBuilder=a,this.customSlices=s,this.lengthArb=tx({min:t,max:r}),this.depthContext=function(e){if(void 0===e)return{depth:0};if("string"!=typeof e)return e;let t=function(e){try{return e.get}catch(e){return}}(tC)===el?tC.get(e):q(el,tC,[e]);if(void 0!==t)return t;let r={depth:0};return function(e){try{return e.set}catch(e){return}}(tC)===eo?tC.set(e,r):q(eo,tC,[e,r]),r}(n)}preFilter(e){if(void 0===this.setBuilder)return e;let t=this.setBuilder();for(let r=0;r!==e.length;++r)t.tryAdd(e[r]);return t.getData()}static makeItCloneable(e,t){return e[R]=()=>{let e=[];for(let r=0;r!==t.length;++r)ei(e,t[r].value);return this.makeItCloneable(e,t),e},e}generateNItemsNoDuplicates(e,t,r,i){let n=0,a=e(),s=t_(this.arb,r,this.customSlices,i);for(;a.size()<t&&n<this.maxGeneratedLength;){let e=s.next();a.tryAdd(e)?n=0:n+=1}return a.getData()}safeGenerateNItemsNoDuplicates(e,t,r,i){let n=tN(0,t-tL(this.minLength,this.maxGeneratedLength));this.depthContext.depth+=n;try{return this.generateNItemsNoDuplicates(e,t,r,i)}finally{this.depthContext.depth-=n}}generateNItems(e,t,r){let i=[],n=t_(this.arb,t,this.customSlices,r);n.attemptExact(e);for(let t=0;t!==e;++t)ei(i,n.next());return i}safeGenerateNItems(e,t,r){let i=tN(0,e-tL(this.minLength,this.maxGeneratedLength));this.depthContext.depth+=i;try{return this.generateNItems(e,t,r)}finally{this.depthContext.depth-=i}}wrapper(e,t,r,i){let n=t?this.preFilter(e):e,a=!1,s=[],o=[];for(let e=0;e!==n.length;++e){let t=n[e];a=a||t.hasToBeCloned,ei(s,t.value),ei(o,t.context)}return a&&tU.makeItCloneable(s,n),new _(s,{shrunkOnce:t,lengthContext:e.length===n.length&&void 0!==r?r:void 0,itemsContexts:o,startIndex:i})}generate(e,t){let r=this.applyBias(e,t),i=r.size,n=void 0!==this.setBuilder?this.safeGenerateNItemsNoDuplicates(this.setBuilder,i,e,r.biasFactorItems):this.safeGenerateNItems(i,e,r.biasFactorItems);return this.wrapper(n,!1,void 0,0)}applyBias(e,t){if(void 0===t)return{size:this.lengthArb.generate(e,void 0).value};if(this.minLength===this.maxGeneratedLength)return{size:this.lengthArb.generate(e,void 0).value,biasFactorItems:t};if(1!==e.nextInt(1,t))return{size:this.lengthArb.generate(e,void 0).value};if(1!==e.nextInt(1,t)||this.minLength===this.maxGeneratedLength)return{size:this.lengthArb.generate(e,void 0).value,biasFactorItems:t};let r=tL(this.minLength,this.maxGeneratedLength);return{size:tx({min:this.minLength,max:r}).generate(e,void 0).value,biasFactorItems:t}}canShrinkWithoutContext(e){if(!tP(e)||this.minLength>e.length||e.length>this.maxLength)return!1;for(let t=0;t!==e.length;++t)if(!(t in e)||!this.arb.canShrinkWithoutContext(e[t]))return!1;return this.preFilter(er(e,e=>new _(e,void 0))).length===e.length}shrinkItemByItem(e,t,r){let i=[];for(let n=t.startIndex;n<r;++n)ei(i,new em(()=>this.arb.shrink(e[n],t.itemsContexts[n]).map(r=>[[...er(en(e,0,n),(e,r)=>new _(A(e),t.itemsContexts[r])),r,...er(en(e,n+1),(e,r)=>new _(A(e),t.itemsContexts[r+n+1]))],void 0,n])));return C.nil().join(...i)}shrinkImpl(e,t){if(0===e.length)return C.nil();let r=void 0!==t?t:{shrunkOnce:!1,lengthContext:void 0,itemsContexts:[],startIndex:0};return this.lengthArb.shrink(e.length,r.lengthContext).drop(r.shrunkOnce&&void 0===r.lengthContext&&e.length>this.minLength+1?1:0).map(t=>{let i=e.length-t.value;return[er(en(e,i),(e,t)=>new _(A(e),r.itemsContexts[t+i])),t.context,0]}).join(new em(()=>e.length>this.minLength?this.shrinkItemByItem(e,r,1):this.shrinkItemByItem(e,r,e.length))).join(e.length>this.minLength?new em(()=>{let t={shrunkOnce:!1,lengthContext:void 0,itemsContexts:en(r.itemsContexts,1),startIndex:0};return this.shrinkImpl(en(e,1),t).filter(e=>this.minLength<=e[0].length+1).map(t=>[[new _(A(e[0]),r.itemsContexts[0]),...t[0]],void 0,0])}):C.nil())}shrink(e,t){return this.shrinkImpl(e,t).map(e=>this.wrapper(e[0],!0,e[1],e[2]))}}let tz=Math.floor,tW=Math.min,tB=["xsmall","small","medium","large","xlarge"],tq=["-4","-3","-2","-1","=","+1","+2","+3","+4"],t$=String.fromCodePoint;function tj(e,t,r,i){return tx({min:e,max:t}).map(e=>t$(r(e)),e=>i(function(e){if("string"!=typeof e)throw Error("Cannot unmap non-string");if(0===e.length||e.length>2)throw Error("Cannot unmap string with more or less than one character");let t=ep(e,0);if(1===e.length)return t;let r=ep(e,1);if(t<55296||t>56319||r<56320||r>57343)throw Error("Cannot unmap invalid surrogate pairs");return e.codePointAt(0)}(e)))}function tV(e){return e}class tH{constructor(){this.receivedLogs=[]}log(e){this.receivedLogs.push(e)}size(){return this.receivedLogs.length}toString(){return JSON.stringify({logs:this.receivedLogs})}[R](){return new tH}}tj(0,1112063,function(e){if(e<55296)return e<95?e+32:e<=126?e-95:e;return e+2048},function(e){if(e<55296)return e>=32&&e<=126?e-32:e>=0&&e<=31?e+95:e;return e<=57343?-1:e-2048}).map(function(e){let t=H(e);return e!==t?t:`%${function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return function(e){try{return e.toString}catch(e){return}}(e)===ef?e.toString(...r):q(ef,e,r)}(ep(e,0),16)}`},function(e){if("string"!=typeof e)throw Error("Unsupported");return decodeURIComponent(e)}),new WeakMap,Object.create(null),Symbol("adapted-value");let tG=new Float64Array(1);new Uint32Array(tG.buffer,tG.byteOffset);let tK=new Float32Array(1);new Uint32Array(tK.buffer,tK.byteOffset),$.isArray,Symbol("no-key");let tJ={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F",16:"G",17:"H",18:"J",19:"K",20:"M",21:"N",22:"P",23:"Q",24:"R",25:"S",26:"T",27:"V",28:"W",29:"X",30:"Y",31:"Z"};function tZ(e,t){let r="";for(;e.length+r.length<t;)r+="0";return r+e}function tQ(e){let t="";for(let i=e;0!==i;){var r;let e=i>>5;t=((r=i-(e<<5))<10?V(r):tJ[r])+t,i=e}return t}function tY(e){return function(t){return tZ(tQ(~~(t/0x40000000)),e-6)+tZ(tQ(0x3fffffff&t),6)}}tY(10),tY(8);class tX{constructor(e,t){this.commands=e,this.metadataForReplay=t}[Symbol.iterator](){return this.commands[Symbol.iterator]()}[R](){return new tX(this.commands.map(e=>e.clone()),this.metadataForReplay)}toString(){let e=this.commands.filter(e=>e.hasRan).map(e=>e.toString()).join(","),t=this.metadataForReplay();return 0!==t.length?`${e} /*${t}*/`:e}}let t0=e=>e();class t1{constructor(e,t){this.act=e,this.taskSelector=t,this.lastTaskId=0,this.sourceTaskSelector=t.clone(),this.scheduledTasks=[],this.triggeredTasks=[],this.scheduledWatchers=[]}static buildLog(e){return`[task\${${e.taskId}}] ${0!==e.label.length?`${e.schedulingType}::${e.label}`:e.schedulingType} ${e.status}${void 0!==e.outputValue?` with value ${e.outputValue.replace(/([$`\\])/g,"\\$1").replace(/\r/g,"\\r")}`:""}`}log(e,t,r,i,n,a){this.triggeredTasks.push({status:n,schedulingType:e,taskId:t,label:r,metadata:i,outputValue:void 0!==a?tp(a):void 0})}scheduleInternal(e,t,r,i,n,a){let s=null,o=++this.lastTaskId,l=new Promise((n,l)=>{s=()=>{(a?r.then(()=>a()):r).then(r=>(this.log(e,o,t,i,"resolved",r),n(r)),r=>(this.log(e,o,t,i,"rejected",r),l(r)))}});return this.scheduledTasks.push({original:r,scheduled:l,trigger:s,schedulingType:e,taskId:o,label:t,metadata:i,customAct:n}),0!==this.scheduledWatchers.length&&this.scheduledWatchers[0](),l}schedule(e,t,r,i){return this.scheduleInternal("promise",t||"",e,r,i||t0)}scheduleFunction(e,t){var r=this;return function(){for(var i=arguments.length,n=Array(i),a=0;a<i;a++)n[a]=arguments[a];return r.scheduleInternal("function",`${e.name}(${n.map(tp).join(",")})`,e(...n),void 0,t||t0)}}scheduleSequence(e,t){let r={done:!1,faulty:!1},i={then:e=>e()},n=()=>{},a=new Promise(e=>n=e);return e.reduce((e,a)=>{let[s,o,l]="function"==typeof a?[a,a.name,void 0]:[a.builder,a.label,a.metadata];return e.then(()=>{let e=this.scheduleInternal("sequence",o,i,l,t||t0,()=>s());return e.catch(()=>{r.faulty=!0,n()}),e})},i).then(()=>{r.done=!0,n()},()=>{}),Object.assign(r,{task:Promise.resolve(a).then(()=>({done:r.done,faulty:r.faulty}))})}count(){return this.scheduledTasks.length}internalWaitOne(){if(0===this.scheduledTasks.length)throw Error("No task scheduled");let e=this.taskSelector.nextTaskIndex(this.scheduledTasks),[t]=this.scheduledTasks.splice(e,1);return t.customAct(async()=>{t.trigger();try{await t.scheduled}catch(e){}})}async waitOne(e){let t=e||t0;await this.act(()=>t(async()=>await this.internalWaitOne()))}async waitAll(e){for(;this.scheduledTasks.length>0;)await this.waitOne(e)}async waitFor(e,t){let r=!1,i=null,n=async()=>{for(;!r&&this.scheduledTasks.length>0;)await this.waitOne(t);i=null},a=()=>{null===i&&(i=Promise.resolve().then(n))},s=()=>{let e=this.scheduledWatchers.indexOf(a);-1!==e&&this.scheduledWatchers.splice(e,1),0===e&&0!==this.scheduledWatchers.length&&this.scheduledWatchers[0]()},o=e.then(e=>(r=!0,null===i)?(s(),e):i.then(()=>(s(),e)),e=>{if(r=!0,null===i)throw s(),e;return i.then(()=>{throw s(),e})});return this.scheduledTasks.length>0&&0===this.scheduledWatchers.length&&a(),this.scheduledWatchers.push(a),o}report(){return[...this.triggeredTasks,...this.scheduledTasks.map(e=>({status:"pending",schedulingType:e.schedulingType,taskId:e.taskId,label:e.label,metadata:e.metadata}))]}toString(){return"schedulerFor()`\n"+this.report().map(t1.buildLog).map(e=>`-> ${e}`).join("\n")+"`"}[R](){return new t1(this.act,this.sourceTaskSelector)}}(i=s||(s={}))[i.Full=0]="Full",i[i.Character=1]="Character",[..."abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_"],[..."0123456789"],[..." 	\r\n\v\f"],[..."\r\n",..."\x1e\x15"],tj(32,126,tV,tV),e.s(["__commitHash",0,"a4a600eaa08c833707067a877db144289a724b91","__type",0,"module","__version",0,"3.23.2"],8739447),e.i(8739447);var t2=e.i(1150852),t5=e.i(3683485),t3=e.i(9159985),t8=e.i(5015632),t4=e.i(9390854),t6=e.i(4043929),t9=e.i(4935619);let t7=(e,t)=>{switch(t._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(e);case"SymbolKeyword":return Object.getOwnPropertySymbols(e);case"Refinement":return t7(e,t.from)}},re=e=>{let t,r=!1;return()=>(r||(t=e(),r=!0),t)},rt=e=>{try{return e.toISOString()}catch{return String(e)}},rr="[Circular]";function ri(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=new WeakSet,i=t?"number"==typeof t?" ".repeat(t):t:"",n=(e,t)=>{let r=e?.constructor;return r&&r!==Object.prototype.constructor&&r.name?`${r.name}(${t})`:t};return function e(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(Array.isArray(t)){let n,s;if(r.has(t))return rr;if(r.add(t),!i||t.length<=1)return`[${t.map(t=>e(t,a)).join(",")}]`;let o=t.map(t=>e(t,a+1)).join(",\n"+(n=a+1,i.repeat(n)));return`[
${s=a+1,i.repeat(s)}${o}
${i.repeat(a)}]`}if(t9.isDate(t))return rt(t);if(t9.hasProperty(t,"toString")&&t9.isFunction(t.toString)&&t.toString!==Object.prototype.toString)try{let e=t.toString();return"string"==typeof e?e:String(e)}catch{return"[toString threw]"}if(t9.isString(t))return JSON.stringify(t);if(t9.isNumber(t)||null==t||t9.isBoolean(t)||t9.isSymbol(t))return String(t);if(t9.isBigInt(t))return String(t)+"n";if(t instanceof Set||t instanceof Map)return r.has(t)?rr:(r.add(t),`${t.constructor.name}(${e(Array.from(t),a)})`);if(t9.isObject(t)){if(r.has(t))return rr;r.add(t);let s=(e=>{try{return Reflect.ownKeys(e)}catch{return["[ownKeys threw]"]}})(t);if(!i||s.length<=1){let r=`{${s.map(r=>`${rn(r)}:${e(t[r],a)}`).join(",")}}`;return n(t,r)}let o=`{
${s.map(r=>{let n;return`${n=a+1,i.repeat(n)}${rn(r)}: ${e(t[r],a+1)}`}).join(",\n")}
${i.repeat(a)}}`;return n(t,o)}return String(t)}(e,0)}function rn(e){return t9.isString(e)?JSON.stringify(e):String(e)}let ra=e=>`[${rn(e)}]`,rs=e=>Array.isArray(e)?e.map(ra).join(""):ra(e),ro=(e,t,r,i)=>{let n=e;return r&&o.isNonEmptyReadonlyArray(r)&&(n+=`
at path: ${rs(r)}`),void 0!==t&&(n+=`
details: ${t}`),i&&(n+=`
schema (${i._tag}): ${i}`),n},rl=(e,t,r)=>ro("Unsupported schema or overlapping types",`cannot extend ${e} with ${t}`,r),ru=e=>ro("Unsupported schema",void 0,void 0,e),rc=e=>ro("Duplicate index signature",`${e} index signature`),rd=ro("Unsupported index signature parameter","An index signature parameter type must be `string`, `symbol`, a template literal type or a refinement of the previous types"),rp=ro("Invalid element","A required element cannot follow an optional element. ts(1257)"),rf=e=>ro("Duplicate property signature transformation",`Duplicate key ${ri(e)}`),rh=e=>ro("Duplicate property signature",`Duplicate key ${ri(e)}`),rm=Symbol.for("effect/SchemaId/DateFromSelf"),rg=Symbol.for("effect/SchemaId/GreaterThan"),ry=Symbol.for("effect/SchemaId/GreaterThanOrEqualTo"),rS=Symbol.for("effect/SchemaId/LessThan"),rb=Symbol.for("effect/SchemaId/LessThanOrEqualTo"),rv=Symbol.for("effect/SchemaId/Int"),rE=Symbol.for("effect/SchemaId/NonNaN"),rw=Symbol.for("effect/SchemaId/Finite"),rk=Symbol.for("effect/SchemaId/JsonNumber"),rI=Symbol.for("effect/SchemaId/Between"),rT=Symbol.for("effect/SchemaId/GreaterThanBigint"),rx=Symbol.for("effect/SchemaId/GreaterThanOrEqualToBigint"),rC=Symbol.for("effect/SchemaId/LessThanBigint"),rR=Symbol.for("effect/SchemaId/LessThanOrEqualToBigint"),rF=Symbol.for("effect/SchemaId/BetweenBigint"),rA=Symbol.for("effect/SchemaId/MinLength"),rO=Symbol.for("effect/SchemaId/MaxLength"),r_=Symbol.for("effect/SchemaId/Length"),rM=Symbol.for("effect/SchemaId/MinItems"),rD=Symbol.for("effect/SchemaId/MaxItems"),rN=Symbol.for("effect/SchemaId/ItemsCount");var rP=e.i(6774608),rL=e.i(5921732),rU=e.i(8815901),rz=m,rW=e.i(2873450),rB=e.i(2916763),rq=e.i(6712028),r$=e.i(408695);let rj=Symbol.for("effect/annotation/Brand"),rV=Symbol.for("effect/annotation/SchemaId"),rH=Symbol.for("effect/annotation/Message"),rG=Symbol.for("effect/annotation/MissingMessage"),rK=Symbol.for("effect/annotation/Identifier"),rJ=Symbol.for("effect/annotation/Title"),rZ=Symbol.for("effect/annotation/AutoTitle"),rQ=Symbol.for("effect/annotation/Description"),rY=Symbol.for("effect/annotation/Examples"),rX=Symbol.for("effect/annotation/Default"),r0=Symbol.for("effect/annotation/JSONSchema"),r1=Symbol.for("effect/annotation/Arbitrary"),r2=Symbol.for("effect/annotation/Pretty"),r5=Symbol.for("effect/annotation/Equivalence"),r3=Symbol.for("effect/annotation/Documentation"),r8=Symbol.for("effect/annotation/Concurrency"),r4=Symbol.for("effect/annotation/Batching"),r6=Symbol.for("effect/annotation/ParseIssueTitle"),r9=Symbol.for("effect/annotation/ParseOptions"),r7=Symbol.for("effect/annotation/DecodingFallback"),ie=Symbol.for("effect/annotation/Surrogate"),it=Symbol.for("effect/annotation/StableFilter"),ir=(0,t5.dual)(2,(e,t)=>Object.prototype.hasOwnProperty.call(e.annotations,t)?rU.some(e.annotations[t]):rU.none()),ii=ir(rj),ia=ir(rH),is=ir(rG),io=ir(rJ),il=ir(rZ),iu=ir(rK),ic=ir(rQ),id=ir(r8),ip=ir(r4),ih=ir(r6),im=ir(r9),ig=ir(r7),iy=ir(ie),iS=ir(it),ib=e=>rU.exists(iS(e),e=>!0===e),iv=Symbol.for("effect/annotation/JSONIdentifier"),iE=ir(iv),iw=Symbol.for("effect/schema/ParseJson");class ik{typeParameters;decodeUnknown;encodeUnknown;annotations;_tag="Declaration";constructor(e,t,r,i={}){this.typeParameters=e,this.decodeUnknown=t,this.encodeUnknown=r,this.annotations=i}toString(){return rU.getOrElse(n9(this),()=>"<declaration schema>")}toJSON(){return{_tag:this._tag,typeParameters:this.typeParameters.map(e=>e.toJSON()),annotations:nZ(this.annotations)}}}let iI=e=>t=>t._tag===e;class iT{literal;annotations;_tag="Literal";constructor(e,t={}){this.literal=e,this.annotations=t}toString(){return rU.getOrElse(n9(this),()=>ri(this.literal))}toJSON(){return{_tag:this._tag,literal:t9.isBigInt(this.literal)?String(this.literal):this.literal,annotations:nZ(this.annotations)}}}let ix=iI("Literal"),iC=new iT(null);class iR{symbol;annotations;_tag="UniqueSymbol";constructor(e,t={}){this.symbol=e,this.annotations=t}toString(){return rU.getOrElse(n9(this),()=>ri(this.symbol))}toJSON(){return{_tag:this._tag,symbol:String(this.symbol),annotations:nZ(this.annotations)}}}let iF=iI("UniqueSymbol"),iA=new class{annotations;_tag="UndefinedKeyword";constructor(e={}){this.annotations=e}toString(){return n4(this)}toJSON(){return{_tag:this._tag,annotations:nZ(this.annotations)}}}({[rJ]:"undefined"}),iO=new class{annotations;_tag="VoidKeyword";constructor(e={}){this.annotations=e}toString(){return n4(this)}toJSON(){return{_tag:this._tag,annotations:nZ(this.annotations)}}}({[rJ]:"void"}),i_=new class{annotations;_tag="NeverKeyword";constructor(e={}){this.annotations=e}toString(){return n4(this)}toJSON(){return{_tag:this._tag,annotations:nZ(this.annotations)}}}({[rJ]:"never"}),iM=iI("NeverKeyword"),iD=new class{annotations;_tag="UnknownKeyword";constructor(e={}){this.annotations=e}toString(){return n4(this)}toJSON(){return{_tag:this._tag,annotations:nZ(this.annotations)}}}({[rJ]:"unknown"}),iN=new class{annotations;_tag="AnyKeyword";constructor(e={}){this.annotations=e}toString(){return n4(this)}toJSON(){return{_tag:this._tag,annotations:nZ(this.annotations)}}}({[rJ]:"any"}),iP=new class{annotations;_tag="StringKeyword";constructor(e={}){this.annotations=e}toString(){return n4(this)}toJSON(){return{_tag:this._tag,annotations:nZ(this.annotations)}}}({[rJ]:"string",[rQ]:"a string"}),iL=iI("StringKeyword"),iU=new class{annotations;_tag="NumberKeyword";constructor(e={}){this.annotations=e}toString(){return n4(this)}toJSON(){return{_tag:this._tag,annotations:nZ(this.annotations)}}}({[rJ]:"number",[rQ]:"a number"}),iz=iI("NumberKeyword"),iW=new class{annotations;_tag="BooleanKeyword";constructor(e={}){this.annotations=e}toString(){return n4(this)}toJSON(){return{_tag:this._tag,annotations:nZ(this.annotations)}}}({[rJ]:"boolean",[rQ]:"a boolean"}),iB=iI("BooleanKeyword"),iq=new class{annotations;_tag="BigIntKeyword";constructor(e={}){this.annotations=e}toString(){return n4(this)}toJSON(){return{_tag:this._tag,annotations:nZ(this.annotations)}}}({[rJ]:"bigint",[rQ]:"a bigint"}),i$=new class{annotations;_tag="SymbolKeyword";constructor(e={}){this.annotations=e}toString(){return n4(this)}toJSON(){return{_tag:this._tag,annotations:nZ(this.annotations)}}}({[rJ]:"symbol",[rQ]:"a symbol"}),ij=iI("SymbolKeyword"),iV=new class{annotations;_tag="ObjectKeyword";constructor(e={}){this.annotations=e}toString(){return n4(this)}toJSON(){return{_tag:this._tag,annotations:nZ(this.annotations)}}}({[rJ]:"object",[rQ]:"an object in the TypeScript meaning, i.e. the `object` type"});class iH{enums;annotations;_tag="Enums";constructor(e,t={}){this.enums=e,this.annotations=t}toString(){return rU.getOrElse(n9(this),()=>`<enum ${this.enums.length} value(s): ${this.enums.map(e=>{let[t,r]=e;return JSON.stringify(r)}).join(" | ")}>`)}toJSON(){return{_tag:this._tag,enums:this.enums,annotations:nZ(this.annotations)}}}let iG=iI("Enums"),iK=e=>{switch(e._tag){case"Literal":case"NumberKeyword":case"StringKeyword":case"TemplateLiteral":return!0;case"Union":return e.types.every(iK)}return!1},iJ=e=>{switch(e._tag){case"Literal":return JSON.stringify(String(e.literal));case"StringKeyword":return"string";case"NumberKeyword":return"number";case"TemplateLiteral":return String(e);case"Union":return e.types.map(iJ).join(" | ")}};class iZ{literal;type;constructor(e,t){if(this.literal=t,iK(e))this.type=e;else throw Error((e=>ro("Unsupported template literal span",void 0,void 0,e))(e))}toString(){return(e=>{switch(e._tag){case"Literal":return String(e.literal);case"StringKeyword":return"${string}";case"NumberKeyword":return"${number}";case"TemplateLiteral":return"${"+String(e)+"}";case"Union":return"${"+e.types.map(iJ).join(" | ")+"}"}})(this.type)+this.literal}toJSON(){return{type:this.type.toJSON(),literal:this.literal}}}class iQ{head;spans;annotations;_tag="TemplateLiteral";constructor(e,t,r={}){this.head=e,this.spans=t,this.annotations=r}toString(){return rU.getOrElse(n9(this),()=>iY(this))}toJSON(){return{_tag:this._tag,head:this.head,spans:this.spans.map(e=>e.toJSON()),annotations:nZ(this.annotations)}}}let iY=e=>"`"+e.head+e.spans.map(String).join("")+"`",iX=iI("TemplateLiteral");class i0{type;annotations;constructor(e,t={}){this.type=e,this.annotations=t}toJSON(){return{type:this.type.toJSON(),annotations:nZ(this.annotations)}}toString(){return String(this.type)}}class i1 extends i0{isOptional;constructor(e,t,r={}){super(e,r),this.isOptional=t}toJSON(){return{type:this.type.toJSON(),isOptional:this.isOptional,annotations:nZ(this.annotations)}}toString(){return String(this.type)+(this.isOptional?"?":"")}}let i2=e=>e.map(e=>e.type);class i5{elements;rest;isReadonly;annotations;_tag="TupleType";constructor(e,t,r,i={}){this.elements=e,this.rest=t,this.isReadonly=r,this.annotations=i;let n=!1,a=!1;for(const t of e)if(t.isOptional)n=!0;else if(n){a=!0;break}if(a||n&&t.length>1)throw Error(rp)}toString(){return rU.getOrElse(n9(this),()=>i3(this))}toJSON(){return{_tag:this._tag,elements:this.elements.map(e=>e.toJSON()),rest:this.rest.map(e=>e.toJSON()),isReadonly:this.isReadonly,annotations:nZ(this.annotations)}}}let i3=e=>{let t=e.elements.map(String).join(", ");return o.matchLeft(e.rest,{onEmpty:()=>`readonly [${t}]`,onNonEmpty:(r,i)=>{let n=String(r),a=n.includes(" | ")?`(${n})`:n;if(i.length>0){let r=i.map(String).join(", ");return e.elements.length>0?`readonly [${t}, ...${a}[], ${r}]`:`readonly [...${a}[], ${r}]`}return e.elements.length>0?`readonly [${t}, ...${a}[]]`:`ReadonlyArray<${n}>`}})};class i8 extends i1{name;isReadonly;constructor(e,t,r,i,n){super(t,r,n),this.name=e,this.isReadonly=i}toString(){return(this.isReadonly?"readonly ":"")+String(this.name)+(this.isOptional?"?":"")+": "+this.type}toJSON(){return{name:String(this.name),type:this.type.toJSON(),isOptional:this.isOptional,isReadonly:this.isReadonly,annotations:nZ(this.annotations)}}}let i4=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return i4(e.from)}return!1};class i6{type;isReadonly;parameter;constructor(e,t,r){if(this.type=t,this.isReadonly=r,i4(e))this.parameter=e;else throw Error(rd)}toString(){return(this.isReadonly?"readonly ":"")+`[x: ${this.parameter}]: ${this.type}`}toJSON(){return{parameter:this.parameter.toJSON(),type:this.type.toJSON(),isReadonly:this.isReadonly}}}class i9{annotations;_tag="TypeLiteral";propertySignatures;indexSignatures;constructor(e,t,r={}){this.annotations=r;const i={};for(let t=0;t<e.length;t++){const r=e[t].name;if(Object.prototype.hasOwnProperty.call(i,r))throw Error(rh(r));i[r]=null}const n={string:!1,symbol:!1};for(let e=0;e<t.length;e++){const r=nQ(t[e].parameter);if(iL(r)){if(n.string)throw Error(rc("string"));n.string=!0}else if(ij(r)){if(n.symbol)throw Error(rc("symbol"));n.symbol=!0}}this.propertySignatures=e,this.indexSignatures=t}toString(){return rU.getOrElse(n9(this),()=>ne(this))}toJSON(){return{_tag:this._tag,propertySignatures:this.propertySignatures.map(e=>e.toJSON()),indexSignatures:this.indexSignatures.map(e=>e.toJSON()),annotations:nZ(this.annotations)}}}let i7=e=>e.map(String).join("; "),ne=e=>{if(e.propertySignatures.length>0){let t=e.propertySignatures.map(String).join("; ");return e.indexSignatures.length>0?`{ ${t}; ${i7(e.indexSignatures)} }`:`{ ${t} }`}return e.indexSignatures.length>0?`{ ${i7(e.indexSignatures)} }`:"{}"},nt=iI("TypeLiteral"),nr=o.sort(rq.mapInput(rL.Order,e=>{switch(e._tag){case"AnyKeyword":return 0;case"UnknownKeyword":return 1;case"ObjectKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3}return 4})),ni={string:"StringKeyword",number:"NumberKeyword",boolean:"BooleanKeyword",bigint:"BigIntKeyword"},nn=e=>o.flatMap(e,e=>nl(e)?nn(e.types):[e]);class na{types;annotations;static make=(e,t)=>no(e)?new na(e,t):1===e.length?e[0]:i_;static unify=(e,t)=>na.make((e=>{let t=nr(e),r=[],i={},n=[];for(let e of t)switch(e._tag){case"NeverKeyword":break;case"AnyKeyword":return[iN];case"UnknownKeyword":return[iD];case"ObjectKeyword":case"UndefinedKeyword":case"VoidKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":i[e._tag]||(i[e._tag]=e,r.push(e));break;case"Literal":{let t=typeof e.literal;switch(t){case"string":case"number":case"bigint":case"boolean":i[ni[t]]||n.includes(e.literal)||(n.push(e.literal),r.push(e));break;case"object":n.includes(e.literal)||(n.push(e.literal),r.push(e))}break}case"UniqueSymbol":i.SymbolKeyword||n.includes(e.symbol)||(n.push(e.symbol),r.push(e));break;case"TupleType":i.ObjectKeyword||r.push(e);break;case"TypeLiteral":0===e.propertySignatures.length&&0===e.indexSignatures.length?i["{}"]||(i["{}"]=e,r.push(e)):i.ObjectKeyword||r.push(e);break;default:r.push(e)}return r})(nn(e)),t);_tag="Union";constructor(e,t={}){this.types=e,this.annotations=t}toString(){return rU.getOrElse(n9(this),()=>this.types.map(String).join(" | "))}toJSON(){return{_tag:this._tag,types:this.types.map(e=>e.toJSON()),annotations:nZ(this.annotations)}}}let ns=(e,t)=>e.map(t),no=e=>e.length>1,nl=iI("Union"),nu=(0,t3.globalValue)(Symbol.for("effect/Schema/AST/toJSONMemoMap"),()=>new WeakMap);class nc{f;annotations;_tag="Suspend";constructor(e,t={}){this.f=e,this.annotations=t,this.f=re(e)}toString(){return n9(this).pipe(rU.orElse(()=>rU.flatMap(rU.liftThrowable(this.f)(),e=>n9(e))),rU.getOrElse(()=>"<suspended schema>"))}toJSON(){let e=this.f(),t=nu.get(e);return t||(nu.set(e,{_tag:this._tag}),t={_tag:this._tag,ast:e.toJSON(),annotations:nZ(this.annotations)},nu.set(e,t)),t}}class nd{from;filter;annotations;_tag="Refinement";constructor(e,t,r={}){this.from=e,this.filter=t,this.annotations=r}toString(){return iu(this).pipe(rU.getOrElse(()=>rU.match(n6(this),{onNone:()=>`{ ${this.from} | filter }`,onSome:e=>np(this.from)?String(this.from)+" & "+e:e})))}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),annotations:nZ(this.annotations)}}}let np=iI("Refinement"),nf={};class nh{from;to;transformation;annotations;_tag="Transformation";constructor(e,t,r,i={}){this.from=e,this.to=t,this.transformation=r,this.annotations=i}toString(){return rU.getOrElse(n9(this),()=>`(${String(this.from)} <-> ${String(this.to)})`)}toJSON(){return{_tag:this._tag,from:this.from.toJSON(),to:this.to.toJSON(),annotations:nZ(this.annotations)}}}let nm=iI("Transformation");class ng{decode;encode;_tag="FinalTransformation";constructor(e,t){this.decode=e,this.encode=t}}let ny=new class{_tag="ComposeTransformation"};class nS{from;to;decode;encode;constructor(e,t,r,i){this.from=e,this.to=t,this.decode=r,this.encode=i}}let nb=e=>e.decode===t5.identity&&e.encode===t5.identity;class nv{propertySignatureTransformations;_tag="TypeLiteralTransformation";constructor(e){this.propertySignatureTransformations=e;const t={},r={};for(const i of e){const e=i.from;if(t[e])throw Error(rf(e));t[e]=!0;const n=i.to;if(r[n])throw Error(rf(n));r[n]=!0}}}let nE=e=>"TypeLiteralTransformation"===e._tag,nw=(e,t)=>{let r=Object.getOwnPropertyDescriptors(e),i={...e.annotations};delete i[rK];let n={...i,...t},a=iy(e);return rU.isSome(a)&&(n[ie]=nw(a.value,t)),r.annotations.value=n,Object.create(Object.getPrototypeOf(e),r)},nk=e=>na.unify(n5(e)),nI=(e,t)=>{switch(e._tag){case"Literal":return r$.escape(String(e.literal));case"StringKeyword":return"[\\s\\S]*?";case"NumberKeyword":return"[+-]?\\d*\\.?\\d+(?:[Ee][+-]?\\d+)?";case"TemplateLiteral":return nx(e,t,!1);case"Union":return e.types.map(e=>nI(e,t)).join("|")}},nT=(e,t,r,i)=>{if(nl(e)){if(r&&!i)return`(?:${t})`}else if(!r||!i)return t;return`(${t})`},nx=(e,t,r)=>{let i="";if(""!==e.head){let n=r$.escape(e.head);i+=t&&r?`(${n})`:n}for(let n of e.spans){let e=nI(n.type,t);if(i+=nT(n.type,e,t,r),""!==n.literal){let e=r$.escape(n.literal);i+=t&&r?`(${e})`:e}}return i},nC=e=>RegExp(`^${nx(e,!1,!0)}$`),nR=e=>RegExp(`^${nx(e,!0,!0)}$`),nF=e=>{let t=iy(e);if(rU.isSome(t))return nF(t.value);switch(e._tag){case"TypeLiteral":return e.indexSignatures.slice();case"Suspend":return nF(e.f());case"Refinement":return nF(e.from)}return[]},nA=e=>{switch(e._tag){case"TupleType":{let t=!1,r=[];for(let i of e.elements)i.isOptional&&(t=!0),r.push(i.type);return t&&r.push(iA),r=r.concat(i2(e.rest)),na.make(r)}case"Refinement":return nA(e.from);case"Union":return na.make(e.types.map(nA));case"Suspend":return nA(e.f())}throw Error(ru(e))},nO=(e,t)=>{let r=o.findFirst(e.propertySignatures,e=>e.name===t);if(rU.isSome(r))return r.value;if(t9.isString(t)){let r;for(let i of e.indexSignatures){let e=nQ(i.parameter);switch(e._tag){case"TemplateLiteral":if(nC(e).test(t))return new i8(t,i.type,!1,!0);break;case"StringKeyword":void 0===r&&(r=new i8(t,i.type,!1,!0))}}if(r)return r}else if(t9.isSymbol(t)){for(let r of e.indexSignatures)if(ij(nQ(r.parameter)))return new i8(t,r.type,!1,!0)}},n_=(e,t)=>{let r=iy(e);if(rU.isSome(r))return n_(r.value,t);switch(e._tag){case"TypeLiteral":{let r=nO(e,t);if(r)return r;break}case"Union":return new i8(t,na.make(e.types.map(e=>n_(e,t).type)),!1,!0);case"Suspend":return n_(e.f(),t);case"Refinement":return n_(e.from,t)}throw Error(ru(e))},nM=e=>{let t=iy(e);if(rU.isSome(t))return nM(t.value);switch(e._tag){case"TypeLiteral":return e.propertySignatures.map(e=>e.name);case"Union":return e.types.slice(1).reduce((e,t)=>o.intersection(e,nM(t)),nM(e.types[0]));case"Suspend":return nM(e.f());case"Refinement":return nM(e.from);case"Transformation":return nM(e.to)}return[]},nD=(e,t)=>{let r=[],i=[],n=e=>{switch(e._tag){case"NeverKeyword":break;case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":case"Refinement":i.push(new i6(e,t,!0));break;case"Literal":if(t9.isString(e.literal)||t9.isNumber(e.literal))r.push(new i8(e.literal,t,!1,!0));else{let t;throw Error((t=e.literal,ro("Unsupported literal",`literal value: ${ri(t)}`)))}break;case"Enums":for(let[i,n]of e.enums)r.push(new i8(n,t,!1,!0));break;case"UniqueSymbol":r.push(new i8(e.symbol,t,!1,!0));break;case"Union":e.types.forEach(n);break;default:throw Error(ro("Unsupported key schema",void 0,void 0,e))}};return n(e),{propertySignatures:r,indexSignatures:i}},nN=(e,t)=>{let r=iy(e);if(rU.isSome(r))return nN(r.value,t);switch(e._tag){case"TypeLiteral":{let r=[],i={};for(let n of e.propertySignatures)i[n.name]=null,t.includes(n.name)&&r.push(n);for(let n of t)if(!(n in i)){let t=nO(e,n);t&&r.push(t)}return new i9(r,[])}case"Union":return new i9(t.map(t=>n_(e,t)),[]);case"Suspend":return nN(e.f(),t);case"Refinement":return nN(e.from,t);case"Transformation":switch(e.transformation._tag){case"ComposeTransformation":return new nh(nN(e.from,t),nN(e.to,t),ny);case"TypeLiteralTransformation":{let r=[],i=[];for(let n of t){let t=e.transformation.propertySignatureTransformations.find(e=>e.to===n);t?(r.push(t),i.push(t.from)):i.push(n)}return o.isNonEmptyReadonlyArray(r)?new nh(nN(e.from,i),nN(e.to,t),new nv(r)):nN(e.from,i)}}}throw Error(ru(e))},nP=(e,t)=>{let r=nF(e);return r.length>0?(r.some(e=>iL(nQ(e.parameter)))&&(r=r.filter(e=>!iX(nQ(e.parameter)))),new i9([],r)):nN(e,nM(e).filter(e=>!t.includes(e)))},nL=e=>na.make([e,iA]),nU=(e,t)=>{let r=t?.exact===!0;switch(e._tag){case"TupleType":return new i5(e.elements.map(e=>new i1(r?e.type:nL(e.type),!0)),o.match(e.rest,{onEmpty:()=>e.rest,onNonEmpty:e=>[new i0(na.make([...i2(e),iA]))]}),e.isReadonly);case"TypeLiteral":return new i9(e.propertySignatures.map(e=>new i8(e.name,r?e.type:nL(e.type),!0,e.isReadonly,e.annotations)),e.indexSignatures.map(e=>new i6(e.parameter,nL(e.type),e.isReadonly)));case"Union":return na.make(e.types.map(e=>nU(e,t)));case"Suspend":return new nc(()=>nU(e.f(),t));case"Declaration":case"Refinement":throw Error(ru(e));case"Transformation":if(nE(e.transformation)&&e.transformation.propertySignatureTransformations.every(nb))return new nh(nU(e.from,t),nU(e.to,t),e.transformation);throw Error(ru(e))}return e},nz=e=>{switch(e._tag){case"TupleType":return new i5(e.elements.map(e=>new i1(e.type,!1)),e.rest,e.isReadonly);case"TypeLiteral":return new i9(e.propertySignatures.map(e=>new i8(e.name,e.type,!1,e.isReadonly,e.annotations)),e.indexSignatures);case"Union":return na.make(e.types.map(e=>nz(e)));case"Suspend":return new nc(()=>nz(e.f()));case"Declaration":case"Refinement":throw Error(ru(e));case"Transformation":if(nE(e.transformation)&&e.transformation.propertySignatureTransformations.every(nb))return new nh(nz(e.from),nz(e.to),e.transformation);throw Error(ru(e))}return e},nW=e=>{switch(e._tag){case"TupleType":return!1===e.isReadonly?e:new i5(e.elements,e.rest,!1,e.annotations);case"TypeLiteral":{let t=nV(e.propertySignatures,e=>!1===e.isReadonly?e:new i8(e.name,e.type,e.isOptional,!1,e.annotations)),r=nV(e.indexSignatures,e=>!1===e.isReadonly?e:new i6(e.parameter,e.type,!1));return t===e.propertySignatures&&r===e.indexSignatures?e:new i9(t,r,e.annotations)}case"Union":{let t=nV(e.types,nW);return t===e.types?e:na.make(t,e.annotations)}case"Suspend":return new nc(()=>nW(e.f()),e.annotations);case"Refinement":{let t=nW(e.from);return t===e.from?e:new nd(t,e.filter,e.annotations)}case"Transformation":{let t=nW(e.from),r=nW(e.to);return t===e.from&&r===e.to?e:new nh(t,r,e.transformation,e.annotations)}}return e},nB=e=>t=>{let r;for(let i of e)Object.prototype.hasOwnProperty.call(t.annotations,i)&&(void 0===r&&(r={}),r[i]=t.annotations[i]);return r},nq=e=>t=>{let r={...t.annotations};for(let t of e)delete r[t];return r},n$=nB([rY,rX,r0,r1,r2,r5]),nj=e=>{switch(e._tag){case"Declaration":{let t=nV(e.typeParameters,nj);return t===e.typeParameters?e:new ik(t,e.decodeUnknown,e.encodeUnknown,e.annotations)}case"TupleType":{let t=nV(e.elements,e=>{let t=nj(e.type);return t===e.type?e:new i1(t,e.isOptional)}),r=i2(e.rest),i=nV(r,nj);return t===e.elements&&i===r?e:new i5(t,i.map(e=>new i0(e)),e.isReadonly,e.annotations)}case"TypeLiteral":{let t=nV(e.propertySignatures,e=>{let t=nj(e.type);return t===e.type?e:new i8(e.name,t,e.isOptional,e.isReadonly)}),r=nV(e.indexSignatures,e=>{let t=nj(e.type);return t===e.type?e:new i6(e.parameter,t,e.isReadonly)});return t===e.propertySignatures&&r===e.indexSignatures?e:new i9(t,r,e.annotations)}case"Union":{let t=nV(e.types,nj);return t===e.types?e:na.make(t,e.annotations)}case"Suspend":return new nc(()=>nj(e.f()),e.annotations);case"Refinement":{let t=nj(e.from);return t===e.from?e:new nd(t,e.filter,e.annotations)}case"Transformation":{let t=n$(e);return nj(void 0!==t?nw(e.to,t):e.to)}}return e};function nV(e,t){let r=!1,i=o.allocate(e.length);for(let n=0;n<e.length;n++){let a=e[n],s=t(a);s!==a&&(r=!0),i[n]=s}return r?i:e}let nH=e=>{switch(e._tag){case"Transformation":return e.from;case"Refinement":return nH(e.from);case"Suspend":return nH(e.f())}},nG=(e,t)=>{switch(e._tag){case"Declaration":{let r=nV(e.typeParameters,e=>nG(e,t));return r===e.typeParameters?e:new ik(r,e.decodeUnknown,e.encodeUnknown)}case"TupleType":{let r=nV(e.elements,e=>{let r=nG(e.type,t);return r===e.type?e:new i1(r,e.isOptional)}),i=i2(e.rest),n=nV(i,e=>nG(e,t));return r===e.elements&&n===i?e:new i5(r,n.map(e=>new i0(e)),e.isReadonly)}case"TypeLiteral":{let r=nV(e.propertySignatures,e=>{let r=nG(e.type,t);return r===e.type?e:new i8(e.name,r,e.isOptional,e.isReadonly)}),i=nV(e.indexSignatures,e=>{let r=nG(e.type,t);return r===e.type?e:new i6(e.parameter,r,e.isReadonly)});return r===e.propertySignatures&&i===e.indexSignatures?e:new i9(r,i)}case"Union":{let r=nV(e.types,e=>nG(e,t));return r===e.types?e:na.make(r)}case"Suspend":{let r,i=rU.orElse(iE(e),()=>iu(e));if(rU.isSome(i)){let e=t?"Bound":"";r={[iv]:`${i.value}Encoded${e}`}}return new nc(()=>nG(e.f(),t),r)}case"Refinement":{let r=nG(e.from,t);if(!t)return r;if(r===e.from)return e;if(void 0===nH(e.from)&&ib(e))return new nd(r,e.filter,e.annotations);return r}case"Transformation":return nG(e.from,t)}return e},nK=e=>nG(e,!1),nJ=e=>nG(e,!0),nZ=e=>{let t={};for(let r of Object.getOwnPropertySymbols(e))t[String(r)]=e[r];return t},nQ=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return nQ(e.from)}},nY=(e,t)=>{switch(e._tag){case"Literal":return ix(t)&&t.literal===e.literal;case"UniqueSymbol":return iF(t)&&t.symbol===e.symbol;case"UndefinedKeyword":case"VoidKeyword":case"NeverKeyword":case"UnknownKeyword":case"AnyKeyword":case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"SymbolKeyword":case"ObjectKeyword":return t._tag===e._tag;case"TemplateLiteral":return iX(t)&&t.head===e.head&&nX(t.spans,e.spans);case"Enums":return iG(t)&&n0(t.enums,e.enums);case"Union":return nl(t)&&n1(e.types,t.types);case"Refinement":case"TupleType":case"TypeLiteral":case"Suspend":case"Transformation":case"Declaration":return e===t}},nX=o.getEquivalence((e,t)=>e.literal===t.literal&&nY(e.type,t.type)),n0=o.getEquivalence((e,t)=>t[0]===e[0]&&t[1]===e[1]),n1=o.getEquivalence(nY),n2=o.intersectionWith(nY),n5=e=>{switch(e._tag){case"Declaration":{let t=iy(e);if(rU.isSome(t))return n5(t.value);break}case"TypeLiteral":return e.propertySignatures.map(e=>t9.isSymbol(e.name)?new iR(e.name):new iT(e.name)).concat(e.indexSignatures.map(e=>nQ(e.parameter)));case"Suspend":return n5(e.f());case"Union":return e.types.slice(1).reduce((e,t)=>n2(e,n5(t)),n5(e.types[0]));case"Transformation":return n5(e.to)}throw Error(ru(e))},n3=(e,t)=>new nh(e,t,ny),n8=(e,t)=>{switch(e._tag){case"TypeLiteral":{let r=[];for(let e of Reflect.ownKeys(t)){let i=t[e];void 0!==i&&r.push(new nS(e,i,t5.identity,t5.identity))}if(0===r.length)return e;return new nh(e,new i9(e.propertySignatures.map(e=>{let r=t[e.name];return new i8(void 0===r?e.name:r,nj(e.type),e.isOptional,e.isReadonly,e.annotations)}),e.indexSignatures),new nv(r))}case"Union":return na.make(e.types.map(e=>n8(e,t)));case"Suspend":return new nc(()=>n8(e.f(),t));case"Transformation":return n3(e,n8(nj(e),t))}throw Error(ro("Unsupported schema",void 0,void 0,e))},n4=e=>rU.getOrElse(n9(e),()=>e._tag),n6=e=>io(e).pipe(rU.orElse(()=>ic(e)),rU.orElse(()=>il(e)),rU.map(t=>t+rU.match(ii(e),{onNone:()=>"",onSome:e=>e.map(e=>` & Brand<${ri(e)}>`).join("")}))),n9=e=>rU.orElse(iu(e),()=>n6(e)),n7=(e,t,r)=>{switch(e._tag){case"UndefinedKeyword":return i_;case"Union":{let r=[],i=!1;for(let n of e.types){let e=t(n);e?(i=!0,iM(e)||r.push(e)):r.push(n)}if(i)return na.make(r);break}case"Suspend":return t(e.f());case"Transformation":return r(e)}};e.s(["ArbitraryAnnotationId",0,r1,"AutoTitleAnnotationId",0,rZ,"BatchingAnnotationId",0,r4,"BrandAnnotationId",0,rj,"ConcurrencyAnnotationId",0,r8,"Declaration",0,ik,"DecodingFallbackAnnotationId",0,r7,"DefaultAnnotationId",0,rX,"DescriptionAnnotationId",0,rQ,"DocumentationAnnotationId",0,r3,"Enums",0,iH,"EquivalenceAnnotationId",0,r5,"ExamplesAnnotationId",0,rY,"FinalTransformation",0,ng,"IdentifierAnnotationId",0,rK,"IndexSignature",0,i6,"JSONIdentifierAnnotationId",0,iv,"JSONSchemaAnnotationId",0,r0,"Literal",0,iT,"MessageAnnotationId",0,rH,"MissingMessageAnnotationId",0,rG,"OptionalType",0,i1,"ParseIssueTitleAnnotationId",0,r6,"ParseJsonSchemaId",0,iw,"ParseOptionsAnnotationId",0,r9,"PrettyAnnotationId",0,r2,"PropertySignature",0,i8,"PropertySignatureTransformation",0,nS,"Refinement",0,nd,"SchemaIdAnnotationId",0,rV,"StableFilterAnnotationId",0,it,"SurrogateAnnotationId",0,ie,"Suspend",0,nc,"TemplateLiteral",0,iQ,"TemplateLiteralSpan",0,iZ,"TitleAnnotationId",0,rJ,"Transformation",0,nh,"TupleType",0,i5,"Type",0,i0,"TypeLiteral",0,i9,"TypeLiteralTransformation",0,nv,"Union",0,na,"UniqueSymbol",0,iR,"annotations",0,nw,"anyKeyword",0,iN,"bigIntKeyword",0,iq,"booleanKeyword",0,iW,"compose",0,n3,"composeTransformation",0,ny,"defaultParseOption",0,nf,"encodedAST",0,nK,"encodedBoundAST",0,nJ,"getAnnotation",0,ir,"getAutoTitleAnnotation",0,il,"getBatchingAnnotation",0,ip,"getBrandAnnotation",0,ii,"getConcurrencyAnnotation",0,id,"getDecodingFallbackAnnotation",0,ig,"getDescriptionAnnotation",0,ic,"getEncodedParameter",0,nQ,"getIdentifierAnnotation",0,iu,"getMessageAnnotation",0,ia,"getMissingMessageAnnotation",0,is,"getNumberIndexedAccess",0,nA,"getParseIssueTitleAnnotation",0,ih,"getParseOptionsAnnotation",0,im,"getPropertyKeyIndexedAccess",0,n_,"getSurrogateAnnotation",0,iy,"getTemplateLiteralCapturingRegExp",0,nR,"getTemplateLiteralRegExp",0,nC,"getTitleAnnotation",0,io,"hasStableFilter",0,ib,"isBooleanKeyword",0,iB,"isLiteral",0,ix,"isMembers",0,no,"isNumberKeyword",0,iz,"isRefinement",0,np,"isStringKeyword",0,iL,"isSymbolKeyword",0,ij,"isTransformation",0,nm,"isTypeLiteral",0,nt,"isTypeLiteralTransformation",0,nE,"isUnion",0,nl,"keyof",0,nk,"mapMembers",0,ns,"mutable",0,nW,"neverKeyword",0,i_,"null",0,iC,"numberKeyword",0,iU,"objectKeyword",0,iV,"omit",0,nP,"omitAnnotations",0,nq,"orUndefined",0,nL,"partial",0,nU,"pick",0,nN,"pickAnnotations",0,nB,"pruneUndefined",0,n7,"record",0,nD,"rename",0,n8,"required",0,nz,"stringKeyword",0,iP,"symbolKeyword",0,i$,"typeAST",0,nj,"undefinedKeyword",0,iA,"unknownKeyword",0,iD,"voidKeyword",0,iO],1932814);class ae{path;actual;issue;_tag="Pointer";constructor(e,t,r){this.path=e,this.actual=t,this.issue=r}}class at{actual;message;_tag="Unexpected";constructor(e,t){this.actual=e,this.message=t}}class ar{ast;message;_tag="Missing";actual=void 0;constructor(e,t){this.ast=e,this.message=t}}class ai{ast;actual;issues;output;_tag="Composite";constructor(e,t,r,i){this.ast=e,this.actual=t,this.issues=r,this.output=i}}class an{ast;actual;kind;issue;_tag="Refinement";constructor(e,t,r,i){this.ast=e,this.actual=t,this.kind=r,this.issue=i}}class aa{ast;actual;kind;issue;_tag="Transformation";constructor(e,t,r,i){this.ast=e,this.actual=t,this.kind=r,this.issue=i}}class as{ast;actual;message;_tag="Type";constructor(e,t,r){this.ast=e,this.actual=t,this.message=r}}class ao{ast;actual;message;_tag="Forbidden";constructor(e,t,r){this.ast=e,this.actual=t,this.message=r}}let al=Symbol.for("effect/Schema/ParseErrorTypeId");class au extends(0,rz.TaggedError)("ParseError"){[al]=al;get message(){return this.toString()}toString(){return a1.formatIssueSync(this.issue)}toJSON(){return{_id:"ParseError",message:this.toString()}}[rW.NodeInspectSymbol](){return this.toJSON()}}let ac=e=>new au({issue:e}),ad=b.right,ap=b.left,af=b.try,ah=b.fromOption,am=b.isEither,ag=(0,t5.dual)(2,(e,t)=>am(e)?b.match(e,{onLeft:b.left,onRight:t}):S.flatMap(e,t)),ay=(0,t5.dual)(2,(e,t)=>am(e)?b.map(e,t):S.map(e,t)),aS=(0,t5.dual)(2,(e,t)=>am(e)?b.mapLeft(e,t):S.mapError(e,t)),ab=(0,t5.dual)(2,(e,t)=>am(e)?b.mapBoth(e,{onLeft:t.onFailure,onRight:t.onSuccess}):S.mapBoth(e,t)),av=(0,t5.dual)(2,(e,t)=>am(e)?b.match(e,{onLeft:t,onRight:b.right}):S.catchAll(e,t)),aE=(e,t)=>void 0===t||t9.isNumber(t)?e:void 0===e?t:{...e,...t},aw=(e,t,r)=>{let i=aq(e,t);return(e,t)=>i(e,aE(r,t))},ak=(e,t,r)=>{let i=aw(e,t,r);return(e,t)=>b.getOrThrowWith(i(e,t),ac)},aI=(e,t,r)=>{let i=aw(e,t,r);return(e,t)=>rU.getRight(i(e,t))},aT=(e,t,r)=>{let i=aq(e,t);return(e,t)=>i(e,{...aE(r,t),isEffectAllowed:!0})},ax=(e,t)=>ak(e.ast,!0,t),aC=(e,t)=>aI(e.ast,!0,t),aR=(e,t)=>aw(e.ast,!0,t),aF=(e,t)=>{let r=aA(e,t);return(e,t)=>S.runPromise(r(e,t))},aA=(e,t)=>aT(e.ast,!0,t),aO=(e,t)=>ak(e.ast,!1,t),a_=(e,t)=>aI(e.ast,!1,t),aM=(e,t)=>aw(e.ast,!1,t),aD=(e,t)=>{let r=aN(e,t);return(e,t)=>S.runPromise(r(e,t))},aN=(e,t)=>aT(e.ast,!1,t),aP=(e,t)=>ak(nj(e.ast),!0,t),aL=(e,t)=>aw(nj(e.ast),!0,t),aU=(e,t)=>aT(nj(e.ast),!0,t),az=(e,t)=>{let r=aq(nj(e.ast),!0);return(e,i)=>b.isRight(r(e,{exact:!0,...aE(t,i)}))},aW=(0,t3.globalValue)(Symbol.for("effect/ParseResult/decodeMemoMap"),()=>new WeakMap),aB=(0,t3.globalValue)(Symbol.for("effect/ParseResult/encodeMemoMap"),()=>new WeakMap),aq=(e,t)=>{let r=t?aW:aB,i=r.get(e);if(i)return i;let n=aV(e,t),a=im(e),s=rU.isSome(a)?(e,t)=>n(e,aE(t,a.value)):n,o=ig(e),l=t&&rU.isSome(o)?(t,r)=>aZ(av(s(t,r),o.value),e,t,r):s;return r.set(e,l),l},a$=e=>rU.getOrUndefined(id(e)),aj=e=>rU.getOrUndefined(ip(e)),aV=(e,t)=>{switch(e._tag){case"Refinement":if(t){let t=aq(e.from,!0);return(r,i)=>{i=i??nf;let n=i?.errors==="all";return aZ(ag(av(t(r,i),t=>{let a=new an(e,r,"From",t);return n&&ib(e)&&a6(t)?rU.match(e.filter(r,i,e),{onNone:()=>b.left(a),onSome:t=>b.left(new ai(e,r,[a,new an(e,r,"Predicate",t)]))}):b.left(a)}),t=>rU.match(e.filter(t,i,e),{onNone:()=>b.right(t),onSome:t=>b.left(new an(e,r,"Predicate",t))})),e,r,i)}}{let t=aq(nj(e),!0),r=aq(aJ(e.from),!1);return(i,n)=>aZ(ag(t(i,n),e=>r(e,n)),e,i,n)}case"Transformation":{let r=aX(e.transformation,t),i=t?aq(e.from,!0):aq(e.to,!1),n=t?aq(e.to,!0):aq(e.from,!1);return(a,s)=>aZ(ag(aS(i(a,s),r=>new aa(e,a,t?"Encoded":"Type",r)),i=>ag(aS(r(i,s??nf,e,a),t=>new aa(e,a,"Transformation",t)),r=>aS(n(r,s),r=>new aa(e,a,t?"Type":"Encoded",r)))),e,a,s)}case"Declaration":{let r=t?e.decodeUnknown(...e.typeParameters):e.encodeUnknown(...e.typeParameters);return(t,i)=>aZ(r(t,i??nf,e),e,t,i)}case"Literal":return aH(e,t=>t===e.literal);case"UniqueSymbol":return aH(e,t=>t===e.symbol);case"UndefinedKeyword":return aH(e,t9.isUndefined);case"NeverKeyword":return aH(e,t9.isNever);case"UnknownKeyword":case"AnyKeyword":case"VoidKeyword":return b.right;case"StringKeyword":return aH(e,t9.isString);case"NumberKeyword":return aH(e,t9.isNumber);case"BooleanKeyword":return aH(e,t9.isBoolean);case"BigIntKeyword":return aH(e,t9.isBigInt);case"SymbolKeyword":return aH(e,t9.isSymbol);case"ObjectKeyword":return aH(e,t9.isObject);case"Enums":return aH(e,t=>e.enums.some(e=>{let[r,i]=e;return i===t}));case"TemplateLiteral":{let t=nC(e);return aH(e,e=>t9.isString(e)&&t.test(e))}case"TupleType":{let r=e.elements.map(e=>aq(e.type,t)),i=e.rest.map(e=>aq(e.type,t)),n=e.elements.filter(e=>!e.isOptional);e.rest.length>0&&(n=n.concat(e.rest.slice(1)));let a=n.length,s=e.elements.length>0?e.elements.map((e,t)=>t).join(" | "):"never",l=a$(e),u=aj(e);return(t,c)=>{let d;if(!o.isArray(t))return b.left(new as(e,t));let p=c?.errors==="all",f=[],h=0,m=[],g=t.length;for(let r=g;r<=a-1;r++){let i=new ae(r,t,new ar(n[r-g]));if(!p)return b.left(new ai(e,t,i,m));f.push([h++,i])}if(0===e.rest.length)for(let r=e.elements.length;r<=g-1;r++){let i=new ae(r,t,new at(t[r],`is unexpected, expected: ${s}`));if(!p)return b.left(new ai(e,t,i,m));f.push([h++,i])}let y=0;for(;y<r.length;y++)if(g<y+1){if(e.elements[y].isOptional)continue}else{let i=(0,r[y])(t[y],c);if(am(i)){if(b.isLeft(i)){let r=new ae(y,t,i.left);if(!p)return b.left(new ai(e,t,r,aY(m)));f.push([h++,r]);continue}m.push([h++,i.right])}else{let r=h++,n=y;d||(d=[]),d.push(a=>{let{es:s,output:o}=a;return S.flatMap(S.either(i),i=>{if(b.isLeft(i)){let a=new ae(n,t,i.left);return p?(s.push([r,a]),S.void):b.left(new ai(e,t,a,aY(o)))}return o.push([r,i.right]),S.void})})}}if(o.isNonEmptyReadonlyArray(i)){let[r,...n]=i;for(;y<g-n.length;y++){let i=r(t[y],c);if(am(i))if(b.isLeft(i)){let r=new ae(y,t,i.left);if(!p)return b.left(new ai(e,t,r,aY(m)));f.push([h++,r]);continue}else m.push([h++,i.right]);else{let r=h++,n=y;d||(d=[]),d.push(a=>{let{es:s,output:o}=a;return S.flatMap(S.either(i),i=>{if(!b.isLeft(i))return o.push([r,i.right]),S.void;{let a=new ae(n,t,i.left);return p?(s.push([r,a]),S.void):b.left(new ai(e,t,a,aY(o)))}})})}}for(let r=0;r<n.length;r++)if(!(g<(y+=r)+1)){let i=n[r](t[y],c);if(am(i)){if(b.isLeft(i)){let r=new ae(y,t,i.left);if(!p)return b.left(new ai(e,t,r,aY(m)));f.push([h++,r]);continue}m.push([h++,i.right])}else{let r=h++,n=y;d||(d=[]),d.push(a=>{let{es:s,output:o}=a;return S.flatMap(S.either(i),i=>{if(b.isLeft(i)){let a=new ae(n,t,i.left);return p?(s.push([r,a]),S.void):b.left(new ai(e,t,a,aY(o)))}return o.push([r,i.right]),S.void})})}}}let v=r=>{let{es:i,output:n}=r;return o.isNonEmptyArray(i)?b.left(new ai(e,t,aY(i),aY(n))):b.right(aY(n))};if(d&&d.length>0){let e=d;return S.suspend(()=>{let t={es:o.copy(f),output:o.copy(m)};return S.flatMap(S.forEach(e,e=>e(t),{concurrency:l,batching:u,discard:!0}),()=>v(t))})}return v({output:m,es:f})}}case"TypeLiteral":{if(0===e.propertySignatures.length&&0===e.indexSignatures.length)return aH(e,t9.isNotNullable);let r=[],i={},n=[];for(let a of e.propertySignatures)r.push([aq(a.type,t),a]),i[a.name]=null,n.push(a.name);let a=e.indexSignatures.map(e=>[aq(e.parameter,t),aq(e.type,t),e.parameter]),s=na.make(e.indexSignatures.map(e=>e.parameter).concat(n.map(e=>t9.isSymbol(e)?new iR(e):new iT(e)))),l=aq(s,t),u=a$(e),c=aj(e);return(t,d)=>{let p,f;if(!t9.isRecord(t))return b.left(new as(e,t));let h=d?.errors==="all",m=[],g=0,y=d?.onExcessProperty==="error",v=d?.onExcessProperty==="preserve",E={};if(y||v)for(let r of p=Reflect.ownKeys(t)){let i=l(r,d);if(am(i)&&b.isLeft(i))if(y){let i=new ae(r,t,new at(t[r],`is unexpected, expected: ${String(s)}`));if(!h)return b.left(new ai(e,t,i,E));m.push([g++,i]);continue}else E[r]=t[r]}let w=d?.exact===!0;for(let i=0;i<r.length;i++){let n=r[i][1],a=n.name,s=Object.prototype.hasOwnProperty.call(t,a);if(!s){if(n.isOptional)continue;else if(w){let r=new ae(a,t,new ar(n));if(!h)return b.left(new ai(e,t,r,E));m.push([g++,r]);continue}}let o=(0,r[i][0])(t[a],d);if(am(o)){if(b.isLeft(o)){let r=new ae(a,t,s?o.left:new ar(n));if(!h)return b.left(new ai(e,t,r,E));m.push([g++,r]);continue}E[a]=o.right}else{let r=g++;f||(f=[]),f.push(i=>{let{es:l,output:u}=i;return S.flatMap(S.either(o),i=>{if(b.isLeft(i)){let o=new ae(a,t,s?i.left:new ar(n));return h?(l.push([r,o]),S.void):b.left(new ai(e,t,o,u))}return u[a]=i.right,S.void})})}}for(let r=0;r<a.length;r++){let n=a[r],s=n[0],o=n[1];for(let r of t7(t,n[2])){let n=s(r,d);if(am(n)&&b.isRight(n)){let n=o(t[r],d);if(am(n))if(b.isLeft(n)){let i=new ae(r,t,n.left);if(!h)return b.left(new ai(e,t,i,E));m.push([g++,i]);continue}else Object.prototype.hasOwnProperty.call(i,r)||(E[r]=n.right);else{let a=g++,s=r;f||(f=[]),f.push(o=>{let{es:l,output:u}=o;return S.flatMap(S.either(n),n=>{if(!b.isLeft(n))return Object.prototype.hasOwnProperty.call(i,r)||(u[r]=n.right),S.void;{let r=new ae(s,t,n.left);return h?(l.push([a,r]),S.void):b.left(new ai(e,t,r,u))}})})}}}}let k=r=>{let{es:i,output:a}=r;if(o.isNonEmptyArray(i))return b.left(new ai(e,t,aY(i),a));if(d?.propertyOrder==="original"){let e=p||Reflect.ownKeys(t);for(let t of n)-1===e.indexOf(t)&&e.push(t);let r={};for(let t of e)Object.prototype.hasOwnProperty.call(a,t)&&(r[t]=a[t]);return b.right(r)}return b.right(a)};if(f&&f.length>0){let e=f;return S.suspend(()=>{let t={es:o.copy(m),output:Object.assign({},E)};return S.flatMap(S.forEach(e,e=>e(t),{concurrency:u,batching:c,discard:!0}),()=>k(t))})}return k({es:m,output:E})}}case"Union":{let r=aK(e.types,t),i=Reflect.ownKeys(r.keys),n=i.length,a=e.types.length,s=new Map;for(let r=0;r<a;r++)s.set(e.types[r],aq(e.types[r],t));let l=a$(e)??1,u=aj(e);return(t,c)=>{let d,p=[],f=0,h=[];if(n>0)if(t9.isRecordOrArray(t))for(let e=0;e<n;e++){let n=i[e],s=r.keys[n].buckets;if(Object.prototype.hasOwnProperty.call(t,n)){let e=String(t[n]);if(Object.prototype.hasOwnProperty.call(s,e))h=h.concat(s[e]);else{let{candidates:e,literals:i}=r.keys[n],s=na.make(i),o=e.length===a?new i9([new i8(n,s,!1,!0)],[]):na.make(e);p.push([f++,new ai(o,t,new ae(n,t,new as(s,t[n])))])}}else{let{candidates:e,literals:i}=r.keys[n],s=new i8(n,na.make(i),!1,!0),o=e.length===a?new i9([s],[]):na.make(e);p.push([f++,new ai(o,t,new ae(n,t,new ar(s)))])}}else{let i=r.candidates.length===a?e:na.make(r.candidates);p.push([f++,new as(i,t)])}r.otherwise.length>0&&(h=h.concat(r.otherwise));for(let e=0;e<h.length;e++){let r=h[e],i=s.get(r)(t,c);if(am(i)&&(!d||0===d.length))if(b.isRight(i))return i;else p.push([f++,i.left]);else{let e=f++;d||(d=[]),d.push(t=>S.suspend(()=>"finalResult"in t?S.void:S.flatMap(S.either(i),r=>(b.isRight(r)?t.finalResult=r:t.es.push([e,r.left]),S.void))))}}let m=r=>o.isNonEmptyArray(r)?1===r.length&&"Type"===r[0][1]._tag?b.left(r[0][1]):b.left(new ai(e,t,aY(r))):b.left(new as(e,t));if(d&&d.length>0){let e=d;return S.suspend(()=>{let t={es:o.copy(p)};return S.flatMap(S.forEach(e,e=>e(t),{concurrency:l,batching:u,discard:!0}),()=>"finalResult"in t?t.finalResult:m(t.es))})}return m(p)}}case"Suspend":{let r=re(()=>aq(e.f(),t));return(e,t)=>r()(e,t)}}},aH=(e,t)=>r=>t(r)?b.right(r):b.left(new as(e,r)),aG=(e,t)=>{switch(e._tag){case"Declaration":{let r=iy(e);if(rU.isSome(r))return aG(r.value,t);break}case"TypeLiteral":{let r=[];for(let i=0;i<e.propertySignatures.length;i++){let n=e.propertySignatures[i],a=t?nK(n.type):nj(n.type);ix(a)&&!n.isOptional&&r.push([n.name,a])}return r}case"TupleType":{let r=[];for(let i=0;i<e.elements.length;i++){let n=e.elements[i],a=t?nK(n.type):nj(n.type);ix(a)&&!n.isOptional&&r.push([i,a])}return r}case"Refinement":return aG(e.from,t);case"Suspend":return aG(e.f(),t);case"Transformation":return aG(t?e.from:e.to,t)}return[]},aK=(e,t)=>{let r={},i=[],n=[];for(let a=0;a<e.length;a++){let s=e[a],o=aG(s,t);if(o.length>0){n.push(s);for(let e=0;e<o.length;e++){let[t,i]=o[e],n=String(i.literal);r[t]=r[t]||{buckets:{},literals:[],candidates:[]};let a=r[t].buckets;if(Object.prototype.hasOwnProperty.call(a,n)){if(e<o.length-1)continue;a[n].push(s),r[t].literals.push(i),r[t].candidates.push(s)}else{a[n]=[s],r[t].literals.push(i),r[t].candidates.push(s);break}}}else i.push(s)}return{keys:r,otherwise:i,candidates:n}},aJ=e=>np(e)?aJ(e.from):e,aZ=(e,t,r,i)=>{if(i?.isEffectAllowed===!0||am(e))return e;let n=new rB.SyncScheduler,a=S.runFork(e,{scheduler:n});n.flush();let s=a.unsafePoll();if(s){if(k.isSuccess(s))return b.right(s.value);let e=s.cause;return d.isFailType(e)?b.left(e.error):b.left(new ao(t,r,d.pretty(e)))}return b.left(new ao(t,r,"cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work"))},aQ=(e,t)=>{let[r]=e,[i]=t;return r>i?1:r<i?-1:0};function aY(e){return e.sort(aQ).map(e=>e[1])}let aX=(e,t)=>{switch(e._tag){case"FinalTransformation":return t?e.decode:e.encode;case"ComposeTransformation":return b.right;case"TypeLiteralTransformation":return r=>{let i=b.right(r);for(let r of e.propertySignatureTransformations){let[e,n]=t?[r.from,r.to]:[r.to,r.from],a=t?r.decode:r.encode;i=ay(i,t=>{let r=a(Object.prototype.hasOwnProperty.call(t,e)?rU.some(t[e]):rU.none());return delete t[e],rU.isSome(r)&&(t[n]=r.value),t})}return i}}},a0=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return{value:e,forest:t}},a1={formatIssue:e=>ay(ss(e),a2),formatIssueSync:e=>{let t=a1.formatIssue(e);return am(t)?b.getOrThrow(t):S.runSync(t)},formatError:e=>a1.formatIssue(e.issue),formatErrorSync:e=>a1.formatIssueSync(e.issue)},a2=e=>e.value+a5("\n",e.forest),a5=(e,t)=>{let r,i="",n=t.length;for(let a=0;a<n;a++){r=t[a];let s=a===n-1;i+=e+(s?"":"")+" "+r.value,i+=a5(e+(n>1&&!s?"  ":"   "),r.forest)}return i},a3=e=>"ast"in e?rU.some(e.ast):rU.none(),a8=b.right(void 0),a4=e=>t=>t._tag===e,a6=a4("Composite"),a9=a4("Refinement"),a7=a4("Transformation"),se=e=>ag(a3(e).pipe(rU.flatMap(ia),rU.match({onNone:()=>a8,onSome:t=>{let r=t(e);return t9.isString(r)?b.right({message:r,override:!1}):S.isEffect(r)?S.map(r,e=>({message:e,override:!1})):t9.isString(r.message)?b.right({message:r.message,override:r.override}):S.map(r.message,e=>({message:e,override:r.override}))}})),t=>void 0!==t?!t.override&&(a6(e)||a9(e)&&"From"===e.kind||a7(e)&&"Transformation"!==e.kind)?a7(e)||a9(e)?se(e.issue):a8:b.right(t.message):a8),st=e=>a3(e).pipe(rU.flatMap(ih),rU.flatMapNullable(t=>t(e)),rU.getOrUndefined);function sr(e){return ic(e).pipe(rU.orElse(()=>io(e)),rU.orElse(()=>il(e)),rU.orElse(()=>iu(e)),rU.getOrElse(()=>`{ ${e.from} | filter }`))}let si=e=>ay(se(e),t=>t??st(e)??function(e){if(void 0!==e.message)return e.message;let t=np(e.ast)?sr(e.ast):String(e.ast);return`Expected ${t}, actual ${ri(e.actual)}`}(e)),sn=e=>st(e)??String(e.ast),sa=e=>{let t=is(e.ast);if(rU.isSome(t)){let e=t.value();return t9.isString(e)?b.right(e):e}return b.right(e.message??"is missing")},ss=e=>{switch(e._tag){case"Type":return ay(si(e),a0);case"Forbidden":return b.right(a0(sn(e),[a0(e.message??"is forbidden")]));case"Unexpected":return b.right(a0(e.message??"is unexpected"));case"Missing":return ay(sa(e),a0);case"Transformation":return ag(se(e),t=>void 0!==t?b.right(a0(t)):ay(ss(e.issue),t=>a0(sn(e),[a0((e=>{switch(e){case"Encoded":return"Encoded side transformation failure";case"Transformation":return"Transformation process failure";case"Type":return"Type side transformation failure"}})(e.kind),[t])])));case"Refinement":return ag(se(e),t=>void 0!==t?b.right(a0(t)):ay(ss(e.issue),t=>a0(sn(e),[a0((e=>{switch(e){case"From":return"From side refinement failure";case"Predicate":return"Predicate refinement failure"}})(e.kind),[t])])));case"Pointer":return ay(ss(e.issue),t=>a0(rs(e.path),[t]));case"Composite":return ag(se(e),t=>{if(void 0!==t)return b.right(a0(t));let r=sn(e);return Array.isArray(e.issues)?ay(S.forEach(e.issues,ss),e=>a0(r,e)):ay(ss(e.issues),e=>a0(r,[e]))})}},so=(e,t,r)=>({_tag:e,path:t,message:r}),sl={formatIssue:e=>su(e,void 0,[]),formatIssueSync:e=>{let t=sl.formatIssue(e);return am(t)?b.getOrThrow(t):S.runSync(t)},formatError:e=>sl.formatIssue(e.issue),formatErrorSync:e=>sl.formatIssueSync(e.issue)},su=(e,t,r)=>{let i=e._tag;switch(i){case"Type":return ay(si(e),e=>[so(t??i,r,e)]);case"Forbidden":return b.right([so(i,r,e.message??"is forbidden")]);case"Unexpected":return b.right([so(i,r,e.message??"is unexpected")]);case"Missing":return ay(sa(e),e=>[so(i,r,e)]);case"Pointer":return su(e.issue,void 0,r.concat(e.path));case"Composite":return ag(se(e),t=>void 0!==t?b.right([so(i,r,t)]):Array.isArray(e.issues)?ay(S.forEach(e.issues,e=>su(e,void 0,r)),o.flatten):su(e.issues,void 0,r));case"Refinement":return ag(se(e),t=>void 0!==t?b.right([so(i,r,t)]):su(e.issue,"Predicate"===e.kind?i:void 0,r));case"Transformation":return ag(se(e),t=>void 0!==t?b.right([so(i,r,t)]):su(e.issue,"Transformation"===e.kind?i:void 0,r))}};e.s(["ArrayFormatter",0,sl,"Composite",0,ai,"Forbidden",0,ao,"Missing",0,ar,"ParseError",0,au,"ParseErrorTypeId",0,al,"Pointer",0,ae,"Refinement",0,an,"Transformation",0,aa,"TreeFormatter",0,a1,"Type",0,as,"Unexpected",0,at,"asserts",0,(e,t)=>{let r=aq(nj(e.ast),!0);return(e,i)=>{let n=r(e,{exact:!0,...aE(t,i)});if(b.isLeft(n))throw ac(n.left)}},"decode",0,aA,"decodeEither",0,aR,"decodeOption",0,aC,"decodePromise",0,aF,"decodeSync",0,ax,"decodeUnknown",0,aA,"decodeUnknownEither",0,aR,"decodeUnknownOption",0,aC,"decodeUnknownPromise",0,aF,"decodeUnknownSync",0,ax,"eitherOrUndefined",0,e=>{if(am(e))return e},"encode",0,aN,"encodeEither",0,aM,"encodeOption",0,a_,"encodePromise",0,aD,"encodeSync",0,aO,"encodeUnknown",0,aN,"encodeUnknownEither",0,aM,"encodeUnknownOption",0,a_,"encodeUnknownPromise",0,aD,"encodeUnknownSync",0,aO,"fail",0,ap,"flatMap",0,ag,"fromOption",0,ah,"getFinalTransformation",0,aX,"getLiterals",0,aG,"getOption",0,aI,"getRefinementExpected",0,sr,"getSearchTree",0,aK,"is",0,az,"isComposite",0,a6,"isParseError",0,e=>t9.hasProperty(e,al),"map",0,ay,"mapBoth",0,ab,"mapError",0,aS,"mergeInternalOptions",0,aE,"orElse",0,av,"parseError",0,ac,"succeed",0,ad,"try",0,af,"validate",0,aU,"validateEither",0,aL,"validateOption",0,(e,t)=>aI(nj(e.ast),!0,t),"validatePromise",0,(e,t)=>{let r=aU(e,t);return(e,t)=>S.runPromise(r(e,t))},"validateSync",0,aP],9552070);var sc=e.i(9960543),sd=t9,sp=e.i(8611396);let sf=sp.RedactedTypeId,sh=sp.isRedacted,sm=sp.make,sg=sp.value,sy=sp.unsafeWipe,sS=e=>w.make((t,r)=>e(sg(t),sg(r)));e.s(["RedactedTypeId",0,sf,"getEquivalence",0,sS,"isRedacted",0,sh,"make",0,sm,"unsafeWipe",0,sy,"value",0,sg],4434603);var sb=e.i(945364),sv=e.i(1635211),sE=e.i(9333060);let sw=(0,t5.dual)(e=>t9.isObject(e[0]),function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];let n={};for(let t of r)t in e&&(n[t]=e[t]);return n}),sk=(0,t5.dual)(e=>t9.isObject(e[0]),function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];let n={...e};for(let e of r)delete n[e];return n});w.struct,rq.struct,e.s(["omit",0,sk,"pick",0,sw],8558266);let sI=Symbol.for("effect/Schema");function sT(e){return class{[sI]=sx;static ast=e;static annotations(e){return sT(s_(this.ast,e))}static pipe(){return(0,sc.pipeArguments)(this,arguments)}static toString(){return String(e)}static Type;static Encoded;static Context;static [sI]=sx}}let sx={_A:e=>e,_I:e=>e,_R:e=>e},sC=e=>k.isSuccess(e)?e.value:sR(d.pretty(e.cause)),sR=e=>({issues:[{message:e}]}),sF=e=>S.map(sl.formatIssue(e),e=>({issues:e.map(e=>({path:e.path,message:e.message}))})),sA={schemaId:rV,message:rH,missingMessage:rG,identifier:rK,title:rJ,description:rQ,examples:rY,default:rX,documentation:r3,jsonSchema:r0,arbitrary:r1,pretty:r2,equivalence:r5,concurrency:r8,batching:r4,parseIssueTitle:r6,parseOptions:r9,decodingFallback:r7},sO=e=>{if(!e)return{};let t={...e};for(let r in sA)r in e&&(t[sA[r]]=e[r],delete t[r]);return t},s_=(e,t)=>nw(e,sO(t));function sM(e){return e}let sD=e=>String(e.ast),sN=e=>sT(nK(e.ast)),sP=e=>sT(nJ(e.ast)),sL=e=>sT(nj(e.ast)),sU=(e,t)=>{let r=aN(e,t);return(e,t)=>aS(r(e,t),ac)},sz=(e,t)=>{let r=aM(e,t);return(e,t)=>b.mapLeft(r(e,t),ac)},sW=(e,t)=>{let r=sU(e,t);return(e,t)=>S.runPromise(r(e,t))},sB=(e,t)=>{let r=aA(e,t);return(e,t)=>aS(r(e,t),ac)},sq=(e,t)=>{let r=aR(e,t);return(e,t)=>b.mapLeft(r(e,t),ac)},s$=(e,t)=>{let r=sB(e,t);return(e,t)=>S.runPromise(r(e,t))},sj=(e,t)=>{let r=aU(e,t);return(e,t)=>aS(r(e,t),ac)},sV=e=>sd.hasProperty(e,sI)&&sd.isObject(e[sI]);function sH(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return o.isNonEmptyReadonlyArray(t)?function e(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:no(t)?na.make(ns(t,e=>new iT(e))):new iT(t[0]);return class extends sT(r){static annotations(t){return e(this.literals,s_(this.ast,t))}static literals=[...t]}}(t):s3}let sG=e=>sT(new iR(e)),sK=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new iH(Object.keys(e).filter(t=>"number"!=typeof e[e[t]]).map(t=>[t,e[t]]));return class extends sT(t){static annotations(e){return sK(this.enums,s_(this.ast,e))}static enums={...e}}},sJ=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let[i,...n]=t,a=[],s="",l=n;sV(i)?ix(i.ast)?s=String(i.ast.literal):l=[i,...l]:s=String(i);for(let e=0;e<l.length;e++){let t=l[e];if(sV(t)){if(e<l.length-1){let r=l[e+1];if(sV(r)){if(ix(r.ast)){a.push(new iZ(t.ast,String(r.ast.literal))),e++;continue}}else{a.push(new iZ(t.ast,String(r))),e++;continue}}a.push(new iZ(t.ast,""))}else a.push(new iZ(new iT(t),""))}return o.isNonEmptyArray(a)?sT(new iQ(s,a)):sT(new iQ("",[new iZ(new iT(s),"")]))};function sZ(e,t){return class extends sT(t){static annotations(e){return sZ(this.typeParameters,s_(this.ast,e))}static typeParameters=[...e]}}let sQ=function(){let e;if(Array.isArray(arguments[0])){let e=arguments[0],t=arguments[1],r=arguments[2];return sZ(e,new ik(e.map(e=>e.ast),function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return t.decode(...r.map(sT))},function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return t.encode(...r.map(sT))},sO(r)))}let t=arguments[0],r=arguments[1];return sZ([],new ik([],e=()=>(e,r,i)=>t(e)?ad(e):ap(new as(i,e)),e,sO(r)))},sY=Symbol.for("effect/SchemaId/Brand"),sX=Symbol.for("effect/SchemaId/InstanceOf"),s0=(e,t)=>sQ(t=>t instanceof e,{title:e.name,description:`an instance of ${e.name}`,pretty:()=>String,schemaId:sX,[sX]:{constructor:e},...t});class s1 extends sT(iA){}class s2 extends sT(iO){}class s5 extends sT(iC){}class s3 extends sT(i_){}class s8 extends sT(iD){}class s4 extends sT(iN){}class s6 extends sT(iq){}class s9 extends sT(i$){}class s7 extends sT(iP){}class oe extends sT(iU){}class ot extends sT(iW){}class or extends sT(iV){}function oi(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return no(t)?function e(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:na.make(t.map(e=>e.ast));return class extends sT(r){static annotations(t){return e(this.members,s_(this.ast,t))}static members=[...t]}}(t):o.isNonEmptyReadonlyArray(t)?t[0]:s3}let on=e=>oi(e,s5),oa=e=>oi(e,s1),os=e=>oi(e,s5,s1),oo=e=>new ol(new i1(e.ast,!1),e);class ol{ast;from;[sI];_Token;constructor(e,t){this.ast=e,this.from=t}annotations(e){return new ol(new i1(this.ast.type,this.ast.isOptional,{...this.ast.annotations,...sO(e)}),this.from)}toString(){return`${this.ast.type}${this.ast.isOptional?"?":""}`}}function ou(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new i5(e.map(e=>sV(e)?new i1(e.ast,!1):e.ast),t.map(e=>sV(e)?new i0(e.ast):e.ast),!0);return class extends sT(r){static annotations(e){return ou(this.elements,this.rest,s_(this.ast,e))}static elements=[...e];static rest=[...t]}}function oc(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return Array.isArray(t[0])?ou(t[0],t.slice(1)):ou(t,[])}let od=e=>(function e(t,r){return class extends ou([],[t],r){static annotations(t){return e(this.value,s_(this.ast,t))}static value=t}})(e),op=e=>(function e(t,r){return class extends ou([t],[t],r){static annotations(t){return e(this.value,s_(this.ast,t))}static value=t}})(e),of=e=>e?'"?:"':'":"';class oh extends i1{isReadonly;defaultValue;_tag="PropertySignatureDeclaration";constructor(e,t,r,i,n){super(e,t,i),this.isReadonly=r,this.defaultValue=n}toString(){let e=of(this.isOptional),t=String(this.type);return`PropertySignature<${e}, ${t}, never, ${e}, ${t}>`}}class om extends i1{isReadonly;fromKey;constructor(e,t,r,i,n){super(e,t,i),this.isReadonly=r,this.fromKey=n}}class og extends i1{isReadonly;defaultValue;constructor(e,t,r,i,n){super(e,t,i),this.isReadonly=r,this.defaultValue=n}}class oy{from;to;decode;encode;_tag="PropertySignatureTransformation";constructor(e,t,r,i){this.from=e,this.to=t,this.decode=r,this.encode=i}toString(){var e;return`PropertySignature<${of(this.to.isOptional)}, ${this.to.type}, ${void 0===(e=this.from.fromKey)?"never":sd.isString(e)?JSON.stringify(e):String(e)}, ${of(this.from.isOptional)}, ${this.from.type}>`}}let oS=(e,t)=>{switch(e._tag){case"PropertySignatureDeclaration":return new oh(e.type,e.isOptional,e.isReadonly,{...e.annotations,...t},e.defaultValue);case"PropertySignatureTransformation":return new oy(e.from,new og(e.to.type,e.to.isOptional,e.to.isReadonly,{...e.to.annotations,...t},e.to.defaultValue),e.decode,e.encode)}},ob=Symbol.for("effect/PropertySignature"),ov=e=>sd.hasProperty(e,ob);class oE{ast;[sI];[ob]=null;_TypeToken;_Key;_EncodedToken;_HasDefault;constructor(e){this.ast=e}pipe(){return(0,sc.pipeArguments)(this,arguments)}annotations(e){return new oE(oS(this.ast,sO(e)))}toString(){return String(this.ast)}}let ow=e=>new oE(e);class ok extends oE{from;constructor(e,t){super(e),this.from=t}annotations(e){return new ok(oS(this.ast,sO(e)),this.from)}}let oI=e=>new ok(new oh(e.ast,!1,!0,{},void 0),e),oT=(0,t5.dual)(2,(e,t)=>{let r=e.ast;switch(r._tag){case"PropertySignatureDeclaration":return ow(new oh(r.type,r.isOptional,r.isReadonly,r.annotations,t));case"PropertySignatureTransformation":return ow(new oy(r.from,new og(r.to.type,r.to.isOptional,r.to.isReadonly,r.to.annotations,t),r.decode,r.encode))}}),ox=(e,t)=>rU.match(e,{onNone:()=>rU.some(t()),onSome:e=>rU.some(void 0===e?t():e)}),oC=e=>n7(e,oC,e=>{let t=oC(e.to);if(t)return new nh(e.from,t,e.transformation)}),oR=(0,t5.dual)(2,(e,t)=>{let r=e.ast;switch(r._tag){case"PropertySignatureDeclaration":{let e=nj(r.type);return ow(new oy(new om(r.type,r.isOptional,r.isReadonly,r.annotations),new og(oC(e)??e,!1,!0,{},r.defaultValue),e=>ox(e,t),t5.identity))}case"PropertySignatureTransformation":{let e=r.to.type;return ow(new oy(r.from,new og(oC(e)??e,!1,r.to.isReadonly,r.to.annotations,r.to.defaultValue),e=>ox(r.decode(e),t),r.encode))}}}),oF=(0,t5.dual)(2,(e,t)=>e.pipe(oR(t.decoding),oT(t.constructor))),oA=(0,t5.dual)(2,(e,t)=>{let r=e.ast;switch(r._tag){case"PropertySignatureDeclaration":return ow(new oy(new om(r.type,r.isOptional,r.isReadonly,r.annotations,t),new og(nj(r.type),r.isOptional,r.isReadonly,{},r.defaultValue),t5.identity,t5.identity));case"PropertySignatureTransformation":return ow(new oy(new om(r.from.type,r.from.isOptional,r.from.isReadonly,r.from.annotations,t),r.to,r.decode,r.encode))}}),oO=(e,t,r)=>ow(new oy(new om(e.ast,!0,!0,{},void 0),new og(t.ast,!1,!0,{},void 0),e=>rU.some(r.decode(e)),rU.flatMap(r.encode))),o_=(e,t,r)=>ow(new oy(new om(e.ast,!0,!0,{},void 0),new og(t.ast,!0,!0,{},void 0),r.decode,r.encode)),oM=(0,t5.dual)(e=>sV(e[0]),(e,t)=>new ok(((e,t)=>{let r=t?.exact,i=t?.default,n=t?.nullable,a=t?.as=="Option",s=t?.onNoneEncoding?rU.orElse(t.onNoneEncoding):t5.identity;if(r)if(i)if(n)return oT(oO(on(e),sL(e),{decode:rU.match({onNone:i,onSome:e=>null===e?i():e}),encode:rU.some}),i).ast;else return oT(oO(e,sL(e),{decode:rU.match({onNone:i,onSome:t5.identity}),encode:rU.some}),i).ast;else if(a){let t=c_(sL(e));return n?oO(on(e),t,{decode:rU.filter(sd.isNotNull),encode:s}).ast:oO(e,t,{decode:t5.identity,encode:t5.identity}).ast}else if(n)return o_(on(e),sL(e),{decode:rU.filter(sd.isNotNull),encode:t5.identity}).ast;else return new oh(e.ast,!0,!0,{},void 0);if(i)if(n)return oT(oO(os(e),sL(e),{decode:rU.match({onNone:i,onSome:e=>null==e?i():e}),encode:rU.some}),i).ast;else return oT(oO(oa(e),sL(e),{decode:rU.match({onNone:i,onSome:e=>void 0===e?i():e}),encode:rU.some}),i).ast;if(a){let t=c_(sL(e));return n?oO(os(e),t,{decode:rU.filter(e=>null!=e),encode:s}).ast:oO(oa(e),t,{decode:rU.filter(sd.isNotUndefined),encode:s}).ast}if(n)return o_(os(e),oa(sL(e)),{decode:rU.filter(sd.isNotNull),encode:t5.identity}).ast;return new oh(oa(e).ast,!0,!0,{},void 0)})(e,t),e)),oD=nB([rG]),oN=(e,t)=>{for(let r of Reflect.ownKeys(e)){let i=e[r];if(void 0===t[r]&&ov(i)){let e=i.ast,n="PropertySignatureDeclaration"===e._tag?e.defaultValue:e.to.defaultValue;void 0!==n&&(t[r]=n())}}return t};function oP(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:((e,t)=>{let r=Reflect.ownKeys(e),i=[];if(r.length>0){let n=[],a=[],s=[];for(let t=0;t<r.length;t++){let o=r[t],l=e[o];if(ov(l)){let e=l.ast;switch(e._tag){case"PropertySignatureDeclaration":{let t=e.type,r=e.isOptional,s=e.annotations;n.push(new i8(o,t,r,!0,oD(e))),a.push(new i8(o,nj(t),r,!0,s)),i.push(new i8(o,t,r,!0,s));break}case"PropertySignatureTransformation":{let t=e.from.fromKey??o;n.push(new i8(t,e.from.type,e.from.isOptional,!0,e.from.annotations)),a.push(new i8(o,e.to.type,e.to.isOptional,!0,e.to.annotations)),s.push(new nS(t,o,e.decode,e.encode))}}}else n.push(new i8(o,l.ast,!1,!0)),a.push(new i8(o,nj(l.ast),!1,!0)),i.push(new i8(o,l.ast,!1,!0))}if(o.isNonEmptyReadonlyArray(s)){let e=[],r=[];for(let i of t){let{indexSignatures:t,propertySignatures:s}=nD(i.key.ast,i.value.ast);s.forEach(e=>{n.push(e),a.push(new i8(e.name,nj(e.type),e.isOptional,e.isReadonly,e.annotations))}),t.forEach(t=>{e.push(t),r.push(new i6(t.parameter,nj(t.type),t.isReadonly))})}return new nh(new i9(n,e,{[rZ]:"Struct (Encoded side)"}),new i9(a,r,{[rZ]:"Struct (Type side)"}),new nv(s))}}let n=[];for(let e of t){let{indexSignatures:t,propertySignatures:r}=nD(e.key.ast,e.value.ast);r.forEach(e=>i.push(e)),t.forEach(e=>n.push(e))}return new i9(i,n)})(e,t);return class extends sT(r){static annotations(e){return oP(this.fields,this.records,s_(this.ast,e))}static fields={...e};static records=[...t];static make=(t,r)=>{let i=oN(e,{...t});return dz(r)?i:aP(this)(i)};static pick(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return oL(sw(e,...r))}static omit(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return oL(sk(e,...r))}}}function oL(e){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return oP(e,r)}let oU=e=>sH(e).pipe(oI,oT(()=>e)),oz=(e,t)=>oL({_tag:oU(e),...t}),oW=e=>(function e(t,r,i){return class extends oP({},[{key:t,value:r}],i){static annotations(i){return e(t,r,s_(this.ast,i))}static key=t;static value=r}})(e.key,e.value),oB=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>sT(nN(e.ast,t))},oq=(0,t5.dual)(2,(e,t)=>{let r=n_(nj(e.ast),t),i=sT(r.isOptional?nL(r.type):r.type);return o6(e.pipe(oB(t)),i,{strict:!0,decode:e=>e[t],encode:e=>r.isOptional&&void 0===e?{}:{[t]:e}})});function o$(e,t){return class extends sT(t){static annotations(e){return o$(this.from,s_(this.ast,e))}static make=(e,t)=>dz(t)?e:aP(this)(e);static from=e}}let oj=(0,t5.dual)(e=>sV(e[0]),(e,t)=>sT(nU(e.ast,t))),oV=(e,t,r)=>{if(nt(e)&&nt(t)){let i=[...e.propertySignatures];for(let e of t.propertySignatures){let t=e.name,n=i.findIndex(e=>e.name===t);if(-1===n)i.push(e);else{let{isOptional:a,type:s}=i[n];i[n]=new i8(t,oK(s,e.type,r.concat(t)),a,!0)}}return new i9(i,e.indexSignatures.concat(t.indexSignatures))}throw Error(rl(e,t,r))},oH=nq([rK]),oG=(e,t)=>t.map(t=>new nd(t,e.filter,oH(e))),oK=(e,t,r)=>na.make(oZ([e],[t],r)),oJ=e=>nl(e)?e.types:[e],oZ=(e,t,r)=>o.flatMap(e,e=>o.flatMap(t,t=>{switch(t._tag){case"Literal":if(sd.isString(t.literal)&&iL(e)||sd.isNumber(t.literal)&&iz(e)||sd.isBoolean(t.literal)&&iB(e))return[t];break;case"StringKeyword":if(t===iP){if(iL(e)||ix(e)&&sd.isString(e.literal))return[e];else if(np(e))return oG(e,oZ(oJ(e.from),[t],r))}else if(e===iP)return[t];break;case"NumberKeyword":if(t===iU){if(iz(e)||ix(e)&&sd.isNumber(e.literal))return[e];else if(np(e))return oG(e,oZ(oJ(e.from),[t],r))}else if(e===iU)return[t];break;case"BooleanKeyword":if(t===iW){if(iB(e)||ix(e)&&sd.isBoolean(e.literal))return[e];else if(np(e))return oG(e,oZ(oJ(e.from),[t],r))}else if(e===iW)return[t];break;case"Union":return oZ(oJ(e),t.types,r);case"Suspend":return[new nc(()=>oK(e,t.f(),r))];case"Refinement":return oG(t,oZ(oJ(e),oJ(t.from),r));case"TypeLiteral":switch(e._tag){case"Union":return oZ(e.types,[t],r);case"Suspend":return[new nc(()=>oK(e.f(),t,r))];case"Refinement":return oG(e,oZ(oJ(e.from),[t],r));case"TypeLiteral":return[oV(e,t,r)];case"Transformation":{let i=e.transformation,n=oV(e.from,t,r),a=oV(e.to,nj(t),r);switch(i._tag){case"TypeLiteralTransformation":return[new nh(n,a,new nv(i.propertySignatureTransformations))];case"ComposeTransformation":return[new nh(n,a,ny)];case"FinalTransformation":return[new nh(n,a,new ng((e,t,r,n)=>ay(i.decode(e,t,r,n),t=>({...e,...t})),(e,t,r,n)=>ay(i.encode(e,t,r,n),t=>({...e,...t}))))]}}}break;case"Transformation":if(!nm(e))return oZ([t],[e],r);if(nE(t.transformation)&&nE(e.transformation))return[new nh(oV(e.from,t.from,r),oV(e.to,t.to,r),new nv(t.transformation.propertySignatureTransformations.concat(e.transformation.propertySignatureTransformations)))]}throw Error(rl(e,t,r))})),oQ=(0,t5.dual)(2,(e,t)=>sT(oK(e.ast,t.ast,[]))),oY=(0,t5.dual)(e=>sV(e[1]),(e,t)=>o8(e,t,n3(e.ast,t.ast))),oX=e=>sT(new nc(()=>e().ast)),o0=Symbol.for("effect/SchemaId/Refine"),o1=(e,t,r)=>{if(sd.isBoolean(e))return e?rU.none():rU.some(new as(t,r));if(sd.isString(e))return rU.some(new as(t,r,e));if(void 0!==e){if("_tag"in e)return rU.some(e);let i=new as(t,r,e.message);return rU.some(o.isNonEmptyReadonlyArray(e.path)?new ae(e.path,r,i):i)}return rU.none()},o2=(e,t,r)=>{if(!Array.isArray(e))return o1(e,t,r);if(o.isNonEmptyReadonlyArray(e)){let i=o.filterMap(e,e=>o1(e,t,r));if(o.isNonEmptyReadonlyArray(i))return rU.some(1===i.length?i[0]:new ai(t,r,i))}return rU.none()};function o5(e,t){return r=>{function i(t,r,i){return o2(e(t,r,i),i,t)}let n=new nd(r.ast,i,sO(t));return function e(t,r,i){return class extends sT(i){static annotations(t){return e(this.from,this.filter,s_(this.ast,t))}static [o0]=t;static from=t;static filter=r;static make=(e,t)=>dz(t)?e:aP(this)(e)}}(r,i,n)}}let o3=(0,t5.dual)(2,(e,t)=>o4(e,sL(e),{strict:!0,decode:(e,r,i)=>ag(t(e,r,i),t=>rU.match(o2(t,i,e),{onNone:()=>ad(e),onSome:ap})),encode:e=>ad(e)}));function o8(e,t,r){return class extends sT(r){static annotations(e){return o8(this.from,this.to,s_(this.ast,e))}static from=e;static to=t}}let o4=(0,t5.dual)(e=>sV(e[0])&&sV(e[1]),(e,t,r)=>o8(e,t,new nh(e.ast,t.ast,new ng(r.decode,r.encode)))),o6=(0,t5.dual)(e=>sV(e[0])&&sV(e[1]),(e,t,r)=>o4(e,t,{strict:!0,decode:(e,t,i,n)=>ad(r.decode(e,n)),encode:(e,t,i,n)=>ad(r.encode(e,n))}));function o9(e,t){return o6(sH(e),sH(t),{strict:!0,decode:()=>t,encode:()=>e})}let o7=(0,t5.dual)(e=>sV(e[0]),(e,t,r,i)=>{let n=oQ(sL(e),oL({[t]:sd.isSymbol(r)?sG(r):sH(r)})).ast;return sT(new nh(e.ast,i?s_(n,i):n,new nv([new nS(t,t,()=>rU.some(r),()=>rU.none())])))}),le=(0,t5.dual)(2,(e,t)=>e.annotations(t)),lt=(0,t5.dual)(2,(e,t)=>sT(n8(e.ast,t))),lr=Symbol.for("effect/SchemaId/Trimmed"),li=e=>t=>t.pipe(o5(e=>e===e.trim(),{schemaId:lr,title:"trimmed",description:"a string with no leading or trailing whitespace",jsonSchema:{pattern:"^\\S[\\s\\S]*\\S$|^\\S$|^$"},...e})),ln=(e,t)=>r=>r.pipe(o5(t=>t.length>=e,{schemaId:rA,title:`minLength(${e})`,description:`a string at least ${e} character(s) long`,jsonSchema:{minLength:e},...t})),la=(e,t)=>r=>{let i=sd.isObject(e)?Math.max(0,Math.floor(e.min)):Math.max(0,Math.floor(e)),n=sd.isObject(e)?Math.max(i,Math.floor(e.max)):i;return i!==n?r.pipe(o5(e=>e.length>=i&&e.length<=n,{schemaId:r_,title:`length({ min: ${i}, max: ${n})`,description:`a string at least ${i} character(s) and at most ${n} character(s) long`,jsonSchema:{minLength:i,maxLength:n},...t})):r.pipe(o5(e=>e.length===i,{schemaId:r_,title:`length(${i})`,description:1===i?"a single character":`a string ${i} character(s) long`,jsonSchema:{minLength:i,maxLength:i},...t}))},ls=Symbol.for("effect/SchemaId/Pattern"),lo=(e,t)=>r=>{let i=e.source;return r.pipe(o5(t=>(e.lastIndex=0,e.test(t)),{schemaId:ls,[ls]:{regex:e},description:`a string matching the pattern ${i}`,jsonSchema:{pattern:i},...t}))},ll=Symbol.for("effect/SchemaId/StartsWith"),lu=Symbol.for("effect/SchemaId/EndsWith"),lc=Symbol.for("effect/SchemaId/Includes"),ld=Symbol.for("effect/SchemaId/Lowercased"),lp=e=>t=>t.pipe(o5(e=>e===e.toLowerCase(),{schemaId:ld,title:"lowercased",description:"a lowercase string",jsonSchema:{pattern:"^[^A-Z]*$"},...e}));class lf extends s7.pipe(lp({identifier:"Lowercased"})){}let lh=Symbol.for("effect/SchemaId/Uppercased"),lm=e=>t=>t.pipe(o5(e=>e===e.toUpperCase(),{schemaId:lh,title:"uppercased",description:"an uppercase string",jsonSchema:{pattern:"^[^a-z]*$"},...e}));class lg extends s7.pipe(lm({identifier:"Uppercased"})){}let ly=Symbol.for("effect/SchemaId/Capitalized"),lS=e=>t=>t.pipe(o5(e=>e[0]?.toUpperCase()===e[0],{schemaId:ly,title:"capitalized",description:"a capitalized string",jsonSchema:{pattern:"^[^a-z]?.*$"},...e}));class lb extends s7.pipe(lS({identifier:"Capitalized"})){}let lv=Symbol.for("effect/SchemaId/Uncapitalized"),lE=e=>t=>t.pipe(o5(e=>e[0]?.toLowerCase()===e[0],{schemaId:lv,title:"uncapitalized",description:"a uncapitalized string",jsonSchema:{pattern:"^[^A-Z]?.*$"},...e}));class lw extends s7.pipe(lE({identifier:"Uncapitalized"})){}class lk extends s7.pipe(la(1,{identifier:"Char"})){}let lI=e=>ln(1,{title:"nonEmptyString",description:"a non empty string",...e});class lT extends o6(s7.annotations({description:"a string that will be converted to lowercase"}),lf,{strict:!0,decode:e=>e.toLowerCase(),encode:t5.identity}).annotations({identifier:"Lowercase"}){}class lx extends o6(s7.annotations({description:"a string that will be converted to uppercase"}),lg,{strict:!0,decode:e=>e.toUpperCase(),encode:t5.identity}).annotations({identifier:"Uppercase"}){}class lC extends o6(s7.annotations({description:"a string that will be converted to a capitalized format"}),lb,{strict:!0,decode:e=>sE.capitalize(e),encode:t5.identity}).annotations({identifier:"Capitalize"}){}class lR extends o6(s7.annotations({description:"a string that will be converted to an uncapitalized format"}),lw,{strict:!0,decode:e=>sE.uncapitalize(e),encode:t5.identity}).annotations({identifier:"Uncapitalize"}){}class lF extends s7.pipe(li({identifier:"Trimmed"})){}class lA extends lF.pipe(lI({identifier:"NonEmptyTrimmedString"})){}class lO extends o6(s7.annotations({description:"a string that will be trimmed"}),lF,{strict:!0,decode:e=>e.trim(),encode:t5.identity}).annotations({identifier:"Trim"}){}let l_=e=>e instanceof Error?e.message:String(e),lM=(e,t)=>sV(e)?oY(lM(t),e):o4(s7.annotations({description:"a string to be decoded into JSON"}),s8,{strict:!0,decode:(t,r,i)=>af({try:()=>JSON.parse(t,e?.reviver),catch:e=>new as(i,t,l_(e))}),encode:(t,r,i)=>af({try:()=>JSON.stringify(t,e?.replacer,e?.space),catch:e=>new as(i,t,l_(e))})}).annotations({title:"parseJson",schemaId:iw});class lD extends s7.pipe(lI({identifier:"NonEmptyString"})){}let lN=Symbol.for("effect/SchemaId/UUID"),lP=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/i;class lL extends s7.pipe(lo(lP,{schemaId:lN,identifier:"UUID",jsonSchema:{format:"uuid",pattern:lP.source},description:"a Universally Unique Identifier",arbitrary:()=>e=>e.uuid()})){}let lU=Symbol.for("effect/SchemaId/ULID"),lz=/^[0-7][0-9A-HJKMNP-TV-Z]{25}$/i;class lW extends s7.pipe(lo(lz,{schemaId:lU,identifier:"ULID",description:"a Universally Unique Lexicographically Sortable Identifier",arbitrary:()=>e=>e.ulid()})){}class lB extends s0(URL,{identifier:"URLFromSelf",arbitrary:()=>e=>e.webUrl().map(e=>new URL(e)),pretty:()=>e=>e.toString()}){}class lq extends o4(s7.annotations({description:"a string to be decoded into a URL"}),lB,{strict:!0,decode:(e,t,r)=>af({try:()=>new URL(e),catch:t=>new as(r,e,`Unable to decode ${JSON.stringify(e)} into a URL. ${l_(t)}`)}),encode:e=>ad(e.toString())}).annotations({identifier:"URL",pretty:()=>e=>e.toString()}){}let l$=e=>t=>t.pipe(o5(Number.isFinite,{schemaId:rw,title:"finite",description:"a finite number",jsonSchema:{},...e})),lj=(e,t)=>r=>r.pipe(o5(t=>t>e,{schemaId:rg,title:`greaterThan(${e})`,description:0===e?"a positive number":`a number greater than ${e}`,jsonSchema:{exclusiveMinimum:e},...t})),lV=(e,t)=>r=>r.pipe(o5(t=>t>=e,{schemaId:ry,title:`greaterThanOrEqualTo(${e})`,description:0===e?"a non-negative number":`a number greater than or equal to ${e}`,jsonSchema:{minimum:e},...t})),lH=Symbol.for("effect/SchemaId/MultipleOf"),lG=e=>t=>t.pipe(o5(e=>Number.isSafeInteger(e),{schemaId:rv,title:"int",description:"an integer",jsonSchema:{type:"integer"},...e})),lK=(e,t)=>r=>r.pipe(o5(t=>t<e,{schemaId:rS,title:`lessThan(${e})`,description:0===e?"a negative number":`a number less than ${e}`,jsonSchema:{exclusiveMaximum:e},...t})),lJ=(e,t)=>r=>r.pipe(o5(t=>t<=e,{schemaId:rb,title:`lessThanOrEqualTo(${e})`,description:0===e?"a non-positive number":`a number less than or equal to ${e}`,jsonSchema:{maximum:e},...t})),lZ=(e,t,r)=>i=>i.pipe(o5(r=>r>=e&&r<=t,{schemaId:rI,title:`between(${e}, ${t})`,description:`a number between ${e} and ${t}`,jsonSchema:{minimum:e,maximum:t},...r})),lQ=e=>t=>t.pipe(o5(e=>!Number.isNaN(e),{schemaId:rE,title:"nonNaN",description:"a number excluding NaN",...e})),lY=e=>lj(0,{title:"positive",...e}),lX=e=>lK(0,{title:"negative",...e}),l0=e=>lJ(0,{title:"nonPositive",...e}),l1=e=>lV(0,{title:"nonNegative",...e});function l2(e){return o4(e,oe,{strict:!1,decode:(e,t,r)=>ah(rL.parse(e),()=>new as(r,e,`Unable to decode ${JSON.stringify(e)} into a number`)),encode:e=>ad(String(e))})}class l5 extends l2(s7.annotations({description:"a string to be decoded into a number"})).annotations({identifier:"NumberFromString"}){}class l3 extends oe.pipe(l$({identifier:"Finite"})){}class l8 extends oe.pipe(lG({identifier:"Int"})){}class l4 extends oe.pipe(lQ({identifier:"NonNaN"})){}class l6 extends oe.pipe(lY({identifier:"Positive"})){}class l9 extends oe.pipe(lX({identifier:"Negative"})){}class l7 extends oe.pipe(l0({identifier:"NonPositive"})){}class ue extends oe.pipe(l1({identifier:"NonNegative"})){}let ut=rk;class ur extends oe.pipe(l$({schemaId:ut,identifier:"JsonNumber"})){}class ui extends o6(ot.annotations({description:"a boolean that will be negated"}),ot,{strict:!0,decode:e=>c.not(e),encode:e=>c.not(e)}){}let un=(e,t)=>{let r=Symbol.keyFor(e);return void 0===r?ap(new as(t,e,`Unable to encode a unique symbol ${String(e)} into a string`)):ad(r)},ua=e=>ad(Symbol.for(e));class us extends o4(s7.annotations({description:"a string to be decoded into a globally shared symbol"}),s9,{strict:!1,decode:e=>ua(e),encode:(e,t,r)=>un(e,r)}).annotations({identifier:"Symbol"}){}let uo=(e,t)=>r=>r.pipe(o5(t=>t>e,{schemaId:rT,[rT]:{min:e},title:`greaterThanBigInt(${e})`,description:0n===e?"a positive bigint":`a bigint greater than ${e}n`,...t})),ul=(e,t)=>r=>r.pipe(o5(t=>t>=e,{schemaId:rx,[rx]:{min:e},title:`greaterThanOrEqualToBigInt(${e})`,description:0n===e?"a non-negative bigint":`a bigint greater than or equal to ${e}n`,...t})),uu=(e,t)=>r=>r.pipe(o5(t=>t<e,{schemaId:rC,[rC]:{max:e},title:`lessThanBigInt(${e})`,description:0n===e?"a negative bigint":`a bigint less than ${e}n`,...t})),uc=(e,t)=>r=>r.pipe(o5(t=>t<=e,{schemaId:rR,[rR]:{max:e},title:`lessThanOrEqualToBigInt(${e})`,description:0n===e?"a non-positive bigint":`a bigint less than or equal to ${e}n`,...t})),ud=(e,t,r)=>i=>i.pipe(o5(r=>r>=e&&r<=t,{schemaId:rF,[rF]:{min:e,max:t},title:`betweenBigInt(${e}, ${t})`,description:`a bigint between ${e}n and ${t}n`,...r})),up=e=>uo(0n,{title:"positiveBigInt",...e}),uf=e=>uu(0n,{title:"negativeBigInt",...e}),uh=e=>ul(0n,{title:"nonNegativeBigInt",...e}),um=e=>uc(0n,{title:"nonPositiveBigInt",...e});class ug extends o4(s7.annotations({description:"a string to be decoded into a bigint"}),s6,{strict:!0,decode:(e,t,r)=>ah(u.fromString(e),()=>new as(r,e,`Unable to decode ${JSON.stringify(e)} into a bigint`)),encode:e=>ad(String(e))}).annotations({identifier:"BigInt"}){}let uy=s6.pipe(up({identifier:"PositiveBigintFromSelf"})),uS=ug.pipe(up({identifier:"PositiveBigint"})),ub=s6.pipe(uf({identifier:"NegativeBigintFromSelf"})),uv=ug.pipe(uf({identifier:"NegativeBigint"})),uE=s6.pipe(um({identifier:"NonPositiveBigintFromSelf"})),uw=ug.pipe(um({identifier:"NonPositiveBigint"})),uk=s6.pipe(uh({identifier:"NonNegativeBigintFromSelf"})),uI=ug.pipe(uh({identifier:"NonNegativeBigint"}));class uT extends o4(oe.annotations({description:"a number to be decoded into a bigint"}),s6.pipe(ud(BigInt(Number.MIN_SAFE_INTEGER),BigInt(Number.MAX_SAFE_INTEGER))),{strict:!0,decode:(e,t,r)=>ah(u.fromNumber(e),()=>new as(r,e,`Unable to decode ${e} into a bigint`)),encode:(e,t,r)=>ah(u.toNumber(e),()=>new as(r,e,`Unable to encode ${e}n into a number`))}).annotations({identifier:"BigIntFromNumber"}){}let ux=e=>t=>e(t).map(sm),uC=(e,t,r,i)=>ab(e,{onFailure:e=>new ai(r,i,e),onSuccess:t}),uR=e=>(t,r,i)=>sh(t)?uC(e(sg(t),r),sm,i,t):ap(new as(i,t)),uF=e=>sQ([e],{decode:e=>uR(aA(e)),encode:e=>uR(aN(e))},{description:"Redacted(<redacted>)",pretty:()=>()=>"Redacted(<redacted>)",arbitrary:ux,equivalence:sS});class uA extends sQ(y.isDuration,{identifier:"DurationFromSelf",pretty:()=>String,arbitrary:()=>e=>e.oneof(e.constant(y.infinity),e.bigInt({min:0n}).map(e=>y.nanos(e)),e.maxSafeNat().map(e=>y.millis(e))),equivalence:()=>y.Equivalence}){}class uO extends o4(uk.annotations({description:"a bigint to be decoded into a Duration"}),uA.pipe(o5(e=>y.isFinite(e),{description:"a finite duration"})),{strict:!0,decode:e=>ad(y.nanos(e)),encode:(e,t,r)=>rU.match(y.toNanos(e),{onNone:()=>ap(new as(r,e,`Unable to encode ${e} into a bigint`)),onSome:e=>ad(e)})}).annotations({identifier:"DurationFromNanos"}){}let u_=ue.pipe(lG()).annotations({identifier:"NonNegativeInt"});class uM extends o6(ue.annotations({description:"a non-negative number to be decoded into a Duration"}),uA,{strict:!0,decode:e=>y.millis(e),encode:e=>y.toMillis(e)}).annotations({identifier:"DurationFromMillis"}){}let uD=oz("Millis",{millis:u_}),uN=oz("Nanos",{nanos:ug}),uP=oz("Infinity",{}),uL=uP.make({}),uU=oi(uD,uN,uP).annotations({identifier:"DurationValue",description:"an JSON-compatible tagged union to be decoded into a Duration"}),uz=oi(oc(oo(u_).annotations({title:"seconds"}),oo(u_).annotations({title:"nanos"})).annotations({identifier:"FiniteHRTime"}),oc(sH(-1),sH(0)).annotations({identifier:"InfiniteHRTime"})).annotations({identifier:"HRTime",description:"a tuple of seconds and nanos to be decoded into a Duration"}),uW=e=>"object"==typeof e;class uB extends o6(oi(uU,uz),uA,{strict:!0,decode:e=>{if(uW(e))switch(e._tag){case"Millis":return y.millis(e.millis);case"Nanos":return y.nanos(e.nanos);case"Infinity":return y.infinity}let[t,r]=e;return -1===t?y.infinity:y.nanos(BigInt(t)*BigInt(1e9)+BigInt(r))},encode:e=>{switch(e.value._tag){case"Millis":return uD.make({millis:e.value.millis});case"Nanos":return uN.make({nanos:e.value.nanos});case"Infinity":return uL}}}).annotations({identifier:"Duration"}){}let uq=Symbol.for("effect/SchemaId/LessThanDuration"),u$=Symbol.for("effect/schema/LessThanOrEqualToDuration"),uj=Symbol.for("effect/SchemaId/GreaterThanDuration"),uV=Symbol.for("effect/schema/GreaterThanOrEqualToDuration"),uH=Symbol.for("effect/SchemaId/BetweenDuration"),uG=(e,t,r)=>i=>i.pipe(o5(r=>y.between(r,{minimum:e,maximum:t}),{schemaId:uH,[uH]:{maximum:t,minimum:e},title:`betweenDuration(${e}, ${t})`,description:`a Duration between ${y.decode(e)} and ${y.decode(t)}`,...r}));class uK extends sQ(sd.isUint8Array,{identifier:"Uint8ArrayFromSelf",pretty:()=>e=>`new Uint8Array(${JSON.stringify(Array.from(e))})`,arbitrary:()=>e=>e.uint8Array(),equivalence:()=>o.getEquivalence(E.equals)}){}class uJ extends oe.pipe(lZ(0,255,{identifier:"Uint8",description:"a 8-bit unsigned integer"})){}class uZ extends o6(od(uJ).annotations({description:"an array of 8-bit unsigned integers to be decoded into a Uint8Array"}),uK,{strict:!0,decode:e=>Uint8Array.from(e),encode:e=>Array.from(e)}).annotations({identifier:"Uint8Array"}){}let uQ=(e,t,r)=>o4(s7.annotations({description:"a string to be decoded into a Uint8Array"}),uK,{strict:!0,decode:(e,r,i)=>b.mapLeft(t(e),t=>new as(i,e,t.message)),encode:e=>ad(r(e))}).annotations({identifier:e}),uY=uQ("Uint8ArrayFromBase64",v.decodeBase64,v.encodeBase64),uX=uQ("Uint8ArrayFromBase64Url",v.decodeBase64Url,v.encodeBase64Url),u0=uQ("Uint8ArrayFromHex",v.decodeHex,v.encodeHex),u1=(e,t,r)=>o4(s7.annotations({description:`A string that is interpreted as being ${e}-encoded and will be decoded into a UTF-8 string`}),s7,{strict:!0,decode:(e,r,i)=>b.mapLeft(t(e),t=>new as(i,e,t.message)),encode:e=>ad(r(e))}).annotations({identifier:`StringFrom${e}`}),u2=u1("Base64",v.decodeBase64String,v.encodeBase64),u5=u1("Base64Url",v.decodeBase64UrlString,v.encodeBase64Url),u3=u1("Hex",v.decodeHexString,v.encodeHex),u8=o4(s7.annotations({description:"A string that is interpreted as being UriComponent-encoded and will be decoded into a UTF-8 string"}),s7,{strict:!0,decode:(e,t,r)=>b.mapLeft(v.decodeUriComponent(e),t=>new as(r,e,t.message)),encode:(e,t,r)=>b.mapLeft(v.encodeUriComponent(e),t=>new as(r,e,t.message))}).annotations({identifier:"StringFromUriComponent"}),u4=e=>sT(nA(e.ast)),u6=(0,t5.dual)(e=>sV(e[0]),(e,t)=>o4(e,u4(sL(e)),{strict:!0,decode:(e,r,i)=>e.length>0?ad(e[0]):t?ad(t()):ap(new as(i,e,"Unable to retrieve the first element of an empty array")),encode:e=>ad(o.of(e))})),u9=Symbol.for("effect/SchemaId/ValidDate"),u7=e=>t=>t.pipe(o5(e=>!Number.isNaN(e.getTime()),{schemaId:u9,[u9]:{noInvalidDate:!0},title:"validDate",description:"a valid Date",...e})),ce=Symbol.for("effect/SchemaId/LessThanDate"),ct=Symbol.for("effect/schema/LessThanOrEqualToDate"),cr=Symbol.for("effect/SchemaId/GreaterThanDate"),ci=Symbol.for("effect/schema/GreaterThanOrEqualToDate"),cn=Symbol.for("effect/SchemaId/BetweenDate"),ca=rm;class cs extends sQ(sd.isDate,{identifier:"DateFromSelf",schemaId:ca,[ca]:{noInvalidDate:!1},description:"a potentially invalid Date instance",pretty:()=>e=>`new Date(${JSON.stringify(e)})`,arbitrary:()=>e=>e.date({noInvalidDate:!1}),equivalence:()=>w.Date}){}class co extends cs.pipe(u7({identifier:"ValidDateFromSelf",description:"a valid Date instance"})){}class cl extends o6(s7.annotations({description:"a string to be decoded into a Date"}),cs,{strict:!0,decode:e=>new Date(e),encode:e=>rt(e)}).annotations({identifier:"DateFromString"}){}class cu extends cl.pipe(u7({identifier:"Date"})){}class cc extends o6(oe.annotations({description:"a number to be decoded into a Date"}),cs,{strict:!0,decode:e=>new Date(e),encode:e=>e.getTime()}).annotations({identifier:"DateFromNumber"}){}class cd extends sQ(e=>g.isDateTime(e)&&g.isUtc(e),{identifier:"DateTimeUtcFromSelf",description:"a DateTime.Utc instance",pretty:()=>e=>e.toString(),arbitrary:()=>e=>e.date({noInvalidDate:!0}).map(e=>g.unsafeFromDate(e)),equivalence:()=>g.Equivalence}){}let cp=(e,t)=>af({try:()=>g.unsafeMake(e),catch:()=>new as(t,e,`Unable to decode ${ri(e)} into a DateTime.Utc`)});class cf extends o4(oe.annotations({description:"a number to be decoded into a DateTime.Utc"}),cd,{strict:!0,decode:(e,t,r)=>cp(e,r),encode:e=>ad(g.toEpochMillis(e))}).annotations({identifier:"DateTimeUtcFromNumber"}){}class ch extends o4(cs.annotations({description:"a Date to be decoded into a DateTime.Utc"}),cd,{strict:!0,decode:(e,t,r)=>cp(e,r),encode:e=>ad(g.toDateUtc(e))}).annotations({identifier:"DateTimeUtcFromDate"}){}class cm extends o4(s7.annotations({description:"a string to be decoded into a DateTime.Utc"}),cd,{strict:!0,decode:(e,t,r)=>cp(e,r),encode:e=>ad(g.formatIso(e))}).annotations({identifier:"DateTimeUtc"}){}let cg=()=>e=>e.integer({min:-432e5,max:504e5}).map(g.zoneMakeOffset);class cy extends sQ(g.isTimeZoneOffset,{identifier:"TimeZoneOffsetFromSelf",description:"a TimeZone.Offset instance",pretty:()=>e=>e.toString(),arbitrary:cg}){}class cS extends o6(oe.annotations({description:"a number to be decoded into a TimeZone.Offset"}),cy,{strict:!0,decode:e=>g.zoneMakeOffset(e),encode:e=>e.offset}).annotations({identifier:"TimeZoneOffset"}){}let cb=()=>e=>e.constantFrom(...Intl.supportedValuesOf("timeZone")).map(g.zoneUnsafeMakeNamed);class cv extends sQ(g.isTimeZoneNamed,{identifier:"TimeZoneNamedFromSelf",description:"a TimeZone.Named instance",pretty:()=>e=>e.toString(),arbitrary:cb}){}class cE extends o4(s7.annotations({description:"a string to be decoded into a TimeZone.Named"}),cv,{strict:!0,decode:(e,t,r)=>af({try:()=>g.zoneUnsafeMakeNamed(e),catch:()=>new as(r,e,`Unable to decode ${JSON.stringify(e)} into a TimeZone.Named`)}),encode:e=>ad(e.id)}).annotations({identifier:"TimeZoneNamed"}){}class cw extends oi(cy,cv){}class ck extends o4(s7.annotations({description:"a string to be decoded into a TimeZone"}),cw,{strict:!0,decode:(e,t,r)=>rU.match(g.zoneFromString(e),{onNone:()=>ap(new as(r,e,`Unable to decode ${JSON.stringify(e)} into a TimeZone`)),onSome:ad}),encode:e=>ad(g.zoneToString(e))}).annotations({identifier:"TimeZone"}){}let cI=e=>e.oneof(cg()(e),cb()(e));class cT extends sQ(e=>g.isDateTime(e)&&g.isZoned(e),{identifier:"DateTimeZonedFromSelf",description:"a DateTime.Zoned instance",pretty:()=>e=>e.toString(),arbitrary:()=>e=>e.tuple(e.integer({min:-31536e9,max:31536e9}),cI(e)).map(e=>{let[t,r]=e;return g.unsafeMakeZoned(t,{timeZone:r})}),equivalence:()=>g.Equivalence}){}class cx extends o4(s7.annotations({description:"a string to be decoded into a DateTime.Zoned"}),cT,{strict:!0,decode:(e,t,r)=>rU.match(g.makeZonedFromString(e),{onNone:()=>ap(new as(r,e,`Unable to decode ${JSON.stringify(e)} into a DateTime.Zoned`)),onSome:ad}),encode:e=>ad(g.formatIsoZoned(e))}).annotations({identifier:"DateTimeZoned"}){}let cC=oL({_tag:sH("None")}).annotations({description:"NoneEncoded"}),cR=e=>"None"===e._tag?rU.none():rU.some(e.value),cF=(e,t)=>r=>r.oneof(t,r.record({_tag:r.constant("None")}),r.record({_tag:r.constant("Some"),value:e(r)})).map(cR),cA=e=>rU.match({onNone:()=>"none()",onSome:t=>`some(${e(t)})`}),cO=e=>(t,r,i)=>rU.isOption(t)?rU.isNone(t)?ad(rU.none()):uC(e(t.value,r),rU.some,i,t):ap(new as(i,t)),c_=e=>sQ([e],{decode:e=>cO(aA(e)),encode:e=>cO(aN(e))},{pretty:cA,arbitrary:cF,equivalence:rU.getEquivalence}),cM=e=>c_(e).annotations({description:`Option<${sD(e)}>`}),cD={_tag:"None"},cN=e=>({_tag:"Some",value:e});class cP extends o6(s7,cM(lA),{strict:!0,decode:e=>rU.filter(rU.some(e.trim()),sE.isNonEmpty),encode:e=>rU.getOrElse(e,()=>"")}){}let cL=e=>oL({_tag:sH("Right"),right:e}).annotations({description:`RightEncoded<${sD(e)}>`}),cU=e=>oL({_tag:sH("Left"),left:e}).annotations({description:`LeftEncoded<${sD(e)}>`}),cz=e=>"Left"===e._tag?b.left(e.left):b.right(e.right),cW=(e,t)=>r=>r.oneof(r.record({_tag:r.constant("Left"),left:t(r)}),r.record({_tag:r.constant("Right"),right:e(r)})).map(cz),cB=(e,t)=>b.match({onLeft:e=>`left(${t(e)})`,onRight:t=>`right(${e(t)})`}),cq=(e,t)=>(r,i,n)=>b.isEither(r)?b.match(r,{onLeft:e=>uC(t(e,i),b.left,n,r),onRight:t=>uC(e(t,i),b.right,n,r)}):ap(new as(n,r)),c$=e=>{let{left:t,right:r}=e;return sQ([r,t],{decode:(e,t)=>cq(aA(e),aA(t)),encode:(e,t)=>cq(aN(e),aN(t))},{description:`Either<${sD(r)}, ${sD(t)}>`,pretty:cB,arbitrary:cW,equivalence:(e,t)=>b.getEquivalence({left:t,right:e})})},cj=e=>({_tag:"Left",left:e}),cV=e=>({_tag:"Right",right:e}),cH=(e,t,r)=>i=>{let n=i.array(i.tuple(e(i),t(i)));return(void 0!==r.depthIdentifier?i.oneof(r,i.constant([]),n):n).map(e=>new Map(e))},cG=(e,t)=>r=>`new Map([${Array.from(r.entries()).map(r=>{let[i,n]=r;return`[${e(i)}, ${t(n)}]`}).join(", ")}])`,cK=(e,t)=>{let r=o.getEquivalence(w.make((r,i)=>{let[n,a]=r,[s,o]=i;return e(n,s)&&t(a,o)}));return w.make((e,t)=>r(Array.from(e.entries()),Array.from(t.entries())))},cJ=e=>(t,r,i)=>sd.isMap(t)?uC(e(Array.from(t.entries()),r),e=>new Map(e),i,t):ap(new as(i,t)),cZ=(e,t,r)=>sQ([e,t],{decode:(e,t)=>cJ(aA(od(oc(e,t)))),encode:(e,t)=>cJ(aN(od(oc(e,t))))},{description:r,pretty:cG,arbitrary:cH,equivalence:cK}),cQ=e=>{let{key:t,value:r}=e;return cZ(t,r,`ReadonlyMap<${sD(t)}, ${sD(r)}>`)},cY=e=>{let{key:t,value:r}=e;return cZ(t,r,`Map<${sD(t)}, ${sD(r)}>`)},cX=(e,t)=>r=>{let i=r.array(e(r));return(void 0!==t.depthIdentifier?r.oneof(t,r.constant([]),i):i).map(e=>new Set(e))},c0=e=>t=>`new Set([${Array.from(t.values()).map(t=>e(t)).join(", ")}])`,c1=e=>{let t=o.getEquivalence(e);return w.make((e,r)=>t(Array.from(e.values()),Array.from(r.values())))},c2=e=>(t,r,i)=>sd.isSet(t)?uC(e(Array.from(t.values()),r),e=>new Set(e),i,t):ap(new as(i,t)),c5=(e,t)=>sQ([e],{decode:e=>c2(aA(od(e))),encode:e=>c2(aN(od(e)))},{description:t,pretty:c0,arbitrary:cX,equivalence:c1}),c3=e=>c5(e,`ReadonlySet<${sD(e)}>`),c8=e=>c5(e,`Set<${sD(e)}>`),c4=()=>e=>`BigDecimal(${l.format(l.normalize(e))})`,c6=()=>e=>e.tuple(e.bigInt(),e.integer({min:0,max:18})).map(e=>{let[t,r]=e;return l.make(t,r)});class c9 extends sQ(l.isBigDecimal,{identifier:"BigDecimalFromSelf",pretty:c4,arbitrary:c6,equivalence:()=>l.Equivalence}){}class c7 extends o4(s7.annotations({description:"a string to be decoded into a BigDecimal"}),c9,{strict:!0,decode:(e,t,r)=>l.fromString(e).pipe(rU.match({onNone:()=>ap(new as(r,e,`Unable to decode ${JSON.stringify(e)} into a BigDecimal`)),onSome:e=>ad(l.normalize(e))})),encode:e=>ad(l.format(l.normalize(e)))}).annotations({identifier:"BigDecimal"}){}class de extends o6(oe.annotations({description:"a number to be decoded into a BigDecimal"}),c9,{strict:!0,decode:e=>l.unsafeFromNumber(e),encode:e=>l.unsafeToNumber(e)}).annotations({identifier:"BigDecimalFromNumber"}){}let dt=Symbol.for("effect/SchemaId/GreaterThanBigDecimal"),dr=Symbol.for("effect/schema/GreaterThanOrEqualToBigDecimal"),di=Symbol.for("effect/SchemaId/LessThanBigDecimal"),dn=Symbol.for("effect/schema/LessThanOrEqualToBigDecimal"),da=Symbol.for("effect/schema/PositiveBigDecimal"),ds=e=>t=>t.pipe(o5(e=>l.isPositive(e),{schemaId:da,title:"positiveBigDecimal",description:"a positive BigDecimal",...e})),dl=c9.pipe(ds({identifier:"PositiveBigDecimalFromSelf"})),du=Symbol.for("effect/schema/NonNegativeBigDecimal"),dc=e=>t=>t.pipe(o5(e=>e.value>=0n,{schemaId:du,title:"nonNegativeBigDecimal",description:"a non-negative BigDecimal",...e})),dd=c9.pipe(dc({identifier:"NonNegativeBigDecimalFromSelf"})),dp=Symbol.for("effect/schema/NegativeBigDecimal"),df=e=>t=>t.pipe(o5(e=>l.isNegative(e),{schemaId:dp,title:"negativeBigDecimal",description:"a negative BigDecimal",...e})),dh=c9.pipe(df({identifier:"NegativeBigDecimalFromSelf"})),dm=Symbol.for("effect/schema/NonPositiveBigDecimal"),dg=e=>t=>t.pipe(o5(e=>e.value<=0n,{schemaId:dm,title:"nonPositiveBigDecimal",description:"a non-positive BigDecimal",...e})),dy=c9.pipe(dg({identifier:"NonPositiveBigDecimalFromSelf"})),dS=Symbol.for("effect/SchemaId/BetweenBigDecimal"),db=(e,t,r)=>i=>{let n=l.format(e),a=l.format(t);return i.pipe(o5(r=>l.between(r,{minimum:e,maximum:t}),{schemaId:dS,[dS]:{maximum:t,minimum:e},title:`betweenBigDecimal(${n}, ${a})`,description:`a BigDecimal between ${n} and ${a}`,...r}))},dv=(e,t)=>r=>{let i=r.array(e(r));return(void 0!==t.depthIdentifier?r.oneof(t,r.constant([]),i):i).map(p.fromIterable)},dE=e=>t=>`Chunk(${p.toReadonlyArray(t).map(e).join(", ")})`,dw=e=>(t,r,i)=>p.isChunk(t)?p.isEmpty(t)?ad(p.empty()):uC(e(p.toReadonlyArray(t),r),p.fromIterable,i,t):ap(new as(i,t)),dk=e=>sQ([e],{decode:e=>dw(aA(od(e))),encode:e=>dw(aN(od(e)))},{description:`Chunk<${sD(e)}>`,pretty:dE,arbitrary:dv,equivalence:p.getEquivalence}),dI=e=>t=>(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.size,i=t.minLength||0,n=t.maxLength,a=t.depthIdentifier,s=void 0!==n?n:0x7fffffff,o=function(e,t,r,i){let{baseSize:n="small",defaultSizeToMaxWhenMaxSpecified:a}=eS||{},s=void 0!==e?e:i&&a?"max":n;return"max"===s?r:tW(function(e,t){switch(t){case"xsmall":return tz(1.1*e)+1;case"small":return 2*e+10;case"medium":return 11*e+100;case"large":return 101*e+1e3;case"xlarge":return 1001*e+1e4;default:throw Error(`Unable to compute lengths based on received size: ${t}`)}}(t,function(e,t){let r=ee(tq,e);if(-1===r)return e;let i=ee(tB,t);if(-1===i)throw Error(`Unable to offset size based on the unknown defaulted one: ${t}`);let n=i+r-4;return n<0?tB[0]:n>=tB.length?tB[tB.length-1]:tB[n]}(s,n)),r)}(r,i,s,void 0!==n);return new tU(e,i,o,s,a,void 0,t.experimentalCustomSlices||[])})(e(t),{minLength:1}).map(e=>p.unsafeFromNonEmptyArray(e)),dT=e=>t=>`NonEmptyChunk(${p.toReadonlyArray(t).map(e).join(", ")})`,dx=e=>(t,r,i)=>p.isChunk(t)&&p.isNonEmpty(t)?uC(e(p.toReadonlyArray(t),r),p.unsafeFromNonEmptyArray,i,t):ap(new as(i,t)),dC=e=>sQ([e],{decode:e=>dx(aA(op(e))),encode:e=>dx(aN(op(e)))},{description:`NonEmptyChunk<${sD(e)}>`,pretty:dT,arbitrary:dI,equivalence:p.getEquivalence}),dR=e=>Array.isArray(e)?m.array(e):m.struct(e),dF=e=>t=>e(t).map(dR),dA=e=>t=>`Data(${e(t)})`,dO=e=>(t,r,i)=>E.isEqual(t)?uC(e(t,r),dR,i,t):ap(new as(i,t)),d_=e=>sQ([e],{decode:e=>dO(aA(e)),encode:e=>dO(aN(e))},{description:`Data<${sD(e)}>`,pretty:dA,arbitrary:dF}),dM=e=>Reflect.ownKeys(e).every(t=>{let r;return sV(r=e[t])||ov(r)}),dD=e=>"fields"in e?e.fields:dD(e[o0]),dN=e=>dM(e)?oL(e):sV(e)?e:oL(dD(e)),dP=e=>dM(e)?e:dD(e),dL=e=>oT(oI(sH(e)),()=>e),dU=(e,t)=>{let r={...e};for(let i of Reflect.ownKeys(t)){if(i in e)throw Error(rh(i));r[i]=t[i]}return r};function dz(e){return sd.isBoolean(e)?e:e?.disableValidation??!1}let dW=(0,t3.globalValue)("effect/Schema/astCache",()=>new WeakMap),dB=e=>{let{Base:t,annotations:r,disableToString:i,fields:n,identifier:a,kind:s,schema:o}=e,l=Symbol.for(`effect/Schema/${s}/${a}`),[u,c,d]=void 0===r?[]:Array.isArray(r)?r:[r],p=sL(o),f=p.annotations({identifier:a,...u}),h=p.annotations({[rZ]:`${a} (Type side)`,...u}),m=o.annotations({[rZ]:`${a} (Constructor)`,...u}),g=o.annotations({[rZ]:`${a} (Encoded side)`,...d}),y=o.annotations({...d,...u,...c}),S=class extends t{constructor(e={},t=!1){e={...e},"Class"!==s&&delete e._tag,e=oN(n,e),dz(t)||(e=aP(m)(e)),super(e,!0)}static [sI]=sx;static get ast(){let e=dW.get(this);return e||(e=o6(g,sQ([o],{decode:()=>(e,t,r)=>e instanceof this||sd.hasProperty(e,l)&&az(h)(e)?ad(e):ap(new as(r,e)),encode:()=>(e,t)=>e instanceof this?ad(e):ay(aN(h)(e,t),e=>new this(e,!0))},{identifier:a,pretty:e=>t=>`${a}(${e(t)})`,arbitrary:e=>t=>e(t).map(e=>new this(e)),equivalence:t5.identity,[ie]:f.ast,...u}),{strict:!0,decode:e=>new this(e,!0),encode:t5.identity}).annotations({[ie]:y.ast,...c}).ast,dW.set(this,e)),e}static pipe(){return(0,sc.pipeArguments)(this,arguments)}static annotations(e){return sT(this.ast).annotations(e)}static toString(){return`(${String(g)} <-> ${a})`}static make(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return new this(...t)}static fields={...n};static identifier=a;static extend(e){return(t,r)=>{let i=dP(t),a=dN(t),l=dU(n,i);return dB({kind:s,identifier:e,schema:oQ(o,a),fields:l,Base:this,annotations:r})}}static transformOrFail(e){return(t,r,i)=>{let a=dU(n,t);return dB({kind:s,identifier:e,schema:o4(o,sL(oL(a)),r),fields:a,Base:this,annotations:i})}}static transformOrFailFrom(e){return(t,r,i)=>{let a=dU(n,t);return dB({kind:s,identifier:e,schema:o4(sN(o),oL(a),r),fields:a,Base:this,annotations:i})}}get[l](){return l}};return!0!==i&&Object.defineProperty(S.prototype,"toString",{value(){return`${a}({ ${Reflect.ownKeys(n).map(e=>`${rn(e)}: ${ri(this[e])}`).join(", ")} })`},configurable:!0,writable:!0}),S},dq=oi(oL({_tag:sH("None")}).annotations({identifier:"FiberIdNoneEncoded"}),oL({_tag:sH("Runtime"),id:l8,startTimeMillis:l8}).annotations({identifier:"FiberIdRuntimeEncoded"}),oL({_tag:sH("Composite"),left:oX(()=>dq),right:oX(()=>dq)}).annotations({identifier:"FiberIdCompositeEncoded"})).annotations({identifier:"FiberIdEncoded"}),d$=e=>e.letrec(t=>({None:e.record({_tag:e.constant("None")}),Runtime:e.record({_tag:e.constant("Runtime"),id:e.integer(),startTimeMillis:e.integer()}),Composite:e.record({_tag:e.constant("Composite"),left:t("FiberId"),right:t("FiberId")}),FiberId:e.oneof(t("None"),t("Runtime"),t("Composite"))})).FiberId.map(dH),dj=e=>{switch(e._tag){case"None":return"FiberId.none";case"Runtime":return`FiberId.runtime(${e.id}, ${e.startTimeMillis})`;case"Composite":return`FiberId.composite(${dj(e.right)}, ${dj(e.left)})`}};class dV extends sQ(t2.isFiberId,{identifier:"FiberIdFromSelf",pretty:()=>dj,arbitrary:()=>d$}){}let dH=e=>{switch(e._tag){case"None":return t2.none;case"Runtime":return t2.runtime(e.id,e.startTimeMillis);case"Composite":return t2.composite(dH(e.left),dH(e.right))}},dG=e=>{switch(e._tag){case"None":return{_tag:"None"};case"Runtime":return{_tag:"Runtime",id:e.id,startTimeMillis:e.startTimeMillis};case"Composite":return{_tag:"Composite",left:dG(e.left),right:dG(e.right)}}};class dK extends o6(dq,dV,{strict:!0,decode:e=>dH(e),encode:e=>dG(e)}).annotations({identifier:"FiberId"}){}let dJ=oL({_tag:sH("Empty")}),dZ=oL({_tag:sH("Interrupt"),fiberId:dq}),dQ=0,dY=(e,t)=>{let r=sM(e),i=sM(t),n=oX(()=>a),a=oi(dJ,oL({_tag:sH("Fail"),error:r}),oL({_tag:sH("Die"),defect:i}),dZ,oL({_tag:sH("Sequential"),left:n,right:n}),oL({_tag:sH("Parallel"),left:n,right:n})).annotations({title:`CauseEncoded<${sD(e)}>`,[iv]:`CauseEncoded${dQ++}`});return a},dX=(e,t)=>r=>r.letrec(i=>({Empty:r.record({_tag:r.constant("Empty")}),Fail:r.record({_tag:r.constant("Fail"),error:e(r)}),Die:r.record({_tag:r.constant("Die"),defect:t(r)}),Interrupt:r.record({_tag:r.constant("Interrupt"),fiberId:d$(r)}),Sequential:r.record({_tag:r.constant("Sequential"),left:i("Cause"),right:i("Cause")}),Parallel:r.record({_tag:r.constant("Parallel"),left:i("Cause"),right:i("Cause")}),Cause:r.oneof(i("Empty"),i("Fail"),i("Die"),i("Interrupt"),i("Sequential"),i("Parallel"))})).Cause.map(d5),d0=e=>t=>{let r=t=>{switch(t._tag){case"Empty":return"Cause.empty";case"Fail":return`Cause.fail(${e(t.error)})`;case"Die":return`Cause.die(${d.pretty(t)})`;case"Interrupt":return`Cause.interrupt(${dj(t.fiberId)})`;case"Sequential":return`Cause.sequential(${r(t.left)}, ${r(t.right)})`;case"Parallel":return`Cause.parallel(${r(t.left)}, ${r(t.right)})`}};return r(t)},d1=e=>(t,r,i)=>d.isCause(t)?uC(e(d3(t),r),d5,i,t):ap(new as(i,t)),d2=e=>{let{defect:t,error:r}=e;return sQ([r,t],{decode:(e,t)=>d1(aA(dY(e,t))),encode:(e,t)=>d1(aN(dY(e,t)))},{title:`Cause<${r.ast}>`,pretty:d0,arbitrary:dX})};function d5(e){switch(e._tag){case"Empty":return d.empty;case"Fail":return d.fail(e.error);case"Die":return d.die(e.defect);case"Interrupt":return d.interrupt(dH(e.fiberId));case"Sequential":return d.sequential(d5(e.left),d5(e.right));case"Parallel":return d.parallel(d5(e.left),d5(e.right))}}function d3(e){switch(e._tag){case"Empty":return{_tag:"Empty"};case"Fail":return{_tag:"Fail",error:e.error};case"Die":return{_tag:"Die",defect:e.defect};case"Interrupt":return{_tag:"Interrupt",fiberId:e.fiberId};case"Sequential":return{_tag:"Sequential",left:d3(e.left),right:d3(e.right)};case"Parallel":return{_tag:"Parallel",left:d3(e.left),right:d3(e.right)}}}class d8 extends o6(s8,s8,{strict:!0,decode:e=>{if(sd.isObject(e)&&"message"in e&&"string"==typeof e.message){let t=Error(e.message,{cause:e});return"name"in e&&"string"==typeof e.name&&(t.name=e.name),t.stack="stack"in e&&"string"==typeof e.stack?e.stack:"",t}return t6.prettyErrorMessage(e)},encode:e=>e instanceof Error?{name:e.name,message:e.message}:t6.prettyErrorMessage(e)}).annotations({identifier:"Defect"}){}let d4=e=>{switch(e._tag){case"Failure":return k.failCause(d5(e.cause));case"Success":return k.succeed(e.value)}},d6=(e,t,r)=>i=>i.oneof(i.record({_tag:i.constant("Failure"),cause:dX(t,r)(i)}),i.record({_tag:i.constant("Success"),value:e(i)})).map(d4),d9=(e,t)=>r=>"Failure"===r._tag?`Exit.failCause(${d0(t)(r.cause)})`:`Exit.succeed(${e(r.value)})`,d7=(e,t)=>(r,i,n)=>k.isExit(r)?k.match(r,{onFailure:e=>uC(t(e,i),k.failCause,n,r),onSuccess:t=>uC(e(t,i),k.succeed,n,r)}):ap(new as(n,r)),pe=e=>{let{defect:t,failure:r,success:i}=e;return sQ([i,r,t],{decode:(e,t,r)=>d7(aA(e),aA(d2({error:t,defect:r}))),encode:(e,t,r)=>d7(aN(e),aN(d2({error:t,defect:r})))},{title:`Exit<${i.ast}, ${r.ast}>`,pretty:d9,arbitrary:d6})},pt=e=>{let{defect:t,failure:r,success:i}=e,n=sM(i),a=sM(r),s=sM(t);return o6(oi(oL({_tag:sH("Failure"),cause:dY(a,s)}),oL({_tag:sH("Success"),value:n})).annotations({title:`ExitEncoded<${sD(n)}, ${sD(a)}, ${sD(s)}>`}),pe({failure:sL(a),success:sL(n),defect:sL(s)}),{strict:!1,decode:e=>d4(e),encode:e=>"Failure"===e._tag?{_tag:"Failure",cause:e.cause}:{_tag:"Success",value:e.value}})},pr=(e,t)=>r=>{let i=r.array(e(r));return(void 0!==t.depthIdentifier?r.oneof(t,r.constant([]),i):i).map(t4.fromIterable)},pi=e=>t=>`HashSet(${Array.from(t).map(t=>e(t)).join(", ")})`,pn=e=>{let t=o.getEquivalence(e);return w.make((e,r)=>t(Array.from(e),Array.from(r)))},pa=e=>(t,r,i)=>t4.isHashSet(t)?uC(e(Array.from(t),r),t4.fromIterable,i,t):ap(new as(i,t)),ps=e=>sQ([e],{decode:e=>pa(aA(od(e))),encode:e=>pa(aN(od(e)))},{description:`HashSet<${sD(e)}>`,pretty:pi,arbitrary:pr,equivalence:pn}),po=(e,t,r)=>i=>{let n=i.array(i.tuple(e(i),t(i)));return(void 0!==r.depthIdentifier?i.oneof(r,i.constant([]),n):n).map(t8.fromIterable)},pl=(e,t)=>r=>`HashMap([${Array.from(r).map(r=>{let[i,n]=r;return`[${e(i)}, ${t(n)}]`}).join(", ")}])`,pu=(e,t)=>{let r=o.getEquivalence(w.make((r,i)=>{let[n,a]=r,[s,o]=i;return e(n,s)&&t(a,o)}));return w.make((e,t)=>r(Array.from(e),Array.from(t)))},pc=e=>(t,r,i)=>t8.isHashMap(t)?uC(e(Array.from(t),r),t8.fromIterable,i,t):ap(new as(i,t)),pd=e=>{let{key:t,value:r}=e;return sQ([t,r],{decode:(e,t)=>pc(aA(od(oc(e,t)))),encode:(e,t)=>pc(aN(od(oc(e,t))))},{description:`HashMap<${sD(t)}, ${sD(r)}>`,pretty:pl,arbitrary:po,equivalence:pu})},pp=(e,t)=>r=>{let i=r.array(e(r));return(void 0!==t.depthIdentifier?r.oneof(t,r.constant([]),i):i).map(rP.fromIterable)},pf=e=>t=>`List(${Array.from(t).map(t=>e(t)).join(", ")})`,ph=e=>{let t=o.getEquivalence(e);return w.make((e,r)=>t(Array.from(e),Array.from(r)))},pm=e=>(t,r,i)=>rP.isList(t)?uC(e(Array.from(t),r),rP.fromIterable,i,t):ap(new as(i,t)),pg=e=>sQ([e],{decode:e=>pm(aA(od(e))),encode:e=>pm(aN(od(e)))},{description:`List<${sD(e)}>`,pretty:pf,arbitrary:pp,equivalence:ph}),py=e=>t=>`new SortedSet([${Array.from(sv.values(t)).map(t=>e(t)).join(", ")}])`,pS=(e,t)=>(r,i,n)=>sv.isSortedSet(r)?uC(e(Array.from(sv.values(r)),i),e=>sv.fromIterable(e,t),n,r):ap(new as(n,r)),pb=(e,t,r)=>sQ([e],{decode:e=>pS(aA(od(e)),t),encode:e=>pS(aN(od(e)),r)},{description:`SortedSet<${sD(e)}>`,pretty:py,arbitrary:(e,r)=>i=>{let n=i.array(e(i));return(void 0!==r.depthIdentifier?i.oneof(r,i.constant([]),n):n).map(e=>sv.fromIterable(e,t))},equivalence:()=>sv.getEquivalence()});class pv extends o6(s8,ot,{strict:!0,decode:e=>sd.isTruthy(e),encode:t5.identity}).annotations({identifier:"BooleanFromUnknown"}){}class pE extends o6(sH("true","false").annotations({description:"a string to be decoded into a boolean"}),ot,{strict:!0,decode:e=>"true"===e,encode:e=>e?"true":"false"}).annotations({identifier:"BooleanFromString"}){}let pw=Symbol.for("effect/Schema/Serializable/symbol"),pk=(0,t5.dual)(2,(e,t)=>sB(e[pw])(t)),pI=Symbol.for("effect/Schema/Serializable/symbolResult"),pT=e=>e[pI].failure,px=e=>e[pI].success,pC=(0,t3.globalValue)("effect/Schema/Serializable/exitSchemaCache",()=>new WeakMap),pR=e=>{let t=Object.getPrototypeOf(e);if(!(pI in t))return pt({failure:pT(e),success:px(e),defect:d8});let r=pC.get(t);return void 0===r&&(r=pt({failure:pT(e),success:px(e),defect:d8}),pC.set(t,r)),r},pF=(0,t5.dual)(2,(e,t)=>sU(e[pI].failure)(t)),pA=(0,t5.dual)(2,(e,t)=>sB(e[pI].failure)(t)),pO=(0,t5.dual)(2,(e,t)=>sU(e[pI].success)(t)),p_=(0,t5.dual)(2,(e,t)=>sB(e[pI].success)(t)),pM=(0,t5.dual)(2,(e,t)=>sU(pR(e))(t)),pD=(0,t5.dual)(2,(e,t)=>sB(pR(e))(t)),pN=ir(r5),pP=(e,t)=>{let r=pN(e);if(rU.isSome(r))switch(e._tag){case"Declaration":return r.value(...e.typeParameters.map(e=>pP(e,t)));case"Refinement":return r.value(pP(e.from,t));default:return r.value()}switch(e._tag){case"NeverKeyword":throw Error(ro("Unsupported schema","Cannot build an Equivalence",t,e));case"Transformation":return pP(e.to,t);case"Declaration":case"Literal":case"StringKeyword":case"TemplateLiteral":case"UniqueSymbol":case"SymbolKeyword":case"UnknownKeyword":case"AnyKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"UndefinedKeyword":case"VoidKeyword":case"Enums":case"ObjectKeyword":return E.equals;case"Refinement":return pP(e.from,t);case"Suspend":{let r=re(()=>pP(e.f(),t));return(e,t)=>r()(e,t)}case"TupleType":{let r=e.elements.map((e,r)=>pP(e.type,t.concat(r))),i=e.rest.map(e=>pP(e.type,t));return w.make((t,n)=>{if(!Array.isArray(t)||!Array.isArray(n))return!1;let a=t.length;if(a!==n.length)return!1;let s=0;for(;s<Math.min(a,e.elements.length);s++)if(!r[s](t[s],n[s]))return!1;if(o.isNonEmptyReadonlyArray(i)){let[e,...r]=i;for(;s<a-r.length;s++)if(!e(t[s],n[s]))return!1;for(let e=0;e<r.length;e++)if(s+=e,!r[e](t[s],n[s]))return!1}return!0})}case"TypeLiteral":{if(0===e.propertySignatures.length&&0===e.indexSignatures.length)return E.equals;let r=e.propertySignatures.map(e=>pP(e.type,t.concat(e.name))),i=e.indexSignatures.map(e=>pP(e.type,t));return w.make((t,n)=>{let a,s;if(!sd.isRecord(t)||!sd.isRecord(n))return!1;let o=Object.keys(t),l=Object.getOwnPropertySymbols(t);for(let i=0;i<r.length;i++){let a=e.propertySignatures[i],s=a.name,o=Object.prototype.hasOwnProperty.call(t,s),l=Object.prototype.hasOwnProperty.call(n,s);if(a.isOptional&&o!==l||o&&l&&!r[i](t[s],n[s]))return!1}for(let r=0;r<i.length;r++){let u=ij(nQ(e.indexSignatures[r].parameter));if(u){if(a=a||Object.getOwnPropertySymbols(n),l.length!==a.length)return!1}else if(s=s||Object.keys(n),o.length!==s.length)return!1;let c=u?l:o;for(let e=0;e<c.length;e++){let a=c[e];if(!Object.prototype.hasOwnProperty.call(n,a)||!i[r](t[a],n[a]))return!1}}return!0})}case"Union":{let r=aK(e.types,!0),i=Reflect.ownKeys(r.keys),n=i.length;return w.make((e,a)=>{let s=[];if(n>0&&sd.isRecordOrArray(e))for(let t=0;t<n;t++){let n=i[t],a=r.keys[n].buckets;if(Object.prototype.hasOwnProperty.call(e,n)){let t=String(e[n]);Object.prototype.hasOwnProperty.call(a,t)&&(s=s.concat(a[t]))}}r.otherwise.length>0&&(s=s.concat(r.otherwise));let o=s.map(e=>[pP(e,t),az({ast:e})]);for(let t=0;t<o.length;t++){let[r,i]=o[t];if(i(e)&&i(a)&&r(e,a))return!0}return!1})}}},pL=oz("symbol",{key:s7}).annotations({description:"an object to be decoded into a globally shared symbol"}),pU=o4(pL,s9,{strict:!0,decode:e=>ua(e.key),encode:(e,t,r)=>ay(un(e,r),e=>pL.make({key:e}))});class pz extends oi(s7,oe,pU).annotations({identifier:"PropertyKey"}){}class pW extends oL({_tag:oI(sH("Pointer","Unexpected","Missing","Composite","Refinement","Transformation","Type","Forbidden")).annotations({description:"The tag identifying the type of parse issue"}),path:oI(od(pz)).annotations({description:"The path to the property where the issue occurred"}),message:oI(s7).annotations({description:"A descriptive message explaining the issue"})}).annotations({identifier:"ArrayFormatterIssue",description:"Represents an issue returned by the ArrayFormatter formatter"}){}e.s(["Any",0,s4,"Array",0,od,"ArrayEnsure",0,function(e){return o6(oi(e,od(e)),od(sL(sM(e))),{strict:!0,decode:e=>o.ensure(e),encode:e=>1===e.length?e[0]:e})},"ArrayFormatterIssue",0,pW,"BetweenBigDecimalSchemaId",0,dS,"BetweenBigIntSchemaId",0,rF,"BetweenDateSchemaId",0,cn,"BetweenDurationSchemaId",0,uH,"BetweenSchemaId",0,rI,"BigDecimal",0,c7,"BigDecimalFromNumber",0,de,"BigDecimalFromSelf",0,c9,"BigInt",0,ug,"BigIntFromNumber",0,uT,"BigIntFromSelf",0,s6,"Boolean",0,ot,"BooleanFromString",0,pE,"BooleanFromUnknown",0,pv,"BrandSchemaId",0,sY,"Capitalize",0,lC,"Capitalized",0,lb,"CapitalizedSchemaId",0,ly,"Cause",0,e=>{let{defect:t,error:r}=e,i=sM(r),n=sM(t);return o6(dY(i,n),d2({error:sL(i),defect:sL(n)}),{strict:!1,decode:e=>d5(e),encode:e=>d3(e)})},"CauseFromSelf",0,d2,"Char",0,lk,"Chunk",0,function(e){return o6(od(e),dk(sL(sM(e))),{strict:!0,decode:e=>0===e.length?p.empty():p.fromIterable(e),encode:e=>p.toReadonlyArray(e)})},"ChunkFromSelf",0,dk,"Class",0,e=>(t,r)=>dB({kind:"Class",identifier:e,schema:dN(t),fields:dP(t),Base:m.Class,annotations:r}),"Config",0,(e,t)=>{let r=aR(t);return f.string(e).pipe(f.mapOrFail(e=>r(e).pipe(b.mapLeft(e=>h.InvalidData([],a1.formatIssueSync(e))))))},"Data",0,e=>o6(e,d_(sL(e)),{strict:!1,decode:e=>dR(e),encode:e=>Array.isArray(e)?Array.from(e):Object.assign({},e)}),"DataFromSelf",0,d_,"Date",0,cu,"DateFromNumber",0,cc,"DateFromSelf",0,cs,"DateFromSelfSchemaId",0,ca,"DateFromString",0,cl,"DateTimeUtc",0,cm,"DateTimeUtcFromDate",0,ch,"DateTimeUtcFromNumber",0,cf,"DateTimeUtcFromSelf",0,cd,"DateTimeZoned",0,cx,"DateTimeZonedFromSelf",0,cT,"Defect",0,d8,"Duration",0,uB,"DurationFromMillis",0,uM,"DurationFromNanos",0,uO,"DurationFromSelf",0,uA,"Either",0,e=>{let{left:t,right:r}=e,i=sM(r),n=sM(t);return o6(oi(cL(i),cU(n)).annotations({description:`EitherEncoded<${sD(n)}, ${sD(i)}>`}),c$({left:sL(n),right:sL(i)}),{strict:!0,decode:e=>cz(e),encode:e=>b.match(e,{onLeft:cj,onRight:cV})})},"EitherFromSelf",0,c$,"EitherFromUnion",0,e=>{let{left:t,right:r}=e,i=sM(r),n=sM(t),a=sL(i),s=sL(n),o=o6(i,cL(a),{strict:!0,decode:e=>cV(e),encode:e=>e.right}),l=o6(n,cU(s),{strict:!0,decode:e=>cj(e),encode:e=>e.left});return o6(oi(o,l),c$({left:s,right:a}),{strict:!0,decode:e=>"Left"===e._tag?b.left(e.left):b.right(e.right),encode:e=>b.match(e,{onLeft:cj,onRight:cV})})},"EndsWithSchemaId",0,lu,"Enums",0,e=>sK(e),"Exit",0,pt,"ExitFromSelf",0,pe,"FiberId",0,dK,"FiberIdFromSelf",0,dV,"Finite",0,l3,"FiniteSchemaId",0,rw,"FromPropertySignature",0,om,"GreaterThanBigDecimalSchemaId",0,dt,"GreaterThanBigIntSchemaId",0,rT,"GreaterThanDateSchemaId",0,cr,"GreaterThanDurationSchemaId",0,uj,"GreaterThanOrEqualToBigDecimalSchemaId",0,dr,"GreaterThanOrEqualToBigIntSchemaId",0,rx,"GreaterThanOrEqualToDateSchemaId",0,ci,"GreaterThanOrEqualToDurationSchemaId",0,uV,"GreaterThanOrEqualToSchemaId",0,ry,"GreaterThanSchemaId",0,rg,"HashMap",0,e=>{let{key:t,value:r}=e;return o6(od(oc(t,r)),pd({key:sL(sM(t)),value:sL(sM(r))}),{strict:!0,decode:e=>t8.fromIterable(e),encode:e=>Array.from(e)})},"HashMapFromSelf",0,pd,"HashSet",0,function(e){return o6(od(e),ps(sL(sM(e))),{strict:!0,decode:e=>t4.fromIterable(e),encode:e=>Array.from(e)})},"HashSetFromSelf",0,ps,"IncludesSchemaId",0,lc,"InstanceOfSchemaId",0,sX,"Int",0,l8,"IntSchemaId",0,rv,"ItemsCountSchemaId",0,rN,"JsonNumber",0,ur,"JsonNumberSchemaId",0,ut,"LengthSchemaId",0,r_,"LessThanBigDecimalSchemaId",0,di,"LessThanBigIntSchemaId",0,rC,"LessThanDateSchemaId",0,ce,"LessThanDurationSchemaId",0,uq,"LessThanOrEqualToBigDecimalSchemaId",0,dn,"LessThanOrEqualToBigIntSchemaId",0,rR,"LessThanOrEqualToDateSchemaId",0,ct,"LessThanOrEqualToDurationSchemaId",0,u$,"LessThanOrEqualToSchemaId",0,rb,"LessThanSchemaId",0,rS,"List",0,function(e){return o6(od(e),pg(sL(sM(e))),{strict:!0,decode:e=>rP.fromIterable(e),encode:e=>Array.from(e)})},"ListFromSelf",0,pg,"Literal",0,sH,"Lowercase",0,lT,"Lowercased",0,lf,"LowercasedSchemaId",0,ld,"Map",0,function(e){let{key:t,value:r}=e;return o6(od(oc(t,r)),cY({key:sL(sM(t)),value:sL(sM(r))}),{strict:!0,decode:e=>new Map(e),encode:e=>Array.from(e.entries())})},"MapFromRecord",0,e=>{let{key:t,value:r}=e;return o6(oW({key:sP(t),value:r}).annotations({description:"a record to be decoded into a Map"}),cY({key:t,value:sL(r)}),{strict:!0,decode:e=>new Map(Object.entries(e)),encode:e=>Object.fromEntries(e)})},"MapFromSelf",0,cY,"MaxItemsSchemaId",0,rD,"MaxLengthSchemaId",0,rO,"MinItemsSchemaId",0,rM,"MinLengthSchemaId",0,rA,"MultipleOfSchemaId",0,lH,"Negative",0,l9,"NegativeBigDecimalFromSelf",0,dh,"NegativeBigDecimalSchemaId",0,dp,"NegativeBigInt",0,uv,"NegativeBigIntFromSelf",0,ub,"Never",0,s3,"NonEmptyArray",0,op,"NonEmptyArrayEnsure",0,function(e){return o6(oi(e,op(e)),op(sL(sM(e))),{strict:!0,decode:e=>o.isNonEmptyReadonlyArray(e)?e:o.of(e),encode:e=>1===e.length?e[0]:e})},"NonEmptyChunk",0,function(e){return o6(op(e),dC(sL(sM(e))),{strict:!0,decode:e=>p.unsafeFromNonEmptyArray(e),encode:e=>p.toReadonlyArray(e)})},"NonEmptyChunkFromSelf",0,dC,"NonEmptyString",0,lD,"NonEmptyTrimmedString",0,lA,"NonNaN",0,l4,"NonNaNSchemaId",0,rE,"NonNegative",0,ue,"NonNegativeBigDecimalFromSelf",0,dd,"NonNegativeBigDecimalSchemaId",0,du,"NonNegativeBigInt",0,uI,"NonNegativeBigIntFromSelf",0,uk,"NonNegativeInt",0,u_,"NonPositive",0,l7,"NonPositiveBigDecimalFromSelf",0,dy,"NonPositiveBigDecimalSchemaId",0,dm,"NonPositiveBigInt",0,uw,"NonPositiveBigIntFromSelf",0,uE,"Not",0,ui,"Null",0,s5,"NullOr",0,on,"NullishOr",0,os,"Number",0,oe,"NumberFromString",0,l5,"Object",0,or,"Option",0,function(e){let t=sM(e);return o6(oi(cC,oL({_tag:sH("Some"),value:t}).annotations({description:`SomeEncoded<${sD(t)}>`})).annotations({description:`OptionEncoded<${sD(t)}>`}),cM(sL(t)),{strict:!0,decode:e=>cR(e),encode:e=>rU.match(e,{onNone:()=>cD,onSome:cN})})},"OptionFromNonEmptyTrimmedString",0,cP,"OptionFromNullOr",0,function(e){return o6(on(e),cM(sL(sM(e))),{strict:!0,decode:e=>rU.fromNullable(e),encode:e=>rU.getOrNull(e)})},"OptionFromNullishOr",0,function(e,t){return o6(os(e),cM(sL(sM(e))),{strict:!0,decode:e=>rU.fromNullable(e),encode:null===t?e=>rU.getOrNull(e):e=>rU.getOrUndefined(e)})},"OptionFromSelf",0,cM,"OptionFromUndefinedOr",0,function(e){return o6(oa(e),cM(sL(sM(e))),{strict:!0,decode:e=>rU.fromNullable(e),encode:e=>rU.getOrUndefined(e)})},"PatternSchemaId",0,ls,"Positive",0,l6,"PositiveBigDecimalFromSelf",0,dl,"PositiveBigDecimalSchemaId",0,da,"PositiveBigInt",0,uS,"PositiveBigIntFromSelf",0,uy,"PropertyKey",0,pz,"PropertySignatureDeclaration",0,oh,"PropertySignatureTransformation",0,oy,"PropertySignatureTypeId",0,ob,"ReadonlyMap",0,function(e){let{key:t,value:r}=e;return o6(od(oc(t,r)),cQ({key:sL(sM(t)),value:sL(sM(r))}),{strict:!0,decode:e=>new Map(e),encode:e=>Array.from(e.entries())})},"ReadonlyMapFromRecord",0,e=>{let{key:t,value:r}=e;return o6(oW({key:sP(t),value:r}).annotations({description:"a record to be decoded into a ReadonlyMap"}),cQ({key:t,value:sL(r)}),{strict:!0,decode:e=>new Map(Object.entries(e)),encode:e=>Object.fromEntries(e)})},"ReadonlyMapFromSelf",0,cQ,"ReadonlySet",0,function(e){return o6(od(e),c3(sL(sM(e))),{strict:!0,decode:e=>new Set(e),encode:e=>Array.from(e)})},"ReadonlySetFromSelf",0,c3,"Record",0,oW,"Redacted",0,function(e){return o6(e,uF(sL(sM(e))),{strict:!0,decode:e=>sm(e),encode:e=>sg(e)})},"RedactedFromSelf",0,uF,"RefineSchemaId",0,o0,"Set",0,function(e){return o6(od(e),c8(sL(sM(e))),{strict:!0,decode:e=>new Set(e),encode:e=>Array.from(e)})},"SetFromSelf",0,c8,"SortedSet",0,function(e,t){let r=sL(sM(e));return o6(od(e),pb(r,t,t),{strict:!0,decode:e=>sv.fromIterable(e,t),encode:e=>Array.from(sv.values(e))})},"SortedSetFromSelf",0,pb,"StartsWithSchemaId",0,ll,"String",0,s7,"StringFromBase64",0,u2,"StringFromBase64Url",0,u5,"StringFromHex",0,u3,"StringFromUriComponent",0,u8,"Struct",0,oL,"Symbol",0,us,"SymbolFromSelf",0,s9,"TaggedClass",0,e=>(t,r,i)=>{let n=dP(r),a=dN(r),s={_tag:dL(t)},o=dU(s,n);return class extends dB({kind:"TaggedClass",identifier:e??t,schema:oQ(a,oL(s)),fields:o,Base:m.Class,annotations:i}){static _tag=t}},"TaggedError",0,e=>(t,r,i)=>{class n extends m.Error{}n.prototype.name=t;let a=dP(r),s=dN(r),o={_tag:dL(t)},l=dU(o,a),u="message"in l;class c extends dB({kind:"TaggedError",identifier:e??t,schema:oQ(s,oL(o)),fields:l,Base:n,annotations:i,disableToString:!0}){static _tag=t}return u||Object.defineProperty(c.prototype,"message",{get(){return`{ ${Reflect.ownKeys(a).map(e=>`${rn(e)}: ${ri(this[e])}`).join(", ")} }`},enumerable:!1,configurable:!0}),c},"TaggedRequest",0,e=>(t,r,i)=>{let n=dU({_tag:dL(t)},r.payload);return class extends dB({kind:"TaggedRequest",identifier:e??t,schema:oL(n),fields:n,Base:sb.Class,annotations:i}){static _tag=t;static success=r.success;static failure=r.failure;get[pw](){return this.constructor}get[pI](){return{failure:r.failure,success:r.success}}}},"TaggedStruct",0,oz,"TemplateLiteral",0,sJ,"TemplateLiteralParser",0,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let i=[],n=[],a=[],s=!1;for(let e=0;e<t.length;e++){let r=t[e],o=sV(r)?r:sH(r);a.push(o);let l=sN(o);i.push(l);let u=function e(t,r){let i=t.ast;switch(i._tag){case"Literal":{let e=i.literal;if(!sd.isString(e)){let t=String(e);return o6(sH(t),r,{strict:!0,decode:()=>e,encode:()=>t})}break}case"NumberKeyword":return oY(l5,r);case"Union":{let t=[],n=!1;for(let r of i.types){let i=sT(r),a=e(sN(i),i);a&&(n=!0),t.push(a??i)}return n?oY(oi(...t),r):r}}}(l,o);u?(n.push(u),s=!0):n.push(o)}let o=sJ(...i),l=nR(o.ast),u=oc(...n);return s&&(u=u.annotations({[rZ]:sD(oc(...a))})),class extends o4(o,u,{strict:!1,decode:(e,r,i)=>{let n=l.exec(e);return n?ad(n.slice(1,t.length+1)):ap(new as(i,e,`${l.source}: no match for ${JSON.stringify(e)}`))},encode:e=>ad(e.join(""))}){static params=t.slice()}},"TimeZone",0,ck,"TimeZoneFromSelf",0,cw,"TimeZoneNamed",0,cE,"TimeZoneNamedFromSelf",0,cv,"TimeZoneOffset",0,cS,"TimeZoneOffsetFromSelf",0,cy,"ToPropertySignature",0,og,"Trim",0,lO,"Trimmed",0,lF,"TrimmedSchemaId",0,lr,"Tuple",0,oc,"TypeId",0,sI,"ULID",0,lW,"ULIDSchemaId",0,lU,"URL",0,lq,"URLFromSelf",0,lB,"UUID",0,lL,"UUIDSchemaId",0,lN,"Uint8",0,uJ,"Uint8Array",0,uZ,"Uint8ArrayFromBase64",0,uY,"Uint8ArrayFromBase64Url",0,uX,"Uint8ArrayFromHex",0,u0,"Uint8ArrayFromSelf",0,uK,"Uncapitalize",0,lR,"Uncapitalized",0,lw,"UncapitalizedSchemaId",0,lv,"Undefined",0,s1,"UndefinedOr",0,oa,"Union",0,oi,"UniqueSymbolFromSelf",0,sG,"Unknown",0,s8,"Uppercase",0,lx,"Uppercased",0,lg,"UppercasedSchemaId",0,lh,"ValidDateFromSelf",0,co,"ValidDateSchemaId",0,u9,"Void",0,s2,"annotations",0,le,"asSchema",0,sM,"asSerializable",0,e=>e,"asSerializableWithResult",0,e=>e,"asWithResult",0,e=>e,"attachPropertySignature",0,o7,"between",0,lZ,"betweenBigDecimal",0,db,"betweenBigInt",0,ud,"betweenDate",0,(e,t,r)=>i=>i.pipe(o5(r=>r<=t&&r>=e,{schemaId:cn,[cn]:{max:t,min:e},title:`betweenDate(${rt(e)}, ${rt(t)})`,description:`a date between ${rt(e)} and ${rt(t)}`,...r})),"betweenDuration",0,uG,"brand",0,(e,t)=>r=>{let i=rU.match(ii(r.ast),{onNone:()=>[e],onSome:t=>[...t,e]}),n=nw(r.ast,sO({[rj]:i,...t}));return o$(r,n)},"capitalized",0,lS,"clamp",0,(e,t)=>r=>o6(r,sL(r).pipe(lZ(e,t)),{strict:!1,decode:r=>rL.clamp(r,{minimum:e,maximum:t}),encode:t5.identity}),"clampBigDecimal",0,(e,t)=>r=>o6(r,r.pipe(sL,db(e,t)),{strict:!1,decode:r=>l.clamp(r,{minimum:e,maximum:t}),encode:t5.identity}),"clampBigInt",0,(e,t)=>r=>o6(r,r.pipe(sL,ud(e,t)),{strict:!1,decode:r=>u.clamp(r,{minimum:e,maximum:t}),encode:t5.identity}),"clampDuration",0,(e,t)=>r=>o6(r,r.pipe(sL,uG(e,t)),{strict:!1,decode:r=>y.clamp(r,{minimum:e,maximum:t}),encode:t5.identity}),"compose",0,oY,"declare",0,sQ,"decode",0,sB,"decodeEither",0,sq,"decodePromise",0,s$,"decodeUnknown",0,sB,"decodeUnknownEither",0,sq,"decodeUnknownPromise",0,s$,"deserialize",0,pk,"deserializeExit",0,pD,"deserializeFailure",0,pA,"deserializeSuccess",0,p_,"element",0,oo,"encode",0,sU,"encodeEither",0,sz,"encodePromise",0,sW,"encodeUnknown",0,sU,"encodeUnknownEither",0,sz,"encodeUnknownPromise",0,sW,"encodedBoundSchema",0,sP,"encodedSchema",0,sN,"endsWith",0,(e,t)=>r=>{let i=JSON.stringify(e);return r.pipe(o5(t=>t.endsWith(e),{schemaId:lu,[lu]:{endsWith:e},title:`endsWith(${i})`,description:`a string ending with ${i}`,jsonSchema:{pattern:`^.*${e}$`},...t}))},"equivalence",0,e=>pP(e.ast,[]),"exitSchema",0,pR,"extend",0,oQ,"failureSchema",0,pT,"filter",0,o5,"filterEffect",0,o3,"finite",0,l$,"format",0,sD,"fromBrand",0,(e,t)=>r=>o$(r,new nd(r.ast,function(t,r,i){let n=e.either(t);return b.isLeft(n)?rU.some(new as(i,t,n.left.map(e=>e.message).join(", "))):rU.none()},sO({schemaId:sY,[sY]:{constructor:e},...t}))),"fromKey",0,oA,"getClassTag",0,dL,"getNumberIndexedAccess",0,u4,"greaterThan",0,lj,"greaterThanBigDecimal",0,(e,t)=>r=>{let i=l.format(e);return r.pipe(o5(t=>l.greaterThan(t,e),{schemaId:dt,[dt]:{min:e},title:`greaterThanBigDecimal(${i})`,description:`a BigDecimal greater than ${i}`,...t}))},"greaterThanBigInt",0,uo,"greaterThanDate",0,(e,t)=>r=>r.pipe(o5(t=>t>e,{schemaId:cr,[cr]:{min:e},title:`greaterThanDate(${rt(e)})`,description:`a date after ${rt(e)}`,...t})),"greaterThanDuration",0,(e,t)=>r=>r.pipe(o5(t=>y.greaterThan(t,e),{schemaId:uj,[uj]:{min:e},title:`greaterThanDuration(${e})`,description:`a Duration greater than ${y.decode(e)}`,...t})),"greaterThanOrEqualTo",0,lV,"greaterThanOrEqualToBigDecimal",0,(e,t)=>r=>{let i=l.format(e);return r.pipe(o5(t=>l.greaterThanOrEqualTo(t,e),{schemaId:dr,[dr]:{min:e},title:`greaterThanOrEqualToBigDecimal(${i})`,description:`a BigDecimal greater than or equal to ${i}`,...t}))},"greaterThanOrEqualToBigInt",0,ul,"greaterThanOrEqualToDate",0,(e,t)=>r=>r.pipe(o5(t=>t>=e,{schemaId:ci,[ci]:{min:e},title:`greaterThanOrEqualToDate(${rt(e)})`,description:`a date after or equal to ${rt(e)}`,...t})),"greaterThanOrEqualToDuration",0,(e,t)=>r=>r.pipe(o5(t=>y.greaterThanOrEqualTo(t,e),{schemaId:uV,[uV]:{min:e},title:`greaterThanOrEqualToDuration(${e})`,description:`a Duration greater than or equal to ${y.decode(e)}`,...t})),"head",0,function(e){return o6(e,cM(u4(sL(e))),{strict:!1,decode:e=>o.head(e),encode:e=>rU.match(e,{onNone:()=>[],onSome:o.of})})},"headNonEmpty",0,function(e){return o6(e,u4(sL(e)),{strict:!1,decode:e=>o.headNonEmpty(e),encode:e=>o.of(e)})},"headOrElse",0,u6,"includes",0,(e,t)=>r=>{let i=JSON.stringify(e);return r.pipe(o5(t=>t.includes(e),{schemaId:lc,[lc]:{includes:e},title:`includes(${i})`,description:`a string including ${i}`,jsonSchema:{pattern:`.*${e}.*`},...t}))},"instanceOf",0,s0,"int",0,lG,"isPropertySignature",0,ov,"isSchema",0,sV,"itemsCount",0,(e,t)=>r=>{let i=Math.floor(e);if(i<0)throw Error(ro("Invalid Argument",`Expected an integer greater than or equal to 0, actual ${e}`));return r.pipe(o5(e=>e.length===i,{schemaId:rN,title:`itemsCount(${i})`,description:`an array of exactly ${i} item(s)`,jsonSchema:{minItems:i,maxItems:i},[it]:!0,...t}))},"keyof",0,e=>sT(nk(e.ast)),"length",0,la,"lessThan",0,lK,"lessThanBigDecimal",0,(e,t)=>r=>{let i=l.format(e);return r.pipe(o5(t=>l.lessThan(t,e),{schemaId:di,[di]:{max:e},title:`lessThanBigDecimal(${i})`,description:`a BigDecimal less than ${i}`,...t}))},"lessThanBigInt",0,uu,"lessThanDate",0,(e,t)=>r=>r.pipe(o5(t=>t<e,{schemaId:ce,[ce]:{max:e},title:`lessThanDate(${rt(e)})`,description:`a date before ${rt(e)}`,...t})),"lessThanDuration",0,(e,t)=>r=>r.pipe(o5(t=>y.lessThan(t,e),{schemaId:uq,[uq]:{max:e},title:`lessThanDuration(${e})`,description:`a Duration less than ${y.decode(e)}`,...t})),"lessThanOrEqualTo",0,lJ,"lessThanOrEqualToBigDecimal",0,(e,t)=>r=>{let i=l.format(e);return r.pipe(o5(t=>l.lessThanOrEqualTo(t,e),{schemaId:dn,[dn]:{max:e},title:`lessThanOrEqualToBigDecimal(${i})`,description:`a BigDecimal less than or equal to ${i}`,...t}))},"lessThanOrEqualToBigInt",0,uc,"lessThanOrEqualToDate",0,(e,t)=>r=>r.pipe(o5(t=>t<=e,{schemaId:ct,[ct]:{max:e},title:`lessThanOrEqualToDate(${rt(e)})`,description:`a date before or equal to ${rt(e)}`,...t})),"lessThanOrEqualToDuration",0,(e,t)=>r=>r.pipe(o5(t=>y.lessThanOrEqualTo(t,e),{schemaId:uq,[uq]:{max:e},title:`lessThanOrEqualToDuration(${e})`,description:`a Duration less than or equal to ${y.decode(e)}`,...t})),"lowercased",0,lp,"make",0,sT,"makePropertySignature",0,ow,"maxItems",0,(e,t)=>r=>{let i=Math.floor(e);if(i<1)throw Error(ro("Invalid Argument",`Expected an integer greater than or equal to 1, actual ${e}`));return r.pipe(o5(e=>e.length<=i,{schemaId:rD,title:`maxItems(${i})`,description:`an array of at most ${i} item(s)`,jsonSchema:{maxItems:i},[it]:!0,...t}))},"maxLength",0,(e,t)=>r=>r.pipe(o5(t=>t.length<=e,{schemaId:rO,title:`maxLength(${e})`,description:`a string at most ${e} character(s) long`,jsonSchema:{maxLength:e},...t})),"minItems",0,(e,t)=>r=>{let i=Math.floor(e);if(i<1)throw Error(ro("Invalid Argument",`Expected an integer greater than or equal to 1, actual ${e}`));return r.pipe(o5(e=>e.length>=i,{schemaId:rM,title:`minItems(${i})`,description:`an array of at least ${i} item(s)`,jsonSchema:{minItems:i},[it]:!0,...t}))},"minLength",0,ln,"multipleOf",0,(e,t)=>r=>{let i=Math.abs(e);return r.pipe(o5(t=>0===rL.remainder(t,e),{schemaId:lH,title:`multipleOf(${i})`,description:`a number divisible by ${i}`,jsonSchema:{multipleOf:i},...t}))},"mutable",0,e=>sT(nW(e.ast)),"negative",0,lX,"negativeBigDecimal",0,df,"negativeBigInt",0,uf,"nonEmptyString",0,lI,"nonNaN",0,lQ,"nonNegative",0,l1,"nonNegativeBigDecimal",0,dc,"nonNegativeBigInt",0,uh,"nonPositive",0,l0,"nonPositiveBigDecimal",0,dg,"nonPositiveBigInt",0,um,"omit",0,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>sT(nP(e.ast,t))},"optional",0,e=>new ok(new oh(e.ast===iA||e.ast===i_?iA:oa(e).ast,!0,!0,{},void 0),e),"optionalElement",0,e=>new ol(new i1(e.ast,!0),e),"optionalToOptional",0,o_,"optionalToRequired",0,oO,"optionalWith",0,oM,"parseJson",0,lM,"parseNumber",0,l2,"partial",0,e=>sT(nU(e.ast)),"partialWith",0,oj,"pattern",0,lo,"pick",0,oB,"pickLiteral",0,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>sH(...t)},"pluck",0,oq,"positive",0,lY,"positiveBigDecimal",0,ds,"positiveBigInt",0,up,"propertySignature",0,oI,"rename",0,lt,"required",0,e=>sT(nz(e.ast)),"requiredToOptional",0,(e,t,r)=>ow(new oy(new om(e.ast,!1,!0,{},void 0),new og(t.ast,!0,!0,{},void 0),rU.flatMap(r.decode),e=>rU.some(r.encode(e)))),"serializableSchema",0,e=>e[pw],"serialize",0,e=>sU(e[pw])(e),"serializeExit",0,pM,"serializeFailure",0,pF,"serializeSuccess",0,pO,"split",0,e=>o6(s7.annotations({description:"a string that will be split"}),od(s7),{strict:!0,decode:t=>t.split(e),encode:t=>t.join(e)}),"standardSchemaV1",0,(e,t)=>{let r=aA(e,{errors:"all"});return class extends sT(e.ast){static "~standard"={version:1,vendor:"effect",validate(e){let i=new rB.SyncScheduler,n=S.runFork(S.matchEffect(r(e,t),{onFailure:sF,onSuccess:e=>S.succeed({value:e})}),{scheduler:i});i.flush();let a=n.unsafePoll();return a?sC(a):new Promise(e=>{n.addObserver(t=>{e(sC(t))})})}}}},"startsWith",0,(e,t)=>r=>{let i=JSON.stringify(e);return r.pipe(o5(t=>t.startsWith(e),{schemaId:ll,[ll]:{startsWith:e},title:`startsWith(${i})`,description:`a string starting with ${i}`,jsonSchema:{pattern:`^${e}`},...t}))},"successSchema",0,px,"suspend",0,oX,"symbolSerializable",0,pw,"symbolWithResult",0,pI,"tag",0,oU,"transform",0,o6,"transformLiteral",0,o9,"transformLiterals",0,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return oi(...t.map(e=>{let[t,r]=e;return o9(t,r)}))},"transformOrFail",0,o4,"trimmed",0,li,"typeSchema",0,sL,"uncapitalized",0,lE,"uppercased",0,lm,"validDate",0,u7,"validate",0,sj,"validateEither",0,(e,t)=>{let r=aL(e,t);return(e,t)=>b.mapLeft(r(e,t),ac)},"validatePromise",0,(e,t)=>{let r=sj(e,t);return(e,t)=>S.runPromise(r(e,t))},"withConstructorDefault",0,oT,"withDecodingDefault",0,oR,"withDefaults",0,oF],9973079)},8643033,e=>{"use strict";var t=e.i(5305881);e.i(4935619);var r=e.i(9973079);let i=Symbol.for("@effect/platform/Error"),n=r.Literal("Clipboard","Command","FileSystem","KeyValueStore","Path","Stream","Terminal");class a extends r.TaggedError("@effect/platform/Error/BadArgument")("BadArgument",{module:n,method:r.String,description:r.optional(r.String),cause:r.optional(r.Defect)}){[i]=i;get message(){return`${this.module}.${this.method}${this.description?`: ${this.description}`:""}`}}let s=r.Literal("AlreadyExists","BadResource","Busy","InvalidData","NotFound","PermissionDenied","TimedOut","UnexpectedEof","Unknown","WouldBlock","WriteZero");class o extends r.TaggedError("@effect/platform/Error/SystemError")("SystemError",{reason:s,module:n,method:r.String,description:r.optional(r.String),syscall:r.optional(r.String),pathOrDescriptor:r.optional(r.Union(r.String,r.Number)),cause:r.optional(r.Defect)}){[i]=i;get message(){return`${this.reason}: ${this.module}.${this.method}${void 0!==this.pathOrDescriptor?` (${this.pathOrDescriptor})`:""}${this.description?`: ${this.description}`:""}`}}e.s(["BadArgument",0,a,"SystemError",0,o,"TypeIdError",0,(e,r)=>{class i extends t.Error{_tag=r}return i.prototype[e]=e,i.prototype.name=r,i}])},7037981,e=>{"use strict";var t=e.i(5283034),r=e.i(1331084),i=e.i(3683485),n=e.i(8815901);let a=Symbol.for("effect/Brand"),s=Symbol.for("effect/Brand/Refined"),o=i.unsafeCoerce;e.s(["BrandTypeId",0,a,"RefinedConstructorsTypeId",0,s,"all",0,function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];let o=e=>{let i=r.right(e);for(let n of t){let t=n.either(e);i=r.isLeft(i)&&r.isLeft(t)?r.left([...i.left,...t.left]):r.isLeft(i)?i:t}return i};return Object.assign(e=>r.match(o(e),{onLeft:e=>{throw e},onRight:i.identity}),{[s]:s,option:e=>n.getRight(o(e)),either:o,is:e=>r.isRight(o(e))})},"error",0,(e,t)=>[{message:e,meta:t}],"errors",0,function(){for(var e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return t.flatten(r)},"nominal",0,()=>Object.assign(e=>e,{[s]:s,option:e=>n.some(e),either:e=>r.right(e),is:e=>!0}),"refined",0,function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];let o=2===t.length?e=>t[0](e)?r.right(e):r.left(t[1](e)):e=>n.match(t[0](e),{onNone:()=>r.right(e),onSome:r.left});return Object.assign(e=>r.getOrThrowWith(o(e),i.identity),{[s]:s,option:e=>n.getRight(o(e)),either:o,is:e=>r.isRight(o(e))})},"unbranded",0,o])},4426485,7358204,e=>{"use strict";e.i(7037981);var t=e.i(5972454);e.i(5305881);var r=e.i(6091153),i=e.i(8884753),n=e.i(7365553),a=e.i(469137);i.ChannelTypeId,r.ChannelExceptionTypeId,i.isChannel;let s=r.acquireUseRelease;i.acquireReleaseOut,r.as,r.asVoid,r.buffer,r.bufferChunk,r.catchAll,i.catchAllCause,i.concatAll,i.concatAllWith,r.concatMap,i.concatMapWith,i.concatMapWithCustom,r.collect,r.concatOut,r.mapInput,r.mapInputEffect,r.mapInputError,r.mapInputErrorEffect,r.mapInputIn,r.mapInputInEffect,r.doneCollect,r.drain;let o=i.embedInput;r.emitCollect,r.ensuring,i.ensuringWith,r.context,r.contextWith,r.contextWithChannel,r.contextWithEffect,i.fail,i.failSync,i.failCause,i.failCauseSync;let l=i.flatMap;r.flatten,r.foldChannel,i.foldCauseChannel,i.fromEffect,r.fromEither,r.fromInput,r.fromPubSub,r.fromPubSubScoped,r.fromOption,r.fromQueue,r.identityChannel,r.interruptWhen,r.interruptWhenDeferred,r.map,r.mapEffect,r.mapError,r.mapErrorCause,r.mapOut,r.mapOutEffect,r.mapOutEffectPar,r.mergeAll,r.mergeAllUnbounded,r.mergeAllUnboundedWith,r.mergeAllWith,r.mergeMap,r.mergeOut,r.mergeOutWith,r.mergeWith,r.never,r.orDie,r.orDieWith,r.orElse;let u=i.pipeTo;r.pipeToOrFail,i.provideContext,r.provideLayer,r.mapInputContext,r.provideSomeLayer,r.provideService,r.read,i.readOrFail,i.readWith;let c=i.readWithCause;r.repeated,r.run,r.runCollect;let d=r.runDrain;r.runScoped,r.scoped,r.scopedWith,r.splitLines,i.succeed;let p=i.suspend,f=i.sync;r.toPubSub;let h=r.toPull;r.toPullIn,r.toQueue,n.channelToSink,a.channelToStream;let m=i.void,g=r.unwrap,y=r.unwrapScoped;r.unwrapScopedWith,r.updateService,r.withSpan;let S=i.write;r.writeAll,r.writeChunk,r.zip,r.zipLeft,r.zipRight,r.ChannelException,r.isChannelException,e.s(["acquireUseRelease",0,s,"embedInput",0,o,"flatMap",0,l,"pipeTo",0,u,"readWithCause",0,c,"runDrain",0,d,"suspend",0,p,"sync",0,f,"toPull",0,h,"unwrap",0,g,"unwrapScoped",0,y,"void",0,m,"write",0,S],7358204),e.i(7862555),e.i(3322401),e.i(3683485),e.i(9227260),e.i(8815901),n.SinkTypeId,n.as,n.collectAll,n.collectAllN,n.collectAllFrom,n.collectAllToMap,n.collectAllToMapN,n.collectAllToSet,n.collectAllToSetN,n.collectAllUntil,n.collectAllUntilEffect,n.collectAllWhile,n.collectAllWhileEffect,n.collectAllWhileWith,n.collectLeftover,n.mapInput,n.mapInputEffect,n.mapInputChunks,n.mapInputChunksEffect,n.count,n.die,n.dieMessage,n.dieSync,n.dimap,n.dimapEffect,n.dimapChunks,n.dimapChunksEffect,n.drain,n.drop,n.dropUntil,n.dropUntilEffect,n.dropWhile,n.dropWhileEffect,n.ensuring,n.ensuringWith,n.context,n.contextWith,n.contextWithEffect,n.contextWithSink,n.every,n.fail,n.failSync,n.failCause,n.failCauseSync,n.filterInput,n.filterInputEffect,n.findEffect,n.fold,n.foldSink,n.foldChunks,n.foldChunksEffect,n.foldEffect,n.foldLeft,n.foldLeftChunks,n.foldLeftChunksEffect,n.foldLeftEffect,n.foldUntil,n.foldUntilEffect,n.foldWeighted,n.foldWeightedDecompose,n.foldWeightedDecomposeEffect,n.foldWeightedEffect,n.forEach,n.forEachChunk,n.forEachChunkWhile,n.forEachWhile,n.flatMap,n.fromChannel,n.toChannel,n.fromEffect,n.fromPubSub,n.fromPush,n.fromQueue,n.head,n.ignoreLeftover,n.last,n.leftover,n.map,n.mapEffect,n.mapError,n.mapLeftover,n.mkString,n.never,n.orElse,n.provideContext,n.race,n.raceBoth,n.raceWith,n.refineOrDie,n.refineOrDieWith,n.some,n.splitWhere,n.succeed,n.sum,n.summarized,n.suspend,n.sync,n.take,n.timed,n.unwrap,n.unwrapScoped,n.unwrapScopedWith,n.withDuration,n.zip,n.zipLeft,n.zipRight,n.zipWith,e.i(8554418),e.i(8643033);let b=(0,t.GenericTag)("@effect/platform/FileSystem");e.s(["FileSystem",0,b,"Size",0,e=>"bigint"==typeof e?e:BigInt(e)],4426485)},4584424,1011081,4721362,e=>{"use strict";var t=e.i(5972454),r=e.i(3322401),i=e.i(1331084),n=e.i(8477203),a=e.i(3683485),s=e.i(9227260),o=e.i(8815901),l=e.i(9973079),u=e.i(8643033),c=e.i(4426485);let d=Symbol.for("@effect/platform/Path"),p=(0,t.GenericTag)("@effect/platform/Path");function f(e,t){let r,i="",n=0,a=-1,s=0;for(let o=0;o<=e.length;++o){if(o<e.length)r=e.charCodeAt(o);else if(47===r)break;else r=47;if(47===r){if(a===o-1||1===s);else if(a!==o-1&&2===s){if(i.length<2||2!==n||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2)){if(i.length>2){let e=i.lastIndexOf("/");if(e!==i.length-1){-1===e?(i="",n=0):n=(i=i.slice(0,e)).length-1-i.lastIndexOf("/"),a=o,s=0;continue}}else if(2===i.length||1===i.length){i="",n=0,a=o,s=0;continue}}t&&(i.length>0?i+="/..":i="..",n=2)}else i.length>0?i+="/"+e.slice(a+1,o):i=e.slice(a+1,o),n=o-a-1;a=o,s=0}else 46===r&&-1!==s?++s:s=-1}return i}let h=function(){let e,t="",r=!1;for(let i=arguments.length-1;i>=-1&&!r;i--){let n;if(i>=0)n=arguments[i];else{let t=globalThis.process;void 0===e&&"process"in globalThis&&"object"==typeof t&&null!==t&&"function"==typeof t.cwd&&(e=t.cwd()),n=e}0!==n.length&&(t=n+"/"+t,r=47===n.charCodeAt(0))}if(t=f(t,!r),r)if(t.length>0)return"/"+t;else return"/";return t.length>0?t:"."},m=/%/g,g=/\\/g,y=/\n/g,S=/\r/g,b=/\t/g,v=p.of({[d]:d,resolve:h,normalize(e){if(0===e.length)return".";let t=47===e.charCodeAt(0),r=47===e.charCodeAt(e.length-1);return(0!==(e=f(e,!t)).length||t||(e="."),e.length>0&&r&&(e+="/"),t)?"/"+e:e},isAbsolute:e=>e.length>0&&47===e.charCodeAt(0),join(){let e;if(0==arguments.length)return".";for(let t=0;t<arguments.length;++t){let r=arguments[t];r.length>0&&(void 0===e?e=r:e+="/"+r)}return void 0===e?".":v.normalize(e)},relative(e,t){if(e===t||(e=v.resolve(e),t=v.resolve(t),e===t))return"";let r=1;for(;r<e.length&&47===e.charCodeAt(r);++r);let i=e.length,n=i-r,a=1;for(;a<t.length&&47===t.charCodeAt(a);++a);let s=t.length-a,o=n<s?n:s,l=-1,u=0;for(;u<=o;++u){if(u===o){if(s>o){if(47===t.charCodeAt(a+u))return t.slice(a+u+1);else if(0===u)return t.slice(a+u)}else n>o&&(47===e.charCodeAt(r+u)?l=u:0===u&&(l=0));break}let i=e.charCodeAt(r+u);if(i!==t.charCodeAt(a+u))break;47===i&&(l=u)}let c="";for(u=r+l+1;u<=i;++u)(u===i||47===e.charCodeAt(u))&&(0===c.length?c+="..":c+="/..");return c.length>0?c+t.slice(a+l):(a+=l,47===t.charCodeAt(a)&&++a,t.slice(a))},dirname(e){if(0===e.length)return".";let t=e.charCodeAt(0),r=47===t,i=-1,n=!0;for(let r=e.length-1;r>=1;--r)if(47===(t=e.charCodeAt(r))){if(!n){i=r;break}}else n=!1;return -1===i?r?"/":".":r&&1===i?"//":e.slice(0,i)},basename(e,t){let r,i=0,n=-1,a=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";let s=t.length-1,o=-1;for(r=e.length-1;r>=0;--r){let l=e.charCodeAt(r);if(47===l){if(!a){i=r+1;break}}else -1===o&&(a=!1,o=r+1),s>=0&&(l===t.charCodeAt(s)?-1==--s&&(n=r):(s=-1,n=o))}return i===n?n=o:-1===n&&(n=e.length),e.slice(i,n)}for(r=e.length-1;r>=0;--r)if(47===e.charCodeAt(r)){if(!a){i=r+1;break}}else -1===n&&(a=!1,n=r+1);return -1===n?"":e.slice(i,n)},extname(e){let t=-1,r=0,i=-1,n=!0,a=0;for(let s=e.length-1;s>=0;--s){let o=e.charCodeAt(s);if(47===o){if(!n){r=s+1;break}continue}-1===i&&(n=!1,i=s+1),46===o?-1===t?t=s:1!==a&&(a=1):-1!==t&&(a=-1)}return -1===t||-1===i||0===a||1===a&&t===i-1&&t===r+1?"":e.slice(t,i)},format:function(e){let t,r;if(null===e||"object"!=typeof e)throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return t=e.dir||e.root,r=e.base||(e.name||"")+(e.ext||""),t?t===e.root?t+r:t+"/"+r:r},parse(e){let t,r={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return r;let i=e.charCodeAt(0),n=47===i;n?(r.root="/",t=1):t=0;let a=-1,s=0,o=-1,l=!0,u=e.length-1,c=0;for(;u>=t;--u){if(47===(i=e.charCodeAt(u))){if(!l){s=u+1;break}continue}-1===o&&(l=!1,o=u+1),46===i?-1===a?a=u:1!==c&&(c=1):-1!==a&&(c=-1)}return -1===a||-1===o||0===c||1===c&&a===o-1&&a===s+1?-1!==o&&(0===s&&n?r.base=r.name=e.slice(1,o):r.base=r.name=e.slice(s,o)):(0===s&&n?(r.name=e.slice(1,a),r.base=e.slice(1,o)):(r.name=e.slice(s,a),r.base=e.slice(s,o)),r.ext=e.slice(a,o)),s>0?r.dir=e.slice(0,s-1):n&&(r.dir="/"),r},sep:"/",fromFileUrl:function(e){if("file:"!==e.protocol)return r.fail(new u.BadArgument({module:"Path",method:"fromFileUrl",description:"URL must be of scheme file"}));if(""!==e.hostname)return r.fail(new u.BadArgument({module:"Path",method:"fromFileUrl",description:"Invalid file URL host"}));let t=e.pathname;for(let e=0;e<t.length;e++)if("%"===t[e]){let i=32|t.codePointAt(e+2);if("2"===t[e+1]&&102===i)return r.fail(new u.BadArgument({module:"Path",method:"fromFileUrl",description:"must not include encoded / characters"}))}return r.succeed(decodeURIComponent(t))},toFileUrl:function(e){var t;let i=new URL("file://"),n=h(e);return 47===e.charCodeAt(e.length-1)&&"/"!==n[n.length-1]&&(n+="/"),(t=n).includes("%")&&(t=t.replace(m,"%25")),t.includes("\\")&&(t=t.replace(g,"%5C")),t.includes("\n")&&(t=t.replace(y,"%0A")),t.includes("\r")&&(t=t.replace(S,"%0D")),t.includes("	")&&(t=t.replace(b,"%09")),i.pathname=t,r.succeed(i)},toNamespacedPath:a.identity}),E=Symbol.for("@effect/platform/KeyValueStore"),w=t.GenericTag("@effect/platform/KeyValueStore"),k=e=>w.of({[E]:E,has:t=>r.map(e.get(t),o.isSome),isEmpty:r.map(e.size,e=>0===e),modify:(t,i)=>r.flatMap(e.get(t),n=>{if(o.isNone(n))return r.succeedNone;let a=i(n.value);return r.as(e.set(t,a),o.some(a))}),modifyUint8Array:(t,i)=>r.flatMap(e.getUint8Array(t),n=>{if(o.isNone(n))return r.succeedNone;let a=i(n.value);return r.as(e.set(t,a),o.some(a))}),forSchema(e){return C(this,e)},...e}),I=e=>{let t=new TextEncoder;return k({...e,getUint8Array:s=>e.get(s).pipe(r.map(o.map(e=>i.match(n.decodeBase64(e),{onLeft:()=>t.encode(e),onRight:a.identity})))),set:(t,i)=>"string"==typeof i?e.set(t,i):r.suspend(()=>e.set(t,n.encodeBase64(i)))})},T=(0,a.dual)(2,(e,t)=>({...e,get:r=>e.get(`${t}${r}`),set:(r,i)=>e.set(`${t}${r}`,i),remove:r=>e.remove(`${t}${r}`),has:r=>e.has(`${t}${r}`),modify:(r,i)=>e.modify(`${t}${r}`,i)})),x=Symbol.for("@effect/platform/KeyValueStore/SchemaStore"),C=(e,t)=>{let i=l.parseJson(t),n=l.decodeUnknown(i),a=l.encode(i),s=t=>r.flatMap(e.get(t),o.match({onNone:()=>r.succeedNone,onSome:e=>r.asSome(n(e))})),u=(t,i)=>r.flatMap(a(i),r=>e.set(t,r));return{[x]:x,get:s,set:u,modify:(e,t)=>r.flatMap(s(e),i=>{if(o.isNone(i))return r.succeedNone;let n=t(i.value);return r.as(u(e,n),o.some(n))}),remove:e.remove,clear:e.clear,size:e.size,has:e.has,isEmpty:e.isEmpty}},R=s.sync(w,()=>{let e=new Map,t=new TextEncoder;return k({get:t=>r.sync(()=>o.fromNullable(e.get(t)).pipe(o.map(e=>"string"==typeof e?e:n.encodeBase64(e)))),getUint8Array:i=>r.sync(()=>o.fromNullable(e.get(i)).pipe(o.map(e=>"string"==typeof e?t.encode(e):e))),set:(t,i)=>r.sync(()=>e.set(t,i)),remove:t=>r.sync(()=>e.delete(t)),clear:r.sync(()=>e.clear()),size:r.sync(()=>e.size)})}),F=e=>new u.SystemError({reason:"PermissionDenied",module:"KeyValueStore",...e});e.s(["KeyValueStore",0,w,"SchemaStoreTypeId",0,x,"TypeId",0,E,"layerFileSystem",0,e=>s.effect(w,r.gen(function*(){let t=yield*c.FileSystem,i=yield*p,n=t=>i.join(e,encodeURIComponent(t));return(yield*t.exists(e))||(yield*t.makeDirectory(e,{recursive:!0})),k({get:e=>(0,a.pipe)(r.map(t.readFileString(n(e)),o.some),r.catchTag("SystemError",e=>"NotFound"===e.reason?r.succeed(o.none()):r.fail(e))),getUint8Array:e=>(0,a.pipe)(r.map(t.readFile(n(e)),o.some),r.catchTag("SystemError",e=>"NotFound"===e.reason?r.succeed(o.none()):r.fail(e))),set:(e,r)=>"string"==typeof r?t.writeFileString(n(e),r):t.writeFile(n(e),r),remove:e=>t.remove(n(e)),has:e=>t.exists(n(e)),clear:r.zipRight(t.remove(e,{recursive:!0}),t.makeDirectory(e,{recursive:!0})),size:r.map(t.readDirectory(e),e=>e.length)})})),"layerMemory",0,R,"layerSchema",0,(e,i)=>{let n=t.GenericTag(i),a=s.effect(n,r.map(w,t=>t.forSchema(e)));return{tag:n,layer:a}},"layerStorage",0,e=>s.sync(w,()=>{let t=e();return I({get:e=>r.try({try:()=>o.fromNullable(t.getItem(e)),catch:()=>F({pathOrDescriptor:e,method:"get",description:`Unable to get item with key ${e}`})}),set:(e,i)=>r.try({try:()=>t.setItem(e,i),catch:()=>F({pathOrDescriptor:e,method:"set",description:`Unable to set item with key ${e}`})}),remove:e=>r.try({try:()=>t.removeItem(e),catch:()=>F({pathOrDescriptor:e,method:"remove",description:`Unable to remove item with key ${e}`})}),clear:r.try({try:()=>t.clear(),catch:()=>F({pathOrDescriptor:"clear",method:"clear",description:"Unable to clear storage"})}),size:r.try({try:()=>t.length,catch:()=>F({pathOrDescriptor:"size",method:"size",description:"Unable to get size"})})})}),"make",0,k,"makeStringOnly",0,I,"prefix",0,T],4584424);var A=e.i(9960543),O=e.i(4935619),_=e.i(5369340);e.i(8554418);let M=Symbol.for("effect/Subscribable"),D={[_.TypeId]:_.TypeId,[M]:M,pipe(){return(0,A.pipeArguments)(this,arguments)}};e.s(["TypeId",0,M,"isSubscribable",0,e=>(0,O.hasProperty)(e,M)],1011081);var N=e.i(7525378),P=e.i(1299557),L=e.i(6532885),U=e.i(4026828),z=e.i(3196727),W=e.i(5523614);U.SynchronizedTypeId,U.makeSynchronized,z.get,z.getAndSet,z.getAndUpdate,W.getAndUpdateEffect,z.getAndUpdateSome,W.getAndUpdateSomeEffect,W.modify,W.modifyEffect,z.modifySome,W.modifySomeEffect,z.set,z.setAndGet,z.update,W.updateEffect,z.updateAndGet,W.updateAndGetEffect,z.updateSome,W.updateSomeEffect,z.updateSomeAndGet,U.updateSomeAndGetEffectSynchronized,U.unsafeMakeSynchronized,e.i(469137);let B=Symbol.for("effect/SubscriptionRef");N.Class,_.TypeId,L.RefTypeId;let q=(0,a.dual)(2,(e,t)=>(0,a.pipe)(L.set(e.ref,t),r.zipLeft(P.publish(e.pubsub,t)),e.semaphore.withPermits(1)));L.getAndSet,L.getAndUpdate,L.getAndUpdateSome,L.modifySome,L.setAndGet,L.update,L.updateAndGet,L.updateSome,L.updateSomeAndGet,e.s(["SubscriptionRefTypeId",0,B,"set",0,q],4721362)},8909038,e=>{"use strict";var t=e.i(5450905),r=e.i(3628392),i=e.i(7836076),n=e.i(3683485),a=e.i(2090854),s=e.i(8815901),o=e.i(9960543),l=e.i(4935619),u=e.i(9973079);let c=Symbol.for("@effect-atom/atom/Result"),d=e=>(0,l.hasProperty)(e,c),p={[c]:{E:n.identity,A:n.identity},pipe(){return(0,o.pipeArguments)(this,arguments)},[r.symbol](e){if(this._tag!==e._tag&&this.waiting!==e.waiting)return!1;switch(this._tag){case"Initial":return!0;case"Success":return r.equals(this.value,e.value);case"Failure":return r.equals(this.cause,e.cause)}},[a.symbol](){let e=a.string(`${this._tag}:${this.waiting}`);return"Initial"===this._tag?a.cached(this,e):a.cached(this,a.combine(e)("Success"===this._tag?a.hash(this.value):a.hash(this.cause)))}},f=e=>"Initial"===e._tag,h=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object.create(p);return t._tag="Initial",t.waiting=e,t},m=e=>"Success"===e._tag,g=(e,t)=>{let r=Object.create(p);return r._tag="Success",r.value=e,r.waiting=t?.waiting??!1,r.timestamp=t?.timestamp??Date.now(),r},y=e=>"Failure"===e._tag,S=(e,t)=>{let r=Object.create(p);return r._tag="Failure",r.cause=e,r.previousSuccess=t?.previousSuccess??s.none(),r.waiting=t?.waiting??!1,r},b=(e,t)=>S(e,{previousSuccess:s.flatMap(t.previous,e=>m(e)?s.some(e):y(e)?e.previousSuccess:s.none()),waiting:t.waiting}),v=(e,t)=>{if(e.waiting)return t?.touch?E(e):e;let r=Object.assign(Object.create(p),e);return r.waiting=!0,t?.touch&&m(r)&&(r.timestamp=Date.now()),r},E=e=>m(e)?g(e.value,{waiting:e.waiting}):e,w=e=>"Success"===e._tag?s.some(e.value):"Failure"===e._tag?s.map(e.previousSuccess,e=>e.value):s.none(),k=(0,n.dual)(2,(e,t)=>s.getOrElse(w(e),t)),I=(0,n.dual)(2,(e,t)=>{switch(e._tag){case"Initial":return e;case"Failure":return S(e.cause,{previousSuccess:s.map(e.previousSuccess,e=>g(t(e.value),e)),waiting:e.waiting});case"Success":return g(t(e.value),e)}}),T=(0,n.dual)(2,(e,t)=>{switch(e._tag){case"Initial":return t.onInitial(e);case"Failure":return t.onFailure(e);case"Success":return t.onSuccess(e)}}),x=(0,n.dual)(2,(e,r)=>{switch(e._tag){case"Initial":return r.onInitial(e);case"Failure":{let i=t.failureOrCause(e.cause);if("Right"===i._tag)return r.onDefect(t.squash(i.right),e);return r.onError(i.left,e)}case"Success":return r.onSuccess(e)}}),C=(0,n.dual)(2,(e,r)=>{if(e.waiting)return r.onWaiting(e);switch(e._tag){case"Initial":return r.onWaiting(e);case"Failure":{let i=t.failureOrCause(e.cause);if("Right"===i._tag)return r.onDefect(t.squash(i.right),e);return r.onError(i.left,e)}case"Success":return r.onSuccess(e)}});class R{result;constructor(e){this.result=e}output=s.none();when(e,t){if(s.isNone(this.output)&&e(this.result)){let e=t(this.result);s.isSome(e)&&(this.output=e)}return this}pipe(){return(0,o.pipeArguments)(this,arguments)}onWaiting(e){return this.when(e=>e.waiting,t=>s.some(e(t)))}onInitialOrWaiting(e){return this.when(e=>f(e)||e.waiting,t=>s.some(e(t)))}onInitial(e){return this.when(f,t=>s.some(e(t)))}onSuccess(e){return this.when(m,t=>s.some(e(t.value,t)))}onFailure(e){return this.when(y,t=>s.some(e(t.cause,t)))}onError(e){return this.onErrorIf(n.constTrue,e)}onErrorIf(e,r){return this.when(y,i=>t.failureOption(i.cause).pipe(s.filter(e),s.map(e=>r(e,i))))}onErrorTag(e,t){return this.onErrorIf(t=>(0,l.hasProperty)(t,"_tag")&&(Array.isArray(e)?e.includes(t._tag):t._tag===e),t)}onDefect(e){return this.when(y,r=>t.dieOption(r.cause).pipe(s.map(t=>e(t,r))))}orElse(e){return s.getOrElse(this.output,e)}orNull(){return s.getOrNull(this.output)}render(){if(s.isSome(this.output))return this.output.value;if(y(this.result))throw t.squash(this.result.cause);return null}}let F=u.declare(d,{identifier:"Result"});e.s(["Schema",0,e=>{let t=e.success??u.Never,r=e.error??u.Never,i=u.TaggedStruct("Success",{waiting:u.Boolean,timestamp:u.Number,value:t});return u.transform(u.Union(u.TaggedStruct("Initial",{waiting:u.Boolean}),i,u.TaggedStruct("Failure",{waiting:u.Boolean,previousSuccess:u.Option(i),cause:u.Cause({error:r,defect:u.Defect})})),F,{strict:!1,decode:e=>"Initial"===e._tag?h(e.waiting):"Success"===e._tag?g(e.value,e):S(e.cause,e),encode:n.identity})},"TypeId",0,c,"all",0,e=>{let t=(0,l.isIterable)(e),r=t?Array.from(e,(e,t)=>[t,e]):Object.entries(e),i=t?[]:{},n=!1;for(let e=0;e<r.length;e++){let[t,a]=r[e];if(d(a)){if(!m(a))return a}else{i[t]=a;continue}i[t]=a.value,a.waiting&&(n=!0)}return g(i,{waiting:n})},"builder",0,e=>new R(e),"cause",0,e=>"Failure"===e._tag?s.some(e.cause):s.none(),"error",0,e=>"Failure"===e._tag?t.failureOption(e.cause):s.none(),"fail",0,(e,r)=>S(t.fail(e),r),"failWithPrevious",0,(e,r)=>b(t.fail(e),r),"failure",0,S,"failureWithPrevious",0,b,"fromExit",0,e=>"Success"===e._tag?g(e.value):S(e.cause),"fromExitWithPrevious",0,(e,t)=>"Success"===e._tag?g(e.value):b(e.cause,{previous:t}),"getOrElse",0,k,"getOrThrow",0,e=>s.getOrThrowWith(w(e),()=>new t.NoSuchElementException("Result.getOrThrow: no value found")),"initial",0,h,"isFailure",0,y,"isInitial",0,f,"isInterrupted",0,e=>"Failure"===e._tag&&t.isInterruptedOnly(e.cause),"isNotInitial",0,e=>"Initial"!==e._tag,"isResult",0,d,"isSuccess",0,m,"isWaiting",0,e=>e.waiting,"map",0,I,"match",0,T,"matchWithError",0,x,"matchWithWaiting",0,C,"replacePrevious",0,(e,t)=>"Failure"===e._tag?b(e.cause,{previous:t,waiting:e.waiting}):e,"schemaFromSelf",0,F,"success",0,g,"toExit",0,e=>{switch(e._tag){case"Success":return i.succeed(e.value);case"Failure":return i.failCause(e.cause);default:return i.fail(new t.NoSuchElementException)}},"touch",0,E,"value",0,w,"waiting",0,v,"waitingFrom",0,e=>"None"===e._tag?h(!0):v(e.value)])},7518524,804651,e=>{"use strict";var t,r,i,n,a,s,o=e.i(889957),l=e.i(4584424),u=e.i(5283034),c=e.i(5450905),d=e.i(7358204),p=e.i(7862555),f=e.i(5972454),h=e.i(8973103),m=e.i(3322401),g=e.i(1331084),y=e.i(7836076),S=e.i(6028004),b=e.i(1150852),v=e.i(6098979),E=e.i(3683485),w=e.i(9159985),k=e.i(2873450),I=e.i(9227260),T=e.i(2034623),x=e.i(8815901),C=e.i(9960543),R=e.i(4935619),F=e.i(5310088),A=e.i(9552070),O=e.i(9973079),_=e.i(5160412),M=e.i(8554418),D=e.i(1011081),N=e.i(4721362),P=e.i(3628392),L=e.i(1072215),U=e.i(8909038);let z={immediate:!0};function W(e){}let B="~effect-atom/atom/Registry",q="~effect-atom/atom/Atom/Serializable",$=e=>q in e?e[q].key:e;class j{scheduleTask;defaultIdleTTL;[B];timeoutResolution;constructor(e,t=e=>queueMicrotask(e),r,i){if(this.scheduleTask=t,this.defaultIdleTTL=i,this[B]=B,void 0===r&&void 0!==i?this.timeoutResolution=Math.round(i/2):this.timeoutResolution=r??1e3,void 0!==e)for(const[t,r]of e)this.ensureNode(t).setValue(r)}nodes=new Map;preloadedSerializable=new Map;timeoutBuckets=new Map;nodeTimeoutBucket=new Map;disposed=!1;getNodes(){return this.nodes}get(e){return this.ensureNode(e).value()}set(e,t){e.write(this.ensureNode(e).writeContext,t)}setSerializable(e,t){this.preloadedSerializable.set(e,t)}modify(e,t){let r=this.ensureNode(e),i=t(r.value());return e.write(r.writeContext,i[1]),i[0]}update(e,t){let r=this.ensureNode(e);e.write(r.writeContext,t(r.value()))}refresh=e=>{void 0!==e.refresh?e.refresh(this.refresh):this.invalidateAtom(e)};subscribe(e,t,r){let i=this.ensureNode(e);r?.immediate&&t(i.value());let n=i.subscribe(function(){t(i._value)});return()=>{n(),i.canBeRemoved&&this.scheduleNodeRemoval(i)}}mount(e){return this.subscribe(e,W,z)}atomHasTtl(e){return!e.keepAlive&&0!==e.idleTTL&&(void 0!==e.idleTTL||void 0!==this.defaultIdleTTL)}ensureNode(e){let t=$(e),r=this.nodes.get(t);if(void 0===r?(r=this.createNode(e),this.nodes.set(t,r)):this.atomHasTtl(e)&&this.removeNodeTimeout(r),"string"==typeof t&&this.preloadedSerializable.has(t)){let i=this.preloadedSerializable.get(t);this.preloadedSerializable.delete(t);let n=e[q].decode(i);r.setValue(n)}return r}createNode(e){if(this.disposed)throw Error(`Cannot access Atom ${e}: registry is disposed`);return e.keepAlive||this.scheduleAtomRemoval(e),new V(this,e)}invalidateAtom=e=>{this.ensureNode(e).invalidate()};scheduleAtomRemoval(e){this.scheduleTask(()=>{let t=this.nodes.get($(e));void 0!==t&&t.canBeRemoved&&this.removeNode(t)})}scheduleNodeRemoval(e){this.scheduleTask(()=>{e.canBeRemoved&&this.removeNode(e)})}removeNode(e){this.atomHasTtl(e.atom)?this.setNodeTimeout(e):(this.nodes.delete($(e.atom)),e.remove())}setNodeTimeout(e){if(this.nodeTimeoutBucket.has(e))return;let t=e.atom.idleTTL??this.defaultIdleTTL;if(null!==this.#e&&(t-=this.#e)<=0){this.nodes.delete($(e.atom)),e.remove();return}let r=Math.ceil(t/this.timeoutResolution)*this.timeoutResolution,i=Date.now()+r,n=i-i%this.timeoutResolution+this.timeoutResolution,a=this.timeoutBuckets.get(n);void 0===a&&(a=[new Set,setTimeout(()=>this.sweepBucket(n),n-Date.now())],this.timeoutBuckets.set(n,a)),a[0].add(e),this.nodeTimeoutBucket.set(e,n)}removeNodeTimeout(e){let t=this.nodeTimeoutBucket.get(e);if(void 0===t)return;this.nodeTimeoutBucket.delete(e),this.scheduleNodeRemoval(e);let[r,i]=this.timeoutBuckets.get(t);r.delete(e),0===r.size&&(clearTimeout(i),this.timeoutBuckets.delete(t))}#e=null;sweepBucket(e){let t=this.timeoutBuckets.get(e)[0];this.timeoutBuckets.delete(e),t.forEach(e=>{e.canBeRemoved&&(this.nodeTimeoutBucket.delete(e),this.nodes.delete($(e.atom)),this.#e=e.atom.idleTTL??this.defaultIdleTTL,e.remove(),this.#e=null)})}reset(){this.timeoutBuckets.forEach(e=>{let[,t]=e;return clearTimeout(t)}),this.timeoutBuckets.clear(),this.nodeTimeoutBucket.clear(),this.nodes.forEach(e=>e.remove()),this.nodes.clear()}dispose(){this.disposed=!0,this.reset()}}(t=n||(n={}))[t.alive=1]="alive",t[t.initialized=2]="initialized",t[t.waitingForValue=4]="waitingForValue",(r=a||(a={}))[r.uninitialized=5]="uninitialized",r[r.stale=7]="stale",r[r.valid=3]="valid",r[r.removed=0]="removed";class V{registry;atom;constructor(e,t){this.registry=e,this.atom=t,this.writeContext=new J(e,this)}state=a.uninitialized;lifetime;writeContext;parents=[];previousParents;children=[];listeners=[];skipInvalidation=!1;get canBeRemoved(){return!this.atom.keepAlive&&0===this.listeners.length&&0===this.children.length&&0!==this.state}_value=void 0;value(){if((this.state&n.waitingForValue)!=0){this.lifetime=K(this);let e=this.atom.read(this.lifetime);if((this.state&n.waitingForValue)!=0&&this.setValue(e),this.previousParents){let e=this.previousParents;this.previousParents=void 0;for(let t=0;t<e.length;t++)e[t].removeChild(this),e[t].canBeRemoved&&this.registry.scheduleNodeRemoval(e[t])}}return this._value}valueOption(){return(this.state&n.initialized)==0?x.none():x.some(this._value)}setValue(e){if((this.state&n.initialized)==0){this.state=a.valid,this._value=e,Z.phase===s.collect?Z.notify.add(this):this.notify();return}this.state=a.valid,!P.equals(this._value,e)&&(this._value=e,this.skipInvalidation?this.skipInvalidation=!1:this.invalidateChildren(),this.listeners.length>0&&(Z.phase===s.collect?Z.notify.add(this):this.notify()))}addParent(e){if(this.parents.push(e),void 0!==this.previousParents){let t=this.previousParents.indexOf(e);-1!==t&&(this.previousParents[t]=this.previousParents[this.previousParents.length-1],void 0===this.previousParents.pop()&&(this.previousParents=void 0))}-1===e.children.indexOf(this)&&e.children.push(this)}removeChild(e){let t=this.children.indexOf(e);-1!==t&&(this.children[t]=this.children[this.children.length-1],this.children.pop())}invalidate(){this.state===a.valid&&(this.state=a.stale,this.disposeLifetime()),Z.phase===s.collect?Z.stale.push(this):this.atom.lazy&&0===this.listeners.length&&!function(e){let t;if(0===e.length)return!1;let r=e,i=0;for(;void 0!==r;){for(let e=0,i=r.length;e<i;e++){let i=r[e];if(!i.atom.lazy||i.listeners.length>0)return!0;i.children.length>0&&(void 0===t?t=[i.children]:t.push(i.children))}r=t?.[i++]}return!1}(this.children)?(this.invalidateChildren(),this.skipInvalidation=!0):this.value()}invalidateChildren(){if(0===this.children.length)return;let e=this.children;this.children=[];for(let t=0;t<e.length;t++)e[t].invalidate()}notify(){for(let e=0;e<this.listeners.length;e++)this.listeners[e]();Z.phase===s.commit&&Z.notify.delete(this)}disposeLifetime(){void 0!==this.lifetime&&(this.lifetime.dispose(),this.lifetime=void 0),0!==this.parents.length&&(this.previousParents=this.parents,this.parents=[])}remove(){if(this.state=a.removed,this.listeners=[],void 0===this.lifetime||(this.disposeLifetime(),void 0===this.previousParents))return;let e=this.previousParents;this.previousParents=void 0;for(let t=0;t<e.length;t++)e[t].removeChild(this),e[t].canBeRemoved&&this.registry.removeNode(e[t])}subscribe(e){return this.listeners.push(e),()=>{let t=this.listeners.indexOf(e);-1!==t&&(this.listeners[t]=this.listeners[this.listeners.length-1],this.listeners.pop())}}}let H=e=>Error(`Cannot use context of disposed Atom: ${e}`),G={get registry(){return this.node.registry},addFinalizer(e){if(this.disposed)throw H(this.node.atom);this.finalizers??=[],this.finalizers.push(e)},get(e){if(this.disposed)throw H(this.node.atom);let t=this.node.registry.ensureNode(e);return this.node.addParent(t),t.value()},result(e,t){if(this.disposed)throw H(this.node.atom);if(this.isFn)return this.resultOnce(e);let r=this.get(e);if(t?.suspendOnWaiting&&r.waiting)return m.never;switch(r._tag){case"Initial":return m.never;case"Failure":return y.failCause(r.cause);case"Success":return m.succeed(r.value)}},resultOnce(e,t){if(this.disposed)throw H(this.node.atom);return m.async(r=>{let i=this.once(e);if("Initial"!==i._tag&&!(t?.suspendOnWaiting&&i.waiting))return r(U.toExit(i));let n=this.node.registry.subscribe(e,e=>{"Initial"===e._tag||t?.suspendOnWaiting&&e.waiting||(n(),r(U.toExit(e)))},{immediate:!1});return m.sync(n)})},some(e){if(this.disposed)throw H(this.node.atom);if(this.isFn)return this.someOnce(e);let t=this.get(e);return"None"===t._tag?m.never:m.succeed(t.value)},someOnce(e){if(this.disposed)throw H(this.node.atom);return m.async(t=>{let r=this.once(e);if(x.isSome(r))return t(m.succeed(r.value));let i=this.node.registry.subscribe(e,e=>{x.isNone(e)||(i(),t(m.succeed(e.value)))},{immediate:!1});return m.sync(i)})},once(e){if(this.disposed)throw H(this.node.atom);return this.node.registry.get(e)},self(){if(this.disposed)throw H(this.node.atom);return this.node.valueOption()},refresh(e){if(this.disposed)throw H(this.node.atom);this.node.registry.refresh(e)},refreshSelf(){if(this.disposed)throw H(this.node.atom);this.node.invalidate()},mount(e){if(this.disposed)throw H(this.node.atom);this.addFinalizer(this.node.registry.mount(e))},subscribe(e,t,r){if(this.disposed)throw H(this.node.atom);this.addFinalizer(this.node.registry.subscribe(e,t,r))},setSelf(e){if(this.disposed)throw H(this.node.atom);this.node.setValue(e)},set(e,t){if(this.disposed)throw H(this.node.atom);this.node.registry.set(e,t)},stream(e,t){if(this.disposed)throw H(this.node.atom);return(0,E.pipe)(m.acquireRelease(L.bounded(t?.bufferSize??16),L.shutdown),m.tap(r=>m.acquireRelease(m.sync(()=>this.node.registry.subscribe(e,e=>{L.unsafeOffer(r,e)},{immediate:t?.withoutInitialValue!==!0})),e=>m.sync(e))),m.map(e=>M.fromQueue(e)),M.unwrapScoped)},streamResult(e,t){return(0,E.pipe)(this.stream(e,t),M.filter(U.isNotInitial),M.flatMap(e=>"Success"===e._tag?M.succeed(e.value):M.failCause(e.cause)))},dispose(){if(this.disposed=!0,void 0===this.finalizers)return;let e=this.finalizers;this.finalizers=void 0;for(let t=e.length-1;t>=0;t--)e[t]()}},K=e=>{function t(r){if(t.disposed)throw H(r);if(t.isFn)return e.registry.get(r);let i=e.registry.ensureNode(r);return e.addParent(i),i.value()}return Object.setPrototypeOf(t,G),t.isFn=!1,t.disposed=!1,t.finalizers=void 0,t.node=e,t};class J{registry;node;constructor(e,t){this.registry=e,this.node=t}get(e){return this.registry.get(e)}set(e,t){return this.registry.set(e,t)}setSelf(e){return this.node.setValue(e)}refreshSelf(){return this.node.invalidate()}}(i=s||(s={}))[i.disabled=0]="disabled",i[i.collect=1]="collect",i[i.commit=2]="commit";let Z=(0,w.globalValue)("@effect-atom/atom/Registry/batchState",()=>({phase:s.disabled,depth:0,stale:[],notify:new Set}));var Q=e.i(2916763);let Y=e=>{let t=F.runFork(e);return function(e,r){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=(e=>{switch(e._tag){case"Failure":case"Success":return e;case"Left":return y.fail(e.left);case"Right":return y.succeed(e.right);case"Some":return y.succeed(e.value);case"None":return y.fail(new c.NoSuchElementException)}})(e);if(n)return void r(n);let a=new Q.SyncScheduler,s=t(e,{scheduler:a});a.flush();let o=s.unsafePoll();return o?void r(o):(s.addObserver(r),function(){s.removeObserver(r),i||s.unsafeInterruptAsFork(b.none)})}};var X=f,ee=e.i(1737036);class et extends X.Tag("@effect/atom/Registry/CurrentRegistry")(){}let er=(0,E.dual)(2,(e,t)=>M.unwrapScoped(m.contextWithEffect(r=>{let i=X.get(r,_.Scope);return ee.make().pipe(m.tap(r=>{let n=e.subscribe(t,e=>r.unsafeOffer(e),{immediate:!0});return _.addFinalizer(i,m.suspend(()=>(n(),r.shutdown)))}),m.uninterruptible,m.map(e=>ee.toStream(e)))}))),ei=(0,E.dual)(2,(e,t)=>er(e,t).pipe(M.filter(U.isNotInitial),M.mapEffect(e=>"Success"===e._tag?m.succeed(e.value):m.failCause(e.cause)))),en=(0,E.dual)(e=>{let t;return t=e[0],(0,R.hasProperty)(t,"~effect-atom/atom/Registry")},(e,t,r)=>{let i=r?.suspendOnWaiting??!1;return m.async(r=>{let n=e.get(t);if("Initial"!==n._tag&&!(i&&n.waiting))return r(U.toExit(n));let a=e.subscribe(t,e=>{"Initial"===e._tag||i&&e.waiting||(r(U.toExit(e)),a())});return m.sync(a)})});e.s(["AtomRegistry",0,et,"getResult",0,en,"make",0,e=>new j(e?.initialValues,e?.scheduleTask,e?.timeoutResolution,e?.defaultIdleTTL),"toStream",0,er,"toStreamResult",0,ei],804651);let ea="~effect-atom/atom/Atom",es="~effect-atom/atom/Atom/Writable",eo={[ea]:ea,pipe(){return(0,C.pipeArguments)(this,arguments)},toJSON(){return{_id:"Atom",keepAlive:this.keepAlive,lazy:this.lazy,label:this.label}},toString(){return k.format(this)},[k.NodeInspectSymbol](){return this.toJSON()}},el={...eo,atom(e,t){let r=ey(e,t);return ep(e=>{let t=e.self(),i=e(this);return"Success"!==i._tag?U.replacePrevious(i,t):r(e,i.value)})},fn(e,t){return 0==arguments.length?(e,t)=>eu(this,e,t):eu(this,e,t)},pull(e,t){let r=eS(0),i=ep(i=>{let n=i.self(),a=i(this);return"Success"!==a._tag?U.replacePrevious(a,n):ev(i,eL(i,r,e,t),U.initial(!0),a.value)});return eU(r,i)},subscriptionRef(e){return eR(ep(t=>{let r=t.self(),i=t(this);if("Success"!==i._tag)return U.replacePrevious(i,r);let n="function"==typeof e?e(t):e;return N.SubscriptionRefTypeId in n?n:ev(t,n,U.initial(!0),i.value)}),(e,t)=>{let r=U.getOrThrow(e(this));return eC(e,t,r)})},subscribable(e){return eF(ep(t=>{let r=t.self(),i=t(this);if("Success"!==i._tag)return U.replacePrevious(i,r);let n="function"==typeof e?e(t):e;return D.isSubscribable(n)?n:ev(t,n,U.initial(!0),i.value)}),(e,t)=>{let r=U.getOrThrow(e(this));return eC(e,t,r)})}},eu=(e,t,r)=>{let[i,n,a]=eN(r?.reactivityKeys?(e,i)=>{let n=t(e,i);return m.isEffect(n)?o.mutation(n,r.reactivityKeys):M.ensuring(n,o.invalidate(r.reactivityKeys))}:t,r);return ef(t=>{t.get(a);let r=t.self(),n=t.get(e);return"Success"!==n._tag?U.replacePrevious(n,r):i(t,n.value)},n)},ec={...eo,[es]:es},ed=e=>es in e,ep=(e,t)=>{let r=Object.create(eo);return r.keepAlive=!1,r.lazy=!0,r.read=e,r.refresh=t,r},ef=(e,t,r)=>{let i=Object.create(ec);return i.keepAlive=!1,i.lazy=!0,i.read=e,i.write=t,i.refresh=r,i};function eh(e,t){e.setSelf(t)}let em=(e,t)=>{let r=ey(e,t);return ea in r?r:ep(r)},eg=e=>x.TypeId in e||g.TypeId in e,ey=(e,t)=>{if("function"==typeof e&&!m.isEffect(e)&&!(M.StreamTypeId in e))return function(r,i){let n=e(r);if((0,R.isObject)(n)){if(eg(n));else if(m.EffectTypeId in n)return eb(r,n,t,i);else if(M.StreamTypeId in n)return eT(r,n,t,i)}return n};if((0,R.isObject)(e)){if(eg(e));else if(m.EffectTypeId in e)return function(r,i){return eb(r,e,t,i)};else if(M.StreamTypeId in e)return function(r,i){return eT(r,e,t,i)}}return eS(e)},eS=e=>ef(function(t){return e},eh),eb=(e,t,r,i)=>ev(e,t,r?.initialValue!==void 0?U.success(r.initialValue):U.initial(),i,r?.uninterruptible);function ev(e,t,r){let i,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:F.defaultRuntime,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=e.self(),o=m.runSync(_.make());e.addFinalizer(()=>{m.runFork(_.close(o,y.void))});let l=new Map(n.context.unsafeMap);l.set(_.Scope.key,o),l.set(et.key,e.registry);let u=F.make({context:f.unsafeMake(l),fiberRefs:n.fiberRefs,runtimeFlags:n.runtimeFlags}),c=!1,d=Y(u)(t,function(t){i=U.fromExitWithPrevious(t,s),c&&e.setSelf(i)},a);return(c=!0,void 0!==d&&e.addFinalizer(d),void 0!==i)?i:"Some"===s._tag?U.waitingFrom(s):U.waiting(r)}let eE=e=>{let t=o.layer;function r(i){let n=Object.create(el);n.keepAlive=!1,n.lazy=!0,n.refresh=void 0,n.factory=r;let a=eB("function"==typeof i?ep(e=>I.provideMerge(i(e),t)):ep(()=>I.provideMerge(i,t)));return n.layer=a,n.read=function(t){let r=t(a);return eb(t,m.flatMap(m.flatMap(m.scope,t=>I.buildWithMemoMap(r,e.memoMap,t)),e=>m.provide(m.runtime(),e)),{uninterruptible:!0})},n}r.memoMap=e.memoMap,r.addGlobalLayer=e=>{t=I.provideMerge(t,I.provide(e,o.layer))};let i=em(m.scopeWith(t=>I.buildWithMemoMap(o.layer,e.memoMap,t)).pipe(m.map(f.get(o.Reactivity))));return r.withReactivity=e=>t=>eG(t,r=>{let n=U.getOrThrow(r(i));return r.addFinalizer(n.unsafeRegister(e,()=>{r.refresh(t)})),r.subscribe(t,e=>r.setSelf(e)),r.once(t)}),r},ew=(0,w.globalValue)("@effect-atom/atom/Atom/defaultMemoMap",()=>m.runSync(I.makeMemoMap)),ek=(0,w.globalValue)("@effect-atom/atom/Atom/defaultContext",()=>eE({memoMap:ew})),eI=ek.withReactivity,eT=(e,t,r,i)=>ex(e,t,r?.initialValue!==void 0?U.success(r.initialValue):U.initial(),i);function ex(e,t,r){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:F.defaultRuntime,n=e.self(),a=d.readWithCause({onInput:t=>d.suspend(()=>{let r=p.last(t);return"Some"===r._tag&&e.setSelf(U.success(r.value,{waiting:!0})),a}),onFailure:t=>d.sync(()=>{e.setSelf(U.failureWithPrevious(t,{previous:e.self()}))}),onDone:t=>d.sync(()=>{(0,E.pipe)(e.self(),x.flatMap(U.value),x.match({onNone:()=>e.setSelf(U.failWithPrevious(new c.NoSuchElementException,{previous:e.self()})),onSome:t=>e.setSelf(U.success(t))}))})}),s=Y(F.make({context:f.add(i.context,et,e.registry),fiberRefs:i.fiberRefs,runtimeFlags:i.runtimeFlags}))(d.runDrain(d.pipeTo(M.toChannel(t),a)),E.constVoid,!1);return(void 0!==s&&e.addFinalizer(s),"Some"===n._tag)?U.waitingFrom(n):U.waiting(r)}let eC=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:F.defaultRuntime;return D.TypeId in t?(e.addFinalizer(t.changes.pipe(M.runForEach(t=>(e.setSelf(t),m.void)),F.runCallback(r))),F.runSync(r)(t.get)):"Success"!==t._tag?t:ex(e,t.value.changes,U.initial(!0),r)},eR=(e,t)=>ef(r=>{let i=r(e);return N.SubscriptionRefTypeId in i||U.isSuccess(i)?t(r,i):i},function(t,r){let i=t.get(e);N.SubscriptionRefTypeId in i?m.runSync(N.set(i,r)):U.isSuccess(i)&&m.runSync(N.set(i.value,r))}),eF=(e,t)=>ep(r=>{let i=r(e);return D.isSubscribable(i)||U.isSuccess(i)?t(r,i):i}),eA=(e,t)=>{let r=eS([0,void 0]),i=t?.initialValue!==void 0;return ef(function(n){n.isFn=!0;let[a,s]=n.get(r);return 0===a?i?t.initialValue:x.none():i?e(s,n):x.some(e(s,n))},function(e,t){eY(()=>{e.set(r,[e.get(r)[0]+1,t]),e.refreshSelf()})})},eO=Symbol.for("@effect-atom/atom/Atom/Reset"),e_=Symbol.for("@effect-atom/atom/Atom/Interrupt"),eM=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?eD:eD(...t)},eD=(e,t)=>{let[r,i]=eN(e,t);return ef(r,i)};function eN(e,t){let r=eS([0,void 0]),i=t?.initialValue!==void 0?U.success(t.initialValue):U.initial(),n=t?.concurrent?em(e=>{let t=new Set;return e.addFinalizer(()=>t.forEach(e=>e.unsafeInterruptAsFork(b.none))),t}):void 0;return[function(t,a){let s=n?t(n):void 0;t.isFn=!0;let[o,l]=t.get(r);if(0===o)return i;if(l===e_)return U.failureWithPrevious(c.interrupt(b.none),{previous:t.self()});let u=e(l,t);if(m.EffectTypeId in u){if(s){let e=u;u=m.flatMap(m.runtime(),t=>{let r=F.runFork(t,e);s.add(r);let i=Array.from(s);return r.addObserver(()=>s.delete(r)),eP(i)})}return ev(t,u,i,a,!1)}return ex(t,u,i,a)},function(e,t){eY(()=>{t===eO?e.set(r,[0,void 0]):t===e_?e.set(r,[e.get(r)[0]+1,e_]):e.set(r,[e.get(r)[0]+1,t]),e.refreshSelf()})},r]}let eP=e=>m.async(t=>{let r,i,n=0;function a(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"Failure"===e._tag?r=r?c.parallel(e.cause,r):e.cause:r||(i=e),n++,t||s()}function s(){for(;n<e.length;){let t=e[n],r=t.unsafePoll();if(!r)return t.addObserver(a);a(r,!0)}t(r?y.failCause(r):i||y.failCause(c.empty))}return s(),m.sync(()=>{n<e.length&&e[n].removeObserver(a)})}),eL=(e,t,r,i)=>m.flatMap(d.toPull(M.toChannel("function"==typeof r?r(e):r)),r=>{let n=m.unsafeMakeSemaphore(1),a=x.getOrThrow(S.getCurrentFiber()),s=a.currentContext,o=p.empty(),l=m.flatMap(m.locally(m.suspend(()=>r),v.currentContext,s),g.match({onLeft:()=>{let e=p.toReadonlyArray(o);return u.isNonEmptyArray(e)?m.succeed({done:!0,items:e}):m.fail(new c.NoSuchElementException("Atom.pull: no items"))},onRight(e){let t;i?.disableAccumulation?t=e:o=t=p.appendAll(o,e);let r=p.toReadonlyArray(t);return u.isNonEmptyArray(r)?m.succeed({done:!1,items:r}):l}})),d=n.withPermits(1)(l),f=Y(F.make({context:s,fiberRefs:a.getFiberRefs(),runtimeFlags:F.defaultRuntime.runtimeFlags})),h=new Set;return e.addFinalizer(()=>{for(let e of h)e()}),e.once(t),e.subscribe(t,()=>{let t;e.setSelf(U.waitingFrom(e.self())),(t=f(d,r=>{t&&h.delete(t);let i=U.fromExitWithPrevious(r,e.self()),n=h.size>0;e.setSelf(n?U.waiting(i):i)}))&&h.add(t)}),l}),eU=(e,t)=>ef(t.read,function(t,r){t.set(e,t.get(e)+1)}),ez="u"<typeof WeakRef||"u"<typeof FinalizationRegistry?e=>{let t=T.empty();return function(r){let i=T.get(t,r);if("Some"===i._tag)return i.value;let n=e(r);return T.set(t,r,n),n}}:e=>{let t=T.empty(),r=new FinalizationRegistry(e=>{T.remove(t,e)});return function(i){let n=T.get(t,i).pipe(x.flatMapNullable(e=>e.deref()));if("Some"===n._tag)return n.value;let a=e(i);return T.set(t,i,new WeakRef(a)),r.register(a,i),a}},eW=(0,E.dual)(2,(e,t)=>{function r(r){let i=r(e);return"Initial"===i._tag?U.waiting(r(t)):i}return ed(e)?ef(r,e.write,e.refresh??function(t){t(e)}):ep(r,e.refresh??function(t){t(e)})}),eB=e=>Object.assign(Object.create(Object.getPrototypeOf(e)),{...e,keepAlive:!0}),eq=e=>Object.assign(Object.create(Object.getPrototypeOf(e)),{...e,keepAlive:!1}),e$=(0,E.dual)(2,(e,t)=>Object.assign(Object.create(Object.getPrototypeOf(e)),{...e,lazy:t})),ej=(0,E.dual)(2,(e,t)=>Object.assign(Object.create(Object.getPrototypeOf(e)),{...e,label:[t,Error().stack?.split("\n")[5]??""]})),eV=(0,E.dual)(2,(e,t)=>{let r=h.decode(t),i=h.isFinite(r);return Object.assign(Object.create(Object.getPrototypeOf(e)),{...e,keepAlive:!i,idleTTL:i?h.toMillis(r):void 0})}),eH=(0,E.dual)(2,(e,t)=>[e,t]),eG=(0,E.dual)(2,(e,t)=>ed(e)?ef(t,function(t,r){t.set(e,r)},e.refresh??function(t){t(e)}):ep(t,e.refresh??function(t){t(e)})),eK=(0,E.dual)(2,(e,t)=>eG(e,r=>t(r(e)))),eJ=(0,E.dual)(2,(e,t)=>eK(e,U.map(t))),eZ=(0,E.dual)(2,(e,t)=>{let r=h.toMillis(t);return eG(e,function(t){let i,n=t.once(e);function a(){i=void 0,t.setSelf(n)}return t.addFinalizer(function(){i&&clearTimeout(i)}),t.subscribe(e,function(e){n=e,i&&clearTimeout(i),i=setTimeout(a,r)}),n})}),eQ=(0,E.dual)(2,(e,t)=>{let r=eS(U.initial());return eM((i,n)=>{let a=t.reducer(n(e),i);U.isResult(a)&&(a=U.waiting(a,{touch:!0})),n.set(r,U.success(a,{waiting:!0})),n.set(e,r);let s="function"==typeof t.fn?eq(t.fn(e=>n.set(r,U.success(U.isResult(e)?U.waiting(e):e,{waiting:!0})))):t.fn;return n.set(s,i),m.async(e=>{n.subscribe(s,t=>{"Initial"===t._tag||t.waiting||(n.set(r,U.map(t,()=>a)),e(U.toExit(t)))},{immediate:!0})})})}),eY=function(e){Z.phase=s.collect,Z.depth++;try{if(e(),1===Z.depth){for(let e=0;e<Z.stale.length;e++)!function e(t){if(t.state!==a.valid){for(let r=0;r<t.parents.length;r++){let i=t.parents[r];i.state!==a.valid&&e(i)}t.state!==a.valid&&t.value()}}(Z.stale[e]);for(let e of(Z.phase=s.commit,Z.notify))e.notify();Z.notify.clear()}}finally{Z.depth--,0===Z.depth&&(Z.phase=s.disabled,Z.stale=[])}},eX=ep(e=>{let t=0;function r(){"visible"===document.visibilityState&&e.setSelf(++t)}return window.addEventListener("visibilitychange",r),e.addFinalizer(()=>{window.removeEventListener("visibilitychange",r)}),t}),e0=e=>t=>eG(t,r=>(r.once(e),r.subscribe(e,e=>r.refresh(t)),r.subscribe(t,e=>r.setSelf(e)),r.once(t))),e1=e0(eX),e2={timeout:void 0,updates:new Map,updating:!1};function e5(){e2.timeout=void 0,e2.updating=!0;let e=new URLSearchParams(window.location.search);for(let[t,r]of e2.updates.entries())r.length>0?e.set(t,r):e.delete(t);e2.updates.clear();let t=`${window.location.pathname}?${e.toString()}`;window.history.pushState({},"",t),e2.updating=!1}let e3=(0,E.dual)(2,(e,t)=>m.map(et,r=>r.modify(e,t))),e8=(0,E.dual)(2,(e,t)=>m.map(et,r=>r.set(e,t))),e4=(0,E.dual)(2,(e,t)=>m.map(et,r=>r.update(e,t))),e6="~effect-atom/atom/Atom/Serializable",e9=(0,E.dual)(2,(e,t)=>Object.assign(Object.create(Object.getPrototypeOf(e)),{...e,label:e.label??[t.key,Error().stack?.split("\n")[5]??""],[e6]:{key:t.key,encode:A.encodeSync(t.schema),decode:A.decodeSync(t.schema)}})),e7="~effect-atom/atom/Atom/ServerValue",te=(0,E.dual)(2,(e,t)=>Object.assign(Object.create(Object.getPrototypeOf(e)),{...e,[e7]:t})),tt=(0,E.dual)(2,(e,t)=>e7 in e?e[e7](e=>t.get(e)):t.get(e));e.s(["Interrupt",0,e_,"Reset",0,eO,"SerializableTypeId",0,e6,"ServerValueTypeId",0,e7,"TypeId",0,ea,"WritableTypeId",0,es,"autoDispose",0,eq,"batch",0,eY,"context",0,eE,"debounce",0,eZ,"defaultMemoMap",0,ew,"family",0,ez,"fn",0,eM,"fnSync",0,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?eA:eA(...t)},"get",0,e=>m.map(et,t=>t.get(e)),"getResult",0,(e,t)=>m.flatMap(et,en(e,t)),"getServerValue",0,tt,"initialValue",0,eH,"isAtom",0,e=>(0,R.hasProperty)(e,ea),"isSerializable",0,e=>e6 in e,"isWritable",0,ed,"keepAlive",0,eB,"kvs",0,e=>{let t=e.runtime.fn(m.fnUntraced(function*(t){let r=(yield*l.KeyValueStore).forSchema(e.schema);yield*r.set(e.key,t)})),r=e.runtime.atom(m.flatMap(l.KeyValueStore,t=>m.flatten(t.forSchema(e.schema).get(e.key))));return ef(i=>(i.mount(t),U.getOrElse(i(r),e.defaultValue)),(e,r)=>{e.set(t,r),e.setSelf(r)})},"make",0,em,"makeRefreshOnSignal",0,e0,"map",0,eK,"mapResult",0,eJ,"modify",0,e3,"optimistic",0,e=>{let t=0,r=eS([0,void 0]);return ef(t=>{let i=t.once(e),n=!1;t.subscribe(e,e=>{if(i=e,a.size>0)return;if(n=!1,!U.isResult(e))return t.setSelf(e);let r=x.getOrUndefined(t.self());switch(e._tag){case"Initial":U.isInitial(r)&&t.setSelf(e);return;case"Success":U.isSuccess(r)?!e.waiting&&e.timestamp>=r.timestamp&&t.setSelf(e):t.setSelf(e);return;case"Failure":return t.setSelf(e)}});let a=new Set,s=new Set;return t.subscribe(r,r=>{let o,[,l]=r;a.has(l)||(a.add(l),o=t.registry.subscribe(l,r=>{if(U.isSuccess(r)&&r.waiting)return t.setSelf(r.value);a.delete(l),o&&(s.delete(o),o()),n||U.isFailure(r)||(n=!0),0===a.size&&(n?(n=!1,t.refresh(e)):t.setSelf(i))},{immediate:!0}),a.has(l)?s.add(o):o())}),t.addFinalizer(()=>{for(let e of s)e();a.clear(),s.clear()}),i},(e,i)=>e.set(r,[++t,i]),t=>t(e))},"optimisticFn",0,eQ,"pull",0,(e,t)=>{let r=eS(0),i=ep(ey(function(i){return eL(i,r,e,t)}));return eU(r,i)},"readable",0,ep,"refresh",0,e=>m.map(et,t=>t.refresh(e)),"refreshOnWindowFocus",0,e1,"runtime",0,ek,"searchParam",0,(e,t)=>{let r=t?.schema&&O.decodeEither(t.schema),i=t?.schema&&O.encodeEither(t.schema);return ef(t=>{let i=()=>{if(e2.updating)return;let i=new URLSearchParams(window.location.search).get(e)||"";r?t.setSelf(g.getRight(r(i))):i!==x.getOrUndefined(t.self())&&t.setSelf(i)};window.addEventListener("popstate",i),window.addEventListener("pushstate",i),t.addFinalizer(()=>{window.removeEventListener("popstate",i),window.removeEventListener("pushstate",i)});let n=new URLSearchParams(window.location.search).get(e)||"";return r?g.getRight(r(n)):n},(t,r)=>{if(i){let t=x.flatMap(r,e=>g.getRight(i(e)));e2.updates.set(e,x.getOrElse(t,()=>"")),r=x.zipRight(t,r)}else e2.updates.set(e,r);t.setSelf(r),e2.timeout&&clearTimeout(e2.timeout),e2.timeout=setTimeout(e5,500)})},"serializable",0,e9,"set",0,e8,"setIdleTTL",0,eV,"setLazy",0,e$,"subscribable",0,e=>eF(ep(t=>{let r="function"==typeof e?e(t):e;return D.isSubscribable(r)?r:ev(t,r,U.initial(!0))}),eC),"subscriptionRef",0,e=>eR(ep(t=>{let r="function"==typeof e?e(t):e;return N.SubscriptionRefTypeId in r?r:ev(t,r,U.initial(!0))}),eC),"toStream",0,e=>M.unwrap(m.map(et,er(e))),"toStreamResult",0,e=>M.unwrap(m.map(et,ei(e))),"transform",0,eG,"update",0,e4,"windowFocusSignal",0,eX,"withFallback",0,eW,"withLabel",0,ej,"withReactivity",0,eI,"withServerValue",0,te,"withServerValueInitial",0,e=>te(e,(0,E.constant)(U.initial(!0))),"writable",0,ef],7518524)},8973927,e=>{"use strict";var t=e.i(3322401);e.s(["Effect",0,t])},1794138,(e,t,r)=>{"use strict";function i(e,t){var r=e.length;for(e.push(t);0<r;){var i=r-1>>>1,n=e[i];if(0<s(n,t))e[i]=t,e[r]=n,r=i;else break}}function n(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;for(var i=0,n=e.length,a=n>>>1;i<a;){var o=2*(i+1)-1,l=e[o],u=o+1,c=e[u];if(0>s(l,r))u<n&&0>s(c,l)?(e[i]=c,e[u]=r,i=u):(e[i]=l,e[o]=r,i=o);else if(u<n&&0>s(c,r))e[i]=c,e[u]=r,i=u;else break}}return t}function s(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if(r.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var o,l=performance;r.unstable_now=function(){return l.now()}}else{var u=Date,c=u.now();r.unstable_now=function(){return u.now()-c}}var d=[],p=[],f=1,h=null,m=3,g=!1,y=!1,S=!1,b=!1,v="function"==typeof setTimeout?setTimeout:null,E="function"==typeof clearTimeout?clearTimeout:null,w="u">typeof setImmediate?setImmediate:null;function k(e){for(var t=n(p);null!==t;){if(null===t.callback)a(p);else if(t.startTime<=e)a(p),t.sortIndex=t.expirationTime,i(d,t);else break;t=n(p)}}function I(e){if(S=!1,k(e),!y)if(null!==n(d))y=!0,T||(T=!0,o());else{var t=n(p);null!==t&&M(I,t.startTime-e)}}var T=!1,x=-1,C=5,R=-1;function F(){return!!b||!(r.unstable_now()-R<C)}function A(){if(b=!1,T){var e=r.unstable_now();R=e;var t=!0;try{e:{y=!1,S&&(S=!1,E(x),x=-1),g=!0;var i=m;try{t:{for(k(e),h=n(d);null!==h&&!(h.expirationTime>e&&F());){var s=h.callback;if("function"==typeof s){h.callback=null,m=h.priorityLevel;var l=s(h.expirationTime<=e);if(e=r.unstable_now(),"function"==typeof l){h.callback=l,k(e),t=!0;break t}h===n(d)&&a(d),k(e)}else a(d);h=n(d)}if(null!==h)t=!0;else{var u=n(p);null!==u&&M(I,u.startTime-e),t=!1}}break e}finally{h=null,m=i,g=!1}}}finally{t?o():T=!1}}}if("function"==typeof w)o=function(){w(A)};else if("u">typeof MessageChannel){var O=new MessageChannel,_=O.port2;O.port1.onmessage=A,o=function(){_.postMessage(null)}}else o=function(){v(A,0)};function M(e,t){x=v(function(){e(r.unstable_now())},t)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(e){e.callback=null},r.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},r.unstable_getCurrentPriorityLevel=function(){return m},r.unstable_next=function(e){switch(m){case 1:case 2:case 3:var t=3;break;default:t=m}var r=m;m=t;try{return e()}finally{m=r}},r.unstable_requestPaint=function(){b=!0},r.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=m;m=e;try{return t()}finally{m=r}},r.unstable_scheduleCallback=function(e,t,a){var s=r.unstable_now();switch(a="object"==typeof a&&null!==a&&"number"==typeof(a=a.delay)&&0<a?s+a:s,e){case 1:var l=-1;break;case 2:l=250;break;case 5:l=0x3fffffff;break;case 4:l=1e4;break;default:l=5e3}return l=a+l,e={id:f++,callback:t,priorityLevel:e,startTime:a,expirationTime:l,sortIndex:-1},a>s?(e.sortIndex=a,i(p,e),null===n(d)&&e===n(p)&&(S?(E(x),x=-1):S=!0,M(I,a-s))):(e.sortIndex=l,i(d,e),y||g||(y=!0,T||(T=!0,o()))),e},r.unstable_shouldYield=F,r.unstable_wrapCallback=function(e){var t=m;return function(){var r=m;m=t;try{return e.apply(this,arguments)}finally{m=r}}}},5488440,(e,t,r)=>{"use strict";t.exports=e.r(1794138)},8523664,e=>{"use strict";var t=e.i(7518524),r=e.i(804651),i=e.i(8973927),n=e.i(5450905),a=e.i(7836076),s=e.i(9159985),o=e.i(6695816),l=e.i(5488440);let u=o.createContext(r.make({scheduleTask:function(e){l.unstable_scheduleCallback(l.unstable_LowPriority,e)},defaultIdleTTL:400})),c=(0,s.globalValue)("@effect-atom/atom-react/storeRegistry",()=>new WeakMap);function d(e,r){let i=function(e,r){let i=c.get(e);void 0===i&&(i=new WeakMap,c.set(e,i));let n=i.get(r);if(void 0!==n)return n;let a={subscribe:t=>e.subscribe(r,t),snapshot:()=>e.get(r),getServerSnapshot:()=>t.getServerValue(r,e)};return i.set(r,a),a}(e,r);return o.useSyncExternalStore(i.subscribe,i.snapshot,i.getServerSnapshot)}function p(e,t){o.useEffect(()=>e.mount(t),[t,e])}function f(e,t,n){return n?.mode==="promise"||n?.mode==="promiseExit"?o.useCallback(a=>{e.set(t,a);let s=i.Effect.runPromiseExit(r.getResult(e,t,{suspendOnWaiting:!0}));return"promise"===n.mode?s.then(h):s},[e,t,n.mode]):o.useCallback(r=>{e.set(t,"function"==typeof r?r(e.get(t)):r)},[e,t])}let h=e=>{if(a.isSuccess(e))return e.value;throw n.squash(e.cause)},m=(0,s.globalValue)("@effect-atom/atom-react/atomPromiseMap",()=>({suspendOnWaiting:new Map,default:new Map}));e.s(["useAtom",0,(e,t)=>{let r=o.useContext(u);return[d(r,e),f(r,e,t)]},"useAtomMount",0,e=>{p(o.useContext(u),e)},"useAtomRefresh",0,e=>{let t=o.useContext(u);return p(t,e),o.useCallback(()=>{t.refresh(e)},[t,e])},"useAtomSet",0,(e,t)=>{let r=o.useContext(u);return p(r,e),f(r,e,t)},"useAtomSuspense",0,(e,t)=>{let r=function(e,t,r){let i=d(e,t);if("Initial"===i._tag||r&&i.waiting){let i,n;throw void 0!==(n=(i=r?m.suspendOnWaiting:m.default).get(t))||(n=new Promise(n=>{let a=e.subscribe(t,e=>{"Initial"===e._tag||r&&e.waiting||(setTimeout(a,1e3),n(),i.delete(t))})}),i.set(t,n)),n}return i}(o.useContext(u),e,t?.suspendOnWaiting??!1);if("Failure"===r._tag&&!t?.includeFailure)throw n.squash(r.cause);return r},"useAtomValue",0,(e,r)=>{let i=o.useContext(u);return r?d(i,o.useMemo(()=>t.map(e,r),[e,r])):d(i,e)}],8523664)},9977037,e=>{"use strict";var t=e.i(8909038);e.s(["Result",0,t])},4511046,6021311,8718972,e=>{"use strict";var t=e.i(5972454);e.s(["Context",0,t],4511046);var r=e.i(9227260);e.s(["Layer",0,r],6021311);var i=e.i(7525378),n=e.i(9960543),a=e.i(4935619),s=e.i(5160412),o=e.i(7548658),l=e.i(1658800),u=e.i(2067266),c=e.i(3674254),d=e.i(210165);function p(e,t){return o.flatMap(e.runtimeEffect,e=>o.withFiberRuntime(r=>(r.setFiberRefs(e.fiberRefs),r.currentRuntimeFlags=e.runtimeFlags,o.provideContext(t,e.context))))}let f={...i.CommitPrototype,[c.TypeId]:c.TypeId,pipe(){return(0,n.pipeArguments)(this,arguments)},commit(){return this.runtimeEffect}},h=c.TypeId;e.s(["TypeId",0,h,"isManagedRuntime",0,e=>(0,a.hasProperty)(e,c.TypeId),"make",0,(e,t)=>{let r;t=t??u.unsafeMakeMemoMap();let i=d.unsafeRunSyncEffect(l.scopeMake()),n=o.withFiberRuntime(n=>(r||(r=d.unsafeForkEffect(o.tap(s.extend(u.toRuntimeWithMemoMap(e,t),i),e=>{a.cachedRuntime=e}),{scope:i,scheduler:n.currentScheduler})),o.flatten(r.await))),a=Object.assign(Object.create(f),{memoMap:t,scope:i,runtimeEffect:n,cachedRuntime:void 0,runtime:()=>void 0===a.cachedRuntime?d.unsafeRunPromiseEffect(a.runtimeEffect):Promise.resolve(a.cachedRuntime),dispose:()=>d.unsafeRunPromiseEffect(a.disposeEffect),disposeEffect:o.suspend(()=>(a.runtimeEffect=o.die("ManagedRuntime disposed"),a.cachedRuntime=void 0,s.close(a.scope,o.exitVoid))),runFork:(e,t)=>void 0===a.cachedRuntime?d.unsafeForkEffect(p(a,e),t):d.unsafeFork(a.cachedRuntime)(e,t),runSyncExit:e=>void 0===a.cachedRuntime?d.unsafeRunSyncExitEffect(p(a,e)):d.unsafeRunSyncExit(a.cachedRuntime)(e),runSync:e=>void 0===a.cachedRuntime?d.unsafeRunSyncEffect(p(a,e)):d.unsafeRunSync(a.cachedRuntime)(e),runPromiseExit:(e,t)=>void 0===a.cachedRuntime?d.unsafeRunPromiseExitEffect(p(a,e),t):d.unsafeRunPromiseExit(a.cachedRuntime)(e,t),runCallback:(e,t)=>void 0===a.cachedRuntime?d.unsafeRunCallback(d.defaultRuntime)(p(a,e),t):d.unsafeRunCallback(a.cachedRuntime)(e,t),runPromise:(e,t)=>void 0===a.cachedRuntime?d.unsafeRunPromiseEffect(p(a,e),t):d.unsafeRunPromise(a.cachedRuntime)(e,t)});return a}],3275939);var m=e.i(3275939);e.s(["ManagedRuntime",0,m],8718972)},1445448,6503210,2726583,e=>{"use strict";var t=e.i(5450905);e.s(["Cause",0,t],1445448);var r=e.i(1331084);e.s(["Either",0,r],6503210);var i=e.i(7836076);e.s(["Exit",0,i],2726583)},4520167,e=>{"use strict";var t=e.i(9973079),r=e.i(9552070);e.s(["Any",()=>t.Any,"Array",()=>t.Array,"ArrayEnsure",()=>t.ArrayEnsure,"ArrayFormatterIssue",()=>t.ArrayFormatterIssue,"BetweenBigDecimalSchemaId",()=>t.BetweenBigDecimalSchemaId,"BetweenBigIntSchemaId",()=>t.BetweenBigIntSchemaId,"BetweenDateSchemaId",()=>t.BetweenDateSchemaId,"BetweenDurationSchemaId",()=>t.BetweenDurationSchemaId,"BetweenSchemaId",()=>t.BetweenSchemaId,"BigDecimal",()=>t.BigDecimal,"BigDecimalFromNumber",()=>t.BigDecimalFromNumber,"BigDecimalFromSelf",()=>t.BigDecimalFromSelf,"BigInt",()=>t.BigInt,"BigIntFromNumber",()=>t.BigIntFromNumber,"BigIntFromSelf",()=>t.BigIntFromSelf,"Boolean",()=>t.Boolean,"BooleanFromString",()=>t.BooleanFromString,"BooleanFromUnknown",()=>t.BooleanFromUnknown,"BrandSchemaId",()=>t.BrandSchemaId,"Capitalize",()=>t.Capitalize,"Capitalized",()=>t.Capitalized,"CapitalizedSchemaId",()=>t.CapitalizedSchemaId,"Cause",()=>t.Cause,"CauseFromSelf",()=>t.CauseFromSelf,"Char",()=>t.Char,"Chunk",()=>t.Chunk,"ChunkFromSelf",()=>t.ChunkFromSelf,"Class",()=>t.Class,"Config",()=>t.Config,"Data",()=>t.Data,"DataFromSelf",()=>t.DataFromSelf,"Date",()=>t.Date,"DateFromNumber",()=>t.DateFromNumber,"DateFromSelf",()=>t.DateFromSelf,"DateFromSelfSchemaId",()=>t.DateFromSelfSchemaId,"DateFromString",()=>t.DateFromString,"DateTimeUtc",()=>t.DateTimeUtc,"DateTimeUtcFromDate",()=>t.DateTimeUtcFromDate,"DateTimeUtcFromNumber",()=>t.DateTimeUtcFromNumber,"DateTimeUtcFromSelf",()=>t.DateTimeUtcFromSelf,"DateTimeZoned",()=>t.DateTimeZoned,"DateTimeZonedFromSelf",()=>t.DateTimeZonedFromSelf,"Defect",()=>t.Defect,"Duration",()=>t.Duration,"DurationFromMillis",()=>t.DurationFromMillis,"DurationFromNanos",()=>t.DurationFromNanos,"DurationFromSelf",()=>t.DurationFromSelf,"Either",()=>t.Either,"EitherFromSelf",()=>t.EitherFromSelf,"EitherFromUnion",()=>t.EitherFromUnion,"EndsWithSchemaId",()=>t.EndsWithSchemaId,"Enums",()=>t.Enums,"Exit",()=>t.Exit,"ExitFromSelf",()=>t.ExitFromSelf,"FiberId",()=>t.FiberId,"FiberIdFromSelf",()=>t.FiberIdFromSelf,"Finite",()=>t.Finite,"FiniteSchemaId",()=>t.FiniteSchemaId,"FromPropertySignature",()=>t.FromPropertySignature,"GreaterThanBigDecimalSchemaId",()=>t.GreaterThanBigDecimalSchemaId,"GreaterThanBigIntSchemaId",()=>t.GreaterThanBigIntSchemaId,"GreaterThanDateSchemaId",()=>t.GreaterThanDateSchemaId,"GreaterThanDurationSchemaId",()=>t.GreaterThanDurationSchemaId,"GreaterThanOrEqualToBigDecimalSchemaId",()=>t.GreaterThanOrEqualToBigDecimalSchemaId,"GreaterThanOrEqualToBigIntSchemaId",()=>t.GreaterThanOrEqualToBigIntSchemaId,"GreaterThanOrEqualToDateSchemaId",()=>t.GreaterThanOrEqualToDateSchemaId,"GreaterThanOrEqualToDurationSchemaId",()=>t.GreaterThanOrEqualToDurationSchemaId,"GreaterThanOrEqualToSchemaId",()=>t.GreaterThanOrEqualToSchemaId,"GreaterThanSchemaId",()=>t.GreaterThanSchemaId,"HashMap",()=>t.HashMap,"HashMapFromSelf",()=>t.HashMapFromSelf,"HashSet",()=>t.HashSet,"HashSetFromSelf",()=>t.HashSetFromSelf,"IncludesSchemaId",()=>t.IncludesSchemaId,"InstanceOfSchemaId",()=>t.InstanceOfSchemaId,"Int",()=>t.Int,"IntSchemaId",()=>t.IntSchemaId,"ItemsCountSchemaId",()=>t.ItemsCountSchemaId,"JsonNumber",()=>t.JsonNumber,"JsonNumberSchemaId",()=>t.JsonNumberSchemaId,"LengthSchemaId",()=>t.LengthSchemaId,"LessThanBigDecimalSchemaId",()=>t.LessThanBigDecimalSchemaId,"LessThanBigIntSchemaId",()=>t.LessThanBigIntSchemaId,"LessThanDateSchemaId",()=>t.LessThanDateSchemaId,"LessThanDurationSchemaId",()=>t.LessThanDurationSchemaId,"LessThanOrEqualToBigDecimalSchemaId",()=>t.LessThanOrEqualToBigDecimalSchemaId,"LessThanOrEqualToBigIntSchemaId",()=>t.LessThanOrEqualToBigIntSchemaId,"LessThanOrEqualToDateSchemaId",()=>t.LessThanOrEqualToDateSchemaId,"LessThanOrEqualToDurationSchemaId",()=>t.LessThanOrEqualToDurationSchemaId,"LessThanOrEqualToSchemaId",()=>t.LessThanOrEqualToSchemaId,"LessThanSchemaId",()=>t.LessThanSchemaId,"List",()=>t.List,"ListFromSelf",()=>t.ListFromSelf,"Literal",()=>t.Literal,"Lowercase",()=>t.Lowercase,"Lowercased",()=>t.Lowercased,"LowercasedSchemaId",()=>t.LowercasedSchemaId,"Map",()=>t.Map,"MapFromRecord",()=>t.MapFromRecord,"MapFromSelf",()=>t.MapFromSelf,"MaxItemsSchemaId",()=>t.MaxItemsSchemaId,"MaxLengthSchemaId",()=>t.MaxLengthSchemaId,"MinItemsSchemaId",()=>t.MinItemsSchemaId,"MinLengthSchemaId",()=>t.MinLengthSchemaId,"MultipleOfSchemaId",()=>t.MultipleOfSchemaId,"Negative",()=>t.Negative,"NegativeBigDecimalFromSelf",()=>t.NegativeBigDecimalFromSelf,"NegativeBigDecimalSchemaId",()=>t.NegativeBigDecimalSchemaId,"NegativeBigInt",()=>t.NegativeBigInt,"NegativeBigIntFromSelf",()=>t.NegativeBigIntFromSelf,"Never",()=>t.Never,"NonEmptyArray",()=>t.NonEmptyArray,"NonEmptyArrayEnsure",()=>t.NonEmptyArrayEnsure,"NonEmptyChunk",()=>t.NonEmptyChunk,"NonEmptyChunkFromSelf",()=>t.NonEmptyChunkFromSelf,"NonEmptyString",()=>t.NonEmptyString,"NonEmptyTrimmedString",()=>t.NonEmptyTrimmedString,"NonNaN",()=>t.NonNaN,"NonNaNSchemaId",()=>t.NonNaNSchemaId,"NonNegative",()=>t.NonNegative,"NonNegativeBigDecimalFromSelf",()=>t.NonNegativeBigDecimalFromSelf,"NonNegativeBigDecimalSchemaId",()=>t.NonNegativeBigDecimalSchemaId,"NonNegativeBigInt",()=>t.NonNegativeBigInt,"NonNegativeBigIntFromSelf",()=>t.NonNegativeBigIntFromSelf,"NonNegativeInt",()=>t.NonNegativeInt,"NonPositive",()=>t.NonPositive,"NonPositiveBigDecimalFromSelf",()=>t.NonPositiveBigDecimalFromSelf,"NonPositiveBigDecimalSchemaId",()=>t.NonPositiveBigDecimalSchemaId,"NonPositiveBigInt",()=>t.NonPositiveBigInt,"NonPositiveBigIntFromSelf",()=>t.NonPositiveBigIntFromSelf,"Not",()=>t.Not,"Null",()=>t.Null,"NullOr",()=>t.NullOr,"NullishOr",()=>t.NullishOr,"Number",()=>t.Number,"NumberFromString",()=>t.NumberFromString,"Object",()=>t.Object,"Option",()=>t.Option,"OptionFromNonEmptyTrimmedString",()=>t.OptionFromNonEmptyTrimmedString,"OptionFromNullOr",()=>t.OptionFromNullOr,"OptionFromNullishOr",()=>t.OptionFromNullishOr,"OptionFromSelf",()=>t.OptionFromSelf,"OptionFromUndefinedOr",()=>t.OptionFromUndefinedOr,"PatternSchemaId",()=>t.PatternSchemaId,"Positive",()=>t.Positive,"PositiveBigDecimalFromSelf",()=>t.PositiveBigDecimalFromSelf,"PositiveBigDecimalSchemaId",()=>t.PositiveBigDecimalSchemaId,"PositiveBigInt",()=>t.PositiveBigInt,"PositiveBigIntFromSelf",()=>t.PositiveBigIntFromSelf,"PropertyKey",()=>t.PropertyKey,"PropertySignatureDeclaration",()=>t.PropertySignatureDeclaration,"PropertySignatureTransformation",()=>t.PropertySignatureTransformation,"PropertySignatureTypeId",()=>t.PropertySignatureTypeId,"ReadonlyMap",()=>t.ReadonlyMap,"ReadonlyMapFromRecord",()=>t.ReadonlyMapFromRecord,"ReadonlyMapFromSelf",()=>t.ReadonlyMapFromSelf,"ReadonlySet",()=>t.ReadonlySet,"ReadonlySetFromSelf",()=>t.ReadonlySetFromSelf,"Record",()=>t.Record,"Redacted",()=>t.Redacted,"RedactedFromSelf",()=>t.RedactedFromSelf,"RefineSchemaId",()=>t.RefineSchemaId,"Set",()=>t.Set,"SetFromSelf",()=>t.SetFromSelf,"SortedSet",()=>t.SortedSet,"SortedSetFromSelf",()=>t.SortedSetFromSelf,"StartsWithSchemaId",()=>t.StartsWithSchemaId,"String",()=>t.String,"StringFromBase64",()=>t.StringFromBase64,"StringFromBase64Url",()=>t.StringFromBase64Url,"StringFromHex",()=>t.StringFromHex,"StringFromUriComponent",()=>t.StringFromUriComponent,"Struct",()=>t.Struct,"Symbol",()=>t.Symbol,"SymbolFromSelf",()=>t.SymbolFromSelf,"TaggedClass",()=>t.TaggedClass,"TaggedError",()=>t.TaggedError,"TaggedRequest",()=>t.TaggedRequest,"TaggedStruct",()=>t.TaggedStruct,"TemplateLiteral",()=>t.TemplateLiteral,"TemplateLiteralParser",()=>t.TemplateLiteralParser,"TimeZone",()=>t.TimeZone,"TimeZoneFromSelf",()=>t.TimeZoneFromSelf,"TimeZoneNamed",()=>t.TimeZoneNamed,"TimeZoneNamedFromSelf",()=>t.TimeZoneNamedFromSelf,"TimeZoneOffset",()=>t.TimeZoneOffset,"TimeZoneOffsetFromSelf",()=>t.TimeZoneOffsetFromSelf,"ToPropertySignature",()=>t.ToPropertySignature,"Trim",()=>t.Trim,"Trimmed",()=>t.Trimmed,"TrimmedSchemaId",()=>t.TrimmedSchemaId,"Tuple",()=>t.Tuple,"TypeId",()=>t.TypeId,"ULID",()=>t.ULID,"ULIDSchemaId",()=>t.ULIDSchemaId,"URL",()=>t.URL,"URLFromSelf",()=>t.URLFromSelf,"UUID",()=>t.UUID,"UUIDSchemaId",()=>t.UUIDSchemaId,"Uint8",()=>t.Uint8,"Uint8Array",()=>t.Uint8Array,"Uint8ArrayFromBase64",()=>t.Uint8ArrayFromBase64,"Uint8ArrayFromBase64Url",()=>t.Uint8ArrayFromBase64Url,"Uint8ArrayFromHex",()=>t.Uint8ArrayFromHex,"Uint8ArrayFromSelf",()=>t.Uint8ArrayFromSelf,"Uncapitalize",()=>t.Uncapitalize,"Uncapitalized",()=>t.Uncapitalized,"UncapitalizedSchemaId",()=>t.UncapitalizedSchemaId,"Undefined",()=>t.Undefined,"UndefinedOr",()=>t.UndefinedOr,"Union",()=>t.Union,"UniqueSymbolFromSelf",()=>t.UniqueSymbolFromSelf,"Unknown",()=>t.Unknown,"Uppercase",()=>t.Uppercase,"Uppercased",()=>t.Uppercased,"UppercasedSchemaId",()=>t.UppercasedSchemaId,"ValidDateFromSelf",()=>t.ValidDateFromSelf,"ValidDateSchemaId",()=>t.ValidDateSchemaId,"Void",()=>t.Void,"annotations",()=>t.annotations,"asSchema",()=>t.asSchema,"asSerializable",()=>t.asSerializable,"asSerializableWithResult",()=>t.asSerializableWithResult,"asWithResult",()=>t.asWithResult,"asserts",()=>r.asserts,"attachPropertySignature",()=>t.attachPropertySignature,"between",()=>t.between,"betweenBigDecimal",()=>t.betweenBigDecimal,"betweenBigInt",()=>t.betweenBigInt,"betweenDate",()=>t.betweenDate,"betweenDuration",()=>t.betweenDuration,"brand",()=>t.brand,"capitalized",()=>t.capitalized,"clamp",()=>t.clamp,"clampBigDecimal",()=>t.clampBigDecimal,"clampBigInt",()=>t.clampBigInt,"clampDuration",()=>t.clampDuration,"compose",()=>t.compose,"declare",()=>t.declare,"decode",()=>t.decode,"decodeEither",()=>t.decodeEither,"decodeOption",()=>r.decodeOption,"decodePromise",()=>t.decodePromise,"decodeSync",()=>r.decodeSync,"decodeUnknown",()=>t.decodeUnknown,"decodeUnknownEither",()=>t.decodeUnknownEither,"decodeUnknownOption",()=>r.decodeUnknownOption,"decodeUnknownPromise",()=>t.decodeUnknownPromise,"decodeUnknownSync",()=>r.decodeUnknownSync,"deserialize",()=>t.deserialize,"deserializeExit",()=>t.deserializeExit,"deserializeFailure",()=>t.deserializeFailure,"deserializeSuccess",()=>t.deserializeSuccess,"element",()=>t.element,"encode",()=>t.encode,"encodeEither",()=>t.encodeEither,"encodeOption",()=>r.encodeOption,"encodePromise",()=>t.encodePromise,"encodeSync",()=>r.encodeSync,"encodeUnknown",()=>t.encodeUnknown,"encodeUnknownEither",()=>t.encodeUnknownEither,"encodeUnknownOption",()=>r.encodeUnknownOption,"encodeUnknownPromise",()=>t.encodeUnknownPromise,"encodeUnknownSync",()=>r.encodeUnknownSync,"encodedBoundSchema",()=>t.encodedBoundSchema,"encodedSchema",()=>t.encodedSchema,"endsWith",()=>t.endsWith,"equivalence",()=>t.equivalence,"exitSchema",()=>t.exitSchema,"extend",()=>t.extend,"failureSchema",()=>t.failureSchema,"filter",()=>t.filter,"filterEffect",()=>t.filterEffect,"finite",()=>t.finite,"format",()=>t.format,"fromBrand",()=>t.fromBrand,"fromKey",()=>t.fromKey,"getClassTag",()=>t.getClassTag,"getNumberIndexedAccess",()=>t.getNumberIndexedAccess,"greaterThan",()=>t.greaterThan,"greaterThanBigDecimal",()=>t.greaterThanBigDecimal,"greaterThanBigInt",()=>t.greaterThanBigInt,"greaterThanDate",()=>t.greaterThanDate,"greaterThanDuration",()=>t.greaterThanDuration,"greaterThanOrEqualTo",()=>t.greaterThanOrEqualTo,"greaterThanOrEqualToBigDecimal",()=>t.greaterThanOrEqualToBigDecimal,"greaterThanOrEqualToBigInt",()=>t.greaterThanOrEqualToBigInt,"greaterThanOrEqualToDate",()=>t.greaterThanOrEqualToDate,"greaterThanOrEqualToDuration",()=>t.greaterThanOrEqualToDuration,"head",()=>t.head,"headNonEmpty",()=>t.headNonEmpty,"headOrElse",()=>t.headOrElse,"includes",()=>t.includes,"instanceOf",()=>t.instanceOf,"int",()=>t.int,"is",()=>r.is,"isPropertySignature",()=>t.isPropertySignature,"isSchema",()=>t.isSchema,"itemsCount",()=>t.itemsCount,"keyof",()=>t.keyof,"length",()=>t.length,"lessThan",()=>t.lessThan,"lessThanBigDecimal",()=>t.lessThanBigDecimal,"lessThanBigInt",()=>t.lessThanBigInt,"lessThanDate",()=>t.lessThanDate,"lessThanDuration",()=>t.lessThanDuration,"lessThanOrEqualTo",()=>t.lessThanOrEqualTo,"lessThanOrEqualToBigDecimal",()=>t.lessThanOrEqualToBigDecimal,"lessThanOrEqualToBigInt",()=>t.lessThanOrEqualToBigInt,"lessThanOrEqualToDate",()=>t.lessThanOrEqualToDate,"lessThanOrEqualToDuration",()=>t.lessThanOrEqualToDuration,"lowercased",()=>t.lowercased,"make",()=>t.make,"makePropertySignature",()=>t.makePropertySignature,"maxItems",()=>t.maxItems,"maxLength",()=>t.maxLength,"minItems",()=>t.minItems,"minLength",()=>t.minLength,"multipleOf",()=>t.multipleOf,"mutable",()=>t.mutable,"negative",()=>t.negative,"negativeBigDecimal",()=>t.negativeBigDecimal,"negativeBigInt",()=>t.negativeBigInt,"nonEmptyString",()=>t.nonEmptyString,"nonNaN",()=>t.nonNaN,"nonNegative",()=>t.nonNegative,"nonNegativeBigDecimal",()=>t.nonNegativeBigDecimal,"nonNegativeBigInt",()=>t.nonNegativeBigInt,"nonPositive",()=>t.nonPositive,"nonPositiveBigDecimal",()=>t.nonPositiveBigDecimal,"nonPositiveBigInt",()=>t.nonPositiveBigInt,"omit",()=>t.omit,"optional",()=>t.optional,"optionalElement",()=>t.optionalElement,"optionalToOptional",()=>t.optionalToOptional,"optionalToRequired",()=>t.optionalToRequired,"optionalWith",()=>t.optionalWith,"parseJson",()=>t.parseJson,"parseNumber",()=>t.parseNumber,"partial",()=>t.partial,"partialWith",()=>t.partialWith,"pattern",()=>t.pattern,"pick",()=>t.pick,"pickLiteral",()=>t.pickLiteral,"pluck",()=>t.pluck,"positive",()=>t.positive,"positiveBigDecimal",()=>t.positiveBigDecimal,"positiveBigInt",()=>t.positiveBigInt,"propertySignature",()=>t.propertySignature,"rename",()=>t.rename,"required",()=>t.required,"requiredToOptional",()=>t.requiredToOptional,"serializableSchema",()=>t.serializableSchema,"serialize",()=>t.serialize,"serializeExit",()=>t.serializeExit,"serializeFailure",()=>t.serializeFailure,"serializeSuccess",()=>t.serializeSuccess,"split",()=>t.split,"standardSchemaV1",()=>t.standardSchemaV1,"startsWith",()=>t.startsWith,"successSchema",()=>t.successSchema,"suspend",()=>t.suspend,"symbolSerializable",()=>t.symbolSerializable,"symbolWithResult",()=>t.symbolWithResult,"tag",()=>t.tag,"transform",()=>t.transform,"transformLiteral",()=>t.transformLiteral,"transformLiterals",()=>t.transformLiterals,"transformOrFail",()=>t.transformOrFail,"trimmed",()=>t.trimmed,"typeSchema",()=>t.typeSchema,"uncapitalized",()=>t.uncapitalized,"uppercased",()=>t.uppercased,"validDate",()=>t.validDate,"validate",()=>t.validate,"validateEither",()=>t.validateEither,"validateOption",()=>r.validateOption,"validatePromise",()=>t.validatePromise,"validateSync",()=>r.validateSync,"withConstructorDefault",()=>t.withConstructorDefault,"withDecodingDefault",()=>t.withDecodingDefault,"withDefaults",()=>t.withDefaults],4878902);var i=e.i(4878902);e.s(["Schema",0,i],4520167)},7118357,e=>{"use strict";var t=e.i(1445448),r=e.i(6503210),i=e.i(2726583);let n=e.i(4520167).Schema.String;e.s(["StringWithEmptyObject",0,n,"createContextKeyFn",0,function(e){let t=e.startsWith("@")?e.slice(1):e;return function(e){return`@${t}/${e}`}},"makeRunPromiseSettledResult",0,e=>async(n,a)=>e.runPromiseExit(n,{signal:a?.signal}).then(e=>{if(i.Exit.isSuccess(e))return{status:"fulfilled",value:e.value};let n=t.Cause.failureOrCause(e.cause);return{status:"rejected",reason:r.Either.match(n,{onLeft:e=>({kind:"expected",error:e}),onRight:e=>({kind:"unexpected",error:t.Cause.squash(e)})})}})])},6872829,9642932,2940189,e=>{"use strict";var t=e.i(8554418);e.s(["Stream",0,t],6872829);let r=(0,e.i(7118357).createContextKeyFn)("domains");e.s(["createContextKey",0,r],9642932);var i=e.i(6098979),n=e.i(9674368),a=e.i(3683485),s=e.i(9159985),o=e.i(2873450),l=e.i(4935619),u=e.i(2170327),c=e.i(4434603),d=e.i(9973079),p=e.i(9333060);let f=Symbol.for("@effect/platform/Headers"),h=e=>l.hasProperty(e,f),m=Object.assign(Object.create(null),{[f]:f,[o.symbolRedactable](e){return C(this,n.getOrDefault(e,R))}}),g=e=>Object.assign(Object.create(m),e),y=d.declare(h,{identifier:"Headers",equivalence:()=>u.getEquivalence(p.Equivalence)}),S=d.transform(d.Record({key:d.String,value:d.String}),y,{strict:!0,decode:e=>v(e),encode:a.identity}),b=Object.create(m),v=e=>{if(void 0===e)return b;if(Symbol.iterator in e){let t=Object.create(m);for(let[r,i]of e)t[r.toLowerCase()]=i;return t}let t=Object.create(m);for(let[r,i]of Object.entries(e))Array.isArray(i)?t[r.toLowerCase()]=i.join(", "):void 0!==i&&(t[r.toLowerCase()]=i);return t},E=(0,a.dual)(2,(e,t)=>t.toLowerCase()in e),w=(0,a.dual)(2,(e,t)=>u.get(e,t.toLowerCase())),k=(0,a.dual)(3,(e,t,r)=>{let i=g(e);return i[t.toLowerCase()]=r,i}),I=(0,a.dual)(2,(e,t)=>g({...e,...v(t)})),T=(0,a.dual)(2,(e,t)=>{let r=g(e);return Object.assign(r,t),r}),x=(0,a.dual)(2,(e,t)=>{let r=g(e),i=t=>{if("string"==typeof t){let i=t.toLowerCase();i in e&&delete r[i]}else for(let i in e)t.test(i)&&delete r[i]};if(Array.isArray(t))for(let e=0;e<t.length;e++)i(t[e]);else i(t);return r}),C=(0,a.dual)(2,(e,t)=>{let r={...e},i=t=>{if("string"==typeof t){let i=t.toLowerCase();i in e&&(r[i]=c.make(e[i]))}else for(let i in e)t.test(i)&&(r[i]=c.make(e[i]))};if(Array.isArray(t))for(let e=0;e<t.length;e++)i(t[e]);else i(t);return r}),R=(0,s.globalValue)("@effect/platform/Headers/currentRedactedNames",()=>i.unsafeMake(["authorization","cookie","set-cookie","x-api-key"]));e.s(["HeadersTypeId",0,f,"currentRedactedNames",0,R,"empty",0,b,"fromInput",0,v,"get",0,w,"has",0,E,"isHeaders",0,h,"merge",0,T,"redact",0,C,"remove",0,x,"schema",0,S,"schemaFromSelf",0,y,"set",0,k,"setAll",0,I,"unsafeFromRecord",0,e=>Object.setPrototypeOf(e,m)],2940189)},6529707,1340413,e=>{"use strict";var t=e.i(4935619),r=e.i(8643033);let i=Symbol.for("@effect/platform/HttpClientError");class n extends r.TypeIdError(i,"RequestError"){get methodAndUrl(){return`${this.request.method} ${this.request.url}`}get message(){return this.description?`${this.reason}: ${this.description} (${this.methodAndUrl})`:`${this.reason} error (${this.methodAndUrl})`}}class a extends r.TypeIdError(i,"ResponseError"){get methodAndUrl(){return`${this.request.method} ${this.request.url}`}get message(){let e=`${this.response.status} ${this.methodAndUrl}`;return this.description?`${this.reason}: ${this.description} (${e})`:`${this.reason} error (${e})`}}e.s(["RequestError",0,n,"ResponseError",0,a,"isHttpClientError",0,e=>(0,t.hasProperty)(e,i)],6529707);var s=e.i(8973103),o=e.i(1331084),l=e.i(3683485),u=e.i(2873450),c=e.i(8815901),d=e.i(9960543),p=e.i(2170327),f=r;let h=Symbol.for("@effect/platform/Cookies"),m=Symbol.for("@effect/platform/Cookies/Cookie"),g=Symbol.for("@effect/platform/Cookies/CookieError");class y extends(0,f.TypeIdError)(g,"CookieError"){get message(){return this.reason}}let S={[h]:h,...u.BaseProto,toJSON(){return{_id:"@effect/platform/Cookies",cookies:p.map(this.cookies,e=>e.toJSON())}},pipe(){return(0,d.pipeArguments)(this,arguments)}},b=e=>{let t=Object.create(S);return t.cookies=e,t},v=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,E={[m]:m,...u.BaseProto,toJSON(){return{_id:"@effect/platform/Cookies/Cookie",name:this.name,value:this.value,options:this.options}}},w=(0,l.dual)(2,(e,t)=>b({...e.cookies,...t.cookies})),k=((e,t)=>{let r={...e.cookies};for(let[e,i,n]of t){let t=function(e,t,r){if(!v.test(e))return o.left(new y({reason:"InvalidName"}));let i=encodeURIComponent(t);if(i&&!v.test(i))return o.left(new y({reason:"InvalidValue"}));if(void 0!==r){if(void 0!==r.domain&&!v.test(r.domain))return o.left(new y({reason:"InvalidDomain"}));if(void 0!==r.path&&!v.test(r.path))return o.left(new y({reason:"InvalidPath"}));if(void 0!==r.maxAge&&!s.isFinite(s.decode(r.maxAge)))return o.left(new y({reason:"InfinityMaxAge"}))}return o.right(Object.assign(Object.create(E),{name:e,value:t,valueEncoded:i,options:r}))}(e,i,n);if(o.isLeft(t))return t;r[e]=t.right}return o.right(b(r))},e=>{try{return decodeURIComponent(e)}catch{return e}});e.s(["fromSetCookie",0,e=>{let t=[];for(let r of"string"==typeof e?[e]:e){let e=function(e){let t=e.split(";").map(e=>e.trim()).filter(e=>""!==e);if(0===t.length)return c.none();let r=t[0].indexOf("=");if(-1===r)return c.none();let i=t[0].slice(0,r);if(!v.test(i))return c.none();let n=t[0].slice(r+1),a=k(n);if(1===t.length)return c.some(Object.assign(Object.create(E),{name:i,value:a,valueEncoded:n}));let o={};for(let e=1;e<t.length;e++){let r=t[e],i=r.indexOf("="),n=-1===i?r:r.slice(0,i).trim(),a=-1===i?void 0:r.slice(i+1).trim();switch(n.toLowerCase()){case"domain":{if(void 0===a)break;let e=a.trim().replace(/^\./,"");e&&(o.domain=e);break}case"expires":{if(void 0===a)break;let e=new Date(a);isNaN(e.getTime())||(o.expires=e);break}case"max-age":{if(void 0===a)break;let e=parseInt(a,10);isNaN(e)||(o.maxAge=s.seconds(e));break}case"path":if(void 0===a)break;"/"===a[0]&&(o.path=a);break;case"priority":if(void 0===a)break;switch(a.toLowerCase()){case"low":o.priority="low";break;case"medium":o.priority="medium";break;case"high":o.priority="high"}break;case"httponly":o.httpOnly=!0;break;case"secure":o.secure=!0;break;case"partitioned":o.partitioned=!0;break;case"samesite":if(void 0===a)break;switch(a.toLowerCase()){case"lax":o.sameSite="lax";break;case"strict":o.sameSite="strict";break;case"none":o.sameSite="none"}}}return c.some(Object.assign(Object.create(E),{name:i,value:a,valueEncoded:n,options:Object.keys(o).length>0?o:void 0}))}(r.trim());c.isSome(e)&&t.push(e.value)}let r={};for(let e of t)r[e.name]=e;return b(r)},"isEmpty",0,e=>p.isEmptyRecord(e.cookies),"merge",0,w,"toCookieHeader",0,e=>Object.values(e.cookies).map(e=>`${e.name}=${e.valueEncoded}`).join("; ")],1340413)},2051545,8404901,6076596,3302588,7877750,8460856,9679606,7069118,e=>{"use strict";let t;var r=e.i(5972454),i=e.i(3322401),n=e.i(6098979),a=e.i(8554418),s=e.i(2940189),o=e.i(6529707),l=e.i(5450905),u=e.i(3683485),c=e.i(9159985),d=e.i(2873450),p=e.i(9227260),f=e.i(9960543),h=e.i(4935619),m=e.i(6532885),g=e.i(7703391),y=e.i(5160412),S=e.i(1340413),b=r,v=e.i(8815901),E=e.i(9973079),w=e.i(4426485),k=e.i(5283034),I=e.i(1331084);let T=e=>{let t=x(e),r=[];for(let e=0;e<t.length;e++)if(Array.isArray(t[e][0])){let[i,n]=t[e];r.push([`${i[0]}[${i.slice(1).join("][")}]`,n])}else r.push(t[e]);return r},x=e=>{let t=Symbol.iterator in e?k.fromIterable(e):Object.entries(e),r=[];for(let[e,i]of t)if(Array.isArray(i))for(let t=0;t<i.length;t++)void 0!==i[t]&&r.push([e,String(i[t])]);else if("object"==typeof i)for(let[t,n]of x(i))r.push([[e,..."string"==typeof t?[t]:t],n]);else void 0!==i&&r.push([e,String(i)]);return r},C=(0,u.dual)(3,(e,t,r)=>k.append(k.filter(e,e=>{let[r]=e;return r!==t}),[t,String(r)])),R=(0,u.dual)(2,(e,t)=>{let r=T(t),i=r.map(e=>{let[t]=e;return t});return k.appendAll(k.filter(e,e=>{let[t]=e;return i.includes(t)}),r)}),F=(0,u.dual)(3,(e,t,r)=>k.append(e,[t,String(r)])),A=(0,u.dual)(2,(e,t)=>k.appendAll(e,T(t))),O=(e,t,r)=>{try{let i=new URL(e,_());for(let e=0;e<t.length;e++){let[r,n]=t[e];void 0!==n&&i.searchParams.append(r,n)}return"Some"===r._tag&&(i.hash=r.value),I.right(i)}catch(e){return I.left(e)}},_=()=>{if("location"in globalThis&&void 0!==globalThis.location&&void 0!==globalThis.location.origin&&void 0!==globalThis.location.pathname)return location.origin+location.pathname};E.String;let M=Symbol.for("@effect/platform/HttpIncomingMessage");v.none,e.i(1253121);var D=e.i(4434603),N=e.i(5305881);let P=Symbol.for("@effect/platform/HttpBody"),L=Symbol.for("@effect/platform/HttpBody/HttpBodyError"),U=N.tagged("HttpBodyError"),z=e=>U({[L]:L,reason:e});class W{[P];constructor(){this[P]=P}[d.NodeInspectSymbol](){return this.toJSON()}toString(){return d.format(this)}}let B=new class extends W{_tag="Empty";toJSON(){return{_id:"@effect/platform/HttpBody",_tag:"Empty"}}};class q extends W{body;contentType;_tag="Uint8Array";constructor(e,t){super(),this.body=e,this.contentType=t}get contentLength(){return this.body.length}toJSON(){return{_id:"@effect/platform/HttpBody",_tag:"Uint8Array",body:this.contentType.startsWith("text/")||this.contentType.endsWith("json")?new TextDecoder().decode(this.body):`Uint8Array(${this.body.length})`,contentType:this.contentType,contentLength:this.contentLength}}}let $=(e,t)=>new q(e,t??"application/octet-stream"),j=new TextEncoder,V=(e,t)=>$(j.encode(e),t??"text/plain"),H=e=>V(JSON.stringify(e),"application/json"),G=e=>i.try({try:()=>H(e),catch:e=>z({_tag:"JsonError",error:e})});class K extends W{formData;_tag="FormData";constructor(e){super(),this.formData=e}toJSON(){return{_id:"@effect/platform/HttpBody",_tag:"FormData",formData:this.formData}}}class J extends W{stream;contentType;contentLength;_tag="Stream";constructor(e,t,r){super(),this.stream=e,this.contentType=t,this.contentLength=r}toJSON(){return{_id:"@effect/platform/HttpBody",_tag:"Stream",contentType:this.contentType,contentLength:this.contentLength}}}let Z=(e,t,r)=>new J(e,t??"application/octet-stream",r),Q=Symbol.for("@effect/platform/HttpClientRequest"),Y={[Q]:Q,...d.BaseProto,toJSON(){return{_id:"@effect/platform/HttpClientRequest",method:this.method,url:this.url,urlParams:this.urlParams,hash:this.hash,headers:d.redact(this.headers),body:this.body.toJSON()}},pipe(){return(0,f.pipeArguments)(this,arguments)}};function X(e,t,r,i,n,a){let s=Object.create(Y);return s.method=e,s.url=t,s.urlParams=r,s.hash=i,s.headers=n,s.body=a,s}let ee=e=>"object"==typeof e&&null!==e&&Q in e,et=X("GET","",[],v.none(),s.empty,B),er=e=>(t,r)=>ec(et,{method:e,url:t,...r??void 0}),ei=er("GET"),en=er("POST"),ea=er("PUT"),es=er("PATCH"),eo=er("DELETE"),el=er("HEAD"),eu=er("OPTIONS"),ec=(0,u.dual)(2,(e,t)=>{let r=e;return t.method&&(r=eS(r,t.method)),t.url&&(r=eb(r,t.url)),t.headers&&(r=ep(r,t.headers)),t.urlParams&&(r=ex(r,t.urlParams)),t.hash&&(r=eC(r,t.hash)),t.body&&(r=eR(r,t.body)),t.accept&&(r=eg(r,t.accept)),t.acceptJson&&(r=ey(r)),r}),ed=(0,u.dual)(3,(e,t,r)=>X(e.method,e.url,e.urlParams,e.hash,s.set(e.headers,t,r),e.body)),ep=(0,u.dual)(2,(e,t)=>X(e.method,e.url,e.urlParams,e.hash,s.setAll(e.headers,t),e.body)),ef=e=>"string"==typeof e?e:D.value(e),eh=(0,u.dual)(3,(e,t,r)=>ed(e,"Authorization",`Basic ${btoa(`${ef(t)}:${ef(r)}`)}`)),em=(0,u.dual)(2,(e,t)=>ed(e,"Authorization",`Bearer ${ef(t)}`)),eg=(0,u.dual)(2,(e,t)=>ed(e,"Accept",t)),ey=eg("application/json"),eS=(0,u.dual)(2,(e,t)=>X(t,e.url,e.urlParams,e.hash,e.headers,e.body)),eb=(0,u.dual)(2,(e,t)=>{if("string"==typeof t)return X(e.method,t,e.urlParams,e.hash,e.headers,e.body);let r=new URL(t.toString()),i=T(r.searchParams),n=r.hash?v.some(r.hash.slice(1)):v.none();return r.search="",r.hash="",X(e.method,r.toString(),i,n,e.headers,e.body)}),ev=(0,u.dual)(2,(e,t)=>X(e.method,e.url.endsWith("/")&&t.startsWith("/")?e.url+t.slice(1):e.url+t,e.urlParams,e.hash,e.headers,e.body)),eE=(0,u.dual)(2,(e,t)=>X(e.method,t.endsWith("/")&&e.url.startsWith("/")?t+e.url.slice(1):t+e.url,e.urlParams,e.hash,e.headers,e.body)),ew=(0,u.dual)(2,(e,t)=>X(e.method,t(e.url),e.urlParams,e.hash,e.headers,e.body)),ek=(0,u.dual)(3,(e,t,r)=>X(e.method,e.url,F(e.urlParams,t,r),e.hash,e.headers,e.body)),eI=(0,u.dual)(2,(e,t)=>X(e.method,e.url,A(e.urlParams,t),e.hash,e.headers,e.body)),eT=(0,u.dual)(3,(e,t,r)=>X(e.method,e.url,C(e.urlParams,t,r),e.hash,e.headers,e.body)),ex=(0,u.dual)(2,(e,t)=>X(e.method,e.url,R(e.urlParams,t),e.hash,e.headers,e.body)),eC=(0,u.dual)(2,(e,t)=>X(e.method,e.url,e.urlParams,v.some(t),e.headers,e.body)),eR=(0,u.dual)(2,(e,t)=>{let r=e.headers;if("Empty"===t._tag||"FormData"===t._tag)r=s.remove(r,["Content-type","Content-length"]);else{let e=t.contentType;e&&(r=s.set(r,"content-type",e));let i=t.contentLength;i&&(r=s.set(r,"content-length",i.toString()))}return X(e.method,e.url,e.urlParams,e.hash,r,t)}),eF=(0,u.dual)(e=>ee(e[0]),function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"application/octet-stream";return eR(e,$(t,r))}),eA=(0,u.dual)(e=>ee(e[0]),function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"text/plain";return eR(e,V(t,r))}),eO=(0,u.dual)(2,(e,t)=>i.map(G(t),t=>eR(e,t))),e_=(0,u.dual)(2,(e,t)=>eR(e,H(t))),eM=(0,u.dual)(e=>ee(e[0]),(e,t,r)=>i.map(i.flatMap(w.FileSystem,e=>i.map(e.stat(t),i=>Z(e.stream(t,r),r?.contentType,Number(i.size)))),t=>eR(e,t))),eD=(0,u.dual)(2,(e,t)=>eR(e,Z(a.fromReadableStream(()=>t.stream(),u.identity),t.type,t.size))),eN=(0,u.dual)(2,(e,t)=>eR(e,V(new URLSearchParams(T(t)).toString(),"application/x-www-form-urlencoded"))),eP=(0,u.dual)(2,(e,t)=>eR(e,new K(t))),eL=(0,u.dual)(2,(e,t)=>eR(e,(e=>{let t=new FormData;for(let[r,i]of Object.entries(e))if(Array.isArray(i))for(let e of i)null!=e&&t.append(r,"object"==typeof i?e:String(e));else null!=i&&t.append(r,"object"==typeof i?i:String(i));return new K(t)})(t))),eU=(0,u.dual)(e=>ee(e[0]),function(e,t){let{contentLength:r,contentType:i="application/octet-stream"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return eR(e,Z(t,i,r))});var ez=d;let eW=Symbol.for("@effect/platform/HttpClientResponse");class eB extends ez.Class{request;source;[M];[eW];constructor(e,t){super(),this.request=e,this.source=t,this[M]=M,this[eW]=eW}toJSON(){return((e,t)=>{let r,n=e.headers["content-type"]??"";if(n.includes("application/json"))try{r=i.runSync(e.json)}catch{}else if(n.includes("text/")||n.includes("urlencoded"))try{r=i.runSync(e.text)}catch{}let a={...t,headers:d.redact(e.headers),remoteAddress:e.remoteAddress.toJSON()};return void 0!==r&&(a.body=r),a})(this,{_id:"@effect/platform/HttpClientResponse",request:this.request.toJSON(),status:this.status})}get status(){return this.source.status}get headers(){return s.fromInput(this.source.headers)}cachedCookies;get cookies(){return this.cachedCookies?this.cachedCookies:this.cachedCookies=S.fromSetCookie(this.source.headers.getSetCookie())}get remoteAddress(){return v.none()}get stream(){return this.source.body?a.fromReadableStream(()=>this.source.body,e=>new o.ResponseError({request:this.request,response:this,reason:"Decode",cause:e})):a.fail(new o.ResponseError({request:this.request,response:this,reason:"EmptyBody",description:"can not create stream from empty body"}))}get json(){return i.tryMap(this.text,{try:e=>""===e?null:JSON.parse(e),catch:e=>new o.ResponseError({request:this.request,response:this,reason:"Decode",cause:e})})}textBody;get text(){return this.textBody??=i.tryPromise({try:()=>this.source.text(),catch:e=>new o.ResponseError({request:this.request,response:this,reason:"Decode",cause:e})}).pipe(i.cached,i.runSync)}get urlParamsBody(){return i.flatMap(this.text,e=>i.try({try:()=>T(new URLSearchParams(e)),catch:e=>new o.ResponseError({request:this.request,response:this,reason:"Decode",cause:e})}))}formDataBody;get formData(){return this.formDataBody??=i.tryPromise({try:()=>this.source.formData(),catch:e=>new o.ResponseError({request:this.request,response:this,reason:"Decode",cause:e})}).pipe(i.cached,i.runSync)}arrayBufferBody;get arrayBuffer(){return this.arrayBufferBody??=i.tryPromise({try:()=>this.source.arrayBuffer(),catch:e=>new o.ResponseError({request:this.request,response:this,reason:"Decode",cause:e})}).pipe(i.cached,i.runSync)}}let eq=(0,u.dual)(2,(e,t)=>i.suspend(()=>t(e.status)?i.succeed(e):i.fail(new o.ResponseError({response:e,request:e.request,reason:"StatusCode",description:"invalid status code"})))),e$=e=>e.status>=200&&e.status<300?i.succeed(e):i.fail(new o.ResponseError({response:e,request:e.request,reason:"StatusCode",description:"non 2xx status code"})),ej=e=>`http.request.header.${e}`,eV=e=>`http.response.header.${e}`,eH=Symbol.for("@effect/platform/HttpClient"),eG=r.GenericTag("@effect/platform/HttpClient"),eK=(0,c.globalValue)(Symbol.for("@effect/platform/HttpClient/tracerDisabledWhen"),()=>n.unsafeMake(u.constFalse)),eJ=(0,u.dual)(2,(e,t)=>ts(e,i.locally(eK,t))),eZ=(0,c.globalValue)(Symbol.for("@effect/platform/HttpClient/currentTracerPropagation"),()=>n.unsafeMake(!0)),eQ=(0,u.dual)(2,(e,t)=>ts(e,i.locally(eZ,t))),eY=r.Reference()("@effect/platform/HttpClient/SpanNameGenerator",{defaultValue:()=>e=>`http.client ${e.method}`}),eX=(0,u.dual)(2,(e,t)=>ts(e,i.provideService(eY,t))),e0={[eH]:eH,pipe(){return(0,f.pipeArguments)(this,arguments)},...d.BaseProto,toJSON:()=>({_id:"@effect/platform/HttpClient"}),get(e,t){return this.execute(ei(e,t))},head(e,t){return this.execute(el(e,t))},post(e,t){return this.execute(en(e,t))},put(e,t){return this.execute(ea(e,t))},patch(e,t){return this.execute(es(e,t))},del(e,t){return this.execute(eo(e,t))},options(e,t){return this.execute(eu(e,t))}},e1=(e,t)=>{let r=Object.create(e0);return r.preprocess=t,r.postprocess=e,r.execute=function(r){return e(t(r))},r},e2=(0,c.globalValue)("@effect/platform/HttpClient/responseRegistry",()=>{if("FinalizationRegistry"in globalThis&&globalThis.FinalizationRegistry){let e=new FinalizationRegistry(e=>{e.abort()});return{register(t,r){e.register(t,r,t)},unregister(t){e.unregister(t)}}}let e=new Map;return{register(t,r){e.set(t,setTimeout(()=>r.abort(),5e3))},unregister(t){let r=e.get(t);void 0!==r&&(clearTimeout(r),e.delete(t))}}}),e5=(0,c.globalValue)("@effect/platform/HttpClient/scopedRequests",()=>new WeakMap),e3=e=>e1(t=>i.flatMap(t,t=>i.withFiberRuntime(a=>{let u=e5.get(t),c=u??new AbortController,d=O(t.url,t.urlParams,t.hash);if("Left"===d._tag)return i.fail(new o.RequestError({request:t,reason:"InvalidUrl",cause:d.left}));let p=d.right;if(!a.getFiberRef(n.currentTracerEnabled)||a.getFiberRef(eK)(t)){let r=e(t,p,c.signal,a);return u?r:i.uninterruptibleMask(e=>i.matchCauseEffect(e(r),{onSuccess:e=>(e2.register(e,c),i.succeed(new e8(e,c))),onFailure:e=>(l.isInterrupted(e)&&c.abort(),i.failCause(e))}))}let f=r.get(a.currentContext,eY);return i.useSpan(f(t),{kind:"client",captureStackTrace:!1},r=>{r.attribute("http.request.method",t.method),r.attribute("server.address",p.origin),""!==p.port&&r.attribute("server.port",+p.port),r.attribute("url.full",p.toString()),r.attribute("url.path",p.pathname),r.attribute("url.scheme",p.protocol.slice(0,-1));let n=p.search.slice(1);""!==n&&r.attribute("url.query",n);let o=a.getFiberRef(s.currentRedactedNames),d=s.redact(t.headers,o);for(let e in d)r.attribute(ej(e),String(d[e]));return t=a.getFiberRef(eZ)?ep(t,s.unsafeFromRecord({b3:`${r.traceId}-${r.spanId}-${r.sampled?"1":"0"}${"Some"===r.parent._tag?`-${r.parent.value.spanId}`:""}`,traceparent:`00-${r.traceId}-${r.spanId}-${r.sampled?"01":"00"}`})):t,i.uninterruptibleMask(n=>n(e(t,p,c.signal,a)).pipe(i.withParentSpan(r),i.matchCauseEffect({onSuccess:e=>{r.attribute("http.response.status_code",e.status);let t=s.redact(e.headers,o);for(let e in t)r.attribute(eV(e),String(t[e]));return u?i.succeed(e):(e2.register(e,c),i.succeed(new e8(e,c)))},onFailure:e=>(!u&&l.isInterrupted(e)&&c.abort(),i.failCause(e))})))})})),i.succeed);class e8{original;controller;constructor(e,t){this.original=e,this.controller=t}[eW]=eW;[M]=M;applyInterrupt(e){return i.suspend(()=>(e2.unregister(this.original),i.onInterrupt(e,()=>i.sync(()=>{this.controller.abort()}))))}get request(){return this.original.request}get status(){return this.original.status}get headers(){return this.original.headers}get cookies(){return this.original.cookies}get remoteAddress(){return this.original.remoteAddress}get formData(){return this.applyInterrupt(this.original.formData)}get text(){return this.applyInterrupt(this.original.text)}get json(){return this.applyInterrupt(this.original.json)}get urlParamsBody(){return this.applyInterrupt(this.original.urlParamsBody)}get arrayBuffer(){return this.applyInterrupt(this.original.arrayBuffer)}get stream(){return a.suspend(()=>(e2.unregister(this.original),a.ensuring(this.original.stream,i.sync(()=>{this.controller.abort()}))))}toJSON(){return this.original.toJSON()}[d.NodeInspectSymbol](){return this.original[d.NodeInspectSymbol]()}}let{del:e4,execute:e6,get:e9,head:e7,options:te,patch:tt,post:tr,put:ti}=i.serviceFunctions(eG),tn=(0,u.dual)(2,(e,t)=>e1(i.flatMap(r=>t(e.postprocess(i.succeed(r)),r)),e.preprocess)),ta=(0,u.dual)(2,(e,t)=>ts(e,i.flatMap(eq(t)))),ts=(0,u.dual)(2,(e,t)=>e1(r=>t(e.postprocess(r)),e.preprocess)),to=(0,u.dual)(3,(e,t,r)=>ts(e,i.catchTag(t,r))),tl=(0,u.dual)(2,(e,t)=>ts(e,i.catchTags(t))),tu=(0,u.dual)(2,(e,t)=>ts(e,i.catchAll(t))),tc=(0,u.dual)(3,(e,t,r)=>ts(e,i.filterOrElse(t,r))),td=(0,u.dual)(3,(e,t,r)=>ts(e,i.filterOrFail(t,r))),tp=(0,u.dual)(2,(e,t)=>e1(e.postprocess,r=>i.map(e.preprocess(r),t))),tf=(0,u.dual)(2,(e,t)=>e1(e.postprocess,r=>i.flatMap(e.preprocess(r),t))),th=(0,u.dual)(2,(e,t)=>e1(e.postprocess,r=>e.preprocess(t(r)))),tm=(0,u.dual)(2,(e,t)=>e1(e.postprocess,r=>i.flatMap(t(r),e.preprocess))),tg=(0,u.dual)(2,(e,t)=>ts(e,i.retry(t))),ty=(0,u.dual)(2,(e,t)=>ts(e,i.retry({while:g.ScheduleTypeId in t||void 0===t.while?tS:h.or(tS,t.while),schedule:g.ScheduleTypeId in t?t:t.schedule,times:g.ScheduleTypeId in t?void 0:t.times}))),tS=e=>h.hasProperty(e,l.TimeoutExceptionTypeId)||tb(e),tb=e=>o.isHttpClientError(e)&&("RequestError"===e._tag&&"Transport"===e.reason||"ResponseError"===e._tag&&e.response.status>=429),tv=(0,u.dual)(2,(e,t)=>ts(e,i.tap(t))),tE=(0,u.dual)(2,(e,t)=>ts(e,i.tapError(t))),tw=(0,u.dual)(2,(e,t)=>e1(e.postprocess,r=>i.tap(e.preprocess(r),t))),tk=(0,u.dual)(2,(e,t)=>e1(r=>i.tap(e.postprocess(r),e=>m.update(t,t=>S.merge(t,e.cookies))),r=>i.flatMap(e.preprocess(r),e=>i.map(m.get(t),t=>S.isEmpty(t)?e:ed(e,"cookie",S.toCookieHeader(t)))))),tI=(0,u.dual)(e=>{let t;return t=e[0],h.hasProperty(t,eH)},(e,t)=>e1(r=>{let n=(r,a)=>i.flatMap(e.postprocess(i.succeed(r)),e=>e.status>=300&&e.status<400&&e.headers.location&&a<(t??10)?n(eb(r,new URL(e.headers.location,e.request.url)),a+1):i.succeed(e));return i.flatMap(r,e=>n(e,0))},e.preprocess)),tT=e=>p.effect(eG,i.flatMap(i.context(),t=>i.map(e,e=>ts(e,i.mapInputContext(e=>r.merge(t,e)))))),tx="@effect/platform/FetchHttpClient/Fetch",tC="@effect/platform/FetchHttpClient/FetchOptions",tR=e3((e,t,r,l)=>{let u=l.getFiberRef(n.currentContext),c=u.unsafeMap.get(tx)??globalThis.fetch,d=u.unsafeMap.get(tC)??{},p=d.headers?s.merge(s.fromInput(d.headers),e.headers):e.headers,f=n=>i.map(i.tryPromise({try:()=>c(t,{...d,method:e.method,headers:p,body:n,duplex:"Stream"===e.body._tag?"half":void 0,signal:r}),catch:t=>new o.RequestError({request:e,reason:"Transport",cause:t})}),t=>new eB(e,t));switch(e.body._tag){case"Raw":case"Uint8Array":return f(e.body.body);case"FormData":return f(e.body.formData);case"Stream":return i.flatMap(a.toReadableStreamEffect(e.body.stream),f)}return f(void 0)}),tF=tT(i.succeed(tR));class tA extends r.Tag(tx)(){}class tO extends r.Tag(tC)(){}e.s(["Fetch",0,tA,"RequestInit",0,tO,"layer",0,tF],4925787);var t_=e.i(4925787);e.s(["FetchHttpClient",0,t_],2051545),e.s(["Headers",0,s],8404901),e.s(["HttpClient",0,eG,"SpanNameGenerator",0,eY,"TypeId",0,eH,"catchAll",0,tu,"catchTag",0,to,"catchTags",0,tl,"currentTracerDisabledWhen",0,eK,"currentTracerPropagation",0,eZ,"del",0,e4,"execute",0,e6,"filterOrElse",0,tc,"filterOrFail",0,td,"filterStatus",0,ta,"filterStatusOk",0,e=>ts(e,i.flatMap(e$)),"followRedirects",0,tI,"get",0,e9,"head",0,e7,"layerMergedContext",0,tT,"make",0,e3,"makeWith",0,e1,"mapRequest",0,tp,"mapRequestEffect",0,tf,"mapRequestInput",0,th,"mapRequestInputEffect",0,tm,"options",0,te,"patch",0,tt,"post",0,tr,"put",0,ti,"retry",0,tg,"retryTransient",0,ty,"tap",0,tv,"tapError",0,tE,"tapRequest",0,tw,"transform",0,tn,"transformResponse",0,ts,"withCookiesRef",0,tk,"withScope",0,e=>tn(e,(e,t)=>{let r=new AbortController;return e5.set(t,r),i.zipRight(i.scopeWith(e=>y.addFinalizer(e,i.sync(()=>r.abort()))),e)}),"withSpanNameGenerator",0,eX,"withTracerDisabledWhen",0,eJ,"withTracerPropagation",0,eQ],6076596);var tM=e.i(6076596);e.s(["HttpClient",0,tM],3302588);let tD=Symbol.for("@effect/platform/HttpClientRequest");e.s(["TypeId",0,tD,"accept",0,eg,"acceptJson",0,ey,"appendUrl",0,ev,"appendUrlParam",0,ek,"appendUrlParams",0,eI,"basicAuth",0,eh,"bearerToken",0,em,"bodyFile",0,eM,"bodyFileWeb",0,eD,"bodyFormData",0,eP,"bodyFormDataRecord",0,eL,"bodyJson",0,eO,"bodyStream",0,eU,"bodyText",0,eA,"bodyUint8Array",0,eF,"bodyUnsafeJson",0,e_,"bodyUrlParams",0,eN,"del",0,eo,"get",0,ei,"head",0,el,"make",0,er,"modify",0,ec,"options",0,eu,"patch",0,es,"post",0,en,"prependUrl",0,eE,"put",0,ea,"removeHash",0,e=>X(e.method,e.url,e.urlParams,v.none(),e.headers,e.body),"schemaBodyJson",0,(e,t)=>{let r,n=(r=E.encode(e,t),e=>i.flatMap(i.mapError(r(e),e=>z({_tag:"SchemaError",error:e})),G));return(0,u.dual)(2,(e,t)=>i.map(n(t),t=>eR(e,t)))},"setBody",0,eR,"setHash",0,eC,"setHeader",0,ed,"setHeaders",0,ep,"setMethod",0,eS,"setUrl",0,eb,"setUrlParam",0,eT,"setUrlParams",0,ex,"toUrl",0,e=>I.getRight(O(e.url,e.urlParams,e.hash)),"updateUrl",0,ew],7877750);var tN=e.i(7877750);e.s(["HttpClientRequest",0,tN],8460856),e.s(["text",0,V,"uint8Array",0,$],9679606);var tP=e.i(578549),tL=e.i(7836076),tU=e.i(6028004),tz=e.i(1150852),tW=e.i(9390854),tB=e.i(6816077),tq=e.i(5310088);let t$=Symbol.for("effect/FiberSet"),tj={[t$]:t$,[Symbol.iterator](){return"Closed"===this.state._tag?tB.empty():this.state.backing[Symbol.iterator]()},toString(){return d.format(this.toJSON())},toJSON(){return{_id:"FiberMap",state:this.state}},[d.NodeInspectSymbol](){return this.toJSON()},pipe(){return(0,f.pipeArguments)(this,arguments)}},tV=tz.make(-1,0),tH=l.reduceWithContext(void 0,{emptyCase:u.constFalse,failCase:u.constFalse,dieCase:u.constFalse,interruptCase:(e,t)=>tW.has(tz.ids(t),-1),sequentialCase:(e,t,r)=>t||r,parallelCase:(e,t,r)=>t||r}),tG=(0,u.dual)(e=>{let t;return t=e[0],h.hasProperty(t,t$)},(e,t,r)=>{"Closed"===e.state._tag?t.unsafeInterruptAsFork(tz.combine(r?.interruptAs??tz.none,tV)):e.state.backing.has(t)||(e.state.backing.add(t),t.addObserver(i=>{"Closed"!==e.state._tag&&(e.state.backing.delete(t),!tL.isFailure(i)||(r?.propagateInterruption===!0?tH(i.cause):l.isInterruptedOnly(i.cause))||tP.unsafeDone(e.deferred,i))}))}),tK=()=>(void 0===t&&(t=i.runFork(i.interrupt)),t),tJ=(e,t,r)=>i.fiberIdWith(n=>"Closed"===e.state._tag?i.sync(tK):i.tap(i.forkDaemon(t),t=>tG(e,t,{...r,interruptAs:n})));e.s(["join",0,e=>tP.await(e.deferred),"make",0,()=>i.acquireRelease(i.map(tP.make(),e=>{var t;let r;return t=new Set,(r=Object.create(tj)).state={_tag:"Open",backing:t},r.deferred=e,r}),e=>i.withFiberRuntime(t=>{let r=e.state;if("Closed"===r._tag)return i.void;e.state={_tag:"Closed"};let n=r.backing;return tU.interruptAllAs(n,tz.combine(t.id(),tV)).pipe(i.intoDeferred(e.deferred))})),"run",0,function(){let e=arguments[0];if(!i.isEffect(arguments[1])){let t=arguments[1];return r=>tJ(e,r,t)}return tJ(e,arguments[1],arguments[2])},"runtime",0,e=>()=>i.map(i.runtime(),t=>{let r=tq.runFork(t);return(t,i)=>{if("Closed"===e.state._tag)return tK();let n=r(t,i);return tG(e,n),n}}),"unsafeAdd",0,tG],7069118)},757660,2424531,1524216,e=>{"use strict";let t,r,i,n,a,s,o,l;var u,c,d,p,f,h,m,g,y,S,b,v,E,w=e.i(4511046),k=e.i(8973927),I=e.i(6021311),T=e.i(8718972),x=e.i(6872829),C=e.i(9642932),R=e.i(7118357),F=e.i(2051545),A=e.i(8404901),O=e.i(3302588),_=e.i(8460856),M=e.i(2940189),D=e.i(9679606),N=e.i(6076596),P=e.i(7877750),L=e.i(7358204),U=e.i(5972454),z=e.i(578549),W=e.i(3322401),B=e.i(1177850),q=e.i(7836076),$=e.i(6098979),j=e.i(7069118),V=e.i(3683485),H=e.i(9159985),G=e.i(9227260),K=e.i(1737036),J=e.i(4935619),Z=e.i(5160412),Q=e.i(8643033);let Y=Symbol.for("@effect/platform/Socket"),X=e=>J.hasProperty(e,Y),ee=U.GenericTag("@effect/platform/Socket"),et=Symbol.for("@effect/platform/Socket/CloseEvent"),er=e=>J.hasProperty(e,et),ei=Symbol.for("@effect/platform/Socket/SocketError"),en=e=>J.hasProperty(e,ei);class ea extends(0,Q.TypeIdError)(ei,"SocketError"){get message(){return`An error occurred during ${this.reason}`}}class es extends(0,Q.TypeIdError)(ei,"SocketError"){static is(e){return en(e)&&"Close"===e.reason}static isClean(e){return function(t){return es.is(t)&&e(t.code)}}get message(){return this.closeReason?`${this.reason}: ${this.code}: ${this.closeReason}`:`${this.reason}: ${this.code}`}}let eo=(e,t)=>W.gen(function*(){let r=yield*W.scope,i=yield*K.make(),n=yield*Z.fork(r,B.sequential),a=yield*Z.extend(e.writer,n);return yield*e.runRaw(e=>{i.unsafeOffer(t(e))}).pipe(K.into(i),W.forkIn(r),W.interruptible),L.embedInput(K.toChannel(i),{awaitRead:()=>W.void,emit:e=>W.catchAllCause(W.gen(()=>(function*(e){for(let t of e)yield*a(t)})(e)),e=>i.failCause(e)),error:e=>W.zipRight(Z.close(n,q.void),i.failCause(e)),done:()=>Z.close(n,q.void)})}).pipe(L.unwrapScoped),el=e=>{let t=new TextEncoder;return eo(e,e=>"string"==typeof e?t.encode(e):e)},eu=(0,V.dual)(e=>X(e[0]),(e,t)=>{let r=new TextDecoder(t);return eo(e,e=>"string"==typeof e?e:r.decode(e))}),ec=()=>e=>el(e),ed=e=>1e3!==e&&1006!==e,ep=U.GenericTag("@effect/platform/Socket/WebSocket"),ef=U.GenericTag("@effect/platform/Socket/WebSocketConstructor"),eh=G.succeed(ef,(e,t)=>new globalThis.WebSocket(e,t)),em=(e,t)=>eg(W.acquireRelease(("string"==typeof e?W.succeed(e):e).pipe(W.flatMap(e=>W.map(ef,r=>r(e,t?.protocols)))),e=>W.sync(()=>e.close(1e3))),t),eg=(e,t)=>W.withFiberRuntime(r=>{let i,n=W.unsafeMakeLatch(!1),a=r.currentContext,s=t?.closeCodeIsError??ed,o=(o,l)=>W.scopedWith(W.fnUntraced(function*(a){let u=yield*j.make().pipe(Z.extend(a)),c=yield*Z.extend(e,a),d=yield*W.provideService(j.runtime(u)(),ep,c),p=!1;function f(e){if(e.data instanceof Blob)return W.promise(()=>e.data.arrayBuffer()).pipe(W.andThen(e=>o(new Uint8Array(e))),d);let t=o(e.data);W.isEffect(t)&&d(t)}function h(e){c.removeEventListener("message",f),c.removeEventListener("close",m),z.unsafeDone(u.deferred,W.fail(new ea({reason:p?"Read":"Open",cause:e})))}function m(e){c.removeEventListener("message",f),c.removeEventListener("error",h),z.unsafeDone(u.deferred,W.fail(new es({reason:"Close",code:e.code,closeReason:e.reason})))}if(c.addEventListener("close",m,{once:!0}),c.addEventListener("error",h,{once:!0}),c.addEventListener("message",f),1!==c.readyState){let e=z.unsafeMake(r.id());c.addEventListener("open",()=>{p=!0,z.unsafeDone(e,W.void)},{once:!0}),yield*z.await(e).pipe(W.timeoutFail({duration:t?.openTimeout??1e4,onTimeout:()=>new ea({reason:"OpenTimeout",cause:'timeout waiting for "open"'})}),W.raceFirst(j.join(u)))}return p=!0,i=c,yield*n.open,l?.onOpen&&(yield*l.onOpen),yield*j.join(u).pipe(W.catchIf(es.isClean(e=>!s(e)),e=>W.void))})).pipe(W.mapInputContext(e=>U.merge(a,e)),W.ensuring(W.sync(()=>{n.unsafeClose(),i=void 0})),W.interruptible),l=new TextEncoder,u=W.succeed(e=>n.whenOpen(W.sync(()=>{let t=i;er(e)?t.close(e.code,e.reason):t.send(e)})));return W.succeed(ee.of({[Y]:Y,run:(e,t)=>o(t=>"string"==typeof t?e(l.encode(t)):t instanceof Uint8Array?e(t):e(new Uint8Array(t)),t),runRaw:o,writer:u}))}),ey=(0,H.globalValue)("@effect/platform/Socket/currentSendQueueCapacity",()=>$.unsafeMake(16));e.s(["CloseEvent",0,class{code;reason;[et];constructor(e=1e3,t){this.code=e,this.reason=t,this[et]=et}toString(){return this.reason?`${this.code}: ${this.reason}`:`${this.code}`}},"CloseEventTypeId",0,et,"Socket",0,ee,"SocketCloseError",0,es,"SocketErrorTypeId",0,ei,"SocketGenericError",0,ea,"TypeId",0,Y,"WebSocket",0,ep,"WebSocketConstructor",0,ef,"currentSendQueueCapacity",0,ey,"defaultCloseCodeIsError",0,ed,"fromTransformStream",0,(e,t)=>W.withFiberRuntime(r=>{let i,n=W.unsafeMakeLatch(!1),a=r.currentContext,s=t?.closeCodeIsError??ed,o=(t,r)=>W.scopedWith(W.fnUntraced(function*(a){let o=yield*Z.extend(e,a),l=o.readable.getReader();yield*Z.addFinalizer(a,W.promise(()=>l.cancel()));let u=yield*j.make().pipe(Z.extend(a)),c=yield*j.runtime(u)();return yield*W.tryPromise({try:async()=>{for(;;){let{done:e,value:r}=await l.read();if(e)throw new es({reason:"Close",code:1e3});let i=t(r);W.isEffect(i)&&c(i)}},catch:e=>en(e)?e:new ea({reason:"Read",cause:e})}).pipe(j.run(u)),i={stream:o,fiberSet:u},yield*n.open,r?.onOpen&&(yield*r.onOpen),yield*j.join(u).pipe(W.catchIf(es.isClean(e=>!s(e)),e=>W.void))})).pipe(e=>e,W.mapInputContext(e=>U.merge(a,e)),W.ensuring(W.sync(()=>{n.unsafeClose(),i=void 0})),W.interruptible),l=new TextEncoder,u=new WeakMap,c=e=>{let t=u.get(e);return t||(t=e.writable.getWriter(),u.set(e,t)),t},d=W.acquireRelease(W.succeed(e=>n.whenOpen(W.suspend(()=>{let{fiberSet:t,stream:r}=i;return er(e)?z.fail(t.deferred,new es({reason:"Close",code:e.code,closeReason:e.reason})):W.promise(()=>c(r).write("string"==typeof e?l.encode(e):e))}))),()=>W.promise(async()=>{i&&await c(i.stream).close()}));return W.succeed(ee.of({[Y]:Y,run:(e,t)=>o(t=>"string"==typeof t?e(l.encode(t)):e(t),t),runRaw:o,writer:d}))}),"fromWebSocket",0,eg,"isCloseEvent",0,er,"isSocket",0,X,"isSocketError",0,en,"layerWebSocket",0,(e,t)=>G.effect(ee,em(e,t)),"layerWebSocketConstructorGlobal",0,eh,"makeChannel",0,()=>L.unwrap(W.map(ee,ec())),"makeWebSocket",0,em,"makeWebSocketChannel",0,(e,t)=>L.unwrapScoped(W.map(em(e,t),ec())),"toChannel",0,el,"toChannelMap",0,eo,"toChannelString",0,eu,"toChannelWith",0,ec],2663153);var eS=U,eb=e.i(8815901),ev=e.i(9552070),eE=e.i(9973079);class ew extends eS.Tag("@effect/platform/Transferable/Collector")(){}eE.Any,eE.Any,eE.Uint8ArrayFromSelf;var ek=e.i(8973103),eI=e.i(7525378),eT=e.i(6816077),ex=e.i(9960543),eC=e.i(4039787),eR=e.i(7548658),eF=e.i(7294722),eA=e.i(4026828),eO=e.i(1658800),e_=e.i(8398712);let eM=Symbol.for("effect/Pool"),eD={_E:e=>e,_A:e=>e},eN=e=>eR.uninterruptibleMask(t=>eR.flatMap(eR.context(),r=>{let i=U.get(r,eO.scopeTag),n=new eP(i,eR.mapInputContext(e.acquire,e=>U.merge(r,e)),e.concurrency??1,e.min,e.max,e.strategy,Math.min(Math.max(e.targetUtilization??1,.1),1)),a=eR.tap(eO.forkDaemon(t(n.resize)),e=>i.addFinalizer(()=>eR.interruptFiber(e))),s=eR.tap(eO.forkDaemon(t(e.strategy.run(n))),e=>i.addFinalizer(()=>eR.interruptFiber(e)));return eR.succeed(n).pipe(eR.zipLeft(i.addFinalizer(()=>n.shutdown)),eR.zipLeft(a),eR.zipLeft(s))}));class eP extends eI.Class{scope;acquire;concurrency;minSize;maxSize;strategy;targetUtilization;[eM];isShuttingDown=!1;semaphore;items=new Set;available=new Set;availableLatch=eA.unsafeMakeLatch(!1);invalidated=new Set;waiters=0;constructor(e,t,r,i,n,a,s){super(),this.scope=e,this.acquire=t,this.concurrency=r,this.minSize=i,this.maxSize=n,this.strategy=a,this.targetUtilization=s,this[eM]=eD,this.semaphore=eA.unsafeMakeSemaphore(r*n)}allocate=eR.acquireUseRelease(eO.scopeMake(),e=>this.acquire.pipe(eO.scopeExtend(e),eR.exit,eR.flatMap(t=>{let r={exit:t,finalizer:eR.catchAllCause(e.close(t),eL),refCount:0,disableReclaim:!1};return this.items.add(r),this.available.add(r),eR.as("Success"===t._tag?this.strategy.onAcquire(r):eR.zipRight(r.finalizer,this.strategy.onAcquire(r)),r)})),(e,t)=>"Failure"===t._tag?e.close(t):eR.void);get currentUsage(){let e=this.waiters;for(let t of this.items)e+=t.refCount;return e}get targetSize(){if(this.isShuttingDown)return 0;let e=Math.ceil(this.currentUsage/this.targetUtilization/this.concurrency);return Math.min(Math.max(this.minSize,e),this.maxSize)}get activeSize(){return this.items.size-this.invalidated.size}resizeLoop=eR.suspend(()=>{if(this.activeSize>=this.targetSize)return eR.void;let e=this.targetSize-this.activeSize;return this.strategy.reclaim(this).pipe(eR.flatMap(eb.match({onNone:()=>this.allocate,onSome:eR.succeed})),eO.replicateEffect(e,{concurrency:e}),eR.zipLeft(this.availableLatch.open),eR.flatMap(e=>e.some(e=>"Failure"===e.exit._tag)?eR.void:this.resizeLoop))});resizeSemaphore=eA.unsafeMakeSemaphore(1);resize=this.resizeSemaphore.withPermits(1)(this.resizeLoop);getPoolItem=eR.uninterruptibleMask(e=>e(this.semaphore.take(1)).pipe(eR.zipRight(eO.scopeTag),eR.flatMap(e=>eR.suspend(()=>{if(this.waiters++,this.isShuttingDown)return eR.interrupt;if(this.targetSize>this.activeSize){let e=this;return eR.flatMap(this.resizeSemaphore.withPermitsIfAvailable(1)(eA.forkIn(eR.interruptible(this.resize),this.scope)),function t(){return e.isShuttingDown?eR.interrupt:e.available.size>0?eR.succeed(eT.unsafeHead(e.available)):(e.availableLatch.unsafeClose(),eR.flatMap(e.availableLatch.await,t))})}return eR.succeed(eT.unsafeHead(this.available))}).pipe(eO.ensuring(eR.sync(()=>this.waiters--)),eR.tap(t=>"Failure"===t.exit._tag?(this.items.delete(t),this.invalidated.delete(t),this.available.delete(t),this.semaphore.release(1)):(t.refCount++,this.available.delete(t),t.refCount<this.concurrency&&this.available.add(t),e.addFinalizer(()=>eR.zipRight(eR.suspend(()=>(t.refCount--,this.invalidated.has(t))?this.invalidatePoolItem(t):(this.available.add(t),eR.exitVoid)),this.semaphore.release(1))))),eR.onInterrupt(()=>this.semaphore.release(1))))));commit(){return this.get}get=eR.flatMap(eR.suspend(()=>this.isShuttingDown?eR.interrupt:this.getPoolItem),e=>e.exit);invalidate(e){return eR.suspend(()=>{if(this.isShuttingDown)return eR.void;for(let t of this.items)if("Success"===t.exit._tag&&t.exit.value===e)return t.disableReclaim=!0,eR.uninterruptible(this.invalidatePoolItem(t));return eR.void})}invalidatePoolItem(e){return eR.suspend(()=>this.items.has(e)?0===e.refCount?(this.items.delete(e),this.available.delete(e),this.invalidated.delete(e),eR.zipRight(e.finalizer,eA.forkIn(eR.interruptible(this.resize),this.scope))):(this.invalidated.add(e),this.available.delete(e),eR.void):eR.void)}get shutdown(){return eR.suspend(()=>{if(this.isShuttingDown)return eR.void;this.isShuttingDown=!0;let e=this.items.size,t=eA.unsafeMakeSemaphore(e);return eR.forEachSequentialDiscard(this.items,e=>e.refCount>0?(e.finalizer=eR.zipLeft(e.finalizer,t.release(1)),this.invalidated.add(e),t.take(1)):(this.items.delete(e),this.available.delete(e),this.invalidated.delete(e),e.finalizer)).pipe(eR.zipRight(this.semaphore.releaseAll),eR.zipRight(this.availableLatch.open),eR.zipRight(t.take(e)))})}pipe(){return(0,ex.pipeArguments)(this,arguments)}}let eL=e=>eR.withFiberRuntime(t=>{let r=t.getFiberRef(eR.currentUnhandledErrorLogLevel);return"Some"===r._tag&&t.log("Unhandled error in pool finalizer",e,r),eR.void});var eU=e.i(5310088),ez=e.i(7703391),eW=e.i(8554418),eB=(e.i(1253121),eE);let eq=Symbol.for("@effect/platform/WorkerError");class e$ extends eB.TaggedError()("WorkerError",{reason:eB.Literal("spawn","decode","send","unknown","encode"),cause:eB.Defect}){[eq]=eq;static Cause=eB.Cause({error:this,defect:eB.Defect});static encodeCause=ev.encodeSync(this.Cause);static decodeCause=ev.decodeSync(this.Cause);get message(){switch(this.reason){case"send":return"An error occurred calling .postMessage";case"spawn":return"An error occurred while spawning a worker";case"decode":return"An error occurred during decoding";case"encode":return"An error occurred during encoding";case"unknown":return"An unexpected error occurred"}}}let ej=U.GenericTag("@effect/platform/Worker/PlatformWorker");var eV=e.i(5450905),eH=e.i(7862555),eG=U,eK=e.i(6028004),eJ=e.i(1150852);let eZ=Symbol.for("effect/PrimaryKey");e.s(["symbol",0,eZ],2424531);var eQ=eE,eY=e.i(1932814);let eX=Symbol.for("@effect/rpc/RpcSchema/Stream"),e0=e=>e.annotations[eX]?eb.some(e.annotations[eX]):eb.none(),e1=(e,t)=>(r,i,n)=>W.flatMap(W.context(),a=>(0,J.hasProperty)(r,eW.StreamTypeId)?W.succeed(r.pipe(eW.mapChunksEffect(t=>e(t,i)),eW.catchAll(e=>ev.isParseError(e)?eW.die(e):W.matchEffect(t(e,i),{onFailure:W.die,onSuccess:W.fail})),eW.provideContext(a))):W.fail(new ev.Type(n,r))),e2=Symbol.for("@effect/rpc/Rpc"),e5={[e2]:e2,pipe(){return(0,ex.pipeArguments)(this,arguments)},setSuccess(e){return e3({_tag:this._tag,payloadSchema:this.payloadSchema,successSchema:e,errorSchema:this.errorSchema,annotations:this.annotations,middlewares:this.middlewares})},setError(e){return e3({_tag:this._tag,payloadSchema:this.payloadSchema,successSchema:this.successSchema,errorSchema:e,annotations:this.annotations,middlewares:this.middlewares})},setPayload(e){return e3({_tag:this._tag,payloadSchema:eQ.isSchema(e)?e:eQ.Struct(e),successSchema:this.successSchema,errorSchema:this.errorSchema,annotations:this.annotations,middlewares:this.middlewares})},middleware(e){return e3({_tag:this._tag,payloadSchema:this.payloadSchema,successSchema:this.successSchema,errorSchema:this.errorSchema,annotations:this.annotations,middlewares:new Set([...this.middlewares,e])})},prefix(e){return e3({_tag:`${e}${this._tag}`,payloadSchema:this.payloadSchema,successSchema:this.successSchema,errorSchema:this.errorSchema,annotations:this.annotations,middlewares:this.middlewares})},annotate(e,t){return e3({_tag:this._tag,payloadSchema:this.payloadSchema,successSchema:this.successSchema,errorSchema:this.errorSchema,middlewares:this.middlewares,annotations:U.add(this.annotations,e,t)})},annotateContext(e){return e3({_tag:this._tag,payloadSchema:this.payloadSchema,successSchema:this.successSchema,errorSchema:this.errorSchema,middlewares:this.middlewares,annotations:U.merge(this.annotations,e)})}},e3=e=>{function t(){}return Object.setPrototypeOf(t,e5),Object.assign(t,e),t.key=`@effect/rpc/Rpc/${e._tag}`,t},e8=e=>e3({_tag:e._tag,payloadSchema:e,successSchema:e.success,errorSchema:e.failure,annotations:U.empty(),middlewares:new Set}),e4=(0,H.globalValue)("@effect/rpc/Rpc/exitSchemaCache",()=>new WeakMap),e6=e=>{if(e4.has(e))return e4.get(e);let t=new Set([e.errorSchema]),r=e0(e.successSchema.ast);for(let i of(eb.isSome(r)&&t.add(r.value.failure),e.middlewares))t.add(i.failure);let i=eQ.Exit({success:eb.isSome(r)?eQ.Void:e.successSchema,failure:eQ.Union(...t),defect:eQ.Defect});return e4.set(e,i),i},e9=Symbol.for("@effect/rpc/Rpc/Wrapper"),e7=e=>e9 in e,te=e=>t=>e7(t)?{[e9]:e9,value:t.value,fork:e.fork??t.fork,uninterruptible:e.uninterruptible??t.uninterruptible}:{[e9]:e9,value:t,fork:e.fork??!1,uninterruptible:e.uninterruptible??!1},tt=te({fork:!0}),tr=te({uninterruptible:!0});e.s(["TypeId",0,e2,"WrapperTypeId",0,e9,"exitSchema",0,e6,"fork",0,tt,"fromTaggedRequest",0,e8,"isRpc",0,e=>J.hasProperty(e,e2),"isWrapper",0,e7,"make",0,(e,t)=>{let r,i=t?.success??eQ.Void,n=t?.error??eQ.Never;return r=t?.primaryKey?class extends eQ.Class(`@effect/rpc/Rpc/${e}`)(t.payload){[eZ](){return t.primaryKey(this)}}:eQ.isSchema(t?.payload)?t?.payload:t?.payload?eQ.Struct(t?.payload):eQ.Void,e3({_tag:e,payloadSchema:r,successSchema:t?.stream?(e=>{let{failure:t,success:r}=e;return Object.assign(eE.declare([r,t],{decode:(e,t)=>e1(ev.decodeUnknown(eE.ChunkFromSelf(e)),ev.decodeUnknown(t)),encode:(e,t)=>e1(ev.encodeUnknown(eE.ChunkFromSelf(e)),ev.encodeUnknown(t))},{schemaId:eX,[eX]:{success:r,failure:t}}),{success:r,failure:t})})({success:i,failure:n}):i,errorSchema:t?.stream?eQ.Never:n,annotations:U.empty(),middlewares:new Set})},"uninterruptible",0,tr,"wrap",0,te],3901156);var ti=eE;let tn=Symbol.for("@effect/rpc/RpcClientError");class ta extends ti.TaggedError("@effect/rpc/RpcClientError")("RpcClientError",{reason:ti.Literal("Protocol","Unknown"),message:ti.String,cause:ti.optional(ti.Defect)}){[tn]=tn}let ts=e=>"bigint"==typeof e?e:BigInt(e),to={_tag:"Ping"};eE.Defect;var tl=U,tu=e.i(8107641);try{u=new TextDecoder}catch(e){}var tc=0;let td=[];var tp=td,tf=0,th={},tm=0,tg=0,ty=[],tS={useRecords:!1,mapsAsObjects:!0};class tb{}let tv=new tb;tv.name="MessagePack 0xC1";var tE=!1,tw=2;try{Function("")}catch(e){tw=1/0}class tk{constructor(e){e&&(!1===e.useRecords&&void 0===e.mapsAsObjects&&(e.mapsAsObjects=!0),e.sequential&&!1!==e.trusted&&(e.trusted=!0,!e.structures&&!1!=e.useRecords&&(e.structures=[],e.maxSharedStructures||(e.maxSharedStructures=0))),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0),e.int64AsNumber&&(e.int64AsType="number")),Object.assign(this,e)}unpack(e,t){if(c)return tY(()=>(tX(),this?this.unpack(e,t):tk.prototype.unpack.call(tS,e,t)));e.buffer||e.constructor!==ArrayBuffer||(e=void 0!==tu.Buffer?tu.Buffer.from(e):new Uint8Array(e)),"object"==typeof t?(d=t.end||e.length,tc=t.start||0):(tc=0,d=t>-1?t:e.length),tf=0,tg=0,f=null,tp=td,h=null,c=e;try{g=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(t){if(c=null,e instanceof Uint8Array)throw t;throw Error("Source must be a Uint8Array or Buffer but was a "+(e&&"object"==typeof e?e.constructor.name:typeof e))}return this instanceof tk?(th=this,this.structures?p=this.structures:(!p||p.length>0)&&(p=[])):(th=tS,(!p||p.length>0)&&(p=[])),tI(t)}unpackMultiple(e,t){let r,i=0;try{tE=!0;let n=e.length,a=this?this.unpack(e,n):t1.unpack(e,n);if(t){if(!1===t(a,i,tc))return;for(;tc<n;)if(i=tc,!1===t(tI(),i,tc))return}else{for(r=[a];tc<n;)i=tc,r.push(tI());return r}}catch(e){throw e.lastPosition=i,e.values=r,e}finally{tE=!1,tX()}}_mergeStructures(e,t){S&&(e=S.call(this,e)),Object.isFrozen(e=e||[])&&(e=e.map(e=>e.slice(0)));for(let t=0,r=e.length;t<r;t++){let r=e[t];r&&(r.isShared=!0,t>=32&&(r.highByte=t-32>>5))}for(let r in e.sharedLength=e.length,t||[])if(r>=0){let i=e[r],n=t[r];n&&(i&&((e.restoreStructures||(e.restoreStructures=[]))[r]=i),e[r]=n)}return this.structures=e}decode(e,t){return this.unpack(e,t)}}function tI(e){try{let t;if(!th.trusted&&!tE){let e=p.sharedLength||0;e<p.length&&(p.length=e)}if(th.randomAccessStructure&&c[tc]<64&&c[tc]>=32&&y?(t=y(c,tc,d,th),c=null,!(e&&e.lazy)&&t&&(t=t.toJSON()),tc=d):t=tx(),h&&(tc=h.postBundlePosition,h=null),tE&&(p.restoreStructures=null),tc==d)p&&p.restoreStructures&&tT(),p=null,c=null,m&&(m=null);else if(tc>d)throw Error("Unexpected end of MessagePack data");else if(!tE){let e;try{e=JSON.stringify(t,(e,t)=>"bigint"==typeof t?`${t}n`:t).slice(0,100)}catch(t){e="(JSON view not available "+t+")"}throw Error("Data read, but end of buffer not reached "+e)}return t}catch(e){throw p&&p.restoreStructures&&tT(),tX(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer")||tc>d)&&(e.incomplete=!0),e}}function tT(){for(let e in p.restoreStructures)p[e]=p.restoreStructures[e];p.restoreStructures=null}function tx(){let e=c[tc++];if(e<160)if(e<128)if(e<64)return e;else{let t=p[63&e]||th.getStructures&&tA()[63&e];return t?(t.read||(t.read=tR(t,63&e)),t.read()):e}else if(e<144){if(e-=128,th.mapsAsObjects){let t={};for(let r=0;r<e;r++){let e=tV();"__proto__"===e&&(e="__proto_"),t[e]=tx()}return t}{let t=new Map;for(let r=0;r<e;r++)t.set(tx(),tx());return t}}else{let t=Array(e-=144);for(let r=0;r<e;r++)t[r]=tx();return th.freezeData?Object.freeze(t):t}if(e<192){let t=e-160;if(tg>=tc)return f.slice(tc-tm,(tc+=t)-tm);if(0==tg&&d<140){let e=t<16?tW(t):tz(t);if(null!=e)return e}return tO(t)}{let t;switch(e){case 192:return null;case 193:if(h){if((t=tx())>0)return h[1].slice(h.position1,h.position1+=t);return h[0].slice(h.position0,h.position0-=t)}return tv;case 194:return!1;case 195:return!0;case 196:if(void 0===(t=c[tc++]))throw Error("Unexpected end of buffer");return tq(t);case 197:return t=g.getUint16(tc),tc+=2,tq(t);case 198:return t=g.getUint32(tc),tc+=4,tq(t);case 199:return t$(c[tc++]);case 200:return t=g.getUint16(tc),tc+=2,t$(t);case 201:return t=g.getUint32(tc),tc+=4,t$(t);case 202:if(t=g.getFloat32(tc),th.useFloat32>2){let e=t0[(127&c[tc])<<1|c[tc+1]>>7];return tc+=4,(e*t+(t>0?.5:-.5)|0)/e}return tc+=4,t;case 203:return t=g.getFloat64(tc),tc+=8,t;case 204:return c[tc++];case 205:return t=g.getUint16(tc),tc+=2,t;case 206:return t=g.getUint32(tc),tc+=4,t;case 207:return"number"===th.int64AsType?t=0x100000000*g.getUint32(tc)+g.getUint32(tc+4):"string"===th.int64AsType?t=g.getBigUint64(tc).toString():"auto"===th.int64AsType?(t=g.getBigUint64(tc))<=BigInt(2)<<BigInt(52)&&(t=Number(t)):t=g.getBigUint64(tc),tc+=8,t;case 208:return g.getInt8(tc++);case 209:return t=g.getInt16(tc),tc+=2,t;case 210:return t=g.getInt32(tc),tc+=4,t;case 211:return"number"===th.int64AsType?t=0x100000000*g.getInt32(tc)+g.getUint32(tc+4):"string"===th.int64AsType?t=g.getBigInt64(tc).toString():"auto"===th.int64AsType?(t=g.getBigInt64(tc))>=BigInt(-2)<<BigInt(52)&&t<=BigInt(2)<<BigInt(52)&&(t=Number(t)):t=g.getBigInt64(tc),tc+=8,t;case 212:if(114==(t=c[tc++]))return tG(63&c[tc++]);{let e=ty[t];if(e)if(e.read)return tc++,e.read(tx());else if(e.noBuffer)return tc++,e();else return e(c.subarray(tc,++tc));throw Error("Unknown extension "+t)}case 213:if(114==(t=c[tc]))return tc++,tG(63&c[tc++],c[tc++]);return t$(2);case 214:return t$(4);case 215:return t$(8);case 216:return t$(16);case 217:if(t=c[tc++],tg>=tc)return f.slice(tc-tm,(tc+=t)-tm);return t_(t);case 218:if(t=g.getUint16(tc),tc+=2,tg>=tc)return f.slice(tc-tm,(tc+=t)-tm);return tM(t);case 219:if(t=g.getUint32(tc),tc+=4,tg>=tc)return f.slice(tc-tm,(tc+=t)-tm);return tD(t);case 220:return t=g.getUint16(tc),tc+=2,tP(t);case 221:return t=g.getUint32(tc),tc+=4,tP(t);case 222:return t=g.getUint16(tc),tc+=2,tL(t);case 223:return t=g.getUint32(tc),tc+=4,tL(t);default:if(e>=224)return e-256;if(void 0===e){let e=Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}throw Error("Unknown MessagePack token "+e)}}}let tC=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function tR(e,t){function r(){if(r.count++>tw){let r=e.read=Function("r","return function(){return "+(th.freezeData?"Object.freeze":"")+"({"+e.map(e=>"__proto__"===e?"__proto_:r()":tC.test(e)?e+":r()":"["+JSON.stringify(e)+"]:r()").join(",")+"})}")(tx);return 0===e.highByte&&(e.read=tF(t,e.read)),r()}let i={};for(let t=0,r=e.length;t<r;t++){let r=e[t];"__proto__"===r&&(r="__proto_"),i[r]=tx()}return th.freezeData?Object.freeze(i):i}return(r.count=0,0===e.highByte)?tF(t,r):r}let tF=(e,t)=>function(){let r=c[tc++];if(0===r)return t();let i=e<32?-(e+(r<<5)):e+(r<<5),n=p[i]||tA()[i];if(!n)throw Error("Record id is not defined for "+i);return n.read||(n.read=tR(n,e)),n.read()};function tA(){let e=tY(()=>(c=null,th.getStructures()));return p=th._mergeStructures(e,p)}var tO=tN,t_=tN,tM=tN,tD=tN;function tN(e){let t;if(e<16&&(t=tW(e)))return t;if(e>64&&u)return u.decode(c.subarray(tc,tc+=e));let r=tc+e,i=[];for(t="";tc<r;){let e=c[tc++];if((128&e)==0)i.push(e);else if((224&e)==192){let t=63&c[tc++];i.push((31&e)<<6|t)}else if((240&e)==224){let t=63&c[tc++],r=63&c[tc++];i.push((31&e)<<12|t<<6|r)}else if((248&e)==240){let t=(7&e)<<18|(63&c[tc++])<<12|(63&c[tc++])<<6|63&c[tc++];t>65535&&(t-=65536,i.push(t>>>10&1023|55296),t=56320|1023&t),i.push(t)}else i.push(e);i.length>=4096&&(t+=tU.apply(String,i),i.length=0)}return i.length>0&&(t+=tU.apply(String,i)),t}function tP(e){let t=Array(e);for(let r=0;r<e;r++)t[r]=tx();return th.freezeData?Object.freeze(t):t}function tL(e){if(th.mapsAsObjects){let t={};for(let r=0;r<e;r++){let e=tV();"__proto__"===e&&(e="__proto_"),t[e]=tx()}return t}{let t=new Map;for(let r=0;r<e;r++)t.set(tx(),tx());return t}}var tU=String.fromCharCode;function tz(e){let t=tc,r=Array(e);for(let i=0;i<e;i++){let e=c[tc++];if((128&e)>0){tc=t;return}r[i]=e}return tU.apply(String,r)}function tW(e){if(e<4)if(e<2)if(0===e)return"";else{let e=c[tc++];if((128&e)>1){tc-=1;return}return tU(e)}else{let t=c[tc++],r=c[tc++];if((128&t)>0||(128&r)>0){tc-=2;return}if(e<3)return tU(t,r);let i=c[tc++];if((128&i)>0){tc-=3;return}return tU(t,r,i)}{let t=c[tc++],r=c[tc++],i=c[tc++],n=c[tc++];if((128&t)>0||(128&r)>0||(128&i)>0||(128&n)>0){tc-=4;return}if(e<6)if(4===e)return tU(t,r,i,n);else{let e=c[tc++];if((128&e)>0){tc-=5;return}return tU(t,r,i,n,e)}if(e<8){let a=c[tc++],s=c[tc++];if((128&a)>0||(128&s)>0){tc-=6;return}if(e<7)return tU(t,r,i,n,a,s);let o=c[tc++];if((128&o)>0){tc-=7;return}return tU(t,r,i,n,a,s,o)}{let a=c[tc++],s=c[tc++],o=c[tc++],l=c[tc++];if((128&a)>0||(128&s)>0||(128&o)>0||(128&l)>0){tc-=8;return}if(e<10)if(8===e)return tU(t,r,i,n,a,s,o,l);else{let e=c[tc++];if((128&e)>0){tc-=9;return}return tU(t,r,i,n,a,s,o,l,e)}if(e<12){let u=c[tc++],d=c[tc++];if((128&u)>0||(128&d)>0){tc-=10;return}if(e<11)return tU(t,r,i,n,a,s,o,l,u,d);let p=c[tc++];if((128&p)>0){tc-=11;return}return tU(t,r,i,n,a,s,o,l,u,d,p)}{let u=c[tc++],d=c[tc++],p=c[tc++],f=c[tc++];if((128&u)>0||(128&d)>0||(128&p)>0||(128&f)>0){tc-=12;return}if(e<14)if(12===e)return tU(t,r,i,n,a,s,o,l,u,d,p,f);else{let e=c[tc++];if((128&e)>0){tc-=13;return}return tU(t,r,i,n,a,s,o,l,u,d,p,f,e)}{let h=c[tc++],m=c[tc++];if((128&h)>0||(128&m)>0){tc-=14;return}if(e<15)return tU(t,r,i,n,a,s,o,l,u,d,p,f,h,m);let g=c[tc++];if((128&g)>0){tc-=15;return}return tU(t,r,i,n,a,s,o,l,u,d,p,f,h,m,g)}}}}}function tB(){let e,t=c[tc++];if(t<192)e=t-160;else switch(t){case 217:e=c[tc++];break;case 218:e=g.getUint16(tc),tc+=2;break;case 219:e=g.getUint32(tc),tc+=4;break;default:throw Error("Expected string")}return tN(e)}function tq(e){return th.copyBuffers?Uint8Array.prototype.slice.call(c,tc,tc+=e):c.subarray(tc,tc+=e)}function t$(e){let t=c[tc++];if(ty[t]){let r;return ty[t](c.subarray(tc,r=tc+=e),e=>{tc=e;try{return tx()}finally{tc=r}})}throw Error("Unknown extension type "+t)}var tj=Array(4096);function tV(){let e,t=c[tc++];if(!(t>=160)||!(t<192))return tc--,tH(tx());if(t-=160,tg>=tc)return f.slice(tc-tm,(tc+=t)-tm);if(!(0==tg&&d<180))return tO(t);let r=(t<<5^(t>1?g.getUint16(tc):t>0?c[tc]:0))&4095,i=tj[r],n=tc,a=tc+t-3,s=0;if(i&&i.bytes==t){for(;n<a;){if((e=g.getUint32(n))!=i[s++]){n=0x70000000;break}n+=4}for(a+=3;n<a;)if((e=c[n++])!=i[s++]){n=0x70000000;break}if(n===a)return tc=n,i.string;a-=3,n=tc}for(i=[],tj[r]=i,i.bytes=t;n<a;)e=g.getUint32(n),i.push(e),n+=4;for(a+=3;n<a;)e=c[n++],i.push(e);let o=t<16?tW(t):tz(t);return null!=o?i.string=o:i.string=tO(t)}function tH(e){if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e||"bigint"==typeof e)return e.toString();if(null==e)return e+"";if(th.allowArraysInMapKeys&&Array.isArray(e)&&e.flat().every(e=>["string","number","boolean","bigint"].includes(typeof e)))return e.flat().toString();throw Error(`Invalid property type for record: ${typeof e}`)}let tG=(e,t)=>{let r=tx().map(tH),i=e;void 0!==t&&(e=e<32?-((t<<5)+e):(t<<5)+e,r.highByte=t);let n=p[e];return n&&(n.isShared||tE)&&((p.restoreStructures||(p.restoreStructures=[]))[e]=n),p[e]=r,r.read=tR(r,i),r.read()};ty[0]=()=>{},ty[0].noBuffer=!0,ty[66]=e=>{let t=e.length,r=BigInt(128&e[0]?e[0]-256:e[0]);for(let i=1;i<t;i++)r<<=BigInt(8),r+=BigInt(e[i]);return r};let tK={Error,TypeError,ReferenceError};ty[101]=()=>{let e=tx();return(tK[e[0]]||Error)(e[1],{cause:e[2]})},ty[105]=e=>{let t;if(!1===th.structuredClone)throw Error("Structured clone extension is disabled");let r=g.getUint32(tc-4);m||(m=new Map);let i=c[tc],n={target:t=i>=144&&i<160||220==i||221==i?[]:i>=128&&i<144||222==i||223==i?new Map:(i>=199&&i<=201||i>=212&&i<=216)&&115===c[tc+1]?new Set:{}};m.set(r,n);let a=tx();if(!n.used)return n.target=a;if(Object.assign(t,a),t instanceof Map)for(let[e,r]of a.entries())t.set(e,r);if(t instanceof Set)for(let e of Array.from(a))t.add(e);return t},ty[112]=e=>{if(!1===th.structuredClone)throw Error("Structured clone extension is disabled");let t=g.getUint32(tc-4),r=m.get(t);return r.used=!0,r.target},ty[115]=()=>new Set(tx());let tJ=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(e=>e+"Array"),tZ="object"==typeof globalThis?globalThis:window;ty[116]=e=>{let t=e[0],r=Uint8Array.prototype.slice.call(e,1).buffer,i=tJ[t];if(!i){if(16===t)return r;if(17===t)return new DataView(r);throw Error("Could not find typed array for code "+t)}return new tZ[i](r)},ty[120]=()=>{let e=tx();return new RegExp(e[0],e[1])};let tQ=[];function tY(e){b&&b();let t=d,r=tc,i=tf,n=tm,a=tg,s=f,o=tp,l=m,u=h,y=new Uint8Array(c.slice(0,d)),S=p,v=p.slice(0,p.length),E=th,w=tE,k=e();return d=t,tc=r,tf=i,tm=n,tg=a,f=s,tp=o,m=l,h=u,c=y,tE=w,(p=S).splice(0,p.length,...v),th=E,g=new DataView(c.buffer,c.byteOffset,c.byteLength),k}function tX(){c=null,m=null,p=null}ty[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],r=tc;return tc+=t-e.length,h=tQ,(h=[tB(),tB()]).position0=0,h.position1=0,h.postBundlePosition=tc,tc=r,tx()},ty[255]=e=>4==e.length?new Date((0x1000000*e[0]+(e[1]<<16)+(e[2]<<8)+e[3])*1e3):8==e.length?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+((3&e[3])*0x100000000+0x1000000*e[4]+(e[5]<<16)+(e[6]<<8)+e[7])*1e3):12==e.length?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+((128&e[4]?-0x1000000000000:0)+0x10000000000*e[6]+0x100000000*e[7]+0x1000000*e[8]+(e[9]<<16)+(e[10]<<8)+e[11])*1e3):new Date("invalid");let t0=Array(147);for(let e=0;e<256;e++)t0[e]=+("1e"+Math.floor(45.15-.30103*e));var t1=new tk({useRecords:!1});t1.unpack,t1.unpackMultiple,t1.unpack,new Uint8Array(new Float32Array(1).buffer,0,4);try{t=new TextEncoder}catch(e){}let t2=void 0!==tu.Buffer,t5=t2?function(e){return tu.Buffer.allocUnsafeSlow(e)}:Uint8Array,t3=t2?tu.Buffer:Uint8Array,t8=t2?0x100000000:0x7fd00000,t4=0,t6=null,t9=/[\u0080-\uFFFF]/,t7=Symbol("record-id");class re extends tk{constructor(e){let u,c,d,p;super(e),this.offset=0;let f=t3.prototype.utf8Write?function(e,t){return n.utf8Write(e,t,n.byteLength-t)}:!!t&&!!t.encodeInto&&function(e,r){return t.encodeInto(e,n.subarray(r)).written},h=this;e||(e={});let m=e&&e.sequential,g=e.structures||e.saveStructures,y=e.maxSharedStructures;if(null==y&&(y=32*!!g),y>8160)throw Error("Maximum maxSharedStructure is 8160");e.structuredClone&&void 0==e.moreTypes&&(this.moreTypes=!0);let S=e.maxOwnStructures;null==S&&(S=g?32:64),this.structures||!1==e.useRecords||(this.structures=[]);let b=y>32||S+y>64,v=y+64,E=y+S+64;if(E>8256)throw Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let w=[],k=0,I=0;this.pack=this.encode=function(e,t){let r;if(n||(s=(n=new t5(8192)).dataView||(n.dataView=new DataView(n.buffer,0,8192)),t4=0),(o=n.length-10)-t4<2048?(s=(n=new t5(n.length)).dataView||(n.dataView=new DataView(n.buffer,0,n.length)),o=n.length-10,t4=0):t4=t4+7&0x7ffffff8,u=t4,t&rd&&(t4+=255&t),p=h.structuredClone?new Map:null,h.bundleStrings&&"string"!=typeof e?(t6=[]).size=1/0:t6=null,d=h.structures){d.uninitialized&&(d=h._mergeStructures(h.getStructures()));let e=d.sharedLength||0;if(e>y)throw Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+d.sharedLength);if(!d.transitions){d.transitions=Object.create(null);for(let t=0;t<e;t++){let e=d[t];if(!e)continue;let r,i=d.transitions;for(let t=0,n=e.length;t<n;t++){let n=e[t];(r=i[n])||(r=i[n]=Object.create(null)),i=r}i[t7]=t+64}this.lastNamedStructuresLength=e}m||(d.nextId=e+64)}c&&(c=!1);try{h.randomAccessStructure&&e&&e.constructor&&e.constructor===Object?N(e):C(e);let r=t6;if(t6&&ri(u,C,0),p&&p.idsToInsert){let e=p.idsToInsert.sort((e,t)=>e.offset>t.offset?1:-1),t=e.length,i=-1;for(;r&&t>0;){let n=e[--t].offset+u;n<r.stringsPosition+u&&-1===i&&(i=0),n>r.position+u?i>=0&&(i+=6):(i>=0&&(s.setUint32(r.position+u,s.getUint32(r.position+u)+i),i=-1),r=r.previous,t++)}i>=0&&r&&s.setUint32(r.position+u,s.getUint32(r.position+u)+i),(t4+=6*e.length)>o&&_(t4),h.offset=t4;let a=function(e,t){let r,i=6*t.length,n=e.length-i;for(;r=t.pop();){let t=r.offset,a=r.id;e.copyWithin(t+i,t,n);let s=t+(i-=6);e[s++]=214,e[s++]=105,e[s++]=a>>24,e[s++]=a>>16&255,e[s++]=a>>8&255,e[s++]=255&a,n=t}return e}(n.subarray(u,t4),e);return p=null,a}if(h.offset=t4,t&ru)return n.start=u,n.end=t4,n;return n.subarray(u,t4)}catch(e){throw r=e,e}finally{if(d&&(T(),c&&h.saveStructures)){var i,a;let s=d.sharedLength||0,o=n.subarray(u,t4),l=(i=d,a=h,i.isCompatible=e=>{let t=!e||(a.lastNamedStructuresLength||0)===e.length;return t||a._mergeStructures(e),t},i);if(!r){if(!1===h.saveStructures(l,l.isCompatible))return h.pack(e,t);return h.lastNamedStructuresLength=s,n.length>0x40000000&&(n=null),o}}n.length>0x40000000&&(n=null),t&rc&&(t4=u)}};const T=()=>{I<10&&I++;let e=d.sharedLength||0;if(d.length>e&&!m&&(d.length=e),k>1e4)d.transitions=null,I=0,k=0,w.length>0&&(w=[]);else if(w.length>0&&!m){for(let e=0,t=w.length;e<t;e++)w[e][t7]=0;w=[]}},x=e=>{var t=e.length;t<16?n[t4++]=144|t:t<65536?(n[t4++]=220,n[t4++]=t>>8,n[t4++]=255&t):(n[t4++]=221,s.setUint32(t4,t),t4+=4);for(let r=0;r<t;r++)C(e[r])},C=e=>{t4>o&&(n=_(t4));var t,a=typeof e;if("string"===a){let r,i=e.length;if(t6&&i>=4&&i<4096){if((t6.size+=i)>21760){let e,t,r=(t6[0]?3*t6[0].length+t6[1].length:0)+10;t4+r>o&&(n=_(t4+r)),t6.position?(t=t6,n[t4]=200,t4+=3,n[t4++]=98,e=t4-u,t4+=4,ri(u,C,0),s.setUint16(e+u-3,t4-u-e)):(n[t4++]=214,n[t4++]=98,e=t4-u,t4+=4),(t6=["",""]).previous=t,t6.size=0,t6.position=e}let t=t9.test(e);t6[+!t]+=e,n[t4++]=193,C(t?-i:i);return}r=i<32?1:i<256?2:i<65536?3:5;let a=3*i;if(t4+a>o&&(n=_(t4+a)),i<64||!f){let a,s,o,l=t4+r;for(a=0;a<i;a++)(s=e.charCodeAt(a))<128?n[l++]=s:(s<2048?n[l++]=s>>6|192:((64512&s)==55296&&(64512&(o=e.charCodeAt(a+1)))==56320?(s=65536+((1023&s)<<10)+(1023&o),a++,n[l++]=s>>18|240,n[l++]=s>>12&63|128):n[l++]=s>>12|224,n[l++]=s>>6&63|128),n[l++]=63&s|128);t=l-t4-r}else t=f(e,t4+r);t<32?n[t4++]=160|t:t<256?(r<2&&n.copyWithin(t4+2,t4+1,t4+1+t),n[t4++]=217,n[t4++]=t):t<65536?(r<3&&n.copyWithin(t4+3,t4+2,t4+2+t),n[t4++]=218,n[t4++]=t>>8,n[t4++]=255&t):(r<5&&n.copyWithin(t4+5,t4+3,t4+3+t),n[t4++]=219,s.setUint32(t4,t),t4+=4),t4+=t}else if("number"===a)if(e>>>0===e)e<32||e<128&&!1===this.useRecords||e<64&&!this.randomAccessStructure?n[t4++]=e:e<256?(n[t4++]=204,n[t4++]=e):e<65536?(n[t4++]=205,n[t4++]=e>>8,n[t4++]=255&e):(n[t4++]=206,s.setUint32(t4,e),t4+=4);else if((0|e)===e)e>=-32?n[t4++]=256+e:e>=-128?(n[t4++]=208,n[t4++]=e+256):e>=-32768?(n[t4++]=209,s.setInt16(t4,e),t4+=2):(n[t4++]=210,s.setInt32(t4,e),t4+=4);else{let t;if((t=this.useFloat32)>0&&e<0x100000000&&e>=-0x80000000){let r;if(n[t4++]=202,s.setFloat32(t4,e),t<4||(0|(r=e*t0[(127&n[t4])<<1|n[t4+1]>>7]))===r){t4+=4;return}t4--}n[t4++]=203,s.setFloat64(t4,e),t4+=8}else if("object"===a||"function"===a)if(e){if(p){let t=p.get(e);if(t){t.id||(t.id=(p.idsToInsert||(p.idsToInsert=[])).push(t)),n[t4++]=214,n[t4++]=112,s.setUint32(t4,t.id),t4+=4;return}p.set(e,{offset:t4-u})}let l=e.constructor;if(l===Object)O(e);else if(l===Array)x(e);else if(l===Map)if(this.mapAsEmptyObject)n[t4++]=128;else for(let[r,i]of((t=e.size)<16?n[t4++]=128|t:t<65536?(n[t4++]=222,n[t4++]=t>>8,n[t4++]=255&t):(n[t4++]=223,s.setUint32(t4,t),t4+=4),e))C(r),C(i);else{for(let t=0,a=r.length;t<a;t++)if(e instanceof i[t]){let i,a=r[t];if(a.write){a.type&&(n[t4++]=212,n[t4++]=a.type,n[t4++]=0);let t=a.write.call(this,e);t===e?Array.isArray(e)?x(e):O(e):C(t);return}let l=n,u=s,c=t4;n=null;try{i=a.pack.call(this,e,e=>(n=l,l=null,(t4+=e)>o&&_(t4),{target:n,targetView:s,position:t4-e}),C)}finally{l&&(n=l,s=u,t4=c,o=n.length-10)}i&&(i.length+t4>o&&_(i.length+t4),t4=function(e,t,r,i){let n=e.length;switch(n){case 1:t[r++]=212;break;case 2:t[r++]=213;break;case 4:t[r++]=214;break;case 8:t[r++]=215;break;case 16:t[r++]=216;break;default:n<256?(t[r++]=199,t[r++]=n):(n<65536?(t[r++]=200,t[r++]=n>>8):(t[r++]=201,t[r++]=n>>24,t[r++]=n>>16&255,t[r++]=n>>8&255),t[r++]=255&n)}return t[r++]=i,t.set(e,r),r+=n}(i,n,t4,a.type));return}if(Array.isArray(e))x(e);else{if(e.toJSON){let t=e.toJSON();if(t!==e)return C(t)}if("function"===a)return C(this.writeFunction&&this.writeFunction(e));O(e)}}}else n[t4++]=192;else if("boolean"===a)n[t4++]=e?195:194;else if("bigint"===a){if(e<0x8000000000000000&&e>=-0x8000000000000000)n[t4++]=211,s.setBigInt64(t4,e);else if(e<0xffffffffffffffff&&e>0)n[t4++]=207,s.setBigUint64(t4,e);else if(this.largeBigIntToFloat)n[t4++]=203,s.setFloat64(t4,Number(e));else if(this.largeBigIntToString)return C(e.toString());else if((this.useBigIntExtension||this.moreTypes)&&e<BigInt(2)**BigInt(1023)&&e>-(BigInt(2)**BigInt(1023))){let t;n[t4++]=199,t4++,n[t4++]=66;let r=[];do{let i=e&BigInt(255);t=(i&BigInt(128))===(e<BigInt(0)?BigInt(128):BigInt(0)),r.push(i),e>>=BigInt(8)}while(!((e===BigInt(0)||e===BigInt(-1))&&t))n[t4-2]=r.length;for(let e=r.length;e>0;)n[t4++]=Number(r[--e]);return}else throw RangeError(e+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension, or set largeBigIntToFloat to convert to float-64, or set largeBigIntToString to convert to string");t4+=8}else if("undefined"===a)this.encodeUndefinedAsNil?n[t4++]=192:(n[t4++]=212,n[t4++]=0,n[t4++]=0);else throw Error("Unknown type: "+a)},R=this.variableMapSize||this.coercibleKeyAsNumber||this.skipValues?e=>{let t,r;if(this.skipValues)for(let r in t=[],e)("function"!=typeof e.hasOwnProperty||e.hasOwnProperty(r))&&!this.skipValues.includes(e[r])&&t.push(r);else t=Object.keys(e);let i=t.length;if(i<16?n[t4++]=128|i:i<65536?(n[t4++]=222,n[t4++]=i>>8,n[t4++]=255&i):(n[t4++]=223,s.setUint32(t4,i),t4+=4),this.coercibleKeyAsNumber)for(let n=0;n<i;n++){let i=Number(r=t[n]);C(isNaN(i)?r:i),C(e[r])}else for(let n=0;n<i;n++)C(r=t[n]),C(e[r])}:e=>{n[t4++]=222;let t=t4-u;t4+=2;let r=0;for(let t in e)("function"!=typeof e.hasOwnProperty||e.hasOwnProperty(t))&&(C(t),C(e[t]),r++);if(r>65535)throw Error('Object is too large to serialize with fast 16-bit map size, use the "variableMapSize" option to serialize this object');n[t+++u]=r>>8,n[t+u]=255&r},F=!1===this.useRecords?R:e.progressiveRecords&&!b?e=>{let t,r,i=d.transitions||(d.transitions=Object.create(null)),a=t4++-u;for(let n in e)if("function"!=typeof e.hasOwnProperty||e.hasOwnProperty(n)){if(r=i[n])i=r;else{let s=Object.keys(e),o=i;i=d.transitions;let l=0;for(let e=0,t=s.length;e<t;e++){let t=s[e];!(r=i[t])&&(r=i[t]=Object.create(null),l++),i=r}a+u+1==t4?(t4--,M(i,s,l)):D(i,s,a,l),t=!0,i=o[n]}C(e[n])}if(!t){let t=i[t7];t?n[a+u]=t:D(i,Object.keys(e),a,0)}}:e=>{let t,r=d.transitions||(d.transitions=Object.create(null)),i=0;for(let n in e)("function"!=typeof e.hasOwnProperty||e.hasOwnProperty(n))&&(!(t=r[n])&&(t=r[n]=Object.create(null),i++),r=t);let a=r[t7];for(let t in a?a>=96&&b?(n[t4++]=(31&(a-=96))+96,n[t4++]=a>>5):n[t4++]=a:M(r,r.__keys__||Object.keys(e),i),e)("function"!=typeof e.hasOwnProperty||e.hasOwnProperty(t))&&C(e[t])},A="function"==typeof this.useRecords&&this.useRecords,O=A?e=>{A(e)?F(e):R(e)}:F,_=e=>{let t;if(e>0x1000000){if(e-u>t8)throw Error("Packed buffer would be larger than maximum buffer size");t=Math.min(t8,4096*Math.round(Math.max((e-u)*(e>0x4000000?1.25:2),4194304)/4096))}else t=(Math.max(e-u<<2,n.length-1)>>12)+1<<12;let r=new t5(t);return s=r.dataView||(r.dataView=new DataView(r.buffer,0,t)),e=Math.min(e,n.length),n.copy?n.copy(r,0,u,e):r.set(n.slice(u,e)),t4-=u,u=0,o=r.length-10,n=r},M=(e,t,r)=>{let i=d.nextId;i||(i=64),i<v&&this.shouldShareStructure&&!this.shouldShareStructure(t)?((i=d.nextOwnId)<E||(i=v),d.nextOwnId=i+1):(i>=E&&(i=v),d.nextId=i+1);let a=t.highByte=i>=96&&b?i-96>>5:-1;e[t7]=i,e.__keys__=t,d[i-64]=t,i<v?(t.isShared=!0,d.sharedLength=i-63,c=!0,a>=0?(n[t4++]=(31&i)+96,n[t4++]=a):n[t4++]=i):(a>=0?(n[t4++]=213,n[t4++]=114,n[t4++]=(31&i)+96,n[t4++]=a):(n[t4++]=212,n[t4++]=114,n[t4++]=i),r&&(k+=I*r),w.length>=S&&(w.shift()[t7]=0),w.push(e),C(t))},D=(e,t,r,i)=>{let s=n,l=t4,c=o,d=u;t4=0,u=0,(n=a)||(a=n=new t5(8192)),o=n.length-10,M(e,t,i),a=n;let p=t4;if(n=s,t4=l,o=c,u=d,p>1){let e=t4+p-1;e>o&&_(e);let t=r+u;n.copyWithin(t+p,t+1,t4),n.set(a.slice(0,p),t),t4=e}else n[r+u]=a[0]},N=e=>{let t=l(e,n,u,t4,d,_,(e,t,r)=>{if(r)return c=!0;t4=t;let i=n;return(C(e),T(),i!==n)?{position:t4,targetView:s,target:n}:t4},this);if(0===t)return O(e);t4=t}}useBuffer(e){(n=e).dataView||(n.dataView=new DataView(n.buffer,n.byteOffset,n.byteLength)),t4=0}set position(e){t4=e}get position(){return t4}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}function rt(e,t,r,i){let n=e.byteLength;if(n+1<256){var{target:a,position:s}=r(4+n);a[s++]=199,a[s++]=n+1}else if(n+1<65536){var{target:a,position:s}=r(5+n);a[s++]=200,a[s++]=n+1>>8,a[s++]=n+1&255}else{var{target:a,position:s,targetView:o}=r(7+n);a[s++]=201,o.setUint32(s,n+1),s+=4}a[s++]=116,a[s++]=t,e.buffer||(e=new Uint8Array(e)),a.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),s)}function rr(e,t){let r=e.byteLength;if(r<256){var i,n,{target:i,position:n}=t(r+2);i[n++]=196,i[n++]=r}else if(r<65536){var{target:i,position:n}=t(r+3);i[n++]=197,i[n++]=r>>8,i[n++]=255&r}else{var{target:i,position:n,targetView:a}=t(r+5);i[n++]=198,a.setUint32(n,r),n+=4}i.set(e,n)}function ri(e,t,r){if(t6.length>0){s.setUint32(t6.position+e,t4+r-t6.position-e),t6.stringsPosition=t4-e;let i=t6;t6=null,t(i[0]),t(i[1])}}i=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,DataView,tb],r=[{pack(e,t,r){let i=e.getTime()/1e3;if((this.useTimestamp32||0===e.getMilliseconds())&&i>=0&&i<0x100000000){let{target:e,targetView:r,position:n}=t(6);e[n++]=214,e[n++]=255,r.setUint32(n,i)}else if(i>0&&i<0x100000000){let{target:r,targetView:n,position:a}=t(10);r[a++]=215,r[a++]=255,n.setUint32(a,4e6*e.getMilliseconds()+(i/1e3/0x100000000|0)),n.setUint32(a+4,i)}else if(isNaN(i)){if(this.onInvalidDate)return t(0),r(this.onInvalidDate());let{target:e,targetView:i,position:n}=t(3);e[n++]=212,e[n++]=255,e[n++]=255}else{let{target:r,targetView:n,position:a}=t(15);r[a++]=199,r[a++]=12,r[a++]=255,n.setUint32(a,1e6*e.getMilliseconds()),n.setBigInt64(a+4,BigInt(Math.floor(i)))}}},{pack(e,t,r){if(this.setAsEmptyObject)return t(0),r({});let i=Array.from(e),{target:n,position:a}=t(3*!!this.moreTypes);this.moreTypes&&(n[a++]=212,n[a++]=115,n[a++]=0),r(i)}},{pack(e,t,r){let{target:i,position:n}=t(3*!!this.moreTypes);this.moreTypes&&(i[n++]=212,i[n++]=101,i[n++]=0),r([e.name,e.message,e.cause])}},{pack(e,t,r){let{target:i,position:n}=t(3*!!this.moreTypes);this.moreTypes&&(i[n++]=212,i[n++]=120,i[n++]=0),r([e.source,e.flags])}},{pack(e,t){this.moreTypes?rt(e,16,t):rr(t2?tu.Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let r=e.constructor;r!==t3&&this.moreTypes?rt(e,tJ.indexOf(r.name),t):rr(e,t)}},{pack(e,t){this.moreTypes?rt(e,17,t):rr(t2?tu.Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let{target:r,position:i}=t(1);r[i]=193}}];let rn=new re({useRecords:!1});rn.pack,rn.pack;let{NEVER:ra,ALWAYS:rs,DECIMAL_ROUND:ro,DECIMAL_FIT:rl}={NEVER:0,ALWAYS:1,DECIMAL_ROUND:3,DECIMAL_FIT:4},ru=512,rc=1024,rd=2048;class rp extends tl.Tag("@effect/rpc/RpcSerialization")(){}let rf=rp.of({contentType:"application/json",includesFraming:!1,unsafeMake:()=>{let e=new TextDecoder;return{decode:t=>[JSON.parse("string"==typeof t?t:e.decode(t))],encode:e=>JSON.stringify(e)}}}),rh=rp.of({contentType:"application/ndjson",includesFraming:!0,unsafeMake:()=>{let e=new TextDecoder,t="";return{decode:r=>{t+="string"==typeof r?r:e.decode(r);let i=0,n=t.indexOf("\n",i),a=[];for(;-1!==n;){let e=JSON.parse(t.slice(i,n));a.push(e),i=n+1,n=t.indexOf("\n",i)}return t=t.slice(i),a},encode:e=>{if(Array.isArray(e)){if(0===e.length)return;let t="";for(let r=0;r<e.length;r++)t+=JSON.stringify(e[r])+"\n";return t}return JSON.stringify(e)+"\n"}}}}),rm=e=>rp.of({contentType:e?.contentType??"application/json",includesFraming:!1,unsafeMake:()=>{let e=new TextDecoder,t=new Map;return{decode:r=>ry(JSON.parse("string"==typeof r?r:e.decode(r)),t),encode:e=>{if(Array.isArray(e)){if(0===e.length)return;return JSON.stringify(e.map(rv))}let r=rb(e,t);return r&&JSON.stringify(r)}}}}),rg=e=>rp.of({contentType:e?.contentType??"application/json-rpc",includesFraming:!0,unsafeMake:()=>{let e=rh.unsafeMake(),t=new Map;return{decode:r=>{let i=e.decode(r);if(0===i.length)return[];let n=[];for(let e=0;e<i.length;e++){let r=i[e];n.push(...ry(r,t))}return n},encode:r=>{if(Array.isArray(r))return e.encode(r.map(rv));let i=rb(r,t);return i&&e.encode(i)}}}});function ry(e,t){if(Array.isArray(e)){let r={size:0,responses:new Map};for(let i=0;i<e.length;i++){let n=rS(e[i]);"Request"===n._tag&&(r.size++,t.set(n.id,r))}return[]}return Array.isArray(e)?e.map(rS):[rS(e)]}function rS(e){if("method"in e){if(!e.id&&e.method.startsWith("@effect/rpc/")){let t=e.method.slice(12),r=e.params?.requestId;return r?{_tag:t,requestId:String(r)}:{_tag:t}}return{_tag:"Request",id:e.id?String(e.id):"",tag:e.method,payload:e.params,headers:e.headers??[],traceId:e.traceId,spanId:e.spanId,sampled:e.sampled}}return e.error&&"Defect"===e.error._tag?{_tag:"Defect",defect:e.error.data}:!0===e.chunk?{_tag:"Chunk",requestId:String(e.id),values:e.result}:{_tag:"Exit",requestId:String(e.id),exit:null!=e.error?{_tag:"Failure",cause:"Cause"===e.error._tag?e.error.data:{_tag:"Die",defect:e.error}}:{_tag:"Success",value:e.result}}}function rb(e,t){if(!("requestId"in e))return rv(e);let r=t.get(e.requestId);return r?(t.delete(e.requestId),r.responses.set(e.requestId,e),r.size===r.responses.size)?Array.from(r.responses.values(),rv):void 0:rv(e)}function rv(e){switch(e._tag){case"Request":return{jsonrpc:"2.0",method:e.tag,params:e.payload,id:e.id&&Number(e.id),headers:e.headers,traceId:e.traceId,spanId:e.spanId,sampled:e.sampled};case"Ping":case"Pong":case"Interrupt":case"Ack":case"Eof":return{jsonrpc:"2.0",method:`@effect/rpc/${e._tag}`,params:"requestId"in e?{requestId:e.requestId}:void 0};case"Chunk":return{jsonrpc:"2.0",chunk:!0,id:Number(e.requestId),result:e.values};case"Exit":return{jsonrpc:"2.0",id:e.requestId?Number(e.requestId):void 0,result:"Success"===e.exit._tag?e.exit.value:void 0,error:"Failure"===e.exit._tag?{_tag:"Cause",code:"Fail"===e.exit.cause._tag&&(0,J.hasProperty)(e.exit.cause.error,"code")?Number(e.exit.cause.error.code):0,message:"Fail"===e.exit.cause._tag&&(0,J.hasProperty)(e.exit.cause.error,"message")?e.exit.cause.error.message:JSON.stringify(e.exit.cause),data:e.exit.cause}:void 0};case"Defect":return{jsonrpc:"2.0",id:rE,error:{_tag:"Defect",code:1,message:"A defect occurred",data:e.defect}};case"ClientProtocolError":return{}}}let rE=-32603,rw=rp.of({contentType:"application/msgpack",includesFraming:!0,unsafeMake:()=>{let e,t=new tk,r=new re,i=new TextEncoder;return{decode:r=>{let n="string"==typeof r?i.encode(r):r;if(void 0!==e){let t=n;(r=new Uint8Array(e.length+n.length)).set(e),r.set(t,e.length),n=r,e=void 0}try{return t.unpackMultiple(n)}catch(t){if(t.incomplete)return e=n.subarray(t.lastPosition),t.values??[];return[]}},encode:e=>r.pack(e)}}}),rk=G.succeed(rp,rf),rI=G.succeed(rp,rh),rT=G.succeed(rp,rw);e.s(["RpcSerialization",0,rp,"json",0,rf,"jsonRpc",0,rm,"layerJson",0,rk,"layerJsonRpc",0,e=>G.succeed(rp,rm(e)),"layerMsgPack",0,rT,"layerNdJsonRpc",0,e=>G.succeed(rp,rg(e)),"layerNdjson",0,rI,"msgPack",0,rw,"ndJsonRpc",0,rg,"ndjson",0,rh],6596031);var rx=U;class rC extends rx.Tag("@effect/rpc/RpcWorker/InitialMessage")(){}let rR=BigInt(0),rF=W.fnUntraced(function*(e,t){let r,i=t?.spanPrefix??"RpcClient",n=t?.supportsAck??!0,a=t?.disableTracing??!1,s=t?.generateRequestId??(()=>rR++),o=yield*W.context(),l=eG.get(o,Z.Scope),u=new Map,c=!1;yield*Z.addFinalizer(l,W.fiberIdWith(e=>(c=!0,d(q.interrupt(e)))));let d=W.fnUntraced(function*(e){for(let[t,r]of u)u.delete(t),"Mailbox"===r._tag?yield*r.mailbox.done(e):r.resume(e)}),p=e=>{let r=e.successSchema.ast.annotations[eY.SchemaIdAnnotationId]===eX,n=m(e);return(s,o)=>{let l=o?.headers?M.fromInput(o.headers):M.empty,u=o?.context??eG.empty();if(!r){let r=t=>f(e,n,t,e.payloadSchema.make?e.payloadSchema.make(s):s,l,u,o?.discard??!1);return a?r(void 0):W.useSpan(`${i}.${e._tag}`,{captureStackTrace:!1,attributes:t.spanAttributes},r)}let c=h(e,n,e.payloadSchema.make?e.payloadSchema.make(s):s,l,o?.streamBufferSize??16,u);return o?.asMailbox?c:eW.unwrapScoped(W.map(c,K.toStream))}},f=(e,r,i,n,a,o,l)=>W.withFiberRuntime(d=>{let p;if(c)return W.interrupt;let f=s(),h=r({_tag:"Request",id:f,tag:e._tag,payload:n,traceId:i?.traceId,spanId:i?.spanId,sampled:i?.sampled,headers:M.merge(d.getFiberRef(rO),a)});if(l)return W.flatMap(h,e=>t.onFromClient({message:e,context:o,discard:l}));let m=eU.make({context:d.currentContext,fiberRefs:d.getFiberRefs(),runtimeFlags:eU.defaultRuntime.runtimeFlags});return W.onInterrupt(W.async(r=>{u.set(f,{_tag:"Effect",rpc:e,context:o,resume(e){r(e),p&&!p.unsafePoll()&&d.currentScheduler.scheduleTask(()=>{p.unsafeInterruptAsFork(d.id())},0)}}),(p=h.pipe(W.flatMap(e=>t.onFromClient({message:e,context:o,discard:l})),i?W.withParentSpan(i):V.identity,eU.runFork(m))).addObserver(e=>{if("Failure"===e._tag)return r(e)})}),e=>{u.delete(f);let t=Array.from(e).flatMap(e=>Array.from(eJ.toSet(e)));return W.zipRight(eK.interrupt(p),g(f,t,o))})}),h=W.fnUntraced(function*(e,r,n,o,l,d){if(c)return yield*W.interrupt;let p=a?void 0:yield*W.makeSpanScoped(`${i}.${e._tag}`,{captureStackTrace:!1,attributes:t.spanAttributes}),f=eb.getOrThrow(eK.getCurrentFiber()),h=s(),m=eG.unsafeGet(f.currentContext,Z.Scope);yield*Z.addFinalizerExit(m,e=>u.has(h)?(u.delete(h),g(h,q.isFailure(e)?Array.from(eV.interruptors(e.cause)).flatMap(e=>Array.from(eJ.toSet(e))):[],d)):W.void);let y=yield*K.make(l);return u.set(h,{_tag:"Mailbox",rpc:e,mailbox:y,scope:m,context:d}),yield*r({_tag:"Request",id:h,tag:e._tag,traceId:p?.traceId,payload:n,spanId:p?.spanId,sampled:p?.sampled,headers:M.merge(f.getFiberRef(rO),o)}).pipe(W.flatMap(e=>t.onFromClient({message:e,context:d,discard:!1})),p?W.withParentSpan(p):V.identity,W.catchAllCause(e=>y.failCause(e)),W.interruptible,W.forkIn(m)),y}),m=e=>{let t=[];for(let r of e.middlewares.values()){let e=o.unsafeMap.get(`${r.key}/Client`);e&&t.push(e)}return 0===t.length?W.succeed:function(r){let i=0;return W.map(W.whileLoop({while:()=>i<t.length,body:()=>t[i]({rpc:e,request:r}),step(e){r=e,i++}}),()=>r)}},g=(e,r,i)=>W.async(n=>{let a=eb.getOrThrow(eK.getCurrentFiber()),s=eU.make({context:a.currentContext,fiberRefs:a.getFiberRefs(),runtimeFlags:eU.defaultRuntime.runtimeFlags});t.onFromClient({message:{_tag:"Interrupt",requestId:e,interruptors:r},context:i,discard:!1}).pipe(W.timeout(1e3),eU.runFork(s)).addObserver(()=>{n(W.void)})});if(t.flatten){let t=new Map;r=function(r,i,n){let a=t.get(r);return a||(a=p(e.requests.get(r)),t.set(r,a)),a(i,n)}}else for(let t of(r={},e.requests.values())){let e=t._tag.indexOf("."),i=-1===e?void 0:t._tag.slice(0,e);void 0===i||i in r||(r[i]={}),(void 0!==i?r[i]:r)[void 0!==i?t._tag.slice(e+1):t._tag]=p(t)}return{client:r,write:e=>{switch(e._tag){case"Chunk":{let r=e.requestId,i=u.get(r);if(!i||"Mailbox"!==i._tag)return W.void;return i.mailbox.offerAll(e.values).pipe(n?W.zipRight(t.onFromClient({message:{_tag:"Ack",requestId:e.requestId},context:i.context,discard:!1})):V.identity,W.catchAllCause(e=>i.mailbox.done(q.failCause(e))))}case"Exit":{let t=e.requestId,r=u.get(t);if(!r)return W.void;if(u.delete(t),"Effect"===r._tag)return r.resume(e.exit),W.void;return r.mailbox.done(q.asVoid(e.exit))}case"Defect":return d(q.die(e.defect));case"ClientEnd":return W.void}}}}),rA=W.fnUntraced(function*(e,t){let{run:r,send:i,supportsAck:n,supportsTransferables:a}=yield*rD,s=new Map,{client:o,write:l}=yield*rF(e,{...t,supportsAck:n,onFromClient(t){let{message:r}=t;switch(r._tag){case"Request":{let t,n,o,l,u=e.requests.get(r.tag),c=e0(u.successSchema.ast),d=a?(t=[],n=e=>{t.push(...e)},o=()=>t,l=()=>{let e=t;return t=[],e},ew.of({unsafeAddAll:n,addAll:e=>W.sync(()=>n(e)),unsafeRead:o,read:W.sync(o),unsafeClear:l,clear:W.sync(l)})):void 0,p=eb.getOrThrow(eK.getCurrentFiber()),f={rpc:u,context:d?eG.add(p.currentContext,ew,d):p.currentContext,decodeChunk:eb.isSome(c)?eE.decodeUnknown(eE.NonEmptyArray(c.value.success)):void 0};return s.set(r.id,f),eE.encode(u.payloadSchema)(r.payload).pipe(W.locally($.currentContext,f.context),W.orDie,W.flatMap(e=>i({...r,id:String(r.id),payload:e,headers:Object.entries(r.headers)},d&&d.unsafeClear())))}case"Ack":if(!s.get(r.requestId))return W.void;return i({_tag:"Ack",requestId:String(r.requestId)});case"Interrupt":if(!s.get(r.requestId))return W.void;return s.delete(r.requestId),i({_tag:"Interrupt",requestId:String(r.requestId)});case"Eof":return W.void}}});return yield*r(e=>{switch(e._tag){case"Chunk":{let t=ts(e.requestId),r=s.get(t);if(!r||!r.decodeChunk)return W.void;return r.decodeChunk(e.values).pipe(W.locally($.currentContext,r.context),W.orDie,W.flatMap(t=>l({_tag:"Chunk",clientId:0,requestId:ts(e.requestId),values:t})),W.onError(t=>l({_tag:"Exit",clientId:0,requestId:ts(e.requestId),exit:q.failCause(t)})))}case"Exit":{let t=ts(e.requestId),r=s.get(t);if(!r)return W.void;return s.delete(t),eE.decode(e6(r.rpc))(e.exit).pipe(W.locally($.currentContext,r.context),W.orDie,W.matchCauseEffect({onSuccess:e=>l({_tag:"Exit",clientId:0,requestId:t,exit:e}),onFailure:e=>l({_tag:"Exit",clientId:0,requestId:t,exit:q.failCause(e)})}))}case"Defect":return l({_tag:"Defect",clientId:0,defect:rz(e.defect)});case"ClientProtocolError":{let t=q.fail(e.error);return W.forEach(s.keys(),e=>l({_tag:"Exit",clientId:0,requestId:e,exit:t}))}default:return W.void}}).pipe(W.catchAllCause(W.logError),W.interruptible,W.forkScoped),o}),rO=(0,H.globalValue)("@effect/rpc/RpcClient/currentHeaders",()=>$.unsafeMake(M.empty)),r_=(0,V.dual)(2,(e,t)=>W.locallyWith(e,rO,M.merge(M.fromInput(t)))),rM=(0,V.dual)(2,(e,t)=>W.flatMap(t,t=>r_(e,t)));class rD extends eG.Tag("@effect/rpc/RpcClient/Protocol")(){static make=e=>W.suspend(()=>{let t=W.unsafeMakeSemaphore(1),r=[],i=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return W.contextWith(e=>{r.push([t,e])})};return W.map(e(function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return i(...t)}),e=>({...e,run:e=>t.withPermits(1)(W.gen(function*(){let t=i;for(let[t,n]of(i=e,r))yield*W.provide(i(...t),n);return r=[],yield*W.onExit(W.never,()=>(i=t,W.void))}))}))})}let rN=e=>rD.make(W.fnUntraced(function*(t){let r=yield*rp,i="application/json"===r.contentType;return{send:n=>{if("Request"!==n._tag)return W.void;let a=r.unsafeMake(),s=a.encode(n),o="string"==typeof s?D.text(s,r.contentType):D.uint8Array(s,r.contentType);return i?e.post("",{body:o}).pipe(W.flatMap(e=>e.json),W.mapError(e=>new ta({reason:"Protocol",message:"Failed to send HTTP request",cause:e})),W.flatMap(e=>{if(!Array.isArray(e))return W.dieMessage(`Expected an array of responses, but got: ${e}`);let r=0;return W.whileLoop({while:()=>r<e.length,body:()=>t(e[r++]),step:V.constVoid})})):e.post("",{body:o}).pipe(W.flatMap(e=>eW.runForEachChunk(e.stream,e=>{let r=eH.toReadonlyArray(e).flatMap(a.decode);if(0===r.length)return W.void;let i=0;return W.whileLoop({while:()=>i<r.length,body:()=>t(r[i++]),step:V.constVoid})})),W.mapError(e=>new ta({reason:"Protocol",message:"Failed to send HTTP request",cause:e})))},supportsAck:!1,supportsTransferables:!1}})),rP=e=>rD.make(W.fnUntraced(function*(t){let r,i=yield*ee,n=yield*rp,a=yield*i.writer,s=n.unsafeMake(),o=yield*rL(a(s.encode(to))),l=W.sync(()=>{r=void 0});return yield*W.suspend(()=>(s=n.unsafeMake(),o.reset(),i.runRaw(e=>{try{let r=s.decode(e);if(0===r.length)return;let i=0;return W.whileLoop({while:()=>i<r.length,body:()=>{let e=r[i++];return"Pong"===e._tag&&o.onPong(),t(e)},step:V.constVoid})}catch(e){return t({_tag:"ClientProtocolError",error:new ta({reason:"Protocol",message:"Error decoding message",cause:eV.fail(e)})})}},{onOpen:l}).pipe(W.raceFirst(W.zipRight(o.timeout,W.fail(new ea({reason:"OpenTimeout",cause:Error("ping timeout")}))))))).pipe(W.zipRight(W.fail(new es({reason:"Close",code:1e3}))),W.tapErrorCause(i=>{let n=eV.failureOption(i);return e?.retryTransientErrors&&eb.isSome(n)&&("Open"===n.value.reason||"OpenTimeout"===n.value.reason)?W.void:t({_tag:"ClientProtocolError",error:r=new ta({reason:"Protocol",message:"Error in socket",cause:eV.squash(i)})})}),W.retry(ez.spaced(1e3)),W.annotateLogs({module:"RpcClient",method:"makeProtocolSocket"}),W.interruptible,W.forkScoped),{send(e){if(r)return W.fail(r);let t=s.encode(e);return void 0===t?W.void:W.orDie(a(t))},supportsAck:!0,supportsTransferables:!1}})),rL=W.fnUntraced(function*(e){let t=!0,r=W.unsafeMakeLatch();return yield*W.suspend(()=>t?(t=!1,e):r.open).pipe(W.delay("5 seconds"),W.ignore,W.forever,W.interruptible,W.forkScoped),{timeout:r.await,reset:()=>{t=!0,r.unsafeClose()},onPong:()=>{t=!0}}}),rU=e=>rD.make(W.fnUntraced(function*(t){let r,i,n,a,s=yield*ej,o=yield*W.scope,l=0,u=yield*W.serviceOption(rC),c=new Map,d=W.gen(function*(){let e=l++,r=yield*s.spawn(e),i=yield*W.makeLatch();if(yield*r.run(e=>{if(0===e[0])return i.open;let r=e[1];if("Exit"===r._tag){let e=c.get(r.requestId);e&&(c.delete(r.requestId),e.latch.unsafeOpen())}else if("Defect"===r._tag)for(let[e,t]of c)c.delete(e),t.latch.unsafeOpen();return t(r)}).pipe(W.tapErrorCause(e=>t({_tag:"ClientProtocolError",error:new ta({reason:"Protocol",message:"Error in worker",cause:eV.squash(e)})})),W.retry(ez.spaced(1e3)),W.annotateLogs({module:"RpcClient",method:"makeProtocolWorker"}),W.interruptible,W.forkScoped),yield*i.await,eb.isSome(u)){let[e,t]=yield*u.value;yield*r.send({_tag:"InitialMessage",value:e},t)}return r}),p="minSize"in e?yield*(n={acquire:d,min:e.minSize,max:e.maxSize,concurrency:e.concurrency,targetUtilization:e.targetUtilization,timeToLive:e.timeToLive},eR.flatMap("creation"===n.timeToLiveStrategy?(r=n.timeToLive,eF.clockWith(e=>eR.map(e_.unbounded(),t=>{let i=ek.toMillis(r),n=new WeakMap;return(0,V.identity)({run:r=>{let a=t=>eR.suspend(()=>{if(!r.items.has(t)||r.invalidated.has(t))return eR.void;let s=i-(e.unsafeCurrentTimeMillis()-n.get(t));return s>0?eC.delay(a(t),s):r.invalidatePoolItem(t)});return t.take.pipe(eR.tap(a),eC.forever)},onAcquire:r=>eR.suspend(()=>(n.set(r,e.unsafeCurrentTimeMillis()),t.offer(r))),reclaim:e=>eC.succeedNone})}))):(i=n.timeToLive,eR.map(e_.unbounded(),e=>(0,V.identity)({run:t=>{let r=eR.suspend(()=>t.activeSize-t.targetSize<=0?eR.void:e.take.pipe(eR.tap(e=>t.invalidatePoolItem(e)),eR.zipRight(r)));return r.pipe(eC.delay(i),eC.forever)},onAcquire:t=>e.offer(t),reclaim:t=>eR.suspend(()=>{if(0===t.invalidated.size)return eC.succeedNone;let r=eT.head(eT.filter(t.invalidated,e=>!e.disableReclaim));return"None"===r._tag?eC.succeedNone:(t.invalidated.delete(r.value),r.value.refCount<t.concurrency&&t.available.add(r.value),eR.as(e.offer(r.value),r))})}))),e=>eN({...n,strategy:e}))):yield*eN({...a={acquire:d,size:e.size,concurrency:e.concurrency,targetUtilization:e.targetUtilization},min:a.size,max:a.size,strategy:{run:e=>eR.void,onAcquire:e=>eR.void,reclaim:e=>eC.succeedNone}});return yield*Z.addFinalizer(o,W.sync(()=>{for(let e of c.values())e.latch.unsafeOpen();c.clear()})),yield*W.scoped(p.get),{send:(e,t)=>{switch(e._tag){case"Request":return p.get.pipe(W.flatMap(r=>{let i=W.unsafeMakeLatch(!1);return c.set(e.id,{worker:r,latch:i}),W.zipRight(r.send(e,t),i.await)}),W.scoped,W.orDie);case"Interrupt":{let t=c.get(e.requestId);if(!t)return W.void;return c.delete(e.requestId),t.latch.unsafeOpen(),W.orDie(t.worker.send(e))}case"Ack":{let t=c.get(e.requestId);if(!t)return W.void;return W.orDie(t.worker.send(e))}}return W.void},supportsAck:!0,supportsTransferables:!0}})),rz=ev.decodeSync(eE.Defect);e.s(["Protocol",0,rD,"currentHeaders",0,rO,"layerProtocolHttp",0,e=>G.scoped(rD,W.flatMap(N.HttpClient,t=>(t=N.mapRequest(t,P.prependUrl(e.url)),rN(e.transformClient?e.transformClient(t):t)))),"layerProtocolSocket",0,e=>G.scoped(rD,rP(e)),"layerProtocolWorker",0,e=>G.scoped(rD,rU(e)),"make",0,rA,"makeNoSerialization",0,rF,"makeProtocolHttp",0,rN,"makeProtocolSocket",0,rP,"makeProtocolWorker",0,rU,"withHeaders",0,r_,"withHeadersEffect",0,rM],3065986);var rW=e.i(3065986),rW=rW,rB=e.i(6596031),rB=rB,rq=w,r$=e.i(3901156),r$=r$;let rj=Symbol.for("@effect/rpc/RpcGroup"),rV={add(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return rH({requests:rG(...this.requests.values(),...t),annotations:this.annotations})},merge(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let i=new Map(this.requests),n=new Map(this.annotations.unsafeMap);for(let e of t){for(let[t,r]of e.requests)i.set(t,r);for(let[t,r]of e.annotations.unsafeMap)n.set(t,r)}return rH({requests:i,annotations:U.unsafeMake(n)})},middleware(e){let t=new Map;for(let[r,i]of this.requests)t.set(r,i.middleware(e));return rH({requests:t,annotations:this.annotations})},toHandlersContext(e){return W.gen(this,function*(){let t=yield*W.context(),r=W.isEffect(e)?yield*e:e,i=new Map;for(let[e,n]of Object.entries(r)){let r=this.requests.get(e);i.set(r.key,{handler:n,context:t})}return U.unsafeMake(i)})},prefix(e){let t=new Map;for(let r of this.requests.values()){let i=r.prefix(e);t.set(i._tag,i)}return rH({requests:t,annotations:this.annotations})},toLayer(e){return G.scopedContext(this.toHandlersContext(e))},of:V.identity,toLayerHandler(e,t){return G.scopedContext(W.gen(this,function*(){let r=yield*W.context(),i=W.isEffect(t)?yield*t:t,n=new Map,a=this.requests.get(e);return n.set(a.key,{handler:i,context:r}),U.unsafeMake(n)}))},accessHandler(e){return W.contextWith(t=>{let r=this.requests.get(e),{context:i,handler:n}=t.unsafeMap.get(r.key);return(e,t)=>{let r=n(e,t),a=e7(r)?r.value:r;return W.isEffect(a)?W.provide(a,i):eW.provideContext(a,i)}})},annotate(e,t){return rH({requests:this.requests,annotations:U.add(this.annotations,e,t)})},annotateRpcs(e,t){return this.annotateRpcsContext(U.make(e,t))},annotateContext(e){return rH({requests:this.requests,annotations:U.merge(this.annotations,e)})},annotateRpcsContext(e){let t=new Map;for(let[r,i]of this.requests)t.set(r,i.annotateContext(U.merge(e,i.annotations)));return rH({requests:t,annotations:this.annotations})}},rH=e=>Object.assign(function(){},rV,{requests:e.requests,annotations:e.annotations}),rG=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let i=new Map;for(let e of t)i.set(e._tag,eE.isSchema(e)?e8(e):e);return i};e.s(["TypeId",0,rj,"make",0,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return rH({requests:rG(...t),annotations:U.empty()})}],2629577);var rK=e.i(2629577),rK=rK,rJ=e.i(2558253),rZ=e.i(6396407),rQ=e.i(693063),rY=e.i(8489575),rX=e.i(6640598);let r0=Symbol.for("@effect/rpc/RpcMiddleware");e.s(["Tag",0,()=>(e,t)=>{let r=globalThis.Error,i=r.stackTraceLimit;r.stackTraceLimit=2;let n=new r;function a(){}return r.stackTraceLimit=i,Object.setPrototypeOf(a,Object.getPrototypeOf(U.GenericTag(e))),a.key=e,Object.defineProperty(a,"stack",{get:()=>n.stack}),a[r0]=r0,a.failure=t?.optional===!0||t?.failure===void 0?eE.Never:t.failure,t?.provides&&(a.provides=t.provides),a.optional=t?.optional??!1,a.requiredForClient=t?.requiredForClient??!1,a.wrap=t?.wrap??!1,a},"TypeId",0,r0,"layerClient",0,(e,t)=>G.scopedContext(W.gen(function*(){let r=(yield*W.context()).pipe(U.omit(Z.Scope)),i=W.isEffect(t)?yield*t:t;return U.unsafeMake(new Map([[`${e.key}/Client`,e=>W.mapInputContext(i(e),e=>U.merge(r,e))]]))}))],6307191);var r1=e.i(6307191),r1=r1,r2=e.i(1615351),r5=w;let r3=(0,C.createContextKey)("MaybeUserContext");class r8 extends r5.Context.Tag(r3)(){}var r4=w;let r6=(0,C.createContextKey)("UserContext");class r9 extends r4.Context.Tag(r6)(){}var r7=w,ie=e.i(4520167),it=C;class ir extends r1.Tag()("RpcAuthMiddleware",{provides:r9,failure:ie.Schema.Union(r2.Unauthorized,r2.Forbidden,r2.NotFound,r2.NotAuthorizedForScope)}){}class ii extends r1.Tag()("RpcMaybeAuthMiddleware",{provides:r8,failure:ie.Schema.Union(r2.Unauthorized,r2.NotAuthorizedForScope)}){}class ia extends r7.Context.Tag((0,it.createContextKey)("EnabledBotIdCheck"))(){}ia.layerEnabled=I.Layer.succeed(ia,!0),ia.layerDisabled=I.Layer.succeed(ia,!1);class is extends r7.Context.Tag((0,it.createContextKey)("AuthFor"))(){}is.layerUser=I.Layer.succeed(is,"user"),is.layerTeam=I.Layer.succeed(is,"team");let io=ie.Schema.Struct({tldName:ie.Schema.String,averagePropagationDelayMs:ie.Schema.Number,p90PropagationDelayMs:ie.Schema.Number,maxPropagationDelayMs:ie.Schema.Number}),il=ie.Schema.Array(io),iu=r$.make("getSearchTlds",{payload:{registrar:rQ.RegistrarName},success:rX.SearchTldsPublicSerializable,error:rJ.GetSearchTldsErrorExternal}).middleware(ii),ic=r$.make("getNameserverPropagationStats",{payload:{},success:il,error:rZ.InternalServerError}).middleware(ii),id=r$.make("getTldOutage",{payload:{tldName:ie.Schema.String},success:ie.Schema.NullOr(rY.TldOutagePublicSerializable),error:rZ.InternalServerError}).middleware(ir),ip=rK.make(iu,ic,id),ih="/registrar/rpc",im="/registrar/domains/search/stream",ig="/registrar/domains/search/stream/socket";var r$=r$,rK=rK,iy=e.i(3090185),iS=e.i(7039842),ib=e.i(8919835),iv=e.i(4995849),iE=e.i(5286388),iw=e.i(8305092);let ik=ie.Schema.Struct({domainName:iv.DomainName.schema,years:ie.Schema.Number,autoRenew:ie.Schema.Boolean,expectedPrice:ie.Schema.optional(iE.Dollars.typeSchema),fromAiSuggestion:ie.Schema.optional(ie.Schema.Boolean)}),iI=ik.pipe(ie.Schema.omit("fromAiSuggestion"),ie.Schema.extend(ie.Schema.Struct({status:iy.OrderDomainStatus,error:ie.Schema.optional(iy.OrderDomainError.AnyOrUnknown),price:iE.Dollars.typeSchema,renewalPrice:iE.Dollars.typeSchema,tldOutage:ie.Schema.optional(ie.Schema.Struct({tldName:ie.Schema.String,endsAt:ie.Schema.DateFromString}))}))),iT=ie.Schema.Struct({domainName:iv.DomainName.schema,price:iE.Cents.typeSchema,years:ie.Schema.Number}).pipe(ie.Schema.omit("price"),ie.Schema.extend(ie.Schema.Struct({price:iE.Dollars.typeSchema}))),ix=ie.Schema.Struct({stripeClientSecret:ie.Schema.String,purchaseIntentId:ie.Schema.String,lineItems:ie.Schema.Array(iT),subtotal:iE.Dollars.typeSchema,tax:iE.Dollars.typeSchema,total:iE.Dollars.typeSchema,registrantFields:ie.Schema.Record({key:ie.Schema.String,value:ib.RegistrantFields}),claims:ie.Schema.Array(ie.Schema.Struct({domainName:iv.DomainName.schema,claimsNotice:ie.Schema.optional(ie.Schema.String),claims:ie.Schema.Array(ie.Schema.Struct({trademark:ie.Schema.String,holder:ie.Schema.String}))})),teamRegistrantInfo:ie.Schema.optional(ib.BaseAndTldRegistrantFieldValues)}),iC=r$.make("createOrder",{payload:{items:ie.Schema.Array(ik),source:ie.Schema.Literal("web","mobile")},success:ie.Schema.Struct({orderId:iw.OrderId.schema}),error:iS.CreateOrderErrorExternal}).middleware(ii),iR=r$.make("upsertOrderItem",{payload:{orderId:iw.OrderId.schema,item:ik},success:ie.Schema.Void,error:iS.UpsertOrderItemsErrorExternal}).middleware(ii),iF=r$.make("removeOrderItem",{payload:{orderId:iw.OrderId.schema,domainName:iv.DomainName.schema},success:ie.Schema.Void,error:iS.RemoveOrderItemErrorExternal}).middleware(ii),iA=r$.make("checkoutOrder",{payload:{orderId:iw.OrderId.schema,returnUrl:ie.Schema.String},success:ix,error:iS.CheckoutOrderErrorExternal}).middleware(ir),iO=r$.make("checkoutOrderMobile",{payload:{orderId:iw.OrderId.schema,returnUrl:ie.Schema.String},success:ix,error:iS.CheckoutOrderErrorExternal}).middleware(ir),i_=r$.make("getOrder",{payload:{orderId:iw.OrderId.schema},success:ie.Schema.Struct({items:ie.Schema.Array(iI),status:iy.OrderStatus,error:ie.Schema.optional(iy.OrderError.AnyOrUnknown)}),error:ie.Schema.Union(iS.GetOrderErrorExternal,iS.OrderModeMismatchError)}).middleware(ii),iM=r$.make("submitRegistrantInfoForOrder",{payload:{orderId:iw.OrderId.schema,registrantInfo:ib.BaseAndTldRegistrantFieldValues,saveForTeam:ie.Schema.optional(ie.Schema.Boolean),purchaseIntentId:ie.Schema.String},success:ie.Schema.Void,error:iS.SubmitRegistrantInfoForOrderErrorExternal}).middleware(ir),iD=ie.Schema.Union(ie.Schema.Struct({willSend:ie.Schema.Literal("yes"),email:ie.Schema.String}),ie.Schema.Struct({willSend:ie.Schema.Literal("no")}),ie.Schema.Struct({willSend:ie.Schema.Literal("maybe")})),iN=r$.make("getPostcheckoutRegistrantEmail",{payload:{orderId:iw.OrderId.schema},success:iD,error:iS.GetPostcheckoutRegistrantEmailErrorExternal}).middleware(ir),iP=rK.make(iC,iR,iF,iA,iO,i_,iM,iN);var r$=r$,rK=rK,iL=e.i(5648153),iU=e.i(6607472);let iz=ie.Schema.Literal("active","grace-period","redemption-period","expired"),iW=ie.Schema.Struct({renewalType:iz}),iB=r$.make("getDomainPrice",{payload:{domainName:iv.DomainName.schema,purchaseType:ie.Schema.Literal("renewal","transfer","redemption"),years:ie.Schema.optional(ie.Schema.Int.pipe(ie.Schema.between(1,10)))},success:ie.Schema.Struct({years:ie.Schema.Number,price:iE.Dollars.schema}),error:iS.GetDomainPriceErrorExternal}).middleware(ir),iq=r$.make("getDomainPurchasePrice",{payload:{domainName:iv.DomainName.schema},success:ie.Schema.Struct({years:ie.Schema.Number,price:iE.Dollars.schema}),error:ie.Schema.Union(iS.GetDomainPriceErrorExternal,r2.TooManyRequests,iS.DomainNotAvailableError,iS.DomainTooShortError)}).middleware(ii),i$=r$.make("renewDomain",{payload:{domainName:iv.DomainName.schema,years:ie.Schema.Number,expectedPrice:iE.Dollars.schema,autoRenew:ie.Schema.optional(ie.Schema.Boolean),registrantInformation:ie.Schema.optional(ib.BaseAndTldRegistrantFieldValues)},success:ie.Schema.Struct({orderId:iw.OrderId.schema}),error:iS.RenewDomainErrorExternal}).middleware(ir),ij=r$.make("transferInDomain",{payload:{domainName:iv.DomainName.schema,authCode:ie.Schema.Redacted(ie.Schema.String),years:ie.Schema.Number,expectedPrice:iE.Dollars.schema,autoRenew:ie.Schema.Boolean,registrantInformation:ie.Schema.optional(ib.BaseAndTldRegistrantFieldValues)},success:ie.Schema.Struct({orderId:iw.OrderId.schema}),error:iS.TransferInDomainErrorExternal}).middleware(ir),iV=r$.make("getTransferInStatus",{payload:ie.Schema.Struct({domainName:iv.DomainName.schema}),success:ie.Schema.NullOr(ie.Schema.Struct({status:iU.TransferInStatus})),error:iS.GetTransferInStatusErrorExternal}).middleware(ir),iH=r$.make("getRegistrantInfo",{payload:ie.Schema.Struct({domainName:iv.DomainName.schema}),success:ie.Schema.Struct({registrantInfo:ie.Schema.NullOr(ib.BaseAndTldRegistrantFieldValues.pipe(ie.Schema.omit("byTld")))}),error:iS.GetRegistrantInfoErrorExternal}).middleware(ir),iG=r$.make("updateRegistrantInfo",{payload:ie.Schema.Struct({domainName:iv.DomainName.schema,registrantInfo:ib.BaseAndTldRegistrantFieldValues.pipe(ie.Schema.omit("byTld"))}),success:ie.Schema.Struct({registrantInfo:ib.BaseAndTldRegistrantFieldValues.pipe(ie.Schema.omit("byTld"))}),error:iS.UpdateRegistrantInfoErrorExternal}).middleware(ir),iK=r$.make("verifyContact",{payload:ie.Schema.Struct({contactVerificationId:ie.Schema.String}),success:ie.Schema.Struct({ownerId:ie.Schema.String}),error:rZ.InternalServerError}),iJ=r$.make("getContactVerificationStatus",{payload:ie.Schema.Struct({domainName:iv.DomainName.schema}),success:ie.Schema.Union(ie.Schema.Struct({verified:ie.Schema.Literal(!0)}),ie.Schema.Struct({verified:ie.Schema.Literal(!1),verifyBy:ie.Schema.DateFromString,email:ie.Schema.String})),error:iS.GetContactVerificationStatusErrorExternal}).middleware(ir),iZ=r$.make("getUnverifiedContacts",{payload:ie.Schema.Struct({domainNames:ie.Schema.Array(iv.DomainName.schema)}),success:ie.Schema.Array(ie.Schema.Struct({verifyBy:ie.Schema.DateFromString,email:ie.Schema.String,domains:ie.Schema.Array(ie.Schema.String)})),error:ie.Schema.Union(rZ.InternalServerError,r2.TooManyRequests)}).middleware(ir),iQ=r$.make("resendContactVerificationEmail",{payload:ie.Schema.Struct({domainName:iv.DomainName.schema}),success:ie.Schema.Void,error:iS.ResendContactVerificationEmailErrorExternal}).middleware(ir),iY=r$.make("getAuthCode",{payload:ie.Schema.Struct({domainName:iv.DomainName.schema}),success:ie.Schema.Struct({authCode:ie.Schema.Redacted(ie.Schema.String)}),error:ie.Schema.Union(iS.DomainNotFirstPartyError,iS.DomainNotFoundError,iS.DomainOwnerMismatchError,iS.DomainCannotBeUnlockedUntilError,rZ.InternalServerError,r2.TooManyRequests)}).middleware(ir),iX=r$.make("updateNameservers",{payload:ie.Schema.Struct({domainName:iv.DomainName.schema,nameservers:ie.Schema.Array(iL.Nameserver.schema)}),success:ie.Schema.Void,error:ie.Schema.Union(iS.DomainNotFirstPartyError,iS.DomainNotFoundError,iS.DomainOwnerMismatchError,rZ.InternalServerError,iS.UpstreamDomainNotFoundError,iS.NotEnoughNameserversError,r2.TooManyRequests)}).middleware(ir),i0=r$.make("getAiDomainResults",{payload:ie.Schema.Struct({query:ie.Schema.String}),success:ie.Schema.Struct({suggestions:ie.Schema.Array(iv.DomainName.schema)}),error:ie.Schema.Union(rZ.InternalServerError,r2.TooManyRequests)}).middleware(ii),i1=r$.make("getSavedDomains",{success:ie.Schema.Struct({domains:ie.Schema.Array(ie.Schema.Struct({domainName:iv.DomainName.schema}))}),error:rZ.InternalServerError}).middleware(ir),i2=r$.make("saveDomain",{payload:ie.Schema.Struct({domainName:iv.DomainName.schema}),success:ie.Schema.Void,error:ie.Schema.Union(rZ.InternalServerError,r2.TooManyRequests)}).middleware(ir),i5=r$.make("unsaveDomain",{payload:ie.Schema.Struct({domainName:iv.DomainName.schema}),success:ie.Schema.Void,error:ie.Schema.Union(rZ.InternalServerError,r2.TooManyRequests)}).middleware(ir),i3=r$.make("getRenewalInfo",{payload:ie.Schema.Struct({domainName:iv.DomainName.schema}),success:ie.Schema.NullOr(iW),error:ie.Schema.Union(rZ.InternalServerError,iS.DomainOwnerMismatchError,r2.TooManyRequests)}).middleware(ir),i8=rK.make(iB,iq,i$,ij,iV,iH,iG,iK,iY,iX,iJ,iZ,iQ,i0,i1,i2,i5,i3);!function(e){e.HttpSerializationLayer=rB.layerJson;let t=function(){let{headers:t,domainsRegistrarBaseUrl:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return rW.layerProtocolHttp({url:`${r??"http://localhost:3000"}${ih}`,transformClient:O.HttpClient.mapRequest(_.HttpClientRequest.setHeaders(t??A.Headers.empty))}).pipe(I.Layer.provide([F.FetchHttpClient.layer,e.HttpSerializationLayer]))},r=(0,C.createContextKey)("DomainsRegistrarPublicRpcClient");class i extends rq.Context.Tag(r)(){}e.DomainsRegistrarPublicRpcClient=i,e.layerWithoutDependencies=I.Layer.scoped(i,rW.make(ip.merge(iP,i8))),e.layer=t=>e.layerWithoutDependencies.pipe(I.Layer.provide((t=>{let{domainsRegistrarBaseUrl:r}=t;return rW.layerProtocolHttp({url:`${r}${ih}`}).pipe(I.Layer.provide([F.FetchHttpClient.layer,e.HttpSerializationLayer]))})(t))),e.developmentlayer=function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.layerWithoutDependencies.pipe(I.Layer.provide(t(r)))},e.testLayer=function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.layerWithoutDependencies.pipe(I.Layer.provide(t(r)))}}(v||(v={}));var i4=e.i(2663153),i4=i4,rW=rW,rB=rB,i6=w,i9=e.i(1331084);let i7=Symbol.for("@effect/matcher/Matcher"),ne={[i7]:{_input:V.identity,_filters:V.identity,_remaining:V.identity,_result:V.identity,_return:V.identity},_tag:"TypeMatcher",add(e){return nt([...this.cases,e])},pipe(){return(0,ex.pipeArguments)(this,arguments)}};function nt(e){let t=Object.create(ne);return t.cases=e,t}let nr={[i7]:{_input:V.identity,_filters:V.identity,_remaining:V.identity,_result:V.identity,_provided:V.identity,_return:V.identity},_tag:"ValueMatcher",add(e){return"Right"===this.value._tag?this:"When"===e._tag&&!0===e.guard(this.provided)||"Not"===e._tag&&!1===e.guard(this.provided)?ni(this.provided,i9.right(e.evaluate(this.provided))):this},pipe(){return(0,ex.pipeArguments)(this,arguments)}};function ni(e,t){let r=Object.create(nr);return r.provided=e,r.value=t,r}let nn=(e,t)=>({_tag:"When",guard:e,evaluate:t}),na=e=>{if("function"==typeof e)return e;if(Array.isArray(e)){let t=e.map(na),r=t.length;return e=>{if(!Array.isArray(e))return!1;for(let i=0;i<r;i++)if(!1===t[i](e[i]))return!1;return!0}}if(null!==e&&"object"==typeof e){let t=Object.entries(e).map(e=>{let[t,r]=e;return[t,na(r)]}),r=t.length;return e=>{if("object"!=typeof e||null===e)return!1;for(let i=0;i<r;i++){let[r,n]=t[i];if(!(r in e)||!1===n(e[r]))return!1}return!0}}return t=>t===e},ns=(0,V.dual)(2,(e,t)=>nh(t)(nt([]))(e)),no=e=>function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];let n=r[r.length-1],a=r.slice(0,-1),s=1===a.length?t=>t[e]===a[0]:t=>a.includes(t[e]);return e=>e.add(nn(s,n))},nl=e=>(t,r)=>{let i=r=>"string"==typeof r[e]&&r[e].startsWith(t);return e=>e.add(nn(i,r))},nu=e=>t=>{let r=nn(r=>null!=r&&r[e]in t,r=>t[r[e]](r));return e=>e.add(r)},nc=e=>t=>{let r=nu(e)(t);return e=>nb(r(e))},nd=no("_tag"),np=nl("_tag"),nf=nu("_tag"),nh=nc("_tag"),nm=e=>t=>t instanceof e,ng=e=>t=>{let r=ny(t);return i9.isEither(r)?"Right"===r._tag?r.right:e(r.left):t=>{let i=r(t);return"Right"===i._tag?i.right:e(i.left)}},ny=e=>{if("ValueMatcher"===e._tag)return e.value;let t=e.cases.length;if(1===t){let t=e.cases[0];return e=>"When"===t._tag&&!0===t.guard(e)||"Not"===t._tag&&!1===t.guard(e)?i9.right(t.evaluate(e)):i9.left(e)}return r=>{for(let i=0;i<t;i++){let t=e.cases[i];if("When"===t._tag&&!0===t.guard(r)||"Not"===t._tag&&!1===t.guard(r))return i9.right(t.evaluate(r))}return i9.left(r)}},nS="effect/Match/exhaustive: absurd",nb=e=>{let t=ny(e);if(i9.isEither(t)){if("Right"===t._tag)return t.right;throw Error(nS)}return e=>{let r=t(e);if("Right"===r._tag)return r.right;throw Error(nS)}},nv=J.isString,nE=J.isNumber,nw=J.isBoolean,nk=J.isUndefined,nI=J.isNull,nT=J.isBigInt,nx=J.isSymbol,nC=J.isDate,nR=J.isRecord,nF=Symbol.for("effect/SafeRefinement");e.s(["MatcherTypeId",0,i7,"SafeRefinementId",0,nF,"any",0,()=>!0,"bigint",0,nT,"boolean",0,nw,"date",0,nC,"defined",0,e=>null!=e,"discriminator",0,no,"discriminatorStartsWith",0,nl,"discriminators",0,nu,"discriminatorsExhaustive",0,nc,"either",0,ny,"exhaustive",0,nb,"instanceOf",0,nm,"instanceOfUnsafe",0,nm,"is",0,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let i=t.length;return e=>{for(let r=0;r<i;r++)if(e===t[r])return!0;return!1}},"nonEmptyString",0,e=>"string"==typeof e&&e.length>0,"not",0,(e,t)=>r=>r.add({_tag:"Not",guard:na(e),evaluate:t}),"null",0,nI,"number",0,nE,"option",0,e=>{let t=ny(e);return i9.isEither(t)?i9.match(t,{onLeft:()=>eb.none(),onRight:eb.some}):e=>i9.match(t(e),{onLeft:()=>eb.none(),onRight:eb.some})},"orElse",0,ng,"orElseAbsurd",0,e=>ng(()=>{throw Error("effect/Match/orElseAbsurd: absurd")})(e),"record",0,nR,"string",0,nv,"symbol",0,nx,"tag",0,nd,"tagStartsWith",0,np,"tags",0,nf,"tagsExhaustive",0,nh,"type",0,()=>nt([]),"typeTags",0,()=>e=>{let t=nh(e)(nt([]));return e=>t(e)},"undefined",0,nk,"value",0,e=>ni(e,i9.left(e)),"valueTags",0,ns,"when",0,(e,t)=>r=>r.add(nn(na(e),t)),"whenAnd",0,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>{let r,i,n=t[t.length-1],a=t.slice(0,-1);return e.add(nn((i=(r=a.map(na)).length,e=>{for(let t=0;t<i;t++)if(!1===r[t](e))return!1;return!0}),n))}},"whenOr",0,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>{let r,i,n=t[t.length-1],a=t.slice(0,-1);return e.add(nn((i=(r=a.map(na)).length,e=>{for(let t=0;t<i;t++)if(!0===r[t](e))return!0;return!1}),n))}},"withReturnType",0,()=>e=>e],3012851);var nA=e.i(3012851);e.s(["Match",0,nA],1524216);var nA=nA,r$=r$,rK=rK,nO=e.i(7892259);let n_=r$.make("openSearchStream",{success:nO.SearchStreamMessage,error:ie.Schema.Union(r2.TooManyRequests,rZ.InternalServerError),stream:!0}),nM=r$.make("requestDomains",{payload:{domainNames:ie.Schema.NonEmptyArray(iv.DomainName.schema).pipe(ie.Schema.maxItems(200)),sessionId:ie.Schema.NonEmptyString},success:ie.Schema.Void,error:r2.TooManyRequests}),nD=rK.make(n_,nM).middleware(ii);!function(e){e.HttpSerializationLayer=rB.layerNdjson,e.WebsocketSerializationLayer=rB.layerJson;let t=function(){let{domainsSearchBaseUrl:t,headers:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return rW.layerProtocolHttp({url:`${t??"http://localhost:3001"}${im}`,transformClient:O.HttpClient.mapRequest(_.HttpClientRequest.setHeaders(r??A.Headers.empty))}).pipe(I.Layer.provide([F.FetchHttpClient.layer,e.HttpSerializationLayer]))},r=function(){let{domainsSearchBaseUrl:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return rW.layerProtocolSocket({retryTransientErrors:!0}).pipe(I.Layer.provide([e.WebsocketSerializationLayer,i4.layerWebSocket(`${t??"ws://localhost:3001"}${ig}`).pipe(I.Layer.provide(i4.layerWebSocketConstructorGlobal))]))},i=(0,C.createContextKey)("DomainsSearchRpcClient");class n extends i6.Context.Tag(i)(){}e.DomainsSearchPublicRpcClient=n,e.layerWithoutDependencies=I.Layer.scoped(n,rW.make(nD)),e.layer=t=>e.layerWithoutDependencies.pipe(I.Layer.provide(nA.value(t.searchProtocol??"http").pipe(nA.when("http",()=>(t=>{let{domainsSearchBaseUrl:r}=t;return rW.layerProtocolHttp({url:`${r}${im}`}).pipe(I.Layer.provide([F.FetchHttpClient.layer,e.HttpSerializationLayer]))})(t)),nA.when("socket",()=>(t=>{let{domainsSearchBaseUrl:r}=t;return rW.layerProtocolSocket({retryTransientErrors:!0}).pipe(I.Layer.provide([e.WebsocketSerializationLayer,i4.layerWebSocket(`${r}${ig}`).pipe(I.Layer.provide(i4.layerWebSocketConstructorGlobal))]))})(t)),nA.exhaustive))),e.developmentlayer=function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.layerWithoutDependencies.pipe(I.Layer.provide(nA.value(i.searchProtocol??"http").pipe(nA.when("http",()=>t(i)),nA.when("socket",()=>r(i)),nA.exhaustive)))},e.testLayer=function(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.layerWithoutDependencies.pipe(I.Layer.provide(nA.value(i.searchProtocol??"http").pipe(nA.when("http",()=>t(i)),nA.when("socket",()=>r(i)),nA.exhaustive)))}}(E||(E={}));let nN=(0,C.createContextKey)("DomainsRegistrarRpcClient");class nP extends w.Context.Tag(nN)(){}let nL=k.Effect.gen(function*(){let e=yield*v.DomainsRegistrarPublicRpcClient,t=yield*E.DomainsSearchPublicRpcClient;return{search:{openSearchStream:t.openSearchStream,requestDomains:t.requestDomains,getAiDomainResults:e.getAiDomainResults},tlds:{getSearchTlds:e.getSearchTlds,getNameserverPropagationStats:e.getNameserverPropagationStats,getTldOutage:e.getTldOutage},orders:{create:e.createOrder,get:e.getOrder,upsertItem:e.upsertOrderItem,removeItem:e.removeOrderItem,checkout:e.checkoutOrder,submitRegistrantInfo:e.submitRegistrantInfoForOrder,getPostcheckoutRegistrantEmail:e.getPostcheckoutRegistrantEmail,checkoutMobile:e.checkoutOrderMobile},domains:{getPrice:e.getDomainPrice,getPurchasePrice:e.getDomainPurchasePrice,getRenewalInfo:e.getRenewalInfo,renew:e.renewDomain,transferIn:e.transferInDomain,getTransferInStatus:e.getTransferInStatus,getRegistrantInfo:e.getRegistrantInfo,updateRegistrantInfo:e.updateRegistrantInfo,verifyContact:e.verifyContact,getAuthCode:e.getAuthCode,updateNameservers:e.updateNameservers,getContactVerificationStatus:e.getContactVerificationStatus,resendContactVerificationEmail:e.resendContactVerificationEmail,getUnverifiedContacts:e.getUnverifiedContacts,save:e.saveDomain,unsave:e.unsaveDomain,getSaved:e.getSavedDomains}}}),nU=I.Layer.effect(nP,nL),nz=e=>nU.pipe(I.Layer.provide(v.layer(e)),I.Layer.provide(E.layer(e))),nW=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return nU.pipe(I.Layer.provide(v.developmentlayer(e)),I.Layer.provide(E.developmentlayer(e)))},nB=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return nU.pipe(I.Layer.provide(v.testLayer(e)),I.Layer.provide(E.testLayer(e)))};class nq{constructor(e){this.search={openSearchStream:(e,t)=>this.runEffect(t=>t.search.openSearchStream(e).pipe(x.Stream.toAsyncIterableEffect),{signal:t?.signal}),requestDomains:(e,t)=>this.runEffect(t=>t.search.requestDomains(e),{signal:t?.signal}),getAiDomainResults:(e,t)=>this.runEffect(t=>t.search.getAiDomainResults(e),{signal:t?.signal})},this.tlds={getSearchTlds:(e,t)=>this.runEffect(t=>t.tlds.getSearchTlds(e),{signal:t?.signal}),getNameserverPropagationStats:(e,t)=>this.runEffect(t=>t.tlds.getNameserverPropagationStats(e),{signal:t?.signal}),getTldOutage:(e,t)=>this.runEffect(t=>t.tlds.getTldOutage(e),{signal:t?.signal})},this.orders={create:(e,t)=>this.runEffect(t=>t.orders.create(e),{signal:t?.signal}),get:(e,t)=>this.runEffect(t=>t.orders.get(e),{signal:t?.signal}),upsertItem:(e,t)=>this.runEffect(t=>t.orders.upsertItem(e),{signal:t?.signal}),removeItem:(e,t)=>this.runEffect(t=>t.orders.removeItem(e),{signal:t?.signal}),checkout:(e,t)=>this.runEffect(t=>t.orders.checkout(e),{signal:t?.signal}),checkoutMobile:(e,t)=>this.runEffect(t=>t.orders.checkoutMobile(e),{signal:t?.signal}),submitRegistrantInfo:(e,t)=>this.runEffect(t=>t.orders.submitRegistrantInfo(e),{signal:t?.signal})},this.domains={getPrice:(e,t)=>this.runEffect(t=>t.domains.getPrice(e),{signal:t?.signal}),getPurchasePrice:(e,t)=>this.runEffect(t=>t.domains.getPurchasePrice(e),{signal:t?.signal}),getRenewalInfo:(e,t)=>this.runEffect(t=>t.domains.getRenewalInfo(e),{signal:t?.signal}),renew:(e,t)=>this.runEffect(t=>t.domains.renew(e),{signal:t?.signal}),transferIn:(e,t)=>this.runEffect(t=>t.domains.transferIn(e),{signal:t?.signal}),getTransferInStatus:(e,t)=>this.runEffect(t=>t.domains.getTransferInStatus(e),{signal:t?.signal}),getRegistrantInfo:(e,t)=>this.runEffect(t=>t.domains.getRegistrantInfo(e),{signal:t?.signal}),updateRegistrantInfo:(e,t)=>this.runEffect(t=>t.domains.updateRegistrantInfo(e),{signal:t?.signal}),verifyContact:(e,t)=>this.runEffect(t=>t.domains.verifyContact(e),{signal:t?.signal}),getAuthCode:(e,t)=>this.runEffect(t=>t.domains.getAuthCode(e),{signal:t?.signal}),updateNameservers:(e,t)=>this.runEffect(t=>t.domains.updateNameservers(e),{signal:t?.signal}),getContactVerificationStatus:(e,t)=>this.runEffect(t=>t.domains.getContactVerificationStatus(e),{signal:t?.signal}),resendContactVerificationEmail:(e,t)=>this.runEffect(t=>t.domains.resendContactVerificationEmail(e),{signal:t?.signal}),getUnverifiedContacts:(e,t)=>this.runEffect(t=>t.domains.getUnverifiedContacts(e),{signal:t?.signal}),getPostcheckoutRegistrantEmail:(e,t)=>this.runEffect(t=>t.orders.getPostcheckoutRegistrantEmail(e),{signal:t?.signal}),save:(e,t)=>this.runEffect(t=>t.domains.save(e),{signal:t?.signal}),unsave:(e,t)=>this.runEffect(t=>t.domains.unsave(e),{signal:t?.signal}),getSaved:e=>this.runEffect(e=>e.domains.getSaved(),{signal:e?.signal})},this.runtime=(()=>{if("production"===e.environment)return T.ManagedRuntime.make(nz({...e}));let t={...e};return"development"===e.environment?T.ManagedRuntime.make(nW(t)):T.ManagedRuntime.make(nB(t))})();const t=(0,R.makeRunPromiseSettledResult)(this.runtime);this.runEffect=e=>t(k.Effect.gen(function*(){let t=yield*nP;return yield*e(t)}))}}e.s(["AsyncDomainsRegistrarRpcClient",0,nq,"DomainsRegistrarRpcClient",0,nP,"developmentLayer",0,nW,"layer",0,nz,"layerWithoutDependencies",0,nU,"testLayer",0,nB],9816100),e.i(9816100),e.s(["AsyncDomainsRegistrarRpcClient",0,nq,"DomainsRegistrarRpcClient",0,nP,"DomainsSearchPublicRpcClient",0,E,"developmentLayer",0,nW,"layer",0,nz,"layerWithoutDependencies",0,nU,"testLayer",0,nB],450693);var n$=e.i(450693);e.s(["DomainsRegistrarRpcClient",0,n$],757660)},2558253,6396407,693063,8489575,3641605,8919835,5286388,6640598,1615351,3090185,5031066,4995849,5648153,8305092,7039842,6607472,7892259,8340218,e=>{"use strict";var t,r,i,n,a,s,o,l,u,c,d=e.i(4520167);class p extends d.Schema.TaggedError()("InternalServerError",{}){}e.s(["InternalServerError",0,p],6396407),e.s(["GetSearchTldsErrorExternal",0,p],2558253);let f=d.Schema.Literal("name_dot_com","opensrs").pipe(d.Schema.annotations({identifier:"RegistrarName",description:"Schema defining the name of a registrar."}));e.s(["RegistrarName",0,f],693063);let h=d.Schema.Struct({id:d.Schema.String,tldName:d.Schema.String,startsAt:d.Schema.DateFromSelf,endsAt:d.Schema.DateFromSelf,expired:d.Schema.Boolean,internalNote:d.Schema.optional(d.Schema.String)}),m=d.Schema.Struct({...h.fields,startsAt:d.Schema.DateFromString,endsAt:d.Schema.DateFromString}),g=m.pipe(d.Schema.omit("internalNote","id","startsAt"));e.s(["TldOutage",0,h,"TldOutagePublicSerializable",0,g,"TldOutageSerializable",0,m],8489575);var y=e.i(2170327);e.s(["Record",0,y],3641605);var y=y,S=e.i(9552070),S=S;let b=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;function v(e){if(!b.test(e))return!1;let t=e.split("@");if(2!==t.length)return!1;let[r,i]=t;if(!r||r.length>64||r.startsWith(".")||r.endsWith(".")||r.includes("..")||!i||i.length>253||i.startsWith(".")||i.endsWith(".")||i.startsWith("-")||i.endsWith("-")||i.includes("..")||!i.includes("."))return!1;let n=i.split(".");if(n.length<2)return!1;for(let e of n)if(!e||e.length>63||e.startsWith("-")||e.endsWith("-")||!/^[a-zA-Z0-9-]+$/.test(e))return!1;let a=n[n.length-1];return!a||!(a.length<2)&&!!/^[a-zA-Z]+$/.test(a)}let E=d.Schema.transformOrFail(d.Schema.NonEmptyString,d.Schema.String.pipe(d.Schema.brand("EmailAddress")),{strict:!0,decode:(e,t,r)=>S.try({try:()=>{if(v(e))return e;throw Error(`Invalid RFC 5322 email address: ${e}`)},catch:()=>new S.Type(r,e,`'${e}' is not a valid RFC 5322 email address`)}),encode:e=>S.succeed(e)}).annotations({identifier:"EmailAddress",description:"A valid RFC 5322 email address"}),w=d.Schema.decode(E),k=d.Schema.decodeSync(E);d.Schema.is(E);let I={schema:E,fromString:e=>w(e),fromStringUnsafe:e=>k(e),isValid:e=>"string"==typeof e&&v(e)};e.s(["EmailAddress",0,I],7270874);let T=d.Schema.NonEmptyString.pipe(d.Schema.pattern(/^(?=(?:\D*\d){8,15}$)\+[1-9]\d{0,2}\.?\d+$/),d.Schema.brand("E164PhoneNumber")).annotations({identifier:"E164PhoneNumber",description:"A valid E.164 phone number",arbitrary:()=>e=>e.stringMatching(/^[+][1-9]\d{10}$/).map(C)}),x=d.Schema.decode(T),C=d.Schema.decodeSync(T),R=d.Schema.is(T),F={schema:T,fromString:e=>x(e),fromStringUnsafe:e=>C(e),isValid:e=>R(e)};e.s(["E164PhoneNumber",0,F],1752983);let A=d.Schema.Literal("AD","AE","AF","AG","AI","AL","AM","AO","AQ","AR","AS","AT","AU","AW","AX","AZ","BA","BB","BD","BE","BF","BG","BH","BI","BJ","BL","BM","BN","BO","BQ","BR","BS","BT","BV","BW","BY","BZ","CA","CC","CD","CF","CG","CH","CI","CK","CL","CM","CN","CO","CR","CU","CV","CW","CX","CY","CZ","DE","DJ","DK","DM","DO","DZ","EC","EE","EG","EH","ER","ES","ET","FI","FJ","FK","FM","FO","FR","GA","GB","GD","GE","GF","GG","GH","GI","GL","GM","GN","GP","GQ","GR","GS","GT","GU","GW","GY","HK","HM","HN","HR","HT","HU","ID","IE","IL","IM","IN","IO","IQ","IR","IS","IT","JE","JM","JO","JP","KE","KG","KH","KI","KM","KN","KP","KR","KW","KY","KZ","LA","LB","LC","LI","LK","LR","LS","LT","LU","LV","LY","MA","MC","MD","ME","MF","MG","MH","MK","ML","MM","MN","MO","MP","MQ","MR","MS","MT","MU","MV","MW","MX","MY","MZ","NA","NC","NE","NF","NG","NI","NL","NO","NP","NR","NU","NZ","OM","PA","PE","PF","PG","PH","PK","PL","PM","PN","PR","PS","PT","PW","PY","QA","RE","RO","RS","RU","RW","SA","SB","SC","SD","SE","SG","SH","SI","SJ","SK","SL","SM","SN","SO","SR","SS","ST","SV","SX","SY","SZ","TC","TD","TF","TG","TH","TJ","TK","TL","TM","TN","TO","TR","TT","TV","TW","TZ","UA","UG","UM","US","UY","UZ","VA","VC","VE","VG","VI","VN","VU","WF","WS","XK","YE","YT","ZA","ZM","ZW").pipe(d.Schema.brand("CountryCode")).annotations({identifier:"CountryCode",description:"A valid ISO 3166-1 alpha-2 country code"}),O=d.Schema.decode(A),_=d.Schema.decodeSync(A),M=d.Schema.is(A),D={schema:A,fromString:e=>O(e),fromStringUnsafe:e=>_(e),isValid:e=>M(e)};e.s(["CountryCode",0,D],1581508);let N={description:d.Schema.String,required:d.Schema.Boolean,label:d.Schema.optional(d.Schema.String),validation:d.Schema.optional(d.Schema.Union(d.Schema.Literal("valid_email","valid_countries"),d.Schema.TemplateLiteral("regex:",d.Schema.String),d.Schema.TemplateLiteral("min_length:",d.Schema.String))),required_when:d.Schema.optional(d.Schema.Union(d.Schema.String,d.Schema.Struct({value_in:d.Schema.Array(d.Schema.String)})))},P=d.Schema.Union(d.Schema.Struct({...N,type:d.Schema.Literal("string"),options:d.Schema.optional(d.Schema.Array(d.Schema.Struct({value:d.Schema.String,label:d.Schema.String,fields:d.Schema.optional(d.Schema.Record({key:d.Schema.NonEmptyTrimmedString,value:d.Schema.suspend(()=>P)}))}))),fields:d.Schema.optional(d.Schema.Record({key:d.Schema.NonEmptyTrimmedString,value:d.Schema.suspend(()=>P)}))}),d.Schema.Struct({...N,type:d.Schema.Literal("enum"),options:d.Schema.Array(d.Schema.Struct({value:d.Schema.String,label:d.Schema.String,fields:d.Schema.optional(d.Schema.Record({key:d.Schema.NonEmptyTrimmedString,value:d.Schema.suspend(()=>P)}))})),fields:d.Schema.optional(d.Schema.Record({key:d.Schema.NonEmptyTrimmedString,value:d.Schema.suspend(()=>P)}))}),d.Schema.Struct({...N,type:d.Schema.Literal("acknowledgement"),value:d.Schema.optional(d.Schema.String)}),d.Schema.Struct({...N,type:d.Schema.Literal("notice")})).pipe(d.Schema.annotations({identifier:"RegistrantField",description:"Schema definition for registrant fields."})),L=d.Schema.Record({key:d.Schema.NonEmptyTrimmedString,value:P}),U=d.Schema.Record({key:d.Schema.NonEmptyTrimmedString,value:L}),z=d.Schema.Record({key:d.Schema.NonEmptyTrimmedString,value:d.Schema.String}),W=d.Schema.Record({key:d.Schema.NonEmptyTrimmedString,value:z}),B=d.Schema.Struct({firstName:d.Schema.NonEmptyTrimmedString,lastName:d.Schema.NonEmptyTrimmedString,email:I.schema,phone:F.schema,address1:d.Schema.NonEmptyTrimmedString,address2:d.Schema.optional(d.Schema.NonEmptyTrimmedString),city:d.Schema.NonEmptyTrimmedString,state:d.Schema.NonEmptyTrimmedString,zip:d.Schema.NonEmptyTrimmedString,country:D.schema,companyName:d.Schema.optional(d.Schema.NonEmptyTrimmedString),fax:d.Schema.optional(F.schema)}),q=d.Schema.Struct({base:B,byTld:W}),$=d.Schema.Struct({...B.fields,additional:d.Schema.optional(W)}),j=e=>{let{additional:t,...r}=e;return{base:r,byTld:t??y.empty()}};e.s(["BaseAndTldRegistrantFieldValues",0,q,"BaseAndTldRegistrantFieldValuesApiResource",0,$,"BaseRegistrantFieldValues",0,B,"RegistrantFieldValues",0,z,"RegistrantFieldValuesByTld",0,W,"RegistrantFields",0,L,"RegistrantFieldsByTld",0,U,"registrantFieldValuesFromApiResource",0,j],8919835);var V=e.i(7037981),V=V;(t=s||(s={})).CentsBrand=V.nominal(),t.schema=d.Schema.Int.pipe(d.Schema.fromBrand(t.CentsBrand)).annotations({description:"Represents a monetary amount in cents (1/100th of a dollar)",jsonSchema:{type:"integer"}}),t.typeSchema=d.Schema.typeSchema(t.schema),t.make=d.Schema.decode(t.schema),t.unsafeMake=e=>t.CentsBrand(e),t.fromDollars=e=>t.unsafeMake(Math.round(100*e)),t.toDollars=e=>o.unsafeMake(e/100),t.add=(e,r)=>t.unsafeMake(e+r),t.subtract=(e,r)=>t.unsafeMake(e-r),(r=o||(o={})).DollarsBrand=V.nominal(),r.schema=d.Schema.Number.pipe(d.Schema.fromBrand(r.DollarsBrand)).annotations({description:"Represents a monetary amount in USD dollars",jsonSchema:{type:"number",minimum:.01}}),r.typeSchema=d.Schema.typeSchema(r.schema),r.make=d.Schema.decode(r.schema),r.unsafeMake=e=>r.DollarsBrand(e),r.fromCents=e=>r.unsafeMake(s.toDollars(e)),r.toCents=e=>s.fromDollars(e),r.format=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en-US";return new Intl.NumberFormat(r,{style:"currency",currency:t}).format(e)},r.add=(e,t)=>r.unsafeMake(e+t);let H=d.Schema.transform(d.Schema.typeSchema(s.schema),d.Schema.typeSchema(o.schema),{strict:!0,decode:e=>o.fromCents(e),encode:e=>s.fromDollars(e)}),G=d.Schema.transform(d.Schema.typeSchema(o.schema),d.Schema.typeSchema(s.schema),{strict:!0,decode:e=>s.fromDollars(e),encode:e=>o.fromCents(e)});e.s(["Cents",0,s,"CentsFromDollars",0,G,"Dollars",0,o,"DollarsFromCents",0,H],5286388);let K=d.Schema.Struct({years:d.Schema.Positive,type:d.Schema.Literal("buy","renew","transfer"),price:o.schema}),J=d.Schema.Struct({tldName:d.Schema.NonEmptyTrimmedString,prices:d.Schema.Array(K),registrantFields:L,outage:d.Schema.optional(h),whoisPrivacy:d.Schema.Boolean,supportsIdn:d.Schema.Boolean}),Z=d.Schema.Struct({...J.fields,outage:d.Schema.optional(m.pipe(d.Schema.omit("internalNote","expired","id","tldName")))}),Q=d.Schema.Array(J),Y=d.Schema.Array(Z);e.s(["SearchPrice",0,K,"SearchTldPublicSerializable",0,Z,"SearchTlds",0,Q,"SearchTldsPublicSerializable",0,Y],6640598);var X=e.i(3322401),ee=e.i(7525378),et=e.i(3683485),er=e.i(9159985),ei=e.i(8815901),en=e.i(4935619),ea=e.i(9973079),es=e.i(1932814),eo=e.i(8558266);let el=Symbol.for("@effect/platform/HttpApiSchema/AnnotationMultipart"),eu=Symbol.for("@effect/platform/HttpApiSchema/AnnotationMultipartStream"),ec=Symbol.for("@effect/platform/HttpApiSchema/AnnotationStatus"),ed=Symbol.for("@effect/platform/HttpApiSchema/AnnotationEmptyDecodeable"),ep=Symbol.for("@effect/platform/HttpApiSchema/AnnotationEncoding"),ef=Symbol.for("@effect/platform/HttpApiSchema/AnnotationParam"),eh=(e,t)=>("Transformation"===e._tag?{...e.to.annotations,...e.annotations}:e.annotations)[t],em=(e,t)=>eh(e,ec)??t,eg={kind:"Json",contentType:"application/json"},ey=e=>{let t=eo.omit(e,"status");return void 0!==e.status&&(t[ec]=e.status),t},eS=e=>{switch(e._tag){case"VoidKeyword":return!0;case"Transformation":return eS(e.from);case"Suspend":return eS(e.f());default:return!1}},eb=e=>em(e,eS(e)?204:200),ev=e=>em(e,500),eE=e=>{let t=[];return!function e(r){if(es.isUnion(r))for(let t of r.types)e(t);else t.push(r)}(e),t},ew=(e,t)=>es.Union.make(Array.from(new Set([...eE(e),...eE(t)]))),ek=(0,et.dual)(2,(e,t)=>{let r={[ef]:{name:e,schema:t}};if(ea.isSchema(t)){let e=es.getIdentifierAnnotation(t.ast);ei.isSome(e)&&(r[es.IdentifierAnnotationId]=e.value)}return t.annotations(r)}),eI=e=>ea.Void.annotations(ey({status:e})),eT=(0,et.dual)(2,(e,t)=>ea.transform(ea.Void.annotations(e.ast.annotations),ea.typeSchema(e),{decode:t.decode,encode:et.constVoid}).annotations(ey({status:t.status,[ed]:!0}))),ex=eI(201),eC=eI(202),eR=eI(204),eF=Symbol.for("@effect/platform/HttpApiSchema/Multipart"),eA=Symbol.for("@effect/platform/HttpApiSchema/MultipartStream"),eO=(0,et.dual)(2,(e,t)=>e.annotations({[ep]:{kind:t.kind,contentType:t.contentType??(e=>{switch(e){case"Json":return"application/json";case"UrlParams":return"application/x-www-form-urlencoded";case"Uint8Array":return"application/octet-stream";case"Text":return"text/plain"}})(t.kind)},..."Uint8Array"===t.kind?{jsonSchema:{type:"string",format:"binary"}}:void 0})),e_=(0,er.globalValue)("@effect/platform/HttpApiSchema/astCache",()=>new WeakMap);e.s(["Accepted",0,eC,"AnnotationEmptyDecodeable",0,ed,"AnnotationEncoding",0,ep,"AnnotationMultipart",0,el,"AnnotationMultipartStream",0,eu,"AnnotationParam",0,ef,"AnnotationStatus",0,ec,"Created",0,ex,"Empty",0,eI,"EmptyError",0,()=>e=>{let t,r=Symbol.for(`@effect/platform/HttpApiSchema/EmptyError/${e.tag}`);class i extends ee.StructuralClass{_tag=e.tag;commit(){return X.fail(this)}}return i.prototype[r]=r,Object.assign(i,{[ea.TypeId]:ea.Void[ea.TypeId],pipe:ea.Void.pipe,annotations(e){return ea.make(this.ast).annotations(e)}}),Object.defineProperty(i,"ast",{get(){return t?t.ast:(t=eT(ea.declare(e=>(0,en.hasProperty)(e,r),{identifier:e.tag,title:e.tag}),{status:e.status,decode:(0,et.constant)(new this)})).ast}}),i},"Multipart",0,(e,t)=>e.annotations({[el]:t??{}}),"MultipartStream",0,(e,t)=>e.annotations({[eu]:t??{}}),"MultipartStreamTypeId",0,eA,"MultipartTypeId",0,eF,"NoContent",0,eR,"Text",0,e=>eO(ea.String,{kind:"Text",...e}),"Uint8Array",0,e=>eO(ea.Uint8ArrayFromSelf,{kind:"Uint8Array",...e}),"UnionUnify",0,(e,t)=>ea.make(ew(e.ast,t.ast)),"UnionUnifyAST",0,ew,"annotations",0,ey,"asEmpty",0,eT,"deunionize",0,(e,t)=>{if(e_.has(t.ast))return void e.add(e_.get(t.ast));let r=t.ast;if("Union"===r._tag)for(let t of r.types){if(e_.has(t)){e.add(e_.get(t));continue}let i=ea.make(es.annotations(t,{...r.annotations,...t.annotations}));e_.set(t,i),e.add(i)}else e_.set(r,t),e.add(t)},"extractAnnotations",0,e=>{let t={};return ec in e&&(t[ec]=e[ec]),ed in e&&(t[ed]=e[ed]),ep in e&&(t[ep]=e[ep]),ef in e&&(t[ef]=e[ef]),el in e&&(t[el]=e[el]),eu in e&&(t[eu]=e[eu]),t},"extractUnionTypes",0,eE,"getEmptyDecodeable",0,e=>eh(e,ed)??!1,"getEncoding",0,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eg;return eh(e,ep)??t},"getMultipart",0,e=>eh(e,el),"getMultipartStream",0,e=>eh(e,eu),"getParam",0,e=>{let t="PropertySignatureTransformation"===e._tag?e.to.annotations:e.annotations;return t[ef]?.name},"getStatus",0,em,"getStatusError",0,e=>ev(e.ast),"getStatusErrorAST",0,ev,"getStatusSuccess",0,e=>eb(e.ast),"getStatusSuccessAST",0,eb,"isVoid",0,eS,"param",0,ek,"withEncoding",0,eO],1722676);var eM=e.i(1722676),eM=eM,eD=d;class eN extends eD.Schema.TaggedError()("Unauthorized",{status:eD.Schema.Literal(401),code:eD.Schema.Literal("unauthorized"),message:eD.Schema.String},eM.annotations({status:401})){static new(e){return new eN({message:e,code:"unauthorized",status:401})}}let eP=eD.Schema.Struct({total:eD.Schema.Number,remaining:eD.Schema.Number,reset:eD.Schema.Number}),eL=eD.Schema.Struct({value:eD.Schema.Number,str:eD.Schema.String});class eU extends eD.Schema.TaggedError()("TooManyRequests",{status:eD.Schema.Literal(429),code:eD.Schema.Literal("too_many_requests"),message:eD.Schema.String,retryAfter:eL,limit:eP},eM.annotations({status:429})){static new(e,t){return new eU({message:`Too many requests - try again in ${e.str} (more than ${t.total}).`,code:"too_many_requests",status:429,retryAfter:e,limit:t})}}class ez extends eD.Schema.TaggedError()("Forbidden",{status:eD.Schema.Literal(403),code:eD.Schema.Literal("forbidden"),message:eD.Schema.String},eM.annotations({status:403})){static new(e){return new ez({message:e,code:"forbidden",status:403})}}class eW extends eD.Schema.TaggedError()("NotAuthorizedForScope",{status:eD.Schema.Literal(403),code:eD.Schema.Literal("not_authorized_for_scope"),message:eD.Schema.String},eM.annotations({status:403})){static new(e){return new eW({message:e,code:"not_authorized_for_scope",status:403})}}class eB extends eD.Schema.TaggedError()("NotFound",{status:eD.Schema.Literal(404),code:eD.Schema.Literal("not_found"),message:eD.Schema.String},eM.annotations({status:404})){static new(e){return new eB({message:e,code:"not_found",status:404})}}e.s(["Forbidden",0,ez,"LimitInfo",0,eP,"NotAuthorizedForScope",0,eW,"NotFound",0,eB,"RetryAfter",0,eL,"TooManyRequests",0,eU,"Unauthorized",0,eN],1615351);var eq=e.i(7118357);let e$=["logged-out-draft","draft","created-purchase-intent"],ej=["submitted","failed","completed"],eV=[...e$,...ej],eH=d.Schema.Literal(...e$),eG=d.Schema.Literal(...ej),eK=d.Schema.Literal(...eV),eJ=d.Schema.Literal("production","test"),eZ=d.Schema.Literal("pending","completed","failed","refunded","refund-failed");(i=l||(l={})).UnsupportedLanguageCode=d.Schema.Struct({code:d.Schema.Literal("unsupported-language-code"),details:d.Schema.Struct({detectedLanguageCode:d.Schema.String})}),i.ClientTransferProhibited=d.Schema.Struct({code:d.Schema.Literal("client-transfer-prohibited")}),i.ClaimsNoticeRequired=d.Schema.Struct({code:d.Schema.Literal("claims-notice-required")}),i.CannotTransferInUntil=d.Schema.Struct({code:d.Schema.Literal("cannot-transfer-in-until"),details:d.Schema.Struct({numDaysUntilTransferrable:d.Schema.Number})}),i.PriceChange=d.Schema.Struct({code:d.Schema.Literal("price-change")}),i.Unknown=d.Schema.Struct({code:eq.StringWithEmptyObject,details:d.Schema.optional(d.Schema.Unknown)}),i.Any=d.Schema.Union(i.UnsupportedLanguageCode,i.ClientTransferProhibited,i.ClaimsNoticeRequired,i.CannotTransferInUntil,i.PriceChange),i.AnyOrUnknown=d.Schema.Union(i.Any,i.Unknown),i.make=e=>e,(n=u||(u={})).PaymentFailed=d.Schema.Struct({code:d.Schema.Literal("payment-failed")}),n.TldOutage=d.Schema.Struct({code:d.Schema.Literal("tld-outage"),details:d.Schema.Struct({tlds:d.Schema.Array(d.Schema.Struct({tldName:d.Schema.String,endsAt:d.Schema.String}))})}),n.PriceMismatch=d.Schema.Struct({code:d.Schema.Literal("price-mismatch"),details:d.Schema.Struct({expectedPrice:d.Schema.Number,actualPrice:d.Schema.optional(d.Schema.Number)})}),n.ClaimsRequired=d.Schema.Struct({code:d.Schema.Literal("claims-required"),details:d.Schema.Struct({message:d.Schema.String,domainNames:d.Schema.Array(d.Schema.String)})}),n.DomainsMismatch=d.Schema.Struct({code:d.Schema.Literal("domain-mismatch")}),n.UnexpectedError=d.Schema.Struct({code:d.Schema.Literal("unexpected-error")}),n.Unknown=d.Schema.Struct({code:eq.StringWithEmptyObject,details:d.Schema.optional(d.Schema.Unknown)}),n.Any=d.Schema.Union(n.PaymentFailed,n.TldOutage,n.PriceMismatch,n.UnexpectedError,n.ClaimsRequired,n.DomainsMismatch),n.AnyOrUnknown=d.Schema.Union(n.Any,n.Unknown),n.make=e=>e;let eQ=d.Schema.Literal("api","web","mobile","system");e.s(["EditableOrderStatus",0,eH,"EditableOrderStatuses",0,e$,"NonEditableOrderStatus",0,eG,"NonEditableOrderStatuses",0,ej,"OrderDomainError",0,l,"OrderDomainStatus",0,eZ,"OrderError",0,u,"OrderModeValue",0,eJ,"OrderSource",0,eQ,"OrderStatus",0,eK,"OrderStatuses",0,eV],3090185);var eY=d,eX=d;class e0 extends eX.Schema.TaggedError()("CopperClientError",{message:eX.Schema.String}){}var e1=e.i(8973927),S=S,e2=d,e5=en;e.s(["Predicate",0,e5],5031066);var e5=en,e3=e.i(953632);let e8=e5.or(e=>/^[A-Za-z]$/.test(e),e=>/^[0-9]$/.test(e)),e4=e5.or(e8,e=>"-"===e);function e6(e){let t=(e.endsWith(".")?e.slice(0,-1):e).split(".");return 0!==t.length&&t.every(e=>(function(e){if(0===e.length||e.length>63)return!1;let t=e[0];if(void 0===t||!e8(t))return!1;let r=e[e.length-1];if(void 0===r||!e8(r))return!1;for(let t=1;t<e.length-1;t++){let r=e[t];if(void 0===r||!e4(r))return!1}return!0})(e))}let e9=e2.Schema.transformOrFail(e2.Schema.String,e2.Schema.String.pipe(e2.Schema.brand("DomainName")),{strict:!0,decode:(e,t,r)=>e1.Effect.gen(function*(){let t=e.trim();if(!e6(t))return yield*e1.Effect.fail(Error(`Invalid domain name: ${t}`));let r=yield*e1.Effect.try(()=>(0,e3.parse)(t));return!r.isIp&&r.domain&&r.hostname&&r.domain===r.hostname&&!r.subdomain?r.domain:yield*e1.Effect.fail(Error(`Domain failed parse checks: ${t}`))}).pipe(e1.Effect.mapError(t=>new S.Type(r,e,t.message))),encode:e=>S.succeed(e)}).annotations({identifier:"DomainName",description:"A valid domain name"}).pipe(e2.Schema.asSchema),e7=e2.Schema.decode(e9),te=e2.Schema.decodeSync(e9);class tt extends e2.Schema.TaggedError()("InvalidDomainNameError",{message:e2.Schema.String,domainName:e2.Schema.String,cause:e2.Schema.instanceOf(S.ParseError)}){}let tr={schema:e9,fromString:e=>e7(e).pipe(e1.Effect.catchTag("ParseError",t=>e1.Effect.fail(new tt({message:`${e} is not a valid domain name.`,domainName:e,cause:t})))),fromStringSync:e=>te(e),unsafeBrand:e=>e,tld:e=>e.split(".").slice(1).join("."),sld:e=>e.split(".")[0]};e.s(["DomainName",0,tr,"InvalidDomainNameError",0,tt],4995849);var S=S,ti=d;let tn=ti.Schema.transformOrFail(ti.Schema.String,ti.Schema.String.pipe(ti.Schema.brand("Nameserver")),{strict:!0,decode:(e,t,r)=>e1.Effect.gen(function*(){let t=e.trim();if(!e6(t))return yield*e1.Effect.fail(Error(`Invalid nameserver: ${t}`));let r=t.toLowerCase(),i=r.endsWith(".")?r.slice(0,-1):r,n=yield*e1.Effect.try(()=>(0,e3.parse)(t));return!n.isIp&&n.domain&&n.hostname&&n.hostname===i?n.hostname:yield*e1.Effect.fail(Error(`Invalid nameserver: ${t}`))}).pipe(e1.Effect.mapError(t=>new S.Type(r,e,t.message))),encode:e=>S.succeed(e)}).annotations({identifier:"Nameserver",description:"A valid nameserver"}).pipe(ti.Schema.asSchema),ta=ti.Schema.decode(tn),ts=ti.Schema.decodeSync(tn);class to extends ti.Schema.TaggedError()("InvalidNameserverError",{message:ti.Schema.String,nameserver:ti.Schema.String,cause:ti.Schema.instanceOf(S.ParseError)}){}let tl={schema:tn,fromString:e=>ta(e).pipe(e1.Effect.catchTag("ParseError",t=>e1.Effect.fail(new to({message:`${e} is not a valid nameserver.`,nameserver:e,cause:t})))),fromStringSync:e=>ts(e)};e.s(["InvalidNameserverError",0,to,"Nameserver",0,tl],5648153);var S=S,tu=d;let tc="0123456789ABCDEFGHJKMNPQRSTVWXYZ";(a=c||(c={})).Base32IncorrectEncoding="B32_ENC_INVALID",a.DecodeTimeInvalidCharacter="DEC_TIME_CHAR",a.DecodeTimeValueMalformed="DEC_TIME_MALFORMED",a.EncodeTimeNegative="ENC_TIME_NEG",a.EncodeTimeSizeExceeded="ENC_TIME_SIZE_EXCEED",a.EncodeTimeValueMalformed="ENC_TIME_MALFORMED",a.PRNGDetectFailure="PRNG_DETECT",a.ULIDInvalid="ULID_INVALID",a.Unexpected="UNEXPECTED",a.UUIDInvalid="UUID_INVALID";class td extends Error{constructor(e,t){super(`${t} (${e})`),this.name="ULIDError",this.code=e}}let tp=tu.Schema.transformOrFail(tu.Schema.String,tu.Schema.String.pipe(tu.Schema.brand("OrderId")),{strict:!0,decode:(e,t,r)=>{let i=e.trim();return"string"==typeof i&&26===i.length&&i.toUpperCase().split("").every(e=>-1!==tc.indexOf(e))?e1.Effect.succeed(i):e1.Effect.fail(new S.Type(r,i,`Invalid order ID: ${i}`))},encode:e=>S.succeed(e)}).annotations({identifier:"OrderId",description:"A valid order ID"}).pipe(tu.Schema.asSchema),tf=tu.Schema.decode(tp),th=tu.Schema.decodeSync(tp);class tm extends tu.Schema.TaggedError()("InvalidOrderIdError",{message:tu.Schema.String,orderId:tu.Schema.String}){}let tg={schema:tp,fromString:e=>tf(e).pipe(e1.Effect.catchTag("ParseError",t=>e1.Effect.fail(new tm({message:`${e} is not a valid order ID.`,orderId:e})))),fromStringSync:e=>th(e),unsafeBrand:e=>e,create:()=>{let t;return tg.fromStringSync((t=function(t){let r="u">typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:"u">typeof window?window:e.g,i=r&&(r.crypto||r.msCrypto)||null;if("function"==typeof i?.getRandomValues)return()=>{let e=new Uint8Array(1);return i.getRandomValues(e),e[0]/255};if("function"==typeof i?.randomBytes)return()=>i.randomBytes(1).readUInt8()/255;throw new td(c.PRNGDetectFailure,"Failed to find a reliable PRNG")}(),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;if(isNaN(e))throw new td(c.EncodeTimeValueMalformed,`Time must be a number: ${e}`);if(e>0xffffffffffff)throw new td(c.EncodeTimeSizeExceeded,`Cannot encode a time larger than 281474976710655: ${e}`);if(e<0)throw new td(c.EncodeTimeNegative,`Time must be positive: ${e}`);if(!1===Number.isInteger(e))throw new td(c.EncodeTimeValueMalformed,`Time must be an integer: ${e}`);let r,i="";for(let n=t;n>0;n--)r=e%32,i=tc.charAt(r)+i,e=(e-r)/32;return i}(Date.now(),10)+function(e,t){let r="";for(;e>0;e--)r=function(e){let t=Math.floor(32*e())%32;return tc.charAt(t)}(t)+r;return r}(16,t)))}};e.s(["InvalidOrderIdError",0,tm,"OrderId",0,tg],8305092);class ty extends eY.Schema.TaggedError()("OrderNotFoundError",{orderId:tg.schema}){}class tS extends eY.Schema.TaggedError()("OrderEmptyError",{orderId:tg.schema}){}class tb extends eY.Schema.TaggedError()("TooManyDomainsInOrderError",{orderId:tg.schema,totalDomains:eY.Schema.Number,maxDomains:eY.Schema.Number}){}class tv extends eY.Schema.TaggedError()("OrderTooExpensiveError",{orderId:tg.schema,totalPrice:o.typeSchema,maxPrice:o.typeSchema}){}class tE extends eY.Schema.TaggedError()("TeamNotProvidedError",{message:eY.Schema.optional(eY.Schema.String)}){}class tw extends eY.Schema.TaggedError()("TeamNotFoundError",{teamId:eY.Schema.String}){}class tk extends eY.Schema.TaggedError()("StripeCustomerIdNotFoundError",{ownerId:eY.Schema.String}){}class tI extends eY.Schema.TaggedError()("DomainPriceCheckError",{domainName:tr.schema}){}class tT extends eY.Schema.TaggedError()("DomainAvailabilityCheckError",{domainNames:eY.Schema.NonEmptyArray(tr.schema)}){}class tx extends eY.Schema.TaggedError()("DomainNotAvailableError",{domainName:eY.Schema.String}){}class tC extends eY.Schema.TaggedError()("DomainInfoNotFoundError",{domainName:eY.Schema.String,type:eY.Schema.optional(eY.Schema.Literal("availability","pricing")),years:eY.Schema.Number}){}class tR extends eY.Schema.TaggedError()("DomainAlreadyOwnedError",{domainName:eY.Schema.String,message:eY.Schema.String}){}class tF extends eY.Schema.TaggedError()("ExpectedPriceMismatchError",{domainName:eY.Schema.optional(eY.Schema.String),expectedPrice:o.typeSchema,actualPrice:eY.Schema.Union(o.typeSchema,eY.Schema.Literal("not-found"))}){}class tA extends eY.Schema.TaggedError()("OrderStatusError",{message:eY.Schema.String,orderId:tg.schema,expectedStatuses:eY.Schema.Array(eK),actualStatus:eK}){}class tO extends eY.Schema.TaggedError()("OrderAuthMismatchError",{orderId:tg.schema}){}class t_ extends eY.Schema.TaggedError()("OrderModeMismatchError",{orderId:tg.schema,expectedMode:eJ,actualMode:eJ}){}class tM extends eY.Schema.TaggedError()("InvalidPurchaseIntentError",{message:eY.Schema.String,purchaseIntentId:eY.Schema.String}){}class tD extends eY.Schema.TaggedError()("DomainNotFoundError",{domainName:tr.schema}){}class tN extends eY.Schema.TaggedError()("DomainNotFirstPartyError",{domainName:eY.Schema.String,message:eY.Schema.String}){}class tP extends eY.Schema.TaggedError()("DomainOwnerMismatchError",{domainName:eY.Schema.String,message:eY.Schema.String}){}class tL extends eY.Schema.TaggedError()("DomainNotRenewableError",{domainName:tr.schema,message:eY.Schema.String}){}class tU extends eY.Schema.TaggedError()("DynamicRegistrantInformationRequiredError",{tld:eY.Schema.String}){}class tz extends eY.Schema.TaggedError()("InvalidDynamicRegistrantInformationError",{tld:eY.Schema.String}){}class tW extends eY.Schema.TaggedError()("UpstreamDomainNotFoundError",{domainName:tr.schema,message:eY.Schema.String}){}class tB extends eY.Schema.TaggedError()("TldOutageError",{outages:eY.Schema.Array(eY.Schema.Struct({tldName:eY.Schema.String,endsAt:eY.Schema.DateFromString})),message:eY.Schema.String}){}class tq extends eY.Schema.TaggedError()("TldNotSupportedError",{domainName:tr.schema,tld:eY.Schema.String}){}class t$ extends eY.Schema.TaggedError()("RegistrantInformationRequiredError",{domainName:tr.schema}){}class tj extends eY.Schema.TaggedError()("DuplicateDomainsError",{duplicateDomainNames:eY.Schema.NonEmptyArray(tr.schema)}){}class tV extends eY.Schema.TaggedError()("InvalidRegistrantInformationError",{domainName:eY.Schema.String}){}class tH extends eY.Schema.TaggedError()("NotEnoughNameserversError",{domainName:eY.Schema.String,nameservers:eY.Schema.NonEmptyArray(tl.schema),message:eY.Schema.String}){}class tG extends eY.Schema.TaggedError()("BoughtTooRecentlyError",{domainName:eY.Schema.String,message:eY.Schema.String}){}class tK extends eY.Schema.TaggedError()("ContactAlreadyVerifiedError",{domainName:eY.Schema.String}){}class tJ extends eY.Schema.TaggedError()("DNSSECEnabledError",{domainName:eY.Schema.String}){}class tZ extends eY.Schema.TaggedError()("DomainTooShortError",{domainName:tr.schema,minLength:eY.Schema.Number}){}class tQ extends eY.Schema.TaggedError()("DomainAlreadyExistsError",{domainName:eY.Schema.String,message:eY.Schema.String}){}class tY extends eY.Schema.TaggedError()("DomainCannotBeUnlockedUntilError",{domainName:eY.Schema.String,date:eY.Schema.optional(eY.Schema.DateFromString)}){}class tX extends eY.Schema.TaggedError()("StalePurchaseIntentError",{purchaseIntentId:eY.Schema.String}){}class t0 extends eY.Schema.TaggedError()("RegistrantInfoUpdateNotSupportedForTldError",{domainName:tr.schema,tld:eY.Schema.String}){}let t1=eY.Schema.Union(ty,tO,p),t2=eY.Schema.Union(tE,tI,tT,tC,tx,tR,tF,t_,tq,tj,tZ,p),t5=eY.Schema.Union(tC,tx,tF,ty,tI,tT,tR,tA,tO,tE,t_,tq,tZ,p),t3=eY.Schema.Union(ty,tA,tO,tE,t_,p),t8=eY.Schema.Union(e0,ty,tS,tb,tv,tO,tE,tw,tk,t_,tM,tA,p,tB),t4=eY.Schema.Union(ty,t_,tO,p,tU,tz,tX),t6=eY.Schema.Union(tI,tC,tq,p),t9=eY.Schema.Union(tD,tN,tP,tL,t$,tE,tI,tC,tF,tq,p),t7=eY.Schema.Union(t$,tE,tI,tC,tF,tJ,tq,tZ,p,tQ,tR),re=eY.Schema.Union(eU,tD,tN,tP,tV,p),rt=eY.Schema.Union(eU,tD,tN,tP,tV,t0,p),rr=eY.Schema.Union(eU,tD,tN,tP,tG,p),ri=eY.Schema.Union(tD,tN,tP,tK,tG,p),rn=eY.Schema.Union(ty,tO,t_,p),ra=eY.Schema.Union(p,eU);e.s(["BoughtTooRecentlyError",0,tG,"CheckoutOrderErrorExternal",0,t8,"ContactAlreadyVerifiedError",0,tK,"CreateOrderErrorExternal",0,t2,"DNSSECEnabledError",0,tJ,"DomainAlreadyExistsError",0,tQ,"DomainAlreadyOwnedError",0,tR,"DomainAvailabilityCheckError",0,tT,"DomainCannotBeUnlockedUntilError",0,tY,"DomainInfoNotFoundError",0,tC,"DomainNotAvailableError",0,tx,"DomainNotFirstPartyError",0,tN,"DomainNotFoundError",0,tD,"DomainNotRenewableError",0,tL,"DomainOwnerMismatchError",0,tP,"DomainPriceCheckError",0,tI,"DomainTooShortError",0,tZ,"DuplicateDomainsError",0,tj,"DynamicRegistrantInformationRequiredError",0,tU,"ExpectedPriceMismatchError",0,tF,"GetContactVerificationStatusErrorExternal",0,rr,"GetDomainPriceErrorExternal",0,t6,"GetOrderErrorExternal",0,t1,"GetPostcheckoutRegistrantEmailErrorExternal",0,rn,"GetRegistrantInfoErrorExternal",0,re,"GetTransferInStatusErrorExternal",0,ra,"InvalidDynamicRegistrantInformationError",0,tz,"InvalidPurchaseIntentError",0,tM,"InvalidRegistrantInformationError",0,tV,"NotEnoughNameserversError",0,tH,"OrderAuthMismatchError",0,tO,"OrderEmptyError",0,tS,"OrderModeMismatchError",0,t_,"OrderNotFoundError",0,ty,"OrderStatusError",0,tA,"OrderTooExpensiveError",0,tv,"RegistrantInfoUpdateNotSupportedForTldError",0,t0,"RegistrantInformationRequiredError",0,t$,"RemoveOrderItemErrorExternal",0,t3,"RenewDomainErrorExternal",0,t9,"ResendContactVerificationEmailErrorExternal",0,ri,"StalePurchaseIntentError",0,tX,"StripeCustomerIdNotFoundError",0,tk,"SubmitRegistrantInfoForOrderErrorExternal",0,t4,"TeamNotFoundError",0,tw,"TeamNotProvidedError",0,tE,"TldNotSupportedError",0,tq,"TldOutageError",0,tB,"TooManyDomainsInOrderError",0,tb,"TransferInDomainErrorExternal",0,t7,"UpdateRegistrantInfoErrorExternal",0,rt,"UpsertOrderItemsErrorExternal",0,t5,"UpstreamDomainNotFoundError",0,tW],7039842);let rs=d.Schema.Literal("canceled","canceled_pending_refund","completed","created","failed","pending","pending_insert","pending_new_auth_code","pending_transfer","pending_unlock","rejected","submitting_transfer");e.s(["TransferInStatus",0,rs],6607472);let ro=d.Schema.TaggedStruct("SearchStreamInitialized",{sessionId:d.Schema.String}),rl=d.Schema.Struct({domainName:tr.schema,availability:d.Schema.Literal("available","unavailable"),availabilityCheckedAt:d.Schema.Number,premiumPrice:d.Schema.optional(d.Schema.Number),premiumPriceCheckedAt:d.Schema.optional(d.Schema.Number)}),ru=d.Schema.TaggedStruct("Terminal",{...rl.fields}),rc=d.Schema.TaggedStruct("NonTerminal",{...rl.fields}),rd=d.Schema.TaggedStruct("Error",{domainName:tr.schema}),rp=d.Schema.Union(ru,rc,rd),rf=d.Schema.TaggedStruct("KeepAlive",{}),rh=d.Schema.Union(rp,ro,rf);e.s(["BaseResult",0,rl,"ErrorResult",0,rd,"KeepAliveMessage",0,rf,"NonTerminalResult",0,rc,"SearchResult",0,rp,"SearchStreamInitialized",0,ro,"SearchStreamMessage",0,rh,"TerminalResult",0,ru],7892259),e.s([],2184227),e.i(2184227),e.i(6396407),e.i(7892259);let rm=d.Schema.Literal("buy","renew","transfer","redemption").annotations({identifier:"PriceType",description:"Schema defining the types of TLD pricing."});e.s(["PriceType",0,rm],8400611),e.i(8400611),e.i(6640598);let rg=d.Schema.Struct({name:d.Schema.String,type:rm,registrar:f,price:s.schema,years:d.Schema.Int.pipe(d.Schema.between(1,10)),syncedAt:d.Schema.DateFromSelf}).annotations({identifier:"TldPrice",description:"Represents the structure of a TLD Price entity, including its attributes such as price tiers, currency, and applicable periods."});e.s(["TldPrice",0,rg],5126232),e.i(5126232),e.i(2558253),e.i(8919835),e.i(8489575),e.i(693063),e.i(1615351),e.i(7039842),e.i(3090185),e.i(8305092),e.i(7270874),e.i(1752983),e.i(1581508),e.i(4995849),e.i(5648153),e.i(5286388),e.i(6607472);var ry=S;let rS=/^(?!.*[DFIOQU])[ABCEGHJ-NPRSTVXY]\d[ABCEGHJ-NPRSTVWXYZ][ ]?\d[ABCEGHJ-NPRSTVWXYZ]\d$/i,rb={ca:{zip:d.Schema.NonEmptyTrimmedString.pipe(d.Schema.transform(d.Schema.NonEmptyTrimmedString,{strict:!0,decode:e=>{let t;return 6===(t=e.trim().toUpperCase().replace(/\s/g,"")).length?`${t.slice(0,3)} ${t.slice(3)}`:e},encode:e=>e}),d.Schema.filter(e=>rS.test(e),{message:()=>"Invalid Canadian postal code format. Expected format: A1A 1A1"})).annotations({identifier:"CanadianPostalCode",description:"Canadian postal code in format A1A 1A1 (space optional)"})}},rv=e=>d.Schema.NonEmptyTrimmedString.annotations({message:()=>({message:e,override:!0})}),rE=e=>{let t={...e},r=e=>{e&&Object.entries(e).forEach(e=>{let[r,n]=e;void 0===t[r]&&(t[r]=n,i(n))})},i=e=>{("string"===e.type||"enum"===e.type)&&(r(e.fields),e.options?.forEach(e=>r(e.fields)))};return Object.values(e).forEach(i),t},rw=(e,t)=>{var r;let i,n,a,s,o=rE(e),l=(i=new Set,n=e=>{Object.entries(e).forEach(e=>{let[t,r]=e;i.add(t),("string"===r.type||"enum"===r.type)&&(r.fields&&n(r.fields),r.options?.forEach(e=>{e.fields&&n(e.fields)}))})},Object.values(e).filter(e=>"enum"===e.type&&!!e.options).forEach(e=>e.options?.forEach(e=>{e.fields&&n(e.fields)})),i),u=(a={},Object.entries(o).forEach(e=>{let[r,i]=e;if("notice"===i.type)return;let n=((e,t)=>{let r="enum"===e.type?"Please select a valid option":"string"===e.type&&e.options?.length?"Please select an option":"This field is required";if(t)return e.required?t:d.Schema.Union(d.Schema.Literal(""),t);if("enum"===e.type&&e.options?.length){let t=e.options.map(e=>e.value).filter(e=>void 0!==e);if(0===t.length)return e.required?rv(r):d.Schema.String;let i=d.Schema.String.pipe(d.Schema.filter(e=>t.includes(e),{message:()=>r}));return e.required?i.annotations({message:()=>({message:r,override:!0})}):d.Schema.Union(d.Schema.Literal(""),i)}if(e.validation?.startsWith("regex:")){let t,i=e.validation.slice(6);try{t=new RegExp(i)}catch{return e.required?rv(r):d.Schema.String}let n=d.Schema.String.pipe(d.Schema.pattern(t,{message:()=>`The value must match the pattern ${i}`}));return e.required?n:d.Schema.Union(d.Schema.Literal(""),n)}if(e.validation?.startsWith("min_length:")){let t=Number.parseInt(e.validation.slice(11),10);if(Number.isNaN(t)||t<0)return e.required?rv(r):d.Schema.String;let i=d.Schema.String.pipe(d.Schema.filter(e=>e.length>=t,{message:()=>`The value must be at least ${t} characters long`}));return e.required?i:d.Schema.Union(d.Schema.Literal(""),i)}return e.required?rv(r):d.Schema.String})(i,rb?.[t]?.[r]),s=i.required&&!l.has(r);a[r]=s?n:d.Schema.optional(n)}),a);return r=d.Schema.Struct(u),0===(s=Object.entries(rE(e)).filter(e=>"enum"===e[1].type&&!!e[1].options?.length)).length?r:d.Schema.transformOrFail(r,r,{strict:!0,decode:(e,t,r)=>{let i=[],n=(t,n,a)=>{let s="required_when"in n?n.required_when:void 0;(n.required||s&&a===s)&&(!e[t]||""===e[t])&&i.push(new ry.Pointer(t,e,new ry.Missing(new es.Type(r))))},a=(t,r)=>{if("enum"!==r.type||!r.options)return;let i=e[t];if(!i)return;let s=r.options.find(e=>e.value===i);s?.fields&&Object.entries(s.fields).forEach(t=>{let[r,i]=t;n(r,i),"string"===i.type&&i.fields&&Object.entries(i.fields).forEach(t=>{let[i,a]=t;n(i,a,e[r])}),"enum"===i.type&&i.options&&a(r,i)})};s.forEach(e=>{let[t,r]=e;a(t,r)});let o=i[0];return 0!==i.length&&o?ry.fail(new ry.Composite(r,e,[o,...i.slice(1)])):ry.succeed(e)},encode:e=>ry.succeed(e)})};function rk(e){let t=Object.fromEntries(Object.entries(e).map(e=>{let[t,r]=e;return[t,rw(r,t)]}));return d.Schema.Struct(t)}e.s(["buildTldSchema",0,rw,"constructSchemaFromFieldsSchema",0,rk],3076747),e.i(3076747),e.s(["BaseAndTldRegistrantFieldValues",0,q,"BaseAndTldRegistrantFieldValuesApiResource",0,$,"BaseRegistrantFieldValues",0,B,"BaseResult",0,rl,"BoughtTooRecentlyError",0,tG,"Cents",0,s,"CentsFromDollars",0,G,"CheckoutOrderErrorExternal",0,t8,"ContactAlreadyVerifiedError",0,tK,"CountryCode",0,D,"CreateOrderErrorExternal",0,t2,"DNSSECEnabledError",0,tJ,"Dollars",0,o,"DollarsFromCents",0,H,"DomainAlreadyExistsError",0,tQ,"DomainAlreadyOwnedError",0,tR,"DomainAvailabilityCheckError",0,tT,"DomainCannotBeUnlockedUntilError",0,tY,"DomainInfoNotFoundError",0,tC,"DomainName",0,tr,"DomainNotAvailableError",0,tx,"DomainNotFirstPartyError",0,tN,"DomainNotFoundError",0,tD,"DomainNotRenewableError",0,tL,"DomainOwnerMismatchError",0,tP,"DomainPriceCheckError",0,tI,"DomainTooShortError",0,tZ,"DuplicateDomainsError",0,tj,"DynamicRegistrantInformationRequiredError",0,tU,"E164PhoneNumber",0,F,"EditableOrderStatus",0,eH,"EditableOrderStatuses",0,e$,"EmailAddress",0,I,"ErrorResult",0,rd,"ExpectedPriceMismatchError",0,tF,"Forbidden",0,ez,"GetContactVerificationStatusErrorExternal",0,rr,"GetDomainPriceErrorExternal",0,t6,"GetOrderErrorExternal",0,t1,"GetPostcheckoutRegistrantEmailErrorExternal",0,rn,"GetRegistrantInfoErrorExternal",0,re,"GetSearchTldsErrorExternal",0,p,"GetTransferInStatusErrorExternal",0,ra,"InternalServerError",0,p,"InvalidDomainNameError",0,tt,"InvalidDynamicRegistrantInformationError",0,tz,"InvalidNameserverError",0,to,"InvalidOrderIdError",0,tm,"InvalidPurchaseIntentError",0,tM,"InvalidRegistrantInformationError",0,tV,"KeepAliveMessage",0,rf,"LimitInfo",0,eP,"Nameserver",0,tl,"NonEditableOrderStatus",0,eG,"NonEditableOrderStatuses",0,ej,"NonTerminalResult",0,rc,"NotAuthorizedForScope",0,eW,"NotEnoughNameserversError",0,tH,"NotFound",0,eB,"OrderAuthMismatchError",0,tO,"OrderDomainError",0,l,"OrderDomainStatus",0,eZ,"OrderEmptyError",0,tS,"OrderError",0,u,"OrderId",0,tg,"OrderModeMismatchError",0,t_,"OrderModeValue",0,eJ,"OrderNotFoundError",0,ty,"OrderSource",0,eQ,"OrderStatus",0,eK,"OrderStatusError",0,tA,"OrderStatuses",0,eV,"OrderTooExpensiveError",0,tv,"PriceType",0,rm,"RegistrantFieldValues",0,z,"RegistrantFieldValuesByTld",0,W,"RegistrantFields",0,L,"RegistrantFieldsByTld",0,U,"RegistrantInfoUpdateNotSupportedForTldError",0,t0,"RegistrantInformationRequiredError",0,t$,"RegistrarName",0,f,"RemoveOrderItemErrorExternal",0,t3,"RenewDomainErrorExternal",0,t9,"ResendContactVerificationEmailErrorExternal",0,ri,"RetryAfter",0,eL,"SearchPrice",0,K,"SearchResult",0,rp,"SearchStreamInitialized",0,ro,"SearchStreamMessage",0,rh,"SearchTldPublicSerializable",0,Z,"SearchTlds",0,Q,"SearchTldsPublicSerializable",0,Y,"StalePurchaseIntentError",0,tX,"StripeCustomerIdNotFoundError",0,tk,"SubmitRegistrantInfoForOrderErrorExternal",0,t4,"TeamNotFoundError",0,tw,"TeamNotProvidedError",0,tE,"TerminalResult",0,ru,"TldNotSupportedError",0,tq,"TldOutage",0,h,"TldOutageError",0,tB,"TldOutagePublicSerializable",0,g,"TldOutageSerializable",0,m,"TldPrice",0,rg,"TooManyDomainsInOrderError",0,tb,"TooManyRequests",0,eU,"TransferInDomainErrorExternal",0,t7,"TransferInStatus",0,rs,"Unauthorized",0,eN,"UpdateRegistrantInfoErrorExternal",0,rt,"UpsertOrderItemsErrorExternal",0,t5,"UpstreamDomainNotFoundError",0,tW,"buildTldSchema",0,rw,"constructSchemaFromFieldsSchema",0,rk,"registrantFieldValuesFromApiResource",0,j],6085098);var rI=e.i(6085098);e.s(["Schemas",0,rI],8340218)},5055193,e=>{"use strict";var t=e.i(8815901);e.s(["Option",0,t])},6893786,7983942,7203323,404148,e=>{"use strict";var t=e.i(7703391);e.s(["Schedule",0,t],6893786);var r=e.i(5283034);e.s(["Array",0,r],7983942);var i=e.i(578549);e.s(["Deferred",0,i],7203323);var n=e.i(6532885);e.s(["Ref",0,n],404148)},8358049,e=>{"use strict";var t=e.i(4434603);e.s(["Redacted",0,t])},1097465,e=>{"use strict";var t=e.i(7862555);e.s(["Chunk",0,t])},6912975,e=>{"use strict";var t=e.i(7518524);e.s(["Atom",0,t])},3467418,e=>{"use strict";var t=e.i(4584424);let r=t.layerStorage(()=>sessionStorage),i=t.layerStorage(()=>localStorage);e.s(["layerLocalStorage",0,i,"layerSessionStorage",0,r],9741697);var n=e.i(9741697);e.s(["BrowserKeyValueStore",0,n],3467418)},2800260,e=>{"use strict";var t=e.i(4520167);let r=["relevance","length","price","alphabetical"],i=["all","available","premium"],n=t.Schema.Literal(...r),a=t.Schema.Literal(...i),s=t.Schema.Literal("auto","1","2","3");e.s(["COLUMNS_OPTIONS_DEFAULT",0,"auto","Columns",0,s,"FILTER_OPTIONS",0,i,"FILTER_OPTIONS_DEFAULT",0,"all","FILTER_OPTIONS_MAP",0,{all:"All",available:"Available",premium:"Premium"},"Filter",0,a,"SORT_OPTIONS",0,r,"SORT_OPTIONS_DEFAULT",0,"relevance","SORT_OPTIONS_MAP",0,{relevance:"Relevance",length:"Length",price:"Price",alphabetical:"Alphabetical"},"Sort",0,n])},5836125,1282437,1709267,e=>{"use strict";e.i(7962980);var t,r,i,n,a=e.i(757660),s=e.i(8340218),o=e.i(8973927),l=e.i(5055193),u=e.i(6872829),c=e.i(4520167),d=e.i(6893786),p=e.i(7983942),f=e.i(1445448),h=e.i(7203323),m=e.i(5949828),g=e.i(404148),y=e.i(8358049),S=e.i(1097465),b=e.i(1524216),v=e.i(6912975),E=e.i(9977037),w=e.i(3467418),k=e.i(2800260),I=o,T=e.i(6021311),x=e.i(945364),x=x,C=e.i(5972454),R=e.i(3322401),F=e.i(7548658),A=e.i(5283034),O=e.i(5450905),_=e.i(7862555),M=e.i(3683485),D=e.i(1658800),N=e.i(4309139);let P=e=>new F.RequestResolverImpl(t=>e(t.map(e=>e.map(e=>e.request)))),L=e=>new F.RequestResolverImpl(t=>{if(t.length>1)return F.forEachSequentialDiscard(t,t=>{let r=t.filter(e=>!e.state.completed).map(e=>e.request);return A.isNonEmptyArray(r)?(0,D.invokeWithInterrupt)(e(r),t):F.void});if(1===t.length){let r=t[0].filter(e=>!e.state.completed).map(e=>e.request);return A.isNonEmptyArray(r)?e(r):F.void}return F.void}),U=(0,M.dual)(3,(e,t,r)=>new F.RequestResolverImpl(i=>F.acquireUseRelease(t,()=>e.runAll(i),r),_.make("Around",e,t,r))),z=(0,M.dual)(3,(e,t,r)=>new F.RequestResolverImpl(i=>{let n=i.flatMap(e=>e.map(e=>e.request));return F.acquireUseRelease(t(n),()=>e.runAll(i),e=>r(n,e))},_.make("AroundRequests",e,t,r))),W=(0,M.dual)(2,(e,t)=>new F.RequestResolverImpl(r=>t<1?F.die(new O.IllegalArgumentException("RequestResolver.batchN: n must be at least 1")):e.runAll(Array.from(_.map(A.reduce(r,_.empty(),(e,r)=>_.appendAll(e,_.chunksOf(_.unsafeFromArray(r),t))),e=>Array.from(e)))),_.make("BatchN",e,t))),B=(0,M.dual)(2,(e,t)=>new F.RequestResolverImpl(r=>F.mapInputContext(e.runAll(r),e=>t(e)),_.make("MapInputContext",e,t))),q=(0,M.dual)(3,(e,t,r)=>new F.RequestResolverImpl(i=>F.forEachSequential(i,i=>{let[n,a]=(0,M.pipe)(i,A.partitionMap(r));return(0,D.zipWithOptions)(e.runAll(Array.of(n)),t.runAll(Array.of(a)),()=>void 0,{concurrent:!0})}),_.make("EitherWith",e,t,r))),$=P(()=>R.never).identified("Never"),j=(0,M.dual)(2,(e,t)=>B(e,e=>t).identified("ProvideContext",e,t)),V=(0,M.dual)(2,(e,t)=>new F.RequestResolverImpl(r=>R.race(e.runAll(r),t.runAll(r))).identified("Race",e,t)),H=F.RequestResolverTypeId,G=F.isRequestResolver,K=e=>L(t=>R.forEach(t,t=>R.flatMap(R.exit(e(t)),e=>(0,N.complete)(t,e)),{concurrency:"unbounded",discard:!0})).identified("FromEffect",e),J=F.resolverLocally;e.s(["RequestResolverTypeId",0,H,"around",0,U,"aroundRequests",0,z,"batchN",0,W,"contextFromEffect",0,e=>R.contextWith(t=>j(e,t)),"contextFromServices",0,function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return e=>R.contextWith(r=>j(e,C.pick(...t)(r)))},"eitherWith",0,q,"fromEffect",0,K,"fromEffectTagged",0,()=>e=>L(t=>{let r={},i=[];for(let e=0,n=t.length;e<n;e++)i.includes(t[e]._tag)?r[t[e]._tag].push(t[e]):(r[t[e]._tag]=[t[e]],i.push(t[e]._tag));return R.forEach(i,t=>R.matchCauseEffect(e[t](r[t]),{onFailure:e=>R.forEach(r[t],t=>(0,N.complete)(t,F.exitFail(e)),{discard:!0}),onSuccess:e=>R.forEach(r[t],(t,r)=>(0,N.complete)(t,F.exitSucceed(e[r])),{discard:!0})}),{concurrency:"unbounded",discard:!0})}).identified("FromEffectTagged",e),"fromFunction",0,e=>L(t=>F.forEachSequentialDiscard(t,t=>(0,N.complete)(t,F.exitSucceed(e(t))))).identified("FromFunction",e),"fromFunctionBatched",0,e=>L(t=>R.forEach(e(t),(e,r)=>(0,N.complete)(t[r],F.exitSucceed(e)),{discard:!0})).identified("FromFunctionBatched",e),"isRequestResolver",0,G,"locally",0,J,"make",0,P,"makeBatched",0,L,"makeWithEntry",0,e=>new F.RequestResolverImpl(t=>e(t)),"mapInputContext",0,B,"never",0,$,"provideContext",0,j,"race",0,V],2872692);var Z=e.i(2872692),Z=Z,Q=e.i(4511046),Y=m,X=h,ee=e.i(4584424),ee=ee,et=(e.i(1331084),e.i(6028004)),er=e.i(8815901),ei=e.i(5310088),en=e.i(5160412),ea=e.i(8643033),es=e.i(8973103),eo=(e.i(9227260),e.i(9552070));e.i(2424531),e.i(9973079);let el=Symbol.for("@effect/experimental/PersistenceError");class eu extends(0,ea.TypeIdError)(el,"PersistenceError"){static make(e,t){return new eu({reason:"ParseError",method:e,error:t})}get message(){return eo.TreeFormatter.formatIssueSync(this.error)}}class ec extends(0,ea.TypeIdError)(el,"PersistenceError"){static make(e,t){return new ec({reason:"BackingError",method:e,cause:t})}get message(){return this.reason}}let ed=(0,M.dual)(2,R.fnUntraced(function*(e,t){let r,i=t.maxBatchSize??1/0,n=yield*R.scope,a=yield*R.runtime().pipe(R.interruptible),s=ei.runFork(a),o=new Set,l=t=>R.withRequestCaching(R.forEach(t,t=>{let{request:r,resume:i}=t;return R.request(r,e).pipe(R.exit,R.map(i))},{batching:!0,discard:!0}),!1),u=R.sleep(t.window).pipe(R.flatMap(()=>{let e=o;return o=new Set,r=void 0,l(e)}));return yield*en.addFinalizer(n,R.suspend(()=>r?et.interrupt(r):R.void)),K(e=>R.async(t=>{let n={request:e,resume:t};if(o.add(n),o.size>=i){let e=o;if(o=new Set,r){let e=er.getOrThrow(et.getCurrentFiber());r.unsafeInterruptAsFork(e.id()),r=void 0}s(l(e))}else r||(r=s(u));return R.sync(()=>{o.delete(n)})}))}));var ep=e.i(889957),ef=e.i(8718972);let eh=e=>{let t=window.location.origin;return e.startsWith("/api")?t+e:e.startsWith("/")?t+`/api${e}`:e};ef.ManagedRuntime.make(a.DomainsRegistrarRpcClient.layer({domainsSearchBaseUrl:eh("/api"),domainsRegistrarBaseUrl:eh("/api"),searchProtocol:"http"}));var em=e.i(2051545),eg=e.i(3302588),ey=e.i(2725743);let eS=I.Effect.unsafeMakeLatch();class eb extends Y.Data.TaggedError("SearchStreamNotInitializedError"){}class ev extends Y.Data.TaggedError("DomainSearchFailedError"){}let eE=g.Ref.unsafeMake(null);class ew extends I.Effect.Service()("DomainRequestMap",{sync:()=>{let e=new Map;return{getOrCreate:I.Effect.fnUntraced(function*(t){if(e.has(t))return e.get(t);let r=yield*X.Deferred.make();return e.set(t,r),r})}}}){}let ek=Z.makeBatched(e=>I.Effect.gen(function*(){let t=yield*a.DomainsRegistrarRpcClient.DomainsRegistrarRpcClient;if(!p.Array.isNonEmptyReadonlyArray(e))return;yield*ex,yield*eS.await;let r=yield*g.Ref.get(eE);if(!r)return yield*I.Effect.fail(new eb);for(let i of(yield*t.search.requestDomains({domainNames:p.Array.map(e,e=>e.domain),sessionId:r}),e))yield*x.succeed(i,void 0)}).pipe(I.Effect.catchAll(t=>I.Effect.forEach(e,e=>x.fail(e,t)).pipe(I.Effect.asVoid)))).pipe(Z.contextFromEffect);class eI extends Q.Context.Tag("SubmitDomainAvailabilityRequestResolver")(){static layer=T.Layer.scoped(eI,I.Effect.flatMap(ek,ed({window:"10 millis"})))}class eT extends x.TaggedClass("SubmitDomainAvailabilityRequest"){}let ex=(t="/api/front-domains/checkpoint",r=I.Effect.runSync(I.Effect.makeSemaphore(1)),i=()=>{if((0,ey.isLoggedIn)()||"u"<typeof document)return"valid";let e=document.cookie.split(";"),t=e.find(e=>e.trim().startsWith("domains-checkpoint-token="))?.split("=")[1];if(!t)return"expired-or-invalid";try{let e=JSON.parse(atob(t.split(".")[1])),r=Math.floor(Date.now()/1e3);return!e.exp||e.exp-r<60?"expiring-soon":"valid"}catch{return"expired-or-invalid"}},I.Effect.gen(function*(){let e=yield*eg.HttpClient.HttpClient.pipe(I.Effect.map(eg.HttpClient.filterStatusOk)),r=i();if("expired-or-invalid"===r)yield*e.get(t);else if("expiring-soon"===r)yield*I.Effect.forkScoped(e.get(t));else if("valid"===r)return}).pipe(r.withPermitsIfAvailable(1)));T.Layer.mergeAll(eI.layer,ee.layerMemory,ep.layer,ew.Default).pipe(T.Layer.provideMerge(a.DomainsRegistrarRpcClient.layer({domainsSearchBaseUrl:eh("/api"),domainsRegistrarBaseUrl:eh("/api"),searchProtocol:"http"}).pipe(T.Layer.provideMerge(em.FetchHttpClient.layer))));let eC=T.Layer.mergeAll(eI.layer,w.BrowserKeyValueStore.layerLocalStorage,ep.layer,ew.Default).pipe(T.Layer.provideMerge(a.DomainsRegistrarRpcClient.layer({domainsSearchBaseUrl:eh("/api"),domainsRegistrarBaseUrl:eh("/api"),searchProtocol:"http"}).pipe(T.Layer.provideMerge(em.FetchHttpClient.layer)))),eR=T.Layer.suspend(()=>eC),eF=v.Atom.runtime(eR);Y.Data.taggedEnum();let eA=e=>({headers:{scope:e}});e.s(["DomainRequestMap",0,ew,"DomainSearchFailedError",0,ev,"SubmitDomainAvailabilityRequest",0,eT,"SubmitDomainAvailabilityRequestResolver",0,eI,"atomRuntime",0,eF,"currentSessionIdRef",0,eE,"ensureCookies",0,ex,"scopeHeader",0,eA,"streamOpenLatch",0,eS],1282437);var eO="basil",e_="https://js.stripe.com",eM="".concat(e_,"/").concat(eO,"/stripe.js"),eD=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,eN=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/,eP=function(){for(var e=document.querySelectorAll('script[src^="'.concat(e_,'"]')),t=0;t<e.length;t++){var r,i=e[t];if(r=i.src,eD.test(r)||eN.test(r))return i}return null},eL=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",r=document.createElement("script");r.src="".concat(eM).concat(t);var i=document.head||document.body;if(!i)throw Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return i.appendChild(r),r},eU=function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"7.9.0",startTime:t})},ez=null,eW=null,eB=null,eq=function(e,t,r){if(null===e)return null;var i,n=t[0].match(/^pk_test/),a=3===(i=e.version)?"v3":i;n&&a!==eO&&console.warn("Stripe.js@".concat(a," was loaded on the page, but @stripe/stripe-js@").concat("7.9.0"," expected Stripe.js@").concat(eO,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var s=e.apply(void 0,t);return eU(s,r),s},e$=!1,ej=function(){return n?n:n=(null!==ez?ez:(ez=new Promise(function(e,t){if("u"<typeof window||"u"<typeof document)return void e(null);if(window.Stripe,window.Stripe)return void e(window.Stripe);try{var r,i=eP();i?i&&null!==eB&&null!==eW&&(i.removeEventListener("load",eB),i.removeEventListener("error",eW),null==(r=i.parentNode)||r.removeChild(i),i=eL(null)):i=eL(null),eB=function(){window.Stripe?e(window.Stripe):t(Error("Stripe.js not available"))},eW=function(e){t(Error("Failed to load Stripe.js",{cause:e}))},i.addEventListener("load",eB),i.addEventListener("error",eW)}catch(e){t(e);return}})).catch(function(e){return ez=null,Promise.reject(e)})).catch(function(e){return n=null,Promise.reject(e)})};Promise.resolve().then(function(){return ej()}).catch(function(e){e$||console.warn(e)});var eV=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];e$=!0;var i=Date.now();return ej().then(function(e){return eq(e,t,i)})},eH=e.i(1509709);let eG=e=>""!==e.trim()&&e.includes(" ");e.s(["isAiSearchQuery",0,eG],1709267);let eK=v.Atom.make({status:"closed"}).pipe(v.Atom.withLabel("streamStateAtom"),v.Atom.keepAlive);function eJ(e){return t=>t.pipe(o.Effect.tapError(t=>o.Effect.sync(()=>{"RpcClientError"===t._tag||"RequestError"===t._tag||"ResponseError"===t._tag?console.error("Transient network error",t):(0,eH.captureException)(t,{attributes:{functionName:e,tag:t._tag}})})))}let eZ=v.Atom.family(e=>v.Atom.make(E.Result.initial(!0)).pipe(v.Atom.withLabel(`domainStateRx(${e})`),v.Atom.keepAlive,v.Atom.setIdleTTL("1 minute"))),eQ=v.Atom.family(e=>v.Atom.writable(t=>t(eZ(e)),(t,r)=>{let i=t.get(eZ(e));E.Result.isSuccess(i)&&E.Result.isSuccess(r)&&"Terminal"===i.value._tag&&"NonTerminal"===r.value._tag||t.set(eZ(e),r)}).pipe(v.Atom.withLabel(`domainStateRx(${e})`))),eY=v.Atom.family(e=>eF.atom(t=>o.Effect.gen(function*(){"closed"===t(eK).status&&t.refresh(e0),yield*eS.await,yield*o.Effect.request(new eT({domain:e}),eI);let r=yield*ew,i=yield*r.getOrCreate(e);yield*h.Deferred.await(i)}).pipe(eJ("requestDomainRx"),o.Effect.retry({schedule:d.Schedule.fromDelays(250,750,3e3).pipe(d.Schedule.jittered),while:e=>b.Match.value(e).pipe(b.Match.tag("SearchStreamNotInitializedError",()=>!0),b.Match.tag("RequestError",()=>!0),b.Match.tag("ResponseError",()=>!0),b.Match.tag("RpcClientError",()=>!0),b.Match.tag("DomainSearchFailedError",()=>!0),b.Match.tag("TooManyRequests",()=>!1),b.Match.tag("NotAuthorizedForScope",()=>!1),b.Match.tag("Unauthorized",()=>!1),b.Match.exhaustive)}),o.Effect.catchAll(r=>o.Effect.sync(()=>t.set(eQ(e),E.Result.failure(f.Cause.fail(r))))))).pipe(v.Atom.withLabel(`requestDomainRx(${e})`),v.Atom.keepAlive,v.Atom.setIdleTTL("1 minute"))),eX=v.Atom.family(e=>{let{domain:t,enabled:r}=e;return eF.atom(e=>o.Effect.gen(function*(){return r&&e.once(eY(t)),yield*e.result(eQ(t))})).pipe(v.Atom.withLabel(`optionallyDisabledDomainStateRx(${t})`),v.Atom.refreshOnWindowFocus)}),e0=eF.atom(e=>o.Effect.gen(function*(){e.set(eK,{status:"opening"});let t=yield*a.DomainsRegistrarRpcClient.DomainsRegistrarRpcClient;yield*ex;let r=t.search.openSearchStream(),i=yield*ew;yield*u.Stream.runForEach(r,t=>o.Effect.gen(function*(){if("KeepAlive"===t._tag)return yield*o.Effect.void;if("SearchStreamInitialized"===t._tag)return yield*eS.open,yield*g.Ref.set(eE,t.sessionId),e.set(eK,{status:"opened",sessionId:t.sessionId}),yield*o.Effect.void;{let r=yield*i.getOrCreate(t.domainName);r&&(yield*h.Deferred.succeed(r,void 0)),"Error"===t._tag?e.set(eQ(t.domainName),E.Result.failure(f.Cause.fail(new ev({cause:t})))):e.set(eQ(t.domainName),E.Result.success(t))}}))}).pipe(o.Effect.onExit(()=>o.Effect.gen(function*(){yield*eS.close,yield*g.Ref.set(eE,null),e.set(eK,{status:"closed"})})),eJ("domainSearchStreamRx"),o.Effect.retry({schedule:d.Schedule.fromDelays(250,750,3e3).pipe(d.Schedule.jittered),while:e=>b.Match.value(e).pipe(b.Match.tag("RequestError",()=>!0),b.Match.tag("ResponseError",()=>!0),b.Match.tag("RpcClientError",()=>!0),b.Match.tag("InternalServerError",()=>!0),b.Match.tag("TooManyRequests",()=>!1),b.Match.tag("NotAuthorizedForScope",()=>!1),b.Match.tag("Unauthorized",()=>!1),b.Match.exhaustive)}))).pipe(v.Atom.withLabel("domainSearchStreamRx"),v.Atom.keepAlive),e1=v.Atom.family(e=>eF.atom(o.Effect.gen(function*(){if(!eG(e))return yield*o.Effect.succeed([]);let t=yield*a.DomainsRegistrarRpcClient.DomainsRegistrarRpcClient;return(yield*t.search.getAiDomainResults({query:e.trim()})).suggestions}).pipe(o.Effect.tapError(e=>o.Effect.logError("Error getting AI domain search results",e)),o.Effect.catchAll(e=>"TooManyRequests"===e._tag?e:o.Effect.succeed([])))).pipe(v.Atom.withLabel(`aiDomainSearchResultsRx(${e})`),v.Atom.keepAlive,v.Atom.setIdleTTL("1 minute"))),e2=v.Atom.kvs({runtime:eF,key:"domains:orderId",schema:c.Schema.Option(s.Schemas.OrderId.schema),defaultValue:()=>l.Option.none()}).pipe(v.Atom.withLabel("orderIdRx")),e5=v.Atom.make(e=>o.Effect.gen(function*(){return yield*e(e2)})).pipe(v.Atom.withLabel("unwrappedOrderIdRx")),e3=eF.atom(e=>o.Effect.gen(function*(){let t=yield*a.DomainsRegistrarRpcClient.DomainsRegistrarRpcClient,r=yield*e.result(e5);return yield*t.orders.get({orderId:r})}).pipe(o.Effect.tapErrorTag("OrderAuthMismatchError",()=>o.Effect.sync(()=>e.set(e2,l.Option.none()))),o.Effect.retry({while:e=>"OrderAuthMismatchError"===e._tag}))).pipe(v.Atom.withLabel("orderStateRx"),v.Atom.optimistic,v.Atom.withReactivity(["orderState"])),e8=v.Atom.family(e=>eF.atom(()=>o.Effect.gen(function*(){let t=yield*a.DomainsRegistrarRpcClient.DomainsRegistrarRpcClient;return yield*t.orders.get({orderId:e})})).pipe(v.Atom.withLabel(`postCheckoutOrderStateRx(${e})`),v.Atom.optimistic,v.Atom.withReactivity(["orderState"]))),e4=v.Atom.family(e=>v.Atom.make(t=>o.Effect.gen(function*(){return(yield*t.result(e3)).items.some(t=>t.domainName===e)}).pipe(o.Effect.catchTag("NoSuchElementException",()=>o.Effect.succeed(!1)))).pipe(v.Atom.withLabel(`itemInCartRx(${e})`))),e6=v.Atom.kvs({runtime:v.Atom.runtime(w.BrowserKeyValueStore.layerSessionStorage),key:"domains:searchParams",schema:c.Schema.Option(c.Schema.parseJson(c.Schema.Struct({q:c.Schema.String.pipe(c.Schema.optional),sort:k.Sort.pipe(c.Schema.optional),filter:k.Filter.pipe(c.Schema.optional),columns:k.Columns.pipe(c.Schema.optional)}))),defaultValue:()=>l.Option.none()}).pipe(v.Atom.withLabel("searchParamsSessionRx")),e9=v.Atom.family(e=>v.Atom.make(t=>o.Effect.gen(function*(){let r=yield*t.result(e8(e.orderId)),i=yield*p.Array.findFirst(r.items,t=>t.domainName===e.domain);return"failed"===r.status?{...i,status:"order-failed"}:i})).pipe(v.Atom.withLabel(`postCheckoutDomainStateRx(${e.domain}, ${e.orderId})`))),e7=v.Atom.make(u.Stream.iterate(1,e=>e+1).pipe(u.Stream.schedule(d.Schedule.spaced("2 seconds")))).pipe(v.Atom.withLabel("pollSignalRx")),te=v.Atom.family(e=>e8(e).pipe(v.Atom.makeRefreshOnSignal(e7),v.Atom.withLabel(`pollPostCheckoutStateRx(${e})`))),tt=v.Atom.make(o.Effect.tryPromise(()=>eV(String("pk_test_51KWTJcBQYfoTMhVJkeKojfST4MsShve9XJ7Seqw7mgZaUCeO1DR4dR3EkrWFDqD0MG5IiZRYFygw6ZR8FnmZZKnn004vR9fkFq"))).pipe(o.Effect.catchAll(()=>o.Effect.succeed(null)))).pipe(v.Atom.withLabel("testStripeAtom"),v.Atom.keepAlive),tr=v.Atom.make(o.Effect.tryPromise(()=>eV(String("pk_live_alyEi3lN0kSwbdevK0nrGwTw"))).pipe(o.Effect.catchAll(()=>o.Effect.succeed(null)))).pipe(v.Atom.withLabel("liveStripeAtom"),v.Atom.keepAlive),ti=v.Atom.family(e=>v.Atom.make(t=>t("test"===e?tt:tr)).pipe(v.Atom.withLabel(`stripeAtom(${e})`)));class tn extends m.Data.TaggedError("InvalidOrderError"){}let ta=v.Atom.family(e=>eF.atom(o.Effect.gen(function*(){if(null===e)return yield*o.Effect.never;let t=yield*a.DomainsRegistrarRpcClient.DomainsRegistrarRpcClient,r=yield*t.orders.get({orderId:e});return 1!==r.items.length?yield*o.Effect.fail(new tn({cause:"Order has multiple items"})):"failed"===r.status?{status:"failed",error:r.error}:{status:r.items[0].status,error:r.items[0].error}})).pipe(v.Atom.withLabel(`postRenewStateAtom(${e})`))),ts=v.Atom.family(e=>ta(e).pipe(v.Atom.makeRefreshOnSignal(e7),v.Atom.withLabel(`pollPostRenewStateRx(${e})`))),to=v.Atom.make(null).pipe(v.Atom.withLabel("scrollPositionRx"),v.Atom.keepAlive);class tl extends m.Data.Class{}let tu=v.Atom.family(e=>eF.atom(o.Effect.gen(function*(){if(null===e.domainName)return yield*o.Effect.never;let t=yield*s.Schemas.DomainName.fromString(e.domainName),r=yield*a.DomainsRegistrarRpcClient.DomainsRegistrarRpcClient;return yield*r.domains.getPrice({domainName:t,purchaseType:"renewal",years:e.years})}).pipe(o.Effect.tapError(t=>o.Effect.sync(()=>{console.error("Failed to get renewal price for domain",e.domainName,t)})))).pipe(v.Atom.withServerValueInitial));class tc extends m.Data.Class{}let td=v.Atom.family(e=>eF.atom(o.Effect.gen(function*(){if(null===e.domainName)return yield*o.Effect.never;let t=yield*s.Schemas.DomainName.fromString(e.domainName),r=yield*a.DomainsRegistrarRpcClient.DomainsRegistrarRpcClient;return yield*r.domains.getPrice({domainName:t,purchaseType:"transfer"})}).pipe(o.Effect.tapError(t=>o.Effect.sync(()=>{console.error("Failed to get transfer price for domain",e.domainName,t)})))).pipe(v.Atom.withServerValueInitial)),tp=v.Atom.family(e=>eF.atom(o.Effect.gen(function*(){if(null===e)return yield*o.Effect.never;let t=yield*s.Schemas.DomainName.fromString(e),r=yield*a.DomainsRegistrarRpcClient.DomainsRegistrarRpcClient;return yield*r.domains.getPrice({domainName:t,purchaseType:"redemption"})})).pipe(v.Atom.withServerValueInitial));class tf extends m.Data.Class{}let th=v.Atom.family(e=>eF.atom(o.Effect.gen(function*(){if(null===e.domainName||null===e.scope)return yield*o.Effect.never;let t=yield*s.Schemas.DomainName.fromString(e.domainName),r=yield*a.DomainsRegistrarRpcClient.DomainsRegistrarRpcClient,i=yield*r.domains.getRenewalInfo({domainName:t},eA(e.scope)).pipe(o.Effect.orElseSucceed(()=>null));if(i?.renewalType==="redemption-period")return{renewalType:"redemption-period",price:yield*r.domains.getPrice({domainName:t,purchaseType:"redemption"})};if(i?.renewalType==="expired")return{renewalType:"expired"};let n=yield*r.domains.getPrice({domainName:t,purchaseType:"renewal"});return{renewalType:i?.renewalType??void 0,price:n}}))),tm=v.Atom.family(e=>eF.atom(o.Effect.gen(function*(){if(null===e.domainName||null===e.scope)return yield*o.Effect.never;let t=yield*s.Schemas.DomainName.fromString(e.domainName),r=yield*a.DomainsRegistrarRpcClient.DomainsRegistrarRpcClient;return yield*r.domains.getRenewalInfo({domainName:t},eA(e.scope))})));class tg extends m.Data.Class{}let ty=v.Atom.family(e=>eF.atom(o.Effect.gen(function*(){if(null===e.domainName||null===e.scope)return yield*o.Effect.never;let t=yield*s.Schemas.DomainName.fromString(e.domainName),r=yield*a.DomainsRegistrarRpcClient.DomainsRegistrarRpcClient;return yield*r.domains.getRegistrantInfo({domainName:t},eA(e.scope))}).pipe(o.Effect.tapError(t=>o.Effect.sync(()=>{console.error("Failed to fetch registrant info for domain",e.domainName,t)})))));class tS extends m.Data.Class{}let tb=v.Atom.family(e=>eF.atom(o.Effect.forEach(e.domainNames,t=>o.Effect.gen(function*(){if(null===e.scope)return yield*o.Effect.never;let r=yield*s.Schemas.DomainName.fromString(t),i=yield*a.DomainsRegistrarRpcClient.DomainsRegistrarRpcClient;return yield*i.domains.getRegistrantInfo({domainName:r},eA(e.scope))}).pipe(o.Effect.tapError(e=>o.Effect.sync(()=>{console.error("failed to fetch registrant info for domain",t,e)})),o.Effect.map(e=>{let{registrantInfo:t}=e;return null!==t}),o.Effect.orElse(()=>o.Effect.succeed(!1))))));class tv extends m.Data.Class{}let tE=v.Atom.family(e=>eF.atom(o.Effect.gen(function*(){if(null===e.domainName||null===e.scope)return yield*o.Effect.never;let t=yield*s.Schemas.DomainName.fromString(e.domainName),r=yield*a.DomainsRegistrarRpcClient.DomainsRegistrarRpcClient,i=yield*r.domains.getAuthCode({domainName:t},eA(e.scope));return y.Redacted.value(i.authCode)}).pipe(o.Effect.tapError(t=>o.Effect.sync(()=>{console.error("Failed to fetch auth code for domain",e.domainName,t)})))));class tw extends m.Data.Class{}let tk=v.Atom.family(e=>eF.atom(o.Effect.gen(function*(){if(null===e.domainName||null===e.scope)return yield*o.Effect.never;let t=yield*s.Schemas.DomainName.fromString(e.domainName),r=yield*a.DomainsRegistrarRpcClient.DomainsRegistrarRpcClient;return yield*r.domains.getContactVerificationStatus({domainName:t},eA(e.scope))}).pipe(o.Effect.tapError(t=>o.Effect.sync(()=>{console.error("Failed to get contact verification status for domain",e.domainName,t)})))));class tI extends m.Data.Class{}let tT=v.Atom.family(e=>eF.atom(o.Effect.gen(function*(){if(0===e.domainNames.length||null===e.scope)return[];let t=yield*a.DomainsRegistrarRpcClient.DomainsRegistrarRpcClient;return yield*t.domains.getUnverifiedContacts({domainNames:S.Chunk.toReadonlyArray(S.Chunk.map(e.domainNames,e=>s.Schemas.DomainName.unsafeBrand(e)))},eA(e.scope))}).pipe(o.Effect.tapError(e=>o.Effect.sync(()=>{console.error("Failed to get unverified contacts",e)}))))),tx=v.Atom.family(e=>eF.atom(o.Effect.gen(function*(){let t=yield*a.DomainsRegistrarRpcClient.DomainsRegistrarRpcClient;return yield*t.orders.getPostcheckoutRegistrantEmail({orderId:e})}).pipe(o.Effect.tapError(e=>o.Effect.sync(()=>{console.error("Failed to get postcheckout registrant email",e)})),o.Effect.orElse(()=>o.Effect.succeed({willSend:"maybe"}))))),tC=v.Atom.family(e=>eF.atom(o.Effect.gen(function*(){if(null===e)return yield*o.Effect.succeed(null);let t=e.split(".").slice(1).join("."),r=yield*a.DomainsRegistrarRpcClient.DomainsRegistrarRpcClient;return yield*r.tlds.getTldOutage({tldName:t})}).pipe(o.Effect.tapError(t=>o.Effect.sync(()=>{console.error("Failed to check TLD outage for domain",e,t)})),o.Effect.orElse(()=>o.Effect.succeed(null)))).pipe(v.Atom.withLabel(`tldOutageAtom(${e})`)));class tR extends m.Data.Class{}let tF=v.Atom.family(e=>eF.atom(o.Effect.gen(function*(){if(null===e.domainName||null===e.scope)return yield*o.Effect.never;let t=yield*s.Schemas.DomainName.fromString(e.domainName),r=yield*a.DomainsRegistrarRpcClient.DomainsRegistrarRpcClient;return yield*r.domains.getTransferInStatus({domainName:t},eA(e.scope))}).pipe(o.Effect.tapError(t=>o.Effect.sync(()=>{console.error("Failed to get transfer in status for domain",e.domainName,t)}))))),tA=eF.atom(()=>o.Effect.gen(function*(){let e=yield*a.DomainsRegistrarRpcClient.DomainsRegistrarRpcClient;return(yield*e.domains.getSaved()).domains}).pipe(o.Effect.tapError(e=>o.Effect.sync(()=>{console.error("Failed to get saved domains",e)})),o.Effect.catchAll(()=>o.Effect.succeed([])))).pipe(v.Atom.withLabel("savedDomainsRx"),v.Atom.optimistic,v.Atom.withReactivity(["savedDomains"])),tO=v.Atom.family(e=>v.Atom.make(t=>o.Effect.gen(function*(){return(yield*t.result(tA)).some(t=>t.domainName===e)}).pipe(o.Effect.catchAll(()=>o.Effect.succeed(!1)))).pipe(v.Atom.withLabel(`isDomainSavedRx(${e})`)));e.s(["ContactVerificationStateParams",0,tw,"DomainAuthCodeParams",0,tv,"DomainRegistrantInfoParams",0,tg,"DomainRenewalInfoParams",0,tf,"DomainRenewalPriceParams",0,tl,"DomainTransferInStatusParams",0,tR,"DomainTransferPriceParams",0,tc,"DomainsHaveRegistrantInfoParams",0,tS,"UnverifiedContactsParams",0,tI,"aiDomainSearchResultsRx",0,e1,"contactVerificationStateAtom",0,tk,"domainAuthCodeAtom",0,tE,"domainRedemptionPriceAtom",0,tp,"domainRegistrantInfoAtom",0,ty,"domainRenewalInfoAndPriceAtom",0,th,"domainRenewalInfoAtom",0,tm,"domainRenewalPriceAtom",0,tu,"domainSearchStreamRx",0,e0,"domainTransferInStatusAtom",0,tF,"domainTransferPriceAtom",0,td,"domainsHaveRegistrantInfoAtom",0,tb,"isDomainSavedRx",0,tO,"isSpecificOrderError",0,function(e,t){return e.code===t},"itemInCartRx",0,e4,"matchSearchResult",0,(e,t)=>{let{onAvailable:r,onUnavailable:i}=t;return"available"===e.availability?r(e):i(e)},"optionallyDisabledDomainStateRx",0,eX,"orderIdRx",0,e2,"orderStateRx",0,e3,"pollPostCheckoutStateRx",0,te,"pollPostRenewStateRx",0,ts,"pollSignalRx",0,e7,"postCheckoutDomainStateRx",0,e9,"postCheckoutOrderStateRx",0,e8,"postcheckoutRegistrantEmailAtom",0,tx,"savedDomainsRx",0,tA,"scrollPositionRx",0,to,"searchParamsSessionRx",0,e6,"stripeAtom",0,ti,"tldOutageAtom",0,tC,"unverifiedContactsAtom",0,tT,"unwrappedOrderIdRx",0,e5],5836125)}]);

//# debugId=9bd97046-6f27-73c7-f253-437529c45be6
//# sourceMappingURL=a0e0b4a7420e2275.js.map