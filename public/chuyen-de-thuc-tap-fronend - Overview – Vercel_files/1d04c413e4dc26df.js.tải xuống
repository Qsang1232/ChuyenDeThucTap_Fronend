;!function(){try { var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&((e._debugIds|| (e._debugIds={}))[n]="2fa759d9-2789-b73f-fb49-1873b21991cc")}catch(e){}}();
(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,4405391,e=>{"use strict";function t(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function i(e){return"number"==typeof e&&!Number.isNaN(e)}let r=e=>{if(!i(e))return"–";if(e<60)return`${e.toFixed(0)} s`;let r=Math.round(e/3600);return r<1?`${Math.round(e/60)} m`:`${t(r)} h`};e.s(["isNumber",0,i,"msDetailedTimeFormatter",0,e=>i(e)?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"short";if(0===e)return"short"===t?"0s":"0 seconds";let i=Math.floor(e/3600),r=Math.floor(e%3600/60),o=Math.floor(e%60),a=[];return(i>0&&a.push("short"===t?`${i}h`:`${i} hour${1!==i?"s":""}`),r>0&&a.push("short"===t?`${r}m`:`${r} minute${1!==r?"s":""}`),(o>0||0===a.length)&&a.push("short"===t?`${o}s`:`${o} second${1!==o?"s":""}`),a.length>2)?a.slice(0,2).join(" "):a.join(" ")}(Math.round(e/1e3),"short"):"–","msTimeFormatter",0,e=>i(e)?r(Math.round(e/1e3),"short"):"–","numberWithCommas",0,t,"roundUpAxisRange",0,function(e,t){var i;let o;if(0===e)return t===r?300:5;let a=Math.pow(10,Math.floor(Math.log10(e)));e=Math.ceil(10*e/a)*a/10;let l=5*a;if(e>=3*a&&e<=l)return l;let n=a/10,s=0;for(;6!==new Set([0,o=(i=e)/5,2*o,3*o,4*o,i].map(e=>t(e))).size;)e+=n,++s>=10&&(n*=10,s=0);return e},"timeFormatter",0,r])},6493958,e=>{"use strict";var t=e.i(4405391);let i=["","k","M","B","T","Q","Qi"],r=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"short";if(!(0,t.isNumber)(e))return"–";if("short"!==r&&"short-precision"!==r)return(0,t.numberWithCommas)(Math.round(e));let o=Math.log10(Math.abs(e))/3|0;if(0===o)return String(Math.round(e));let a=i[o],l=e/Math.pow(10,3*o);return[l="short-precision"!==r?Math.round(l):l%Math.round(l)==0?l:l.toFixed(1),a].filter(Boolean).join(" ")};e.s(["countFormatter",0,r,"createCountFormatterWithUnit",0,function(e){let{singular:t,plural:i}=e;return(e,o)=>{let a=r(e,o);if("long"===o){let r=1===e?t:i;return`${a} ${r}`}return a}}])},3993360,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M8.75 1V1.75V8.68934L10.7197 6.71967L11.25 6.18934L12.3107 7.25L11.7803 7.78033L8.70711 10.8536C8.31658 11.2441 7.68342 11.2441 7.29289 10.8536L4.21967 7.78033L3.68934 7.25L4.75 6.18934L5.28033 6.71967L7.25 8.68934V1.75V1H8.75ZM13.5 9.25V13.5H2.5V9.25V8.5H1V9.25V14C1 14.5523 1.44771 15 2 15H14C14.5523 15 15 14.5523 15 14V9.25V8.5H13.5V9.25Z" fill="currentColor"/>');e.s(["Download",0,t])},5366204,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M8.46968 1.46968C10.1433 -0.203925 12.8567 -0.203923 14.5303 1.46968C16.2039 3.14329 16.2039 5.85674 14.5303 7.53034L12.0303 10.0303L10.9697 8.96968L13.4697 6.46968C14.5575 5.38186 14.5575 3.61816 13.4697 2.53034C12.3819 1.44252 10.6182 1.44252 9.53034 2.53034L7.03034 5.03034L5.96968 3.96968L8.46968 1.46968ZM11.5303 5.53034L5.53034 11.5303L4.46968 10.4697L10.4697 4.46968L11.5303 5.53034ZM1.46968 14.5303C3.14329 16.2039 5.85673 16.204 7.53034 14.5303L10.0303 12.0303L8.96968 10.9697L6.46968 13.4697C5.38186 14.5575 3.61816 14.5575 2.53034 13.4697C1.44252 12.3819 1.44252 10.6182 2.53034 9.53034L5.03034 7.03034L3.96968 5.96968L1.46968 8.46968C-0.203923 10.1433 -0.203925 12.8567 1.46968 14.5303Z" fill="currentColor"/>');e.s(["Link",0,t])},2112997,e=>{e.v({checked:"switch-control-module__WvDOda__checked",container:"switch-control-module__WvDOda__container",control:"switch-control-module__WvDOda__control",disabled:"switch-control-module__WvDOda__disabled",icon:"switch-control-module__WvDOda__icon",large:"switch-control-module__WvDOda__large",small:"switch-control-module__WvDOda__small",text:"switch-control-module__WvDOda__text"})},1328457,e=>{e.v({hideBorder:"switch-module__idkRsq__hideBorder",large:"switch-module__idkRsq__large",small:"switch-module__idkRsq__small",switch:"switch-module__idkRsq__switch"})},8923565,e=>{"use strict";var t=e.i(31889),i=e.i(6695816),r=e.i(9722978),o=e.i(9508212),a=e.i(1232321),l=e.i(1344973),n=e.i(2112997),s=e.i(1328457);let u=Object.assign((0,i.forwardRef)(function(e,a){let{className:l,size:n,name:u,children:d,hideBorder:c,checkedColor:h,...m}=e;return(0,t.jsx)(o.Stack,{className:(0,r.clsx)(l,s.default.switch,{[String(s.default.large)]:"large"===n,[String(s.default.small)]:"small"===n,[String(s.default.hideBorder)]:c}),direction:"row",...m,ref:a,children:i.Children.map(d,e=>(0,i.cloneElement)(e,{name:u,size:n,checkedColor:h}))})}),{Control:function(e){let{className:o,icon:s,label:u,size:d,checked:c,disabled:h,checkedColor:m="var(--ds-gray-100)",innerDivClassName:p,...g}=e,b=void 0!==s,f=(0,r.clsx)(n.default.control,{[String(n.default.disabled)]:h,[String(n.default.checked)]:c,[String(n.default.large)]:"large"===d,[String(n.default.small)]:"small"===d,[String(n.default.text)]:!b,[String(n.default.icon)]:b}),y=s?(0,t.jsxs)(t.Fragment,{children:[(0,i.cloneElement)(s,{size:"large"===d?20:16}),(0,t.jsx)("span",{className:"geist-sr-only",children:u})]}):u;return"href"in g&&void 0!==g.href?h?(0,t.jsx)(l.Text,{as:"span",className:f,style:{"--switch-checked-color":m},children:y}):(0,t.jsx)(a.default,{className:f,href:g.href,onClick:g.onClick,prefetch:g.prefetch,scroll:!1,style:{"--switch-checked-color":m},children:y}):(0,t.jsxs)("label",{className:(0,r.clsx)(n.default.container,o),"data-disabled":h?"true":"false",children:[(0,t.jsx)("input",{...g,checked:c,className:"geist-sr-only",disabled:h,type:"radio"}),(0,t.jsx)("div",{className:(0,r.clsx)(f,p),style:{"--switch-checked-color":m},children:y})]})}});e.s(["Switch",0,u],8923565)},6311495,e=>{"use strict";var t=e.i(7553931),i=e.i(8275278);e.s(["useTeamSlug",0,function(){let e,r=(0,t.useParams)(),o=(e=(0,i.useClientOnlySearchParamsHydrationErrorsPossible)(),e?.get("teamSlug")??null);return r?.teamSlug??o}])},4725703,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M6 1V1.75V5C6 5.55229 5.55228 6 5 6H1.75H1V4.5H1.75H4.5V1.75V1H6ZM14.25 6H15V4.5H14.25H11.5V1.75V1H10V1.75V5C10 5.55228 10.4477 6 11 6H14.25ZM10 14.25V15H11.5V14.25V11.5H14.29H15.04V10H14.29H11C10.4477 10 10 10.4477 10 11V14.25ZM1.75 10H1V11.5H1.75H4.5V14.25V15H6V14.25V11C6 10.4477 5.55229 10 5 10H1.75Z" fill="currentColor"/>');e.s(["FullscreenClose",0,t])},5750944,e=>{"use strict";var t=e.i(31889),i=e.i(1482429),r=e.i(4912077),o=e.i(545405),a=e.i(854682),l=e.i(2504781),n=e.i(5468328),s=e.i(455575),u=e.i(5806401),d=e.i(6942035),c=e.i(3672946),h=e.i(4725703),m=e.i(5366204),p=e.i(6143247),g=e.i(6695816),b=e.i(5348482),f=e.i(1135066);function y(){let e=(0,s.useToasts)();return(0,t.jsxs)(u.SheetHeader,{children:[(0,t.jsx)(u.SheetTitle,{className:"hidden"}),(0,t.jsxs)("div",{className:"sticky top-0 z-10 flex items-center gap-2 bg-background-100 pl-2",children:[(0,t.jsx)("p",{className:"text-heading-20 text-nowrap",children:"Run Query"}),(0,t.jsx)(l.Button,{"aria-label":"Copy to clipboard",className:"!px-1.5",onClick:()=>{(0,o.copyToClipboard)(window.location.href),e.message("URL copied to clipboard!")},size:"small",svgOnly:!0,shape:"square",type:"tertiary",children:(0,t.jsx)(m.Link,{color:"gray-800"})})]})]})}function v(e){let{fullScreen:i,setFullScreen:r}=e;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.Button,{"aria-label":i?"Minimize":"Expand",onClick:()=>r(!i),svgOnly:!0,className:"hidden lg:block",shape:"square",type:"tertiary",children:i?(0,t.jsx)(n.Tooltip,{text:"Minimize",position:"bottom",children:(0,t.jsx)(h.FullscreenClose,{})}):(0,t.jsx)(n.Tooltip,{text:"Expand",position:"bottom",children:(0,t.jsx)(c.Fullscreen,{})})}),(0,t.jsx)(u.SheetClose,{asChild:!0,children:(0,t.jsx)(l.Button,{"aria-label":"Close",shape:"square",size:"medium",svgOnly:!0,type:"tertiary",children:(0,t.jsx)(d.Cross,{})})})]})}e.s(["QueryBuilderDrawer",0,function(){let[e,o]=(0,b.useQueryBuilderQueryState)(),{hasObservabilityPlusAccess:l,ready:n}=(0,a.useHasObservabilityPlus)(),s=e.fullScreen??!1;return(0,t.jsx)(u.Sheet,{onOpenChange:e=>o({builder:e},{navigate:!0}),open:e.builder,children:(0,t.jsx)(u.SheetContent,{className:(0,p.cn)("m-3 h-[calc(100%-1.5rem)] w-[calc(100%-1.5rem)] overflow-visible rounded-[1rem] bg-white p-0 lg:w-5/6 sm:max-w-[auto]",s&&"!w-[calc(100%-1.5rem)]"),onEscapeKeyDown:e=>{e.target instanceof HTMLInputElement&&e.preventDefault()},side:"right",children:(0,t.jsxs)("div",{className:"@container flex h-full flex-col overflow-hidden rounded-[1rem]",children:[(0,t.jsx)(f.QueryBuilder,{Actions:(0,t.jsx)(v,{fullScreen:s,setFullScreen:e=>o({fullScreen:e},{navigate:!0})}),query:e,setQuery:e=>o(e,{navigate:!0}),Title:(0,t.jsx)(y,{})}),n&&l?(0,t.jsx)(g.Suspense,{children:(0,t.jsxs)("section",{className:"flex justify-end gap-2 border-t bg-background-200 p-3",children:[(0,t.jsx)(r.ExportButton,{query:e}),(0,t.jsx)(i.AddToNotebookButton,{query:e})]})}):null]})})})}])},3672946,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M1 5.25V6H2.5V5.25V2.5H5.25H6V1H5.25H2C1.44772 1 1 1.44772 1 2V5.25ZM5.25 14.9994H6V13.4994H5.25H2.5V10.7494V9.99939H1V10.7494V13.9994C1 14.5517 1.44772 14.9994 2 14.9994H5.25ZM15 10V10.75V14C15 14.5523 14.5523 15 14 15H10.75H10V13.5H10.75H13.5V10.75V10H15ZM10.75 1H10V2.5H10.75H13.5V5.25V6H15V5.25V2C15 1.44772 14.5523 1 14 1H10.75Z" fill="currentColor"/>');e.s(["Fullscreen",0,t])},1482429,4912077,e=>{"use strict";var t=e.i(31889),i=e.i(9192216),r=e.i(5086286),o=e.i(2128692),a=e.i(7371622),l=e.i(5115727),n=e.i(854682),s=e.i(4998750),u=e.i(5338940),d=e.i(1821888),c=e.i(2504781),h=e.i(5468328),m=e.i(455575),p=e.i(7553931),g=e.i(6695816);let b="new-notebook";function f(e){return{id:b,title:e||"Untitled Notebook",group:"Personal"}}function y(e){return e.id}let v=e=>{let{title:t,group:i}=e;return`${t}${i?` ${i}`:""}`};function w(e){return(0,t.jsx)("div",{className:"flex w-full items-center gap-2 px-2 py-1.5",children:(0,t.jsx)("span",{children:e.title})})}e.s(["AddToNotebookButton",0,function(e){let{query:C}=e,{hasObservabilityPlusAccess:O,ready:k}=(0,n.useHasObservabilityPlus)(),x=!k||!O,{notebooks:E}=(0,a.useNotebooks)(),{createNotebook:_,isSaving:N}=(0,r.useCreateNotebook)(),{saveWidget:T,isSaving:V}=(0,o.useNotebookOperations)(),[H,S]=(0,g.useState)(!1),{team:M}=(0,u.useTeam)(),I=(0,m.useToasts)(),D=(0,p.useRouter)(),L=(0,l.useDefaultQueryTitle)(C),j=(0,g.useMemo)(()=>E.map(e=>({...e,group:M&&e.contributors.includes(M.id)?"Team":"Personal"})),[E,M]),B=(0,g.useCallback)(e=>{(async()=>{try{if(!M)throw Error("Team not found");S(!1);let t=e.id,i={id:"new",query:C,title:L};t===b?t=(await _({title:e.title,widget:i},"query-builder")).id:await T({notebookId:t,widget:i},"query-builder"),D.push(`/${M.slug}/~/observability/notebooks/${t}`)}catch(e){I.error({preserve:!0,text:(0,t.jsxs)(t.Fragment,{children:["Failed to add query to the notebook.",(0,t.jsx)("br",{}),(0,s.extractError)(e)]})})}})()},[_,T,L,C,I,D,M]),A=(0,t.jsx)(c.Button,{disabled:x,loading:V||N,onClick:()=>S(!0),size:"medium",type:"default",typeName:"button",children:"Add to Notebook"});return x?(0,t.jsx)(h.Tooltip,{text:"Unlock all advanced query features with Observability Plus",children:A}):(0,t.jsxs)(d.Root,{modal:!0,onOpenChange:S,open:H,children:[(0,t.jsx)(d.Anchor,{className:"flex",children:(0,t.jsx)(d.Trigger,{asChild:!0,children:A})}),(0,t.jsx)(d.Portal,{children:(0,t.jsx)(d.Content,{align:"end",onCloseAutoFocus:()=>S(!1),sideOffset:8,children:(0,t.jsx)(i.CommandMenu,{getId:y,getValue:v,label:"notebook",onChange:B,options:j,parseNewValue:f,renderItem:w,reverse:!0,allowEmptyAdd:!0,addLabel:"Create"})})})]})}],1482429);var C=e.i(4991687),O=e.i(6694387),k=e.i(8674454),x=e.i(8459493),E=e.i(3993360),_=e.i(3886311);e.s(["ExportButton",0,function(e){let{handleExport:i,disabled:r}=(0,_.useExportSonarData)(e);return(0,t.jsxs)(C.MenuContainer,{closeOnSelect:!0,position:"bottom-end",children:[(0,t.jsx)(O.MenuButton,{"aria-label":"Export data",disabled:r,shape:"square",size:"medium",type:"secondary",children:(0,t.jsx)(E.Download,{size:16})}),(0,t.jsxs)(k.Menu,{style:{minWidth:160},portalClassName:"pointer-events-auto",width:"auto",children:[(0,t.jsx)(x.MenuItem,{onClick:()=>i("csv"),children:"Export as CSV"}),(0,t.jsx)(x.MenuItem,{onClick:()=>i("json"),children:"Export as JSON"})]})]})}],4912077)},5086286,e=>{"use strict";var t=e.i(4998750),i=e.i(2749380),r=e.i(4244280),o=e.i(9668517),a=e.i(5338940),l=e.i(9979783),n=e.i(6352514),s=e.i(4759942),u=e.i(5757634),d=e.i(4005781),c=e.i(8673480);e.s(["useCreateNotebook",0,function(){let e=(0,o.useTeamSlug)()??"",{team:h}=(0,a.useTeam)(),{mutate:m}=(0,u.useSWRConfig)(),p=(0,c.buildSWRKey)(r.API_NOTEBOOKS,{teamSlug:e}),{trigger:g,isMutating:b}=(0,d.default)(p,async(o,a)=>{let{arg:{title:n,widget:s}}=a,u=(0,t.parseNotebook)(await (0,l.typedFetchData)(r.API_NOTEBOOKS,"post",{slug:e},{title:n,variables:{time:t.DEFAULT_TIME_VALUE},widgets:s?[{query:(0,i.serializeQuery)(s.query),title:s.title}]:void 0},{throwOnHTTPError:!0}));return m((0,c.buildSWRKey)(r.API_NOTEBOOK,{id:u.id,teamSlug:e}),(0,c.updateCachedNotebook)(u,u.widgets?.[0])),setTimeout(()=>void m(p,(0,c.updateCachedList)(u)),1e3),u},{revalidate:!1});return{createNotebook:async(e,t)=>{let i=await g(e);return s.analytics.track(n.AnalyticsEvent.OBSERVABILITY_NOTEBOOK_CREATED,{teamId:h?.id,plan:h?.billing?.plan??"hobby",hasInitialWidget:!!e.widget,source:t??"notebook-list-page"}),i},isSaving:b}}])},7371622,e=>{"use strict";var t=e.i(4244280),i=e.i(9668517),r=e.i(215852),o=e.i(8673480);e.s(["useNotebooks",0,function(){let e=(0,i.useTeamSlug)()??"";return(0,r.useIsomorphicSuspenseSWR)((0,o.buildSWRKey)(t.API_NOTEBOOKS,{teamSlug:e})).data}])},3675495,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M11.4749 1.33217L11.1964 2.02853L6.19636 14.5285L5.91781 15.2249L4.5251 14.6678L4.80364 13.9714L9.80364 1.47144L10.0822 0.775085L11.4749 1.33217ZM4 5.49999C4.82843 5.49999 5.5 4.82841 5.5 3.99999C5.5 3.17156 4.82843 2.49999 4 2.49999C3.17157 2.49999 2.5 3.17156 2.5 3.99999C2.5 4.82841 3.17157 5.49999 4 5.49999ZM7 3.99999C7 5.65684 5.65685 6.99999 4 6.99999C2.34315 6.99999 1 5.65684 1 3.99999C1 2.34313 2.34315 0.999986 4 0.999986C5.65685 0.999986 7 2.34313 7 3.99999ZM13.5 12C13.5 12.8284 12.8284 13.5 12 13.5C11.1716 13.5 10.5 12.8284 10.5 12C10.5 11.1716 11.1716 10.5 12 10.5C12.8284 10.5 13.5 11.1716 13.5 12ZM12 15C13.6569 15 15 13.6568 15 12C15 10.3431 13.6569 8.99999 12 8.99999C10.3431 8.99999 9 10.3431 9 12C9 13.6568 10.3431 15 12 15Z" fill="currentColor"/>');e.s(["Percentage",0,t])},7867910,e=>{"use strict";var t=e.i(6695816);e.s(["useHotkey",0,function(e,i){(0,t.useEffect)(()=>{let t=t=>{let r=document.activeElement,o=r&&["input","select","textarea"].includes(r.tagName.toLowerCase());t.key.toLowerCase()!==i||o||t.ctrlKey||t.metaKey||(t.preventDefault(),e())};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}},[e,i])}])},4047087,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M1 2H1.75H14.25H15V3.5H14.25H1.75H1V2ZM1 12.5H1.75H14.25H15V14H14.25H1.75H1V12.5ZM1.75 7.25H1V8.75H1.75H14.25H15V7.25H14.25H1.75Z" fill="currentColor"/>');e.s(["MenuAlt",0,t])},5627633,e=>{"use strict";var t=e.i(8238153),i=e.i(8492421);let r=["years","months","weeks","days","hours","minutes","seconds"];e.s(["formatDuration",0,function(e,o){let a=(0,i.getDefaultOptions)(),l=o?.locale??a.locale??t.defaultLocale,n=o?.format??r,s=o?.zero??!1,u=o?.delimiter??" ";return l.formatDistance?n.reduce((t,i)=>{let r=`x${i.replace(/(^.)/,e=>e.toUpperCase())}`,o=e[i];return void 0!==o&&(s||e[i])?t.concat(l.formatDistance(r,o)):t},[]).join(u):""}])},2006677,e=>{"use strict";let t=(0,e.i(9334638).withNewIcon)('<path fill-rule="evenodd" clip-rule="evenodd" d="M8 14.5C11.5899 14.5 14.5 11.5899 14.5 8C14.5 4.41015 11.5899 1.5 8 1.5C4.41015 1.5 1.5 4.41015 1.5 8C1.5 11.5899 4.41015 14.5 8 14.5ZM8 16C12.4183 16 16 12.4183 16 8C16 3.58172 12.4183 0 8 0C3.58172 0 0 3.58172 0 8C0 12.4183 3.58172 16 8 16ZM9 11C9 11.5523 8.55229 12 8 12C7.44772 12 7 11.5523 7 11C7 10.4477 7.44772 10 8 10C8.55229 10 9 10.4477 9 11ZM7.09584 5.82182C7.25716 5.48223 7.6022 5.25 7.99999 5.25C8.55227 5.25 8.99999 5.69772 8.99999 6.25C8.99999 6.75329 8.62748 7.17086 8.14337 7.23989C7.70367 7.3026 7.24999 7.67511 7.24999 8.25V8.5V9.25H8.74999V8.63535C9.76443 8.31661 10.5 7.36971 10.5 6.25C10.5 4.86929 9.3807 3.75 7.99999 3.75C7.00158 3.75 6.14136 4.3353 5.74095 5.17818L5.41913 5.85563L6.77402 6.49926L7.09584 5.82182Z" fill="currentColor"/>');e.s(["Question",0,t])},8512757,e=>{"use strict";var t=e.i(1283928);e.s(["isValidAggregation",0,function(e,i){return t.AllMeasures[e].aggregations.includes(i)},"isValidDimension",0,function(e,i){return t.AllDimensions[e].events.includes(i)}])},9372366,e=>{"use strict";var t=e.i(4337458),i=e.i(854682),r=e.i(9667097),o=e.i(1283928),a=e.i(1233856),l=e.i(6695816),n=e.i(8690335),s=e.i(4919835),u=e.i(9486194),d=e.i(9429462),c=e.i(7722264),h=e.i(2107254),m=e.i(9668517),p=e.i(747275);let g=e=>{let{observabilityConfiguration:t}=(0,i.useHasObservabilityPlus)(),r=(0,m.useTeamSlug)(),{data:o,updateSearch:a,search:n}=(0,h.default)({limit:10,latestDeployments:null},{},r??void 0);return{decorate:(0,l.useCallback)(async e=>[...e,...o?.projects.map(e=>{let{id:t,name:i}=e;return{id:t,value:t,label:i}})??[]].map(e=>t?.observabilityPlus.excludedProjects?.some(t=>t.id===e.id)?{...e,disabled:!0,tooltip:"Excluded from Observability Plus"}:e),[t,o]),triggerMutation:async e=>{n!==e.text&&a(e.text)},dimensionId:"projectId"}},b=e=>{let{trigger:t}=(0,d.useDeploymentBadgeResolverMutation)(e);return{decorate:(0,l.useCallback)(async e=>{try{let i=await t();return(0,s.applyBadgesToDeploymentIds)(e,i)}catch{return e}},[t]),triggerMutation:()=>t().catch(()=>{}),dimensionId:"deploymentId"}},f=e=>{let{event:r,measure:o}=(0,n.splitEventAndMeasure)(e),a=(0,t.useSonarQueryScope)(),{hasObservabilityPlusAccess:l}=(0,i.useHasObservabilityPlus)();return{decorate:async(e,t)=>{let{dimension:i,text:n}=t;return a?[...e,...await y({event:r,measure:o,column:i.id,reason:l?"observability_query_builder_plus":"observability_query_builder_free",text:n,...a})]:[]},dimensionId:null}};async function y(e){let{event:t,measure:i,column:l,ownerId:s,reason:d,text:c}=e,h={minutes:5},m=(0,a.startOfDuration)(new Date(Date.now()-36e5),h),p=(0,a.endOfDuration)(new Date,h),g=n.labelColumnByColumn.get(l),b=u.staticDimensionValues.find(e=>e.dimensions.includes(l))?.values,f="number"===o.AllDimensions[l].type;if(b)return b.map(e=>({id:e.id.toString(),value:e.id,..."label"in e?{label:e.label}:{}})).sort((e,t)=>String(e.id).localeCompare(String(t.id)));let y=c?`contains(${g||l},'${c}')`:void 0;return(await (0,r.getSonarData)({event:t,scope:{type:"owner",ownerId:s},reason:d,startTime:m,endTime:p,rollups:{value:{measure:i,aggregation:"sum"}},filter:y,granularity:h,groupBy:g?[l,g]:[l],limit:10,tailRollup:"truncate",summaryOnly:!0})).summary.map(e=>{let t=f?Number.parseFloat(e[l]):e[l];return{id:t.toString(),label:g?e[g]:void 0,value:t}})}e.s(["getDimensionValues",0,y,"useValuesResolver",0,e=>{let t,i,r,{decorate:o,triggerMutation:a}=(t=[f,g,b].map(t=>t(e)),(i=(0,l.useRef)(t)).current=t,r=e=>i.current.filter(t=>null===t.dimensionId||t.dimensionId===e.dimension.id),{decorate:async(e,t)=>{let i=e;for(let e of r(t))i=await e.decorate(i,t);return i},triggerMutation:e=>Promise.all(r(e).map(t=>t.triggerMutation?.(e)))});return async e=>{let{dimension:t,text:i}=e;try{a({dimension:t,text:i});let e=await o([],{dimension:t,text:i});return(0,p.default)(e,"id")}catch(e){return console.error(`Error fetching dimension values. ${(0,c.isError)(e)?e.message:""}`,e),[]}}}])},4998750,e=>{"use strict";var t=e.i(2749380);let i="$time";e.s(["DEFAULT_TIME_VALUE",0,"12h","TIME_VARIABLE",0,i,"extractError",0,function(e){return null==e?"Please retry later":`${e.message??e}`},"parseNotebook",0,function(e){let{variables:i,widgets:r,...o}=e;return{...o,variables:function(e){if(e)return{...e,time:e.time?(0,t.parseTime)(e.time):void 0}}(i),widgets:r?.map(e=>{let{query:{time:i,...r},...o}=e;return{type:"query-visualization",...o,query:{...r,time:(0,t.parseTime)(i)}}})}},"replaceVariables",0,function(e,t){return t?{...e,time:e.time===i&&t.time?t.time:e.time}:e},"serializeVariables",0,function(e){if(!e)return;let{time:t,...i}=e;return{...i,time:t?"string"==typeof t?t:{from:t.from.toISOString(),to:t.to.toISOString()}:void 0}}])},8673480,e=>{"use strict";e.s(["buildSWRKey",0,function(e,t){let{id:i,teamSlug:r}=t;return`${e.replace("{id}",i??"")}?${new URLSearchParams({slug:r}).toString()}`},"updateCachedList",0,function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return i=>{let r=i??{hasAccess:!0,notebooks:[]},o=r.notebooks.findIndex(t=>{let{id:i}=t;return i===e.id});return -1!==o?t?r.notebooks[o]=e:r.notebooks.splice(o,1):t&&r.notebooks.push(e),r}},"updateCachedNotebook",0,function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;return r=>{if(!r)return{...e,widgets:t?[t]:void 0};let o={...r,...e};if(i&&(o.widgets=o.widgets?.filter(e=>{let{id:t}=e;return t!==i})),t){o.widgets||(o.widgets=[]);let e=o.widgets.findIndex(e=>{let{id:i}=e;return i===t.id});o.widgets=[...o.widgets.slice(0,e),t,...o.widgets.slice(e+1)]}return o}}])},2128692,e=>{"use strict";var t=e.i(4998750),i=e.i(4244280),r=e.i(9668517),o=e.i(5338940),a=e.i(9979783),l=e.i(6352514),n=e.i(4759942),s=e.i(6695816),u=e.i(5757634),d=e.i(4005781),c=e.i(8673480),h=e.i(2749380);e.s(["useNotebookOperations",0,function(e){let{mutate:m}=(0,u.useSWRConfig)(),p=(0,r.useTeamSlug)()??"",{team:g}=(0,o.useTeam)(),b=g?.id,f=g?.billing?.plan??"hobby",y=(0,c.buildSWRKey)(i.API_NOTEBOOK,{id:e?.id,teamSlug:p}),v=(0,c.buildSWRKey)(i.API_NOTEBOOKS,{teamSlug:p}),{trigger:w,isMutating:C}=(0,d.default)(y,async(r,o)=>{let{arg:l}=o,n=l.id??e?.id;if(!n)throw Error("Notebook ID is required to save a notebook");return(0,t.parseNotebook)(await (0,a.typedFetchData)(i.API_NOTEBOOK,"put",{id:n,slug:p},{title:l.title,variables:(0,t.serializeVariables)(l.variables)},{throwOnHTTPError:!0}))},{revalidate:!1}),{trigger:O,isMutating:k}=(0,d.default)(y,async(t,r)=>{let{arg:o}=r,l=o?.id??e?.id;if(!l)throw Error("Notebook ID is required to delete a notebook");return(0,a.typedFetchData)(i.API_NOTEBOOK,"delete",{id:l,slug:p},{throwOnHTTPError:!0})},{revalidate:!1}),{trigger:x,isMutating:E}=(0,d.default)(y,async(r,o)=>{let{arg:l}=o,n=l?.id??e?.id;if(!n)throw Error("Notebook ID is required to share a notebook");return(0,t.parseNotebook)(await (0,a.typedFetchData)(i.API_NOTEBOOK_SHARE,"put",{id:n,slug:p},{},{throwOnHTTPError:!0}))},{revalidate:!1}),{trigger:_,isMutating:N}=(0,d.default)(y,async(r,o)=>{let{arg:l}=o,n=l.notebookId??e?.id;if(!n)throw Error("Notebook ID is required to save a notebook widget");let{id:s,query:u,...d}=l.widget;return(0,t.parseNotebook)(await (0,a.typedFetchData)(i.API_NOTEBOOK_WIDGET,"put",{id:n,slug:p,widgetId:s},{query:(0,h.serializeQuery)(u),...d},{throwOnHTTPError:!0}))},{revalidate:!1}),{trigger:T,isMutating:V}=(0,d.default)(y,async(r,o)=>{let{arg:l}=o,n=l.notebookId??e?.id;if(!n)throw Error("Notebook ID is required to remove a notebook widget");return(0,t.parseNotebook)(await (0,a.typedFetchData)(i.API_NOTEBOOK_WIDGET,"delete",{id:n,slug:p,widgetId:l.id},{throwOnHTTPError:!0}))},{revalidate:!1}),H=(0,s.useCallback)(async e=>(await Promise.all([m((0,c.buildSWRKey)(i.API_NOTEBOOK,{id:e.id,teamSlug:p}),e),m((0,c.buildSWRKey)(i.API_NOTEBOOKS,{teamSlug:p}),(0,c.updateCachedList)(e))]),e),[p,m]);return{saveNotebook:async e=>{let t=await H(await w(e,{optimisticData:(0,c.updateCachedNotebook)(e),rollbackOnError:!0}));return n.analytics.track(l.AnalyticsEvent.OBSERVABILITY_NOTEBOOK_EDITED,{teamId:b,plan:f,operation:"title_edited",source:"notebook-details-page"}),t},deleteNotebook:async t=>{await O(t),n.analytics.track(l.AnalyticsEvent.OBSERVABILITY_NOTEBOOK_DELETED,{teamId:b,plan:f,source:"notebook-details-page"});let i=t?.id??e?.id;return await m(v,(0,c.updateCachedList)({id:i},!1)),null},shareNotebook:async e=>{let t=H(await x(e));return n.analytics.track(l.AnalyticsEvent.OBSERVABILITY_NOTEBOOK_EDITED,{teamId:b,plan:f,operation:"notebook_shared",source:"notebook-details-page"}),t},saveWidget:async(e,t)=>{let i=await H(await _(e,{optimisticData:(0,c.updateCachedNotebook)({},e.widget),rollbackOnError:!0}));return n.analytics.track(l.AnalyticsEvent.OBSERVABILITY_NOTEBOOK_EDITED,{teamId:b,plan:f,operation:"new"===e.widget.id?"widget_added":"widget_edited",source:t??"notebook-details-page"}),i},removeWidget:async e=>{let t=await H(await T(e,{optimisticData:(0,c.updateCachedNotebook)({},null,e.id),rollbackOnError:!0}));return n.analytics.track(l.AnalyticsEvent.OBSERVABILITY_NOTEBOOK_EDITED,{teamId:b,plan:f,operation:"widget_removed",source:"notebook-details-page"}),t},isSaving:C||k||E||N||V}}])}]);

//# debugId=2fa759d9-2789-b73f-fb49-1873b21991cc
//# sourceMappingURL=5f8ec35a56707405.js.map